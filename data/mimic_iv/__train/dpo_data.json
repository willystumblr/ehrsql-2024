[{"id": "412c09bd6869eec57b61b8ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most frequent microbiology tests in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_TOTAL_C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) T1"}, {"id": "73b0f8fd2749c9bf490fe19c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost that involves a procedure called insertion of infusion device into right atrium, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into right atrium, percutaneous approach' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "8073dc91a374c05758eb7cd2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the ways to consume sodium bicarbonate?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate'", "rejected": "SELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100025662 ) AND prescriptions.starttime IS NOT NULL"}, {"id": "9854ea8f00dd1975080ca8f7", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me all the prescriptions that patient 10539 received in the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100184541 ) AND strftime('%Y',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "5ff74d440cde4459cd975799", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10018845 admitted to the hospital in 2100 in terms of admission type for the first time?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018845 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "1603ed597a3810e80a4e2f15", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last hospital encounter, what was the insurance of patient 10006580?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "be4864408d7e9c4cb2d27c8a", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the value of patient 10022017's chloride, whole blood second measured on the last hospital visit greater than the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "0548ea40a64c517f125a4be7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021487 get input for the last time since 12/14/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-14' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8f5e6c6df7b4307eb679bfd9", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the five most common specimen tests carried out throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "17usts( FINMS.,. 2023020181372000868477201480'"}, {"id": "1f9a407aceb5f8d72e3a565a", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, has patient 10022041 been to an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "b9628f3fb2ea234ae89e50be", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you have any suggestions for preparation for the temporary tracheostomy procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of stent (biliary or pancreatic duct)' ) )"}, {"id": "1594be7c9bbe32471c73ee0e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen is the earliest next visit of patient 8773 for other departments?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "26f7019ccc450e407b7f54db", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top five most common lab tests since 2100.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT SQL SELECT T1.test_name FROM ( SELECT d_labevents.charttime FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) ) ) ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "04572e0972a7993db0621881", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last microbiological test of patient 10037861 since 01/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "43731ce15c8a2d2bccfff70e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the five most common microbiology test conducted since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT SQL SELECT COUNT( DISTINCT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214878 AND admissions.dischtime IS NOT NULL ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) GROUP BY microbiologyevents.test_name )"}, {"id": "0cf19476dc727db127ab20bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the last specimen test which patient 10018328 has received since 17 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-17 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "cece63fb84d3cf5a6e97cb83", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the treatment given to patient 10007795 two times on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "null"}, {"id": "c0684c1ca2e984f005e2f914", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are five of the most frequent specimens taken since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT SQL SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents JOIN microbiologyevents.microbiologyevents ON microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100160584 ) ) WHERE strftime('%Y',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1 )"}, {"id": "d2f1256d39dcc2e6a1fea9cc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time the respiratory rate of patient 10020187 registered less than 20.0 on 02/03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 20.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-02-03' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "46f0cc9294673a19abea3ead", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring what last time during the first hospital visit did patient 10038992 have the maximum urea nitrogen, urine level?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "213a702cca16592f4d19705a", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10015931 given a magnesium lab test on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "\n## SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '111001' ) AND strftime('%Y', admissions.admittime) >= '2100' ) AND strftime('%m', admissions.admittime) = '10'"}, {"id": "abf27942525ea42427bca966", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of anion gap of patient 10031404 second measured on the first hospital visit less than the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "80b96b20149664dff5b51fb1", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the three frequently ordered treatments for patients who were diagnosed with personal history of other venous thrombosis and embolism within the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other venous thrombosis and embolism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "96bc0ce726e80ebe12254cc0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat time was the first time the arterial blood pressure systolic of patient 10005817 was less than 128.0 in the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 128.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3d6be9c3bab36afdf6303321", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen were patient 10007795 first prescribed for metronidazole (flagyl) and ns at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10007795 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ns' AND admissions.subject_id = 10007795 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.admissions_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole' AND admissions.subject_id = 10007795 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007795 ) AS T2 ON T1.starttime = T2.starttime WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1"}, {"id": "fee1526403313e5913e5874b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many other ascites patients since 1 year ago were diagnosed in the same hospital encounter after being diagnosed with posttraumatic stress disorder?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'posttraumatic stress disorder' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ascites' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NOT NULL AND datetime(admissions.admittime) >= datetime(current_time - 1 year)"}, {"id": "535fb807f200d61057c1b7a0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving inspection of tracheobronchial tree, via natural or artificial opening endoscopic?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "562f824477376311916b88db", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10008287 was diagnosed during their first hospital visit for the last time with what?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "\nSELECT SQL SELECT SUM(inputevents.quantity) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058170 ) ) AND inputevents.stay_id IN ( SELECT inputevents.stay_id FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058170 ) ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'"}, {"id": "d4d740fa5b9015e952111b32", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10027445 was prescribed for the first time in 09/this year docusate sodium and furosemide at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'docusate sodium' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "311010fa82081b7438a008c0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the cost of the family history of malignant neoplasm of trachea, bronchus, and lung diagnosing?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of trachea, bronchus, and lung' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of trachea, bronchus, and lung' ) )"}, {"id": "4883a2a4fe195a7f18fa9e6e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients are there in the 50s age group?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59", "rejected": "\nwhat\nSELECT\n\n##\n\n##\n\n##: Clinicaltrials were conducted on patient 1002182853 on four separate occasions.\n\n\n### SQL:\n\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100113056 ) ) ) AND strftime('%Y-%m-%d', labevents.charttime) = '2100-03-16'"}, {"id": "24ad2857877ae3f6da374f4c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many medications were assigned to patient 10038999 throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\nSELECTIVE\n\n### SQL:\n\nSELECT T1 = ( SELECT SUM(prescriptions.dose C1) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100184540 ) AND prescriptions.drug = 'aspirin' AND datetime(prescriptions.starttime) >= datetime(current_time,'start of month') = datetime(current_time,'start of month','-0 month') ) )"}, {"id": "3bd09b282f97fbf5a9f40eaf", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the weight changes of patient 10027602 last measured on the last hospital visit compared to the value second to last measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "fdf5c1e275419554ef051eb7", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what were the top four most commonly tested specimens?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSEST(T1.C1) AS C2 FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_TOTAL_CNT(microbiologyevents.charttime) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 ) AS T2 WHERE T2.C1<= 4"}, {"id": "6b24642366cb89db4096210b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the rank of the top four most common output events in 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_TOTAL_CNT( outputevents.charttime ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 ) ORDER BY T1.C1 DESC"}, {"id": "4830ab94fb0c437406b08947", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 02/2100, when was patient 10021312's first microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "41e594b8986edc48616272fc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10013049's last input on the last ICU stay?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "= -\".\n T ( Tal'd 2.\n of.)A.4)._2. S2. /\n FROM.=. ( E}\nMSa S1 .1 TMS\nMS- \nMS\n...7md to\n.1.. Js  4. InternationalMSMSJ"}, {"id": "034ccc062d441cb484ca8a57", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10020944 come to the ER since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "occasions. day. ( . P.\n Del...\nd C.\n>e/\nMSak peace1. 1.e\n Romas.)a.1 (ate of1?C.1\n P. TesPay\n P\n.\n.as MicroG\n (1_1Fong. 2dBMS.. VirginPAMS\nMS\nMSs'1 .al1-)\n N. FisherPAMSalesTMS.\nMS HRMSMSPA HISTPA.MSMSMSPA.MSMSPAMSPA 009MSPAMSPA TAMSPAMSPA-0.PA"}, {"id": "0e2ed5b1977c59f79cff3b72", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients with long-term (current) use of anticoagulants were diagnosed in the same hospital visit after previously being diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "7f6a053c4c7996cce251e27b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average overall hospital cost that includes potassium chl 20 meq / 1000 ml d5lr since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "51ad9f66e93f33042ccc4669", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10039831 get their first input since 11/24/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-24' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-24'"}, {"id": "921bedddb3b4dad89ed751aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequently ordered procedures for patients who had also received drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "d1054cc1b2ffa4b3b7000b34", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10007058's first tested specimen in 11/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '11' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND datetime(microbiologyevents.charttime) >= '2100-01-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1 )"}, {"id": "95f50999819423b14b82ff47", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who were in the vascular careunit in the previous year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "\n##\n\n##\n##: Convert\n\n###sql Question:\n\nWhat is the average value of hematocrit in patient 1000265806's body during the last hospital encounter?\n\n\n### SQL:\nSELECT AVG(labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100265806 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' )"}, {"id": "b58e546890ee6007f8e2974b", "query": "Convert the question below to SQL query.\n\n### Question:\nLast year, how many patients were diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "75d97d3e27240d4fbce0b019", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total hospital cost with personal history of malignant neoplasm of other gastrointestinal tract?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of other gastrointestinal tract' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "07f02f8bb9cf48ec09ba120e", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 10/2100, when was patient 10018845's last microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "09d05723516e1dd76fa1efe3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of thoracoscopic lobectomy of lung?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) )", "rejected": "SELECT SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT procedures_icd_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopy' ) )"}, {"id": "0f415abf215849df3c74d8fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average value of bicarbonate in patient 10025612's body?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' )", "rejected": "null"}, {"id": "06e428e5b1ed6505097a25ad", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients in pacu since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "null"}, {"id": "2384e194896033ece54e7e01", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many levetiracetam prescriptions occurred?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'levetiracetam'", "rejected": "null"}, {"id": "7809b76d2d7b213240cd949c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since the first time that patient 10004733 stayed in careunit medicine on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "ac2e5b4fdd7c9a6ea505a929", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat changes were made in the prescription of patient 10004733 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "18010be66782b5371bb31160", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most commonly given diagnoses for patients who had received percutaneous abdominal drainage before within 2 months since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "4d29021ef5a4f0368bdfa1a1", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average o2 saturation pulseoxymetry of patient 10021938 on last month/14.\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '14'", "rejected": "null"}, {"id": "2532d7b2500ba53d5b6005e9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen had patient 10009035 first been prescribed for metoprolol tartrate and senna at the same time in 05/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metoprolol tartrate' AND admissions.subject_id = 10009035 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'senna' AND admissions.subject_id = 10009035 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "9811bdd8dd976caed209c6a2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the value of the mcv of 80.0 among patients of the same age as patient 10018423 during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 80.0", "rejected": "null"}, {"id": "20caa47f8def5c75bb352e6b", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the length of time patient 10031757 was in the ICU during the last visit.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT strftime('%J', icustays.intime) - strftime('%J', transfers.intime) FROM transfers JOIN admissions ON transfers.hadm_id = admissions.hadm_id WHERE transfers.careunit = 'icu' AND admissions.subject_id = 10031757"}, {"id": "d33831f0ec31a6a9c49b16ff", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 06/23/2100, what was the first value of arterial blood pressure mean of patient 10013049?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-06-23' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f14d33079f86bdf9032e4b84", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the recently prescribed medication for patient 10018081 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT SQL SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime) = datetime(current_time,'start of day') AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "e1c93dd5e81567e826a17f47", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top five most common microbiology tests that patients were diagnosed with after the diagnosis of noncompliance with renal dialysis in the same hospital encounter?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "17e15ae68d3705f96b36cfb4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the patient count in the hospital currently?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": ".\non\n.ic\n. ((. ). \n\n. _ ,_\n(\n I-4msries.\n.=BMS1120.MS09MSC_MSLONS.SSCU.S.\n##MSGiven the last time's a.'\nMS'"}, {"id": "62ccca10373d7fea84d98e31", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most frequent events?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n\n\n IN\n....\n;..\n\ner... F\nah."}, {"id": "583645b19b83246b4e37528d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new drugs are prescribed for patient 10018081 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "20\nMS\n\n\n##\n\n\n##\n\n##\n\n##\n##\n##\n\n####\n\n#### Convert the number of patients who had a procedure called drain drainage of left pleural drain since 210/01/21000?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd_code = 'drain drain' AND strftime('%Y',procedures_icd_icd_codes.org_id FROM procedures_icd_codes WHERE strftime('%Y',procedures_icd_icd_codes.org_id) >= '2100-01'"}, {"id": "7d2bcbce845713b8e2ec06ac", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time since 06/05/2100 that patient 10007818's arterial blood pressure mean was measured greater than 72.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 72.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-05' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7eb08c958cc9ce4ba921674f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you point to a genetic test that patient 28447 received?\n\n### SQL:\n", "chosen": "null", "rejected": ".11.-.5 F12........i1212MSMS1-920004002801100212189?05420361975796338?"}, {"id": "db32ddeefc60ef2e085d547a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the common method for taking nystatin cream?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin cream'", "rejected": ".\n\nm\n.\n \n..  Kent..  name\n\n\n new\nata  8. PMSasiam..>)Bs=  1.'\n\n\n' 'C.)'\n\n\n\nMSMSMSMSGORMSMS29'"}, {"id": "661a2833119e979de4228585", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10029291 been prescribed with the medication perphenazine, furosemide, or neomycin-polymyxin-bacitracin since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.drug IN ( 'perphenazine', 'furosemide', 'neomycin-polymyxin-bacitracin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "1cfbdedba5f3d901870e5290", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the percentile of 18.1 in a white blood cells lab test at the same age as patient 10026354 during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 18.1", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum DESC ) AS C1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ) AS T1 WHERE T1.valuenum = 18.1"}, {"id": "66c02202fa82b6035ee4845c", "query": "Convert the question below to SQL query.\n\n### Question:\nSince the last diagnosis of patient 10004733 with unspecified sinusitis (chronic) during this hospital visit, how many hours have passed?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "dc77bd8543dca1e8f57847aa", "query": "Convert the question below to SQL query.\n\n### Question:\nInform me about the total amount of patient 10004235's input since 03/21/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-21'", "rejected": "null"}, {"id": "7344c8361b0e586129656284", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there a restriction of left internal carotid artery with intraluminal device, percutaneous approach procedure performed on patient 10018328 on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "72a2d6a35e2ba5c873f1a881", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10027445 had any medication prescribed since 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'", "rejected": "null"}, {"id": "2c618c0f46c3debf9a6fcad3", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me patient 10020786's total po intake input amount on 07/01/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-01'", "rejected": "null"}, {"id": "2a8475d3f201bfe0a949a29a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001217 since 2100 been given a l lab test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y',labevents.charttime) >= '2100'", "rejected": "null"}, {"id": "548d9de7ae8ea687594077ae", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10022017's first discharge in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "04da33946099754d422c8015", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 16 months ago, what was the monthly maximum dose of packed red blood cells for patient 10021487?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-16 month') GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "null"}, {"id": "c84dfff5f8753a12aab6815f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat organism was found in patient 10029291's first stool test during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "127ee80e549fe86039373e27", "query": "Convert the question below to SQL query.\n\n### Question:\nSo how many days has passed since patient 10018081's last other ventral hernia without mention of obstruction or gangrene diagnosis in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ventral hernia without mention of obstruction or gangrene' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "3fad6d968be4660d18e4a33a", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their last ICU visit, what was patient 10007928's last heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\n### Question:\n\nWhat is the cost of a medication named nifedipine?\n\n\n### SQL:\nSELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND cost.drug = 'nifedipine' )"}, {"id": "f9adfa5449b4f14c535921e5", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any free water medication been given to patient 10018081 since 1 day ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-1 day')", "rejected": "\n### SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'clonidipine' AND strftime('%Y', prescriptions.starttime) = '2100-01-01'"}, {"id": "9aaa83b804392690737b00fb", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the current hospital visit, how many hours have passed since patient 10018081's last diagnosis of acute vascular insufficiency of intestine?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute vascular insufficiency of intestine' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute vascular insfficiency of intestine' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "45ea928adb31250e23c1e7d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the maximum total cost of a hospital that involves suicidal ideation?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "PMSPASTMSPA MSMS.'"}, {"id": "eeb43c515ff535d263e55711", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of hospitalization that includes the reticulocyte count, absolute laboratory test since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'reticulocyte count, absolute' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL AND admissions.dischtime is not null ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "654c90f267446af8ba8f70b5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients that received a bands test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bands' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "\n##\n\n##\n##\n\n##\n## Question:\n\n### SQL Select the top five most frequent diagnoses that occurred in 21000.\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1003105777 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) )"}, {"id": "e6f3a62b65568a7ae075f4d2", "query": "Convert the question below to SQL query.\n\n### Question:\nList the five most frequent specimens that were tested since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n\n##\n##\n\n##\n### SQL Query to check the maximum total length of stay for a procedure named unilateral gastric meds inpatient since 21000.\n\n\n### SQL:\n\nSELECT MAX(T1.length) FROM ( SELECT procedures_icd_icd.length FROM procedures_icd WHERE procedures_icd.icd_code = 'unilateral gastric meds' AND strftime('%Y', procedures_icd.starttime) >= '2100' )"}, {"id": "91c2a89a059f3c099a994282", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10009628 had a medication prescribed via the iv drip route in 10/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "4613327670f705e8aa839350", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top five most frequently tested specimens since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n##\n\n### SQL Query:\n\nSELECT SELECT SUM(outputevents.valuenum FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-01' )"}, {"id": "1cf9f8c80c784082726a6dde", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10014078 received any treatment of continuous invasive mechanical ventilation for less than 96 consecutive hours in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "bf8cfa585a54f3a8d4154adb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the duration of patient 10018328's first stay in the ICU?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "66a7bb5b8a5d8c05eb6fe97c", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top three most frequent medications that patients were prescribed with in the same month after being diagnosed with unspecified infectious and parasitic diseases.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified infectious and parasitic diseases' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "2eaf0a50018f2abf03e6f2da", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average cost of a hospital that involves neoplasm of unspecified nature of endocrine glands and other parts of nervous system?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'neoplasm of unspecified nature of endocrine glands and other parts of nervous system' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'neoplasm of unspecified nature of endocrine glands and other parts of nervous system' ) )"}, {"id": "99bcce6bc0fdda73e97057c2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10027602's first input time since 07/21/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-21' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "0097bca5984143bf4c458509", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most common lab tests done this year?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "afebf65f5f340bb7a59e6c3e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen will patient 17953 next go to the hospital?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug IN ( 'docusate sodium (liquid)', 'glucose gel', 'heparin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "42caec4ca4a8bdfb2bf0e159", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given a creatinine lab test in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "null"}, {"id": "99cc6b6a7018e6ce37338641", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three common diagnoses since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSEXpress FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 3 )"}, {"id": "83ee51e6e7fdc992ab579780", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug prescribed to patient 10027602 for the last time via the pr route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8ef6fa9dfc5f788fb73b69e8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top three most common procedures conducted in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T2"}, {"id": "388eba2ee935cfefacdbbcf6", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide the total volume of output for patient 10009049 on 06/13/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-06-13'", "rejected": "null"}, {"id": "78512e3b7c9ea984222bfee1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many tramadol prescription instances took place since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "SELECT\nSELECT SELECT count(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND strftime('%Y', prescriptions.starttime) >= '2100'"}, {"id": "c30028359953f37651a81962", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019172 been admitted into the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019172 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "9bdbd3f131713d2442b05b80", "query": "Convert the question below to SQL query.\n\n### Question:\nList the single rooms that are available now?\n\n### SQL:\n", "chosen": "null", "rejected": "_\n221191414180002145's code'"}, {"id": "11a79e0284c0d972831a98a0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input time since 10/09/2100 for patient 10021938?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-09' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8236653d88c7fec0c10aeb71", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the current hospital visit, how many hours have passed since patient 10004733's first diagnosis of blood in stool?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "fbb777a428c35d8695cc62d5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum value of ketone on patient 10036156 in 07/this year?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'", "rejected": "null"}, {"id": "fb14ee1d9363c64de1cb8c84", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of hospital visits patient 10009628 had since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10009628 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "11bbd36c75760dc9c37a98e7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the maximum value of patient 10038999's total protein, pleural since 03/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, pleural' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'", "rejected": "null"}, {"id": "a7865e6aada988aba5950707", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell the yearly maximum dose of pacu crystalloid intake that patient 10008454 received since 08/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pacu crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-08' GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "7ae9d2ebad321231f55eb04c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015860 received any laboratory testing in 10/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'", "rejected": "\n## SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214878 ) ) AND strftime('%Y', microbiologyevents.charttime) >= '2100' )"}, {"id": "28a2d17f20583959defd0234", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the monthly maximum value of patient 10027445's weight since 14 months ago?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "f8a7c82b3eb920c707fa250b", "query": "Convert the question below to SQL query.\n\n### Question:\nOn this month/10, when was the first input time for patient 10021487?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '10' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "\nSELECT SELECT MAX(inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-05-26' )"}, {"id": "d1d3935b2877cebd687efc35", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much difference is there in phosphate levels among patient 10015931 second measured on the first hospital visit compared to the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "22a17e0cd02cf807c470a259", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the total volume of pre-admission output for patient 10037975 since 351 days ago?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-351 day')", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-351 day')"}, {"id": "9dea9102653c7bfb36386393", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since patient 10004733 got her first diagnosis of cerebral artery occlusion, unspecified with cerebral infarction on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a9fa2caa73b48c01d20c7f01", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that patient 10012552 was prescribed in the same hospital encounter after receiving a single internal mammary-coronary artery bypass procedure in 04/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10012552 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10012552 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "c41797e8b4af4e6ab554fdc5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the treatment given to patient 10007795 two or more times since 28 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-28 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "SELECT"}, {"id": "cbec37a67b1882b8d6f5c38a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the top five most frequent diagnoses since 1 year ago that patients were diagnosed with within the same month after receiving incision with removal of foreign body or device from skin and subcutaneous tissue?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'incision with removal of foreign body or device from skin and subcutaneous tissue' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "a087cf65a777e7f24185f1a9", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the patient 10009049 a male or female?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10009049", "rejected": "\n. )\n13M.' (PAMSMSL.12217'"}, {"id": "767f78eb035eac463d6a7505", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top five most common diagnoses during this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "'"}, {"id": "3a7b1ab9c06a0e50231e8017", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the yearly minimum value of patient 10020944's weight?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y',chartevents.charttime)", "rejected": "...% 2 01MSM131500180201.\nMSMS1127'"}, {"id": "12a5396f55e7c3fd73c0c640", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who undertook drainage of left main bronchus, via natural or artificial opening endoscopic, diagnostic in the same month, what are the top three most frequent specimens tested afterward since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "5b550bcb1829cb627ed0e4b7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich drug was the last one prescribed for patient 10008454 since 12/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT:\n\n\n##\n\n##: SQL Select the top four most frequent microbiology tests that patients were given within 2 months after being diagnosed with other diseases of the blood and blood-related diagnoses since 21000.\n\n\n### SQL:\nSELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSEXITIME.org_id FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180817 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100' ) GROUP BY microbiologyevents.test_id ) ORDER BY COUNT( microbiologyevents.charttime ) DESC )"}, {"id": "189467f58d0bb8aa60867991", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the maximum o2 saturation pulseoxymetry for patient 10016742's body on 08/03/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-08-03'", "rejected": "null"}, {"id": "e8e6ee69e045e5606f6c0aa9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10035185 get inputs for the last time since 04/14/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-14' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-14'"}, {"id": "95ec9b1ef49e9226257fc6c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of blood patient 18866 has.\n\n### SQL:\n", "chosen": "null", "rejected": "\n.. ....\n\n1MS:-2 clients )PE Air 1.d\n (0000SSK.1\nMS111.'s\n\n'SELECT') 111. 10.3804724874747001's 1.'"}, {"id": "87ea2c2233393dc64798684e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequent lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\n##\n\n##: INFORMENTERATING INCORPORATE DEXTRA\n\n\n### SQL:\n\nSELECT SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100219385 ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "5498f998fad51770de8a3567", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004235 had lab testing since 01/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'", "rejected": "null"}, {"id": "48d5f819ed7042b8dca4b7e5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days elapsed since patient 10004733 received his red blood cells lab test for the last time in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "99dc14e34af5f8b1b714560f", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, how many patients received arteriography of femoral and other lower extremity arteries within 2 months after being diagnosed with other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "537ba5b0d8bba89f02aeaf41", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 06/14/2100, when did patient 10019172 have his last input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-14' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": ":- :1.. C.\n'PA0..-:\n ? Root._1last's C.-ICA-\nMSPAINMS\n (MSPA 0131MSDMSKY NICCMSPAMSM's' )'\n##MSMSPAY's'"}, {"id": "d0ec16bdb0c5a9759d4c0833", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the code which is assigned to icd-11, to referring to legal blindness-usa def that occurs in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n P,AS 1. 1y .1.\n where19/ M11121: 111.PAGEMSMSPA_MS.\n03000001900208890-04?"}, {"id": "b2e7d238f47137722ccb3a30", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the\b reimbursement standard for drug?\n\n### SQL:\n", "chosen": "null", "rejected": "\n###sql Question:\n\nWhen was the last time that patient 100214845 was prescribed medication via the iv route in 03/2100?\n\n\n### SQL:\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214845 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m-%d',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "1a5433aa4aa1b3959ef3e77f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the four most common specimens tested?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "a535d7ccf9ef36b4680fc9eb", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 15209 is subject to covid-19 testing\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n##\n\n##\n##\n\n##\n###code:\n\n###03.0 SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'nifedipine' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100130502 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'"}, {"id": "3dfb9565afee9c41fd63cc07", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 6.8 in the white blood cells lab test with the same age as patient 10009628 in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 6.8", "rejected": "null"}, {"id": "7a5650e936855a3fa424dc59", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of hospital visits patient 10014078 had in the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014078 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT SQL SELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 )"}, {"id": "54b8c3dfb6860adfcdf7012e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10020944 admitted to the hospital in 2100 in terms of admission type for the first time?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020944 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "4dbad1cc3c3af06c5664a2ad", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last year, was patient 10014354 in an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "cf8596ed1cee62a5ad2886d8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price for felodipine?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'felodipine' )", "rejected": "\n202019'C's 03419934457?'"}, {"id": "c3b20e163f22e9c64873825c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time yesterday that patient 10004733's respiratory rate was measured greater than 23.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 23.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "bf1e8983b1cc3c09f253f07c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most commonly prescribed medications.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n\n##\n\n##\n### SQL: SELECT SQL SELECT T1.drug FROM ( SELECT prescriptions.drug.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100125402 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AND strftime('%d',prescriptions.starttime) = '21' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "b49883cb372deacf8d0d0392", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of input for patient 10018081 since 09/25/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-25'", "rejected": "null"}, {"id": "ce6918d801a0e9dc37e563ce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most frequently prescribed medicines this year?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "\n##\n\n##\n### SQL:\n\nSELECT SELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of left lower lobe bronchus with tracheostomy, percutaneous approach' ) ) ) AND datetime(prescriptions.starttime) >= datetime(current_time,'start of year','-0 year') ) AND strftime('%m',prescriptions.starttime) = '04' )"}, {"id": "2599f881605016f342ed4ad8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first value of o2 saturation pulseoxymetry patient 10001217 had on 12/04/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-04' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "bb12c097d6c3840101205ef8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the five most common lab test that was given in 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\n##\n##\n\n##\n### SQL Query:\n\nSELECTION_ID IN ( SELECT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd_procedures.icd_procedures.icd_code ) AND admissions.hadm_id IN ( SELECT procedures_icd_icd_procedures.icd_procedures.icd_code ) AND strftime('%Y', admissions.dischtime) >= '2100-04-07' ) AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id ) AND strftime('%Y', transfers.intime) >= '2100-04-07' ) GROUP BY admissions.hadm_id ) AND strftime('%Y', procedures_icd_icd_procedures.charttime) = '2100-04-07' )"}, {"id": "c1b9f618d57148f9613d4e17", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich procedure was performed on patient 10027602 two or more times since 11/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-11' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "493b74ce7611de520a722436", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output patient 10007058 last had since 05/10/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-10' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "67a35d73e846d6a5995d2dd4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the value of the free calcium of 1.06 among patients of the same age as patient 10026255 in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.06", "rejected": "null"}, {"id": "26ca7defafe27bfa854cf965", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of ICU visits for patient 10009628 last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n##\n##: Calculate the total number of hospital visits for patient 100158685 since 03/2100.\n\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 100158685 AND strftime('%Y-%m', admissions.admittime) >= '2100-03'"}, {"id": "b5e8c7efd2cc02936f14bf95", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10039831 since 03/24/2100 for the last time have an input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-24' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f99e58fee0562c646b3dc682", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any prescriptions been given to patient 10022017 during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "be2ea8ec1974fc0574f2921f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021487 had a total nucleated cells, pleural test done in 10/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'", "rejected": "null"}, {"id": "f7b36fae7e1f6246c0b81fd5", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits for patient 10022041 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022041 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "5ec73b90a9326c7868163c73", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10018081 was prescribed drugs via oral since 08/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'oral' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "25766b07f551c549f6e3c32f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total cost of a hospital that contains anemia in chronic kidney disease?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in chronic kidney disease' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia' ) ) GROUP BY cost.hadm_id )"}, {"id": "486691bb6da24ab4f1918724", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the first output of patient 10015860 since 06/05/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT\n\n\n##: SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1003983879 AND admissions.dischtime IS NOT NULL ) AND strftime('%Y', admissions.starttime) >= '2100'"}, {"id": "23c373a6a8da42752c85db68", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost which includes a drug named ciprofloxacin hcl?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin hcl' ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\n right?111201\n_9011331238003201791750080 AND 09011-0409"}, {"id": "4c475fcaf3bf16551e866c3c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most frequent diagnoses since 1 year ago with which patients were diagnosed after receiving extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic during the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "2c4de5ffe5ea946437ba33a6", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last hospital encounter, how old was patient 10019172?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\n### SQL:\n\nSELECTIVE PROCEDURES INCORPORATED IN PATIENT 100216545 SINCE 07/07/2100?\n\n\n### SQL:\nSELECT COUNT(*) FROM procedures_icd_code_icd WHERE procedures_icd_code_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100216545 ) AND strftime('%Y-%m-%d-%m',procedures_icd_icd.charttime) >= '2100-07-07' )"}, {"id": "682b7c020d47e07237753b11", "query": "Convert the question below to SQL query.\n\n### Question:\nWas ketorolac, simvastatin, or lactated ringers prescribed to patient 10011398 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'ketorolac', 'simvastatin', 'lactated ringers' )", "rejected": "null"}, {"id": "cd05e6424347ce699cf7b7cd", "query": "Convert the question below to SQL query.\n\n### Question:\nQuantify the number of patients who were tested since 1 year ago for absolute lymphocyte count.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute lymphocyte count' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "\nSELECT SELECT COUNT( DISTINCT COUNT( procedures_icd.procedures_icd.icd_code ) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND datetime(procedures_icd.starttime) >= datetime(current_time,'-1 year') )"}, {"id": "05a9aa5bb494b962444ac354", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the dose of docusate sodium (liquid) that was last prescribed to patient 10016742 since 03/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'docusate sodium (liquid)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8444ba22b9c952cf50e50901", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you confirm what was the first temperature celsius for patient 10021487 in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d', chartevents.charttime) = '2100-04-11' ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "06c9202911fa52427beba085", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum value of patient 10001217's calcium, total in 12/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'", "rejected": "null"}, {"id": "a8fc0b9f87df5a45d66da39e", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the cost for the procedure called drainage of left pleural cavity, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) )", "rejected": "null"}, {"id": "40e6d3bcc00d291b26feb3e7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10010471 first receive an input in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "4c0ba2326075b47121880872", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10035185's total amount of nacl 0.9% input.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "b90455e3cd10a2bcfe8f3419", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four frequent output events that occurred since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n. .s'B.1srix.-,1( 2?\nMS T-202102-2032: PA'sPAUL 1102 which1.MS.\n'<'\n##'"}, {"id": "891190b131bd38e70baa856f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of a hospital, which includes a drug called ciprofloxacin iv since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100012175 AND admissions.dischtime IS NOT NULL AND strftime('%Y',admissions.admittime) >= '2100' GROUP BY admissions.hadm_id )"}, {"id": "c7e591a3774d0f7222f7345c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between arterial blood pressure mean on patient 10002495 last measured on the last ICU visit compared to the value second to last measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "519ec63fd6ee4ba4f86c8048", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when patient 10007928 had their first blood culture microbiology test in 04/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "b2c10ed422acd1b5e903bf20", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10020740's yearly maximum weight since 28 months ago.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') GROUP BY strftime('%Y',chartevents.charttime)", "rejected": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-02' GROUP BY strftime('%Y',chartevents.charttime)"}, {"id": "5c0ef35bdd581b7068ef254e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time in 11/2100 patient 10006053 had the minimum potassium, whole blood value?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "fd369ed514a6f2c485af417b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10018081 had the calcium, total minimum value during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "8683f07aa65fa12c04532cd7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common procedures that occurred within the same month for patients who had central venous catheter placement with guidance before in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "d57dc0bf4122ea92cbe3fbbf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10007818 was prescribed medication via the replace route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'replace' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT microtime FROM admissions WHERE admissions.subject_id = 10007818"}, {"id": "2ed30506921aece493589863", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a procedure known as partial hepatectomy cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) )", "rejected": "\n\n##\n##\n\n##\n\n##\n##### SQL Query:\n\nSELECT SELECT COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_codes.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute cerebrovascular ischemic infarction' ) ) AND strftime('%Y-%m-%d', d_icd_procedures.charttime) = '2100-01-22'"}, {"id": "27672ae2ddb12a394c90cad6", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top three most frequent medications that patients were prescribed with within the same month after being diagnosed with traumatic shock since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "6d8c0ea325ed343de1ad7c30", "query": "Convert the question below to SQL query.\n\n### Question:\nHey, what was patient 10016150's minimum triglycerides value since 02/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycerides' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-02'", "rejected": "null"}, {"id": "ddf67e92449897f5c52db5d2", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequent microbiology tests that were given to patients after they were diagnosed with sepsis during the same hospital visit during this year.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "ba3296488999e2e149c3a32e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often was other enterostomy done?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other enterostomy' )", "rejected": "('U NecPAMSMS.\nMSMSPAGPAIDPAGEPA: What is the diagn?PASTPAGECANA CATH Lab Test's\n##'"}, {"id": "d289ae08b9d6d02468d8c8d2", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 22 months ago, how much did patient 10019172 weigh during the first measurement?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "792f2622a77b8638438de22f", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients diagnosed with other specified retention of urine before, what are the top five most common treatments in the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified retention of urine' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "4449c0b54dc6e4a7af5dc9d8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first value of a myelocytes lab test of patient 10004235 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'myelocytes' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e2b25103644606a2debc3586", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10038933 was prescribed medication in 09/this year via the ih route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'ih' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "0852a3db12699e7218a1fb0c", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease send me the name of the diagnostic diagnosis patient 5828 received at the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "fa39db2734c74d5812a74112", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10027602 had input since 11/26/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "7cfaf497121871d021a26099", "query": "Convert the question below to SQL query.\n\n### Question:\nCount up how many times patient 10000032 was admitted to the ICU since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.admission_location = 'icu' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "757779a8ac74dd38488f923f", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most frequent procedures that were delivered to patients within the same hospital visit after they received other endovascular procedures on other vessels.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 4 )"}, {"id": "2616e051ac4579e504b2e48d", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their first hospital encounter, what was the diagnosis for patient 10004720 the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100077955 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "eba7513c50f91f2da09549f4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10019172 prescribed aspirin and aspirin ec at the same time for the first time since 04/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10019172 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin ec' AND admissions.subject_id = 10019172 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "dd2f29754291be893cdcffa8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10004733's last specific gravity laboratory test on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "0843691130d6cd5cd2dedc9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients that were given a ferritin test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "\n\n####\n\n\n##\n##\n###04. What are the chances of getting a diagnosis code for icd-11 for the first time this year?\n\n\n### SQL:\n\nSELECT DISTINCT diagnoses_icd.d_icd_code FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'icd-1' AND datetime(diagnoses_icd.current_timezone) = 'this year' ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "d84c6c7fe6daa03fe7f81c8b", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how many patients underwent insertion of endotracheal tube during the same month after the diagnosis of acute kidney failure, unspecified?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "c060af6a8bb23ffdee50e730", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first input time of patient 10004733 since 10/30/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-30' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a3a2597423bb12f178e4e5b7", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the drug that patient 10020740 was last prescribed in 04/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "653d08c20f74e5bc126dbcac", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top five most frequent medications that patients were prescribed with during the same month after being diagnosed with personal history of other endocrine, nutritional and metabolic disease.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other endocrine, nutritional and metabolic disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "f18a1ffa1752d917bfb094ac", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the pt value of patient 10018081 second measured on the current hospital visit greater than the value from the first measurement on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pt' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pt' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "7109e759c570a654d53e3ee4", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10006053 involved in any medical procedure on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "\nSELECTIV infusion of concentrated electrolyte into a central vein, percutaneous approach\n\n\n### SQL:\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'IV infusion of concentrated electrolyte into a central vein, percutaneous' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100'"}, {"id": "997ad426b096ea558462f1a2", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10005817 have an input of kcl (bolus) on this month/25?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '25'", "rejected": "null"}, {"id": "8a3f528d01b5216685826b2a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of patients stayed in medicine/cardiology during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine/cardiology' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "\n### Question:\n\nWhat was the total number of patients who were prescribed opioids in 2100?\n\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadmissions_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug IN ( 'opi' ) AND strftime('%Y', prescriptions.starttime) = '2100' )"}, {"id": "f26a53de07f2471e33f3f8b5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of excision of dental lesion of jaw procedures that took place in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "4e5496cc5a22509ea5c3e4e8", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, how many insertion of endotracheal airway into trachea, via natural or artificial opening procedures were there?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal airway into trachea, via natural or artificial opening' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "e6c07526b6246ff9377949ba", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 07/2100, what was the last drug that patient 10004720 was prescribed through the po/ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "69662f679dde3d8d7bc6490c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the difference in the respiratory rate value for patient 10007058 second measured on the last ICU visit compared to the first value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "bca05145ac82b49ae8acc4b4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the count of patients who left the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "-23: 3\n.\n1401923201881398898405289 AND 09'"}, {"id": "2f8b95322025bab1d2c8da4f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10006053 been prescribed a specific drug since 11/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'", "rejected": "null"}, {"id": "be077de71c2eb054f92281d8", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the protocol of anti cancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\nSELECT\n\n### SQL:\n\nSELECT the total number of patients who were prescribed phenytoin since 2100."}, {"id": "96550da61d7335c3ccc3d5d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for a drug named lidocaine?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine' )", "rejected": "\nSELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polycythemia' ) AND strftime('%Y', admissions.dischtime) >= '2100' )"}, {"id": "74439a67da9347c057e1d1c8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen had patient 10016810 last been prescribed for pseudoephedrine and levothyroxine sodium at the same time since 06/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pseudoephedrine' AND admissions.subject_id = 10016810 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levothyroxine sodium' AND admissions.subject_id = 10016810 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "6f8ec1a440771aa4151d974e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was prescribed to patient 10020740 for the last time in 03/2100 via the po route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "efd16ed6fcf1c6e667f9bca7", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of people who had arteriography of cerebral arteries last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "MSPA 000.\n\n\n##\n\n##\n##\n##\n##\n###Question\n\n## Question:\n\n### SQL:\n\n### Question:\n\nHow many days has it been since patient 1000079585's last diagnosis of vascular insufficiency of left iliac artery bypass graft, percutaneous approach in 21000?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.disch time FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code ) AND strftime('%Y', admissions.admittime) >= '2100' ) ) AND strftime('%Y-%m', admissions.admittime) = '2100'"}, {"id": "d4ffd536638a0b500dea5e1d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug patient 10017492 was prescribed within the same hospital visit after having received a spinal tap procedure in 03/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10017492 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10017492 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "11cc0c3c5ddde55f2933b0a4", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10020740's total amount of foley output on their last ICU stay.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' )", "rejected": "SELECT SQL: SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078185 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-17'"}, {"id": "8511198e010ebb4b33fcc4e3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the aggregate input volume for patient 10007058 since 38 days ago?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-38 day')", "rejected": "\n##\n### SQL:\n\nSELECTIVE CATHETERIZATION OF coronary artery, open approach, percutaneous approach, diagnostic."}, {"id": "75dcf661ef83b60c79a0aa34", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the respiratory rate reading for patient 10026406 last measured on the first ICU visit less than the value second to last measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "e487dbd0cdcc7e16522be18e", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top five most common microbiology tests that patients were diagnosed with in the same month after being diagnosed with personal history of malignant neoplasm of tongue?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of tongue' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of tongue' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1<= 5"}, {"id": "c327e43875d95df50f74425e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10005817 had the hematocrit, calculated maximum value?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "\n\n### Question:\n\nWhat is the difference between the two readings of o2 saturation pulseoxymetry for patient 100214845's body on 03/15/2100?\n\n\n### SQL:\n\nSELECT current_time - datetime(chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214845 ) ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-03' ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "fbeef7a4b32462cf2f85c7ab", "query": "Convert the question below to SQL query.\n\n### Question:\nAnd what was the first time patient 10038933 was prescribed medication using the td route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "7170b2897858fa87237babee", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how many open reduction of fracture with internal fixation, humerus procedures were done in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "17c8391662dfc6e28aa56464", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many drugs have been prescribed to patient 10023239 in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "a342759e5ce55cf378df2630", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015272 come into the ER?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.admission_location = 'emergency room'", "rejected": "null"}, {"id": "f19baaf7b04bf9e553dd2cbf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10018328 was prescribed medications via the iv drip route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "2ff2e805ec42ef3feedcd1aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients receiving thoracoscopic decortication of lung during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic decortication of lung' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "facfa7d227ce410e9a85def3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the title of the medication that was given to patient 10014078 first via the sc means on the last hospital stay?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "5837deca15847d294628637f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the cost of repair of atrial septal defect with tissue graft?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of atrial septal defect with tissue graft' ) )", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of atrial septal defect with tissue graft' ) )"}, {"id": "297e289223cc1de4d969b78b", "query": "Convert the question below to SQL query.\n\n### Question:\nWill patient 28443 receive any additional immunology test?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n### SQL: SELECT SQL SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'microalbumin' ) AND strftime('%Y', labevents.charttime) = '2100' GROUP BY labevents.hadm_id )"}, {"id": "179e0c7223f1d82e5c946ad0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many congestive heart failure, unspecified patients in this year were diagnosed during the same month after being diagnosed with other nonspecific abnormal finding of lung field?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific abnormal finding of lung field' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year') ) )"}, {"id": "ae7068db15837f529f79fa01", "query": "Convert the question below to SQL query.\n\n### Question:\nShare the five most frequently performed procedures since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": " Seal of.ure1 T:\n the ::0..'0 de0.  5\n C./s2.(1..58..2 1 C\nMS. US2801MM1MSPA:MSMSSSMSPAGMSPA-0000000000000010000000000120000003036709000420100508150081000039900000009030000112000390006010"}, {"id": "c32224fbcb946a4db57012a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile ranking of a asparate aminotransferase (ast) test value of 33.0 for patients of the same age as patient 10007795 during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 33.0", "rejected": "null"}, {"id": "ae481d3d9b25f812bf25bdfd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four commonly given procedures for patients that also received other incision of brain previously within the same hospital visit, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "0186746594c1cf90e38d4ffd", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10006053 had a lab test for basophils since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',labevents.charttime) >= '2100'", "rejected": "null"}, {"id": "37921e0dd6b843c93c0dacc1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top three most common lab tests in 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SELECT d_labevents.label FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'coagulation time, whole blood' ) ) AND strftime('%Y', labevents.charttime) = '2100' ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "e4b5f1fc800b0d54f32ed37b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total hospital cost that includes benign neoplasm of cerebral meninges in 2100.\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'benign neoplasm of cerebral meninges' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "acc3a9c211f42e9d6d154a20", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five diagnoses associated with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "\n\n##\n##\n\n##\n###03. What is the minimum total sum of input for patient 1000213577 since 04/02/21000?\n\n\n### SQL:\n\nSELECT SUM(inputevents.quantity) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100072058 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-04'"}, {"id": "3bb6bf7407b7133944318142", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10005909 prescribed a acetaminophen and oxycodone (immediate release) at the same time for the first time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10005909 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'oxycodone (immediate release)' AND admissions.subject_id = 10005909 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "9b039ee786a20e3b239037e0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were staying in med/surg/trauma in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/trauma' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "\n### SQL Question:\n\nWhen was the first time in this year patient 100214877 was prescribed acetaminophen?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10021487 AND datetime(admissions.admittime) >= datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "cc8811490b346c0fe68bf66b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10027602's weight differ from the second value measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "b9aa9ee30245b8000f1127e3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent extirpation of matter from left femoral vein, percutaneous approach in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'-1 year') ) )"}, {"id": "3744204f6970ebf11f57c0ba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time when patient 10019568 received a platelet count lab test during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "22e1a21fc783d4bd45120187", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the first heart rate value that patient 10008454 had on this month/03?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '03' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5e54019ee712a69d9eb50369", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three frequently tested specimens for patients that received extirpation of matter from left femoral vein, percutaneous approach previously within 2 months this year?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "9b11adf840122cc37bef0ed4", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me about the most common four output events during this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT DISTINCT T1.event_type FROM ( SELECT d_icd_procedures.icd_code, DENSE.COUNT( events.charttime ) AS C1 FROM ( SELECT procedures_icd.icd_code, events.charttime FROM procedures_icd JOIN admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100167402 ) ) ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = ( SELECT max(T2.C1) FROM ( SELECT T1.C1, DENSE.C1 FROM T1 JOIN DENSE.events AS T2 ON T1.charttime = T2.charttime ) GROUP BY T1.icd_code ) AS T3 ON T3.C1 = 1 )"}, {"id": "304008138415ff886f9fa539", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the total amount of patient 10008454's output on this month/02.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '02'", "rejected": "null"}, {"id": "233c13143fc7c9d92e63dbb4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drugs are being added to the prescription of patient 10004733 today compared to those yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "b51511a676f74b3a0f868b97", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference in patient 10021487's weights measured at 2100-12-22 04:00:00 compared to the value measured at 2100-12-20 00:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' )", "rejected": "null"}, {"id": "db84c0e7a45cffa783b0950f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last arterial blood pressure systolic in patient 10020187's body on 02/04/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-02-04' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": ".PA, the lastICPAMSMSPA T201.24264267543999's IN ( icd-icd-procedure-name FROM admissions WHERE MIN(ICD_procedures."}, {"id": "54422dbdbf89248bf6be26fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of times rosuvastatin calcium was prescribed in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'rosuvastatin calcium' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "Year \n_  ( .1 (1 - _ Str< FAother..\n Y.2\n. ExMS. R.1\nMS\n\n.eC\n.\n\n***_\n to - 1 :...\n (\n.\n1.en.ng.-\nology -atF 2-9d2's.ov_21111\nMS9<\nMS\nMSMS10011.\n\n 01MSMSA 1328)D inMSPA.MSPA VsMSPA LLPAGEPAKURE 10.\n##MS, diagnosis INCICU.\nCAICU CACSINIMPCANS T2"}, {"id": "e8cd5393964734cd6a8a6375", "query": "Convert the question below to SQL query.\n\n### Question:\nAre you letting me know if patient 3677 is subject to covid-19 testing?\n\n### SQL:\n", "chosen": "null", "rejected": "##\n\n##\n\n##\n##\n"}, {"id": "cd7ec076d6dd032a842781fe", "query": "Convert the question below to SQL query.\n\n### Question:\nToday compared to yesterday, what new medication does patient 10039831's prescription include?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\nSELECT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100128535 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "27c48e778f2f116680270dd6", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most frequently prescribed drugs within 2 months for patients in their 20s who were diagnosed with long-term (current) use of anticoagulants.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "d300ea660eb771a66fc8d2c4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the blood type of patient 32168?\n\n### SQL:\n", "chosen": "null", "rejected": ". ?!.\n' Tay?0 the 112120239181413411910003021837000806'"}, {"id": "ecbc2ee919ccc6a0dea03692", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most frequent medications prescribed within 2 months to the patients in their 60 or above after they were diagnosed with alcohol abuse, unspecified?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "c464ddc6ede81a650537c328", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen, on 01/28/2100, was patient 10019917's heart rate measured less than 73.0 for the last time?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 73.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-01-28' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8d5bb2ecca85dfad41515eb5", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10010471 been admitted to the emergency room since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND admissions.dischtime IS NOT NULL ) AND transfers.careunit = 'emergency room' AND datetime(transfers.intime) >= datetime(current_time - 1 year) ) = 0"}, {"id": "6ec318a2ef73df94df5bdcae", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in patient 10007058's last microbiological serology/blood test in 11/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND microbiologyevents.spec_type_desc = 'serology/blood' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "cf44316ed6f26cdb2af0efb9", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the average total cost in a hospital where tramadol (ultram) is used since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tramadol (ultram)' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tramadol (ultram)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) ) GROUP BY cost.hadm_id )"}, {"id": "0702dadc0d64bed5fdf71418", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the standard of reimbursement for chromosome and genetic tests?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL\n\n### Question:\n\nGet the top five most frequent procedures performed during the last year.\n\n### SQL:\nSELECT d_icd_procedures.procedures_icd_code, COUNT(procedures_icd_icd.charttime) AS C1 FROM d_icd_procedures JOIN d_icd_procedures ON d_icd_procedures.icd_code = d_icd_procedures.icd_code WHERE datetime(d_icd_procedures.charttime) >= datetime(current_time,'start of year,'-1 year') GROUP BY d_icd_procedures.icd_code ) GROUP BY d_icd_procedures.icd_code ) AS T1 WHERE T1.C1<= 5"}, {"id": "523b2264acf6a8ceaf29d220", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10004733's last serology/blood's microbiology test time in 12/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND microbiologyevents.spec_type_desc = 'serology/blood' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "110ca8ef52a592fe8201ca1c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat diagnosis did patient 10005866 have last in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "\nSELECT SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019740 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )"}, {"id": "61f59af2792e3a760c51ddd9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10011398's first input since 04/16/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-16' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "2202303447142eaeb02bfd69", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum value of phosphate on patient 10021666 in 03/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'", "rejected": "null"}, {"id": "44f2c9be4fc4e3268e1c8ba0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time of patient 10019385 staph aureus swab microbiology test since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "adcd9306676f578f4acf1d8a", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top five most frequent events since 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "*,. Less\niFT.T..d\n )d' 1)/ EMSUMSPAMSPAMSMS.(\nMS.13MSPA =MSPA, the C ONPA ' AND 200021814 AND 0 AND patient_id IN ( SELECT_had a total hospital visits since 12100?"}, {"id": "8288ab2fa75b4a191de46940", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the count of the drugs patient 10040025 was prescribed during their first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "\n##: SELECT SQL SELECT COUNT(*) FROM ( SELECT COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100159385 AND admissions.dischtime IS NOT NULL ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "695030002227c1585f70824e", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with accidental fall on or from other stairs or steps since 2100, what are the top three medications prescribed within the same month to patients in their 30s?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall on or from other stairs or steps' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall on or from other stairs or steps' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "0e1d898b2e27b9241962d250", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the count of phlebography of the portal venous system using contrast material procedures that took place since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'phlebography of the portal venous system using contrast material' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "7b577f35637bc7f7cda8a6fc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10005817, since 12/02/2100, had the maximum arterial blood pressure systolic?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-02' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a9ed4f9d02d20ef0e5b898fe", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10001725's length of stay for the first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECTIVE PROCEDURES ON CIRCULATION\n\n\n### SQL:\nSELECT COUNT(procedures_icd.procedures_icd.charttime) FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100084545 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endo] gastric mediascopy' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05'"}, {"id": "17de3ba481cc927f60d16233", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five diagnoses that had the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "null"}, {"id": "f0ed8bc2f755ef37eb17af6e", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021938 receive any surgery on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "dbe29d2282f5b3aed0d011d3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10029291 gone to an emergency room since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "52e1920bba1dc62e51feb58b", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of medicines that have been prescribed to patient 10021487 in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "1fc3739dc0cf84ab7935fd38", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was the last drug prescribed for patient 10020786?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT T1 FROM ( SELECT admissions.drug FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "fe646e876da3a9452e4e05ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the number of patients who were laceration of intercostal blood vessels, left side, initial encounter diagnosed since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'laceration of intercostal blood vessels, left side, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'laceration of intercostal blood vessels, left side, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'laceration of intercostal blood vessels, left side, subsequent encounter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "c4d75676ab4ff43eaf58b28b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021938 receive mrsa screen microbiology test the last time in 11/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '11' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "cdf6333e8b6736879a871a9a", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10004720's total amount of tf residual output on this month/07.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tf residual' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '07'", "rejected": "SELECT SQL SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND outputevents.stay_id IN ( SELECT outputevents.stay_id FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') )"}, {"id": "e447bf35d8f5b5f515e7b40e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum daily number of patients diagnosed with closed fracture of dorsal [thoracic] vertebra without mention of spinal cord injury since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of dorsal [thoracic] vertebra without mention of spinal cord injury' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "4ee0ef355bae021a512da458", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that patient 10031757 was prescribed acetaminophen and phosphorus since 10/2100, at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phosphorus' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "388d3f6a45be242b02005c5c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10018081 got her last diagnosis of other and unspecified hyperlipidemia on their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "be05d63abe091e094958fc47", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed in careunit medicine in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\n  .: \n.1.  G. -ies\n\n21:3.y3\n01.1\n T-) 11 YaleMSPAMSMSMSPA 02180188200210018'"}, {"id": "a1bce132ee08a48c0ca7f84c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat the name of the diagnosis that patient 14467 received in the other department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT\n\n\n##\n\n##: count the number of patients who stayed in the ICU during the last year.\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT T1.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT icustays.icd_procedures.icd_code ) AND datetime(strftime('%Y', icustays.intime) >= '21000-05' )"}, {"id": "387697552eec0b37359509db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that patient 10004235 was prescribed in the same day after having received a laparoscopic cholecystectomy procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "437e22cc3839c9e567107949", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of the hospital which involves chronic systolic (congestive) heart failure in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic (congestive) heart failure' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic (congestive)' ) ) AND strftime('%Y', cost.chargetime) = '2100' GROUP BY cost.hadm_id )"}, {"id": "23bbac068db32a4e588f2d9e", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease list out the monthly maximum weight of patient 10039997 in the first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "SELECT SQL SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1003999776 ) AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100399976 ) AND strftime('%Y-%m', chartevents.charttime) = '2100-07' GROUP BY strftime('%Y-%m', chartevents.charttime)"}, {"id": "327a6b8b85b9df578f97d124", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the average monthly number of patients who were diagnosed with chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "31fc326ca001513cb405a126", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the newly prescribed drugs for patient 10039831 today compared to those prescribed yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 day') ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "0a34cd28b27d1c03905616d8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10039997 admitted to the hospital since 1 year ago in terms of admission type for the first time?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "4aaf4f3c76752b37f232e69b", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you fetch the top three most common specimens tested in 2100 for me?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSEST(T1.C1) AS C2 FROM ( SELECT microbiologyevents.spec_type_desc, COUNT(microbiologyevents.charttime) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T2 WHERE T2.C1<= 3"}, {"id": "5d325bcbd050d7d6eabfcab9", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any procedures been performed on patient 10019568 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "9b96ce996e808fd4f87d1eee", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total tf residual output in patient 10020944 in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tf residual' AND d_items.linksto = 'outputevents' )", "rejected": "\nSELECTIVE: SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-19'"}, {"id": "cd0bcb070c47177a7ad4ff35", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last year, how many patients were provided with vancomycin oral liquid?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin oral liquid' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "'ASC\n\n##\n\n' AND ( ( 1.\n\n\n##' AND T2. What is the maximum total number of patients who were prescribed prescriptions for oral medications since 1 year ago?\n\n\n### SQL\n\nSELECT SQL to count the total number of patients who were diagnosed with unspecified unspecified ischemic heart disease in 21000?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002188545 AND admissions.dischtime IS NOT NULL )"}, {"id": "df5a3dc1bac62f8679a50e44", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10023239's % hemoglobin a1c last measured on the first hospital visit greater than the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "6232ae4db195276a3e324143", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10000032 tested on pt in 08/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08'", "rejected": "null"}, {"id": "687bceb15b59fc60e8fe6650", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide the top four most common output events in 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 ) ORDER BY T1.C1 DESC, ASC"}, {"id": "669a0b2733d0accec1a73720", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the recorded sex of patient 10015931?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10015931", "rejected": "null"}, {"id": "91a1b7d722fd22c60cb7f9c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are patient 10027602's changes in glucose, csf second measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "9645c89ce0e75ea8d9ab156a", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know the average alanine aminotransferase (alt) value of patient 10004733 in 12/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'", "rejected": "null"}, {"id": "fb06f32bc5c8aef557ce529e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10004422 last get prescribed aspirin and milk of magnesia at the same time in 01/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10004422 AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10004422 AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "7d6cd973b881473d4b309a26", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the count of ICU visits for patient 10022017 last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "3310a57f349b527861680281", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of the drug, finasteride?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'finasteride' )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.drug = 'finasteride'"}, {"id": "c1f369fb99bd717e87c34253", "query": "Convert the question below to SQL query.\n\n### Question:\nOn their first hospital encounter, was patient 10009049 given any diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "f1189d2c589416c9c81ca80e", "query": "Convert the question below to SQL query.\n\n### Question:\nSince the first time patient 10004733 was diagnosed with chronic kidney disease, unspecified in this hospital visit, how many days have passed?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "b5bfc514c70281b00a67544d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10004720 was measured respiratory rate greater than 9.0 on this month/06?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 9.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '06' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "3b9849548e56c59f768d5447", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum respiratory rate in patient 10021118 in the first ICU visit.\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' )", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respirations' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum = MIN( chartevents.valuenum ) ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "1089bbe66e821577636739ae", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last hospital encounter was readi-cat 2 (barium sulfate 2% suspension), glipizide xl, or sodium chloride 0.9% prescribed for patient 10029484?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'readi-cat 2 (barium sulfate 2% suspension)', 'glipizide xl', 'sodium chloride 0.9%' )", "rejected": "null"}, {"id": "6277e9a8851e3c1a4ad9cd6e", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease list out the monthly maximum weight of patient 10004235 since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "\n \n2.(.. MS- 101:0_ \u2014MSMS?\nMS12"}, {"id": "73c5a29239e229c1e3d8d5f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first measurement of heart rate in patient 10004733's body since 22 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "senderDlide-1-11002227X-120.21723377893818710008s'"}, {"id": "0f2f3ef0fa1e36d951c5a42f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10007818's weight the last time it was measured since 8 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-8 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "97516d1ecb3c025c618fb0ef", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease count the hospital visits made by patient 10002930 in this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10002930 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "00144320e5ae44ed871c5db7", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent events that took place.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n### SQL:\nSELECTIVE PROCEDURES\n\n### ASPET\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT d_icd_drugs.drug FROM d_icd_drugs WHERE d_icd_drugs.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSELSETS FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100280858 ) ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100280858 AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T2 ON T1.charttime< T2.charttime AND T1.hadm_id< T2.hadm_id ) AS T3 ON T1.charttime< T2.charttime AND T1.hadm_id< T2.hadm_id ) AS T4 ON T3.charttime< T4.charttime ) AS T5 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y-%m',diagnoses_icd.charttime) >= '2100-05' ) AS T6 ON T5.charttime< T6.charttime ) AS T7 ON T5.hadm_id< T6.hadm_id ) AS T8 ON T7.charttime"}, {"id": "c32cd76c5b0aa08c81251752", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many mupirocin nasal ointment 2% prescriptions took place in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'mupirocin nasal ointment 2%' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'mupirocin nasal ointment 2% ' AND strftime('%Y',prescriptions.starttime) = '2100'"}, {"id": "2d6e4345dac956dd550150ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10014078 first had a urine microbiology test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "34f825ce946e62cf44c7f3f5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since patient 10004733 had the last cholesterol, total lab test on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d83c8510ff1184c1d92ff459", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10014354's first measurement for respiratory rate on 10/20/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '10-20' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "62e57b2d710776dc9693105a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total of calcium acetate that patient 10021938 had been prescribed on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'calcium acetate'", "rejected": "null"}, {"id": "4f7a1d19e6fadf0e7b619491", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10014354 visited an emergency room since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "19dd65ead0ee8862ebf01011", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the accumulated output for patient 10039831 since 10/26/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-26'", "rejected": "null"}, {"id": "0a52d95713114e75cad62068", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had a diagnosis of edema of male genital organs?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) )", "rejected": "SELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) )"}, {"id": "92ec6272af144fdb3b7740bd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of hospitalization that includes the parathyroid hormone laboratory test in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'parathyroid hormone' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "498d2f4e14ef15f20bc02818", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for a drug named vancomycin?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' )", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'vancomycin'"}, {"id": "042ab61601f982ee4d6436fd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10022041 get diagnosed with in 2100 for the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "366e4fe872705e8dbb87ae20", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many pseudoephedrine prescription instances took place during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'pseudoephedrine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT( DISTINCT prescriptions.prescriptions.drug ) FROM prescriptions WHERE prescriptions.drug = 'pseudoephedrine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')"}, {"id": "ea237bbea67442bc6b962cce", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with alkalosis after already being diagnosed with postinflammatory pulmonary fibrosis within 2 months?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "07cfa2305771336777be3c17", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients are there that are 60 or above?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60", "rejected": "\n\n##\n\n\n######\n\n\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM icustays WHERE icustays.org_id IN ( SELECT icustays.org_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158540 ) ) AND icustays.org_id IN ( SELECT transfers.org_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158540 ) ) AND transfers.org_id IN ( SELECT admissions.org_id FROM admissions WHERE admissions.subject_id = 100158540 ) AND transfers.careunit = 'medical/surgical intensive care unit (micu)' ) AND strftime('%Y-%m-%d', transfers.intime) >= '2100-02-08' )"}, {"id": "e406dc4e0b4d87d40b90a07f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038933 receive sputum microbiology test the first time since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "b3f1921213d20471bf74e2f5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed to patient 10027445 in the same hospital encounter after having had a percutaneous balloon valvuloplasty procedure since 08/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027445 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous balloon valvuloplasty' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027445 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "9206421c128de64e2474230a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most frequently prescribed medicines since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "</-_ )-'&/  What. rom\n (./(. Winter10 \nMS"}, {"id": "fba8a54ba42e25b3a395f35b", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10002495 have a irrigation of genitourinary tract using irrigating substance, via natural or artificial opening procedure on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' ) AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND strftime('%Y-%m',procedures_icd.starttime) = '2100-07'"}, {"id": "ee59f6b32fc0b17f2e1e888b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell how many times patient 10031757 visited the ICU since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "SELECT SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL AND datetime(icustays.intime) >= datetime(current_time,'-1 year') )"}, {"id": "f1e84b550c51a00e780daaa4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently administered laboratory tests for patients previously diagnosed with nontoxic uninodular goiter within the same hospital visit, in 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nontoxic uninodular goiter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "6d4fb4147666cb3f5be2c8be", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the diagnosis that patient 10009035 received last since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) )"}, {"id": "754791666185be2763502622", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10016742 last had the epithelial cells maximum value in 07/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "631f6c7b12fe0e5f5fad366d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10023239 got a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 )", "rejected": "\n##\n### Question:\n\nWhat was the date of the last hospital discharge for patient 100214877?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "5767b253bcb5c54fa1aaaadc", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top five most commonly prescribed medications.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n\n##\n\n##\n##\n##\n##\n\n## Question:\n\nWhat was the first drug that was prescribed to patient 1002168555 during their last hospital visit for the last time since 1 year ago?\n\n\n### SQL:\n\nSELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100216855 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "bbb1655c44fb049ef7b879ae", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients who stayed in medicine since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "110b301bfc80d9c150556b92", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was measured as patient 10007795's weight during the last check in 05/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '05' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5d890144fe08088c541a7324", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last prescription for patient 10003400 since 01/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "232c1cf9aed1b4611fb6d99a", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top five most frequent drugs prescribed to patients within 2 months after the diagnosis of atrial flutter?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial flutter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "0ae32bee1adc6a16d66b16de", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10036156's documented weight on the last record since 12 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6e7eea4d83bc22c485bd34f3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum monthly number of people diagnosed with compression of brain since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of brain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of intravascular cerebral artery, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )"}, {"id": "b10a4a13a55e7c9b73091d8f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat the proccedural of the drugs against cancer is?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTIVE OF THE TOTAL NORTH AMYLAS (T1) FROM PATIENTS WHO HAD PERCUTANEAN CATHETERIZATION IN 2100."}, {"id": "7eb920ea8c935405a34f2187", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time on their first ICU stay patient 10014078 had a minimum respiratory rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "49d67bd02206d97d3d669508", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is a checklist before lumb/lmbosac fus ant/ant?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT count(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'lumbar laminectomy with exposure of subclavicular lumbosacral lumbosacral ligament with no device placement' AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) )"}, {"id": "61a27855d733cbb01f805863", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the procedure conducted on patient 10000032 two or more times?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "SELECT SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'icd-procedures.procedures_icd.procedures_icd_code' AND strftime('%Y', procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.hadm_id )"}, {"id": "24fdc72bfa641df5e25a4dd3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the price of a procedure referred to as closed reduction of fracture with internal fixation, femur?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed reduction of fracture with internal fixation, femur' ) )", "rejected": "SELECT DISTINCT price.cost FROM price WHERE price.event_type_code = 'procedures_icd' AND price.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reduction of fracture with internal fixation, femur' ) )"}, {"id": "5487ee77cca76c582ae0fd80", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first measurement of o2 saturation pulseoxymetry that patient 10022017 had on the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7de6019246eb50aa7a443936", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of fluticasone-salmeterol diskus (100/50) prescribed to patient 10021666 in total in 03/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'fluticasone-salmeterol diskus (100/50)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'", "rejected": "null"}, {"id": "113cd45e55e5ce4b019aad28", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the total of phenytoin infatab prescriptions since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "PASS\n101.\n21.\n001030.\n04.0.03180770673478 AND admissions.intravenous infusion (divertic and infusion) AND dialysis, how many times did you administer?\n\n\n\n095/08/21000's prescriptions?\n\n### SQL SELE\n\nSELECT SQL SELECT COUNT( SUM(prescriptions.intake.drug) FROM prescriptions WHERE prescriptions.drug = 'ciprofloxac (ciprofloxac)' AND strftime('%Y') >= '21000-08-05'"}, {"id": "c6db806375506c37524257d8", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10027602 received any diagnoses since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "12..0MSPAMSPA 10500202218271684988543999?\n#080068s?"}, {"id": "a803aa24d51a01da7f6a534e", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, how many arteriography of cerebral arteries procedures were there?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "PAMSMSMSPA)\n117PA.\n\n1. What is the name of the maximum value of the last ranitidine?\n\n##\n###### output for patient 1001618309 since 05/17/2100?\n\n\n### SQL:\n\n### SQL:\nSELECT SQL SELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures_icd"}, {"id": "5572350469c75b9bc5b406cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently given diagnoses for patients who had previously had extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic in the same month, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "3355ff6ec63f5859b0030ed5", "query": "Convert the question below to SQL query.\n\n### Question:\nList the four most frequent specimens that were tested since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": ".\n.'d. it.MS"}, {"id": "2b35fcda321bd6bbe4114dd2", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10018423's respiratory rate second measured on the last ICU visit greater than the first value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "19858e80b7638280abbda010", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10029484 have the maximum ketone value for the last time since 04/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e0cf2f53e348a811ec32082d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the insurance for patient 10016150 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n### SQL:\n\nSELECTIVE PROCEDURES ON T2\n\n### SQL:\nSELECT d_icd_procedures.drug FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100160585 ) AND strftime('%Y', admissions.admittime) >= '2100-07-25' ) AND strftime('%Y', d_icd_procedures.charttime) >= '2100-08-01' )"}, {"id": "a291e9eb06fbda894cbb7a33", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 10/this year, what was the maximum mcv value for patient 10018845?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'", "rejected": "\n\n##\n##\n\n##\n##\n\n###03. What is the cost of a single dose of vancomycin (1 g) that was prescribed to patient 10000798858 since 2100?\n\n\n### SQL:\n\nSELECT SUM(cost.cost) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100079858 ) AND prescriptions.drug = 'vancomycin'"}, {"id": "ebda318b91d6e794480eb19b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the difference in the arterial blood pressure systolic value for patient 10020944 second measured on the first ICU visit compared to the first value measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "db2e74ae7eb32d3ddbdbe8b2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10005817 weigh based on the last measurement since 07/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\nSELECT SELECT chartevents.organs FROM chartevents WHERE chartevents.organs_name = 'heart'"}, {"id": "d701f4d1d856c591e1e4c95d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who had a globulin test in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'globulin' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "null"}, {"id": "f483848e8096e4cf24e19ea6", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 83038 have a family history of any disease?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\nSELECTive nephrectomy of kidney, unilateral, open approach."}, {"id": "405f78e6caa381d20fac1fae", "query": "Convert the question below to SQL query.\n\n### Question:\nHey jo, tell me what that diagnosis was that patient 20801 got in that other department\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND datetime(transfers.dischtime,'start of year') = datetime(current_time,'-1 year') ) )"}, {"id": "85217448903d24f91d5ea081", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost for a person with streptococcal septicemia since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcal septicemia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "a857fe023621b88d5229e66e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat treatment were provided to patient 10021938 two or more times since 07/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "665268e8c88a193b5ec8005f", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease retrieve the daily maximum amount of patient 10022880's po intake input.\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "4d8620a9b634b4449be0b4bd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat exactly was the last drug that patient 10021118 was prescribed since 12/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "a041560dafe724349feb959f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients currently in the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "T\nastic.\n.... 1\n Fine-arch_-1 0's. 1(T.\n\n NANC1 means?MSPAU001621115505699059837310'"}, {"id": "22ab23e20a87874b13ca865c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10010471's heart rate change last measured on the first ICU visit compared to the value first measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "898a1010e152158643c29ae2", "query": "Convert the question below to SQL query.\n\n### Question:\nWork out the total amount of input patient 10038999 received since 04/08/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-08'", "rejected": "null"}, {"id": "dcefbced3548a05ff203d8a9", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits that patient 10027602 had in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10027602 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "4613c69ff92c982ad6b0c73e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the weight of patient 10014729 first in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "bd4b95a5ab6e7fce1ea29aca", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often was the last time patient 20801 had a medication that should be regularly taken?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1"}, {"id": "4d4dd766a53d16c73dfa5445", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who were diagnosed with diplopia in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "5e26962b8d9bc2994ab47e5d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you calculate how many patients were prescribed ipratropium-albuterol neb during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium-albuterol neb' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "c73d0d6704a76099f635ad07", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time the arterial blood pressure diastolic of patient 10018081 registered less than 56.0 since 02/28/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 56.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-28' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c469f81f092e3b28dadc05f4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was diagnosed for patient 10002930 the last time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "1"}, {"id": "8794ed581e861d00471884fd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged during the last year from hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\no:. :\n\n'd2om:i\n"}, {"id": "4f945a0ea52625d2facbf443", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum platelet count value for patient 10021118 on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' )", "rejected": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet' ) AND labevents.charttime IS NOT NULL ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "2ea2811b8f3a6ed89aa46618", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did last patient 10014729 have the minimum value of albumin, pleural in 03/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, pleural' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "116aad46ae0fef5a747954b1", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients diagnosed with iatrogenic pneumothorax since 1 year ago, what are the top five most recurrent treatments during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'iatrogenic pneumothorax' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "fb100dfee04065d29677af93", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the last output of patient 10016742 on 07/22/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-22' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "65a18d6c6863a8702f23d4ed", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10016810 have albumin 25% input during their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "e7693ad9894979dd2cf53541", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the drug perphenazine?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'perphenazine' )", "rejected": "\n\n010.1002191175882328658 AND admissions.drug."}, {"id": "66f0e9afff14db4b814ca058", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10004422's last maximum cholesterol, total value on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT MAX(labevents.charttime) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) AND strftime('%Y-%m-%d',labevents.charttime) = '2100-06-21'"}, {"id": "9f59f271601c4130d2301520", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the weight of patient 10016742 first since 14 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "\n## SELECT SQL:\n\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158545 ) AND prescriptions.drug = 'aspirin' AND datetime(prescriptions.starttime) >= '2100-12-18' )"}, {"id": "8a5ce42572b0c5e92d72bd10", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018081 have the first arterial blood pressure systolic observed to be less than 130.0 on this ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 130.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "224951a256954e9d3b39076e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10022281 undergone any laboratory tests in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y',labevents.charttime) = '2100'", "rejected": "He'...T ... /-1 T1..,2-MS,.\nement:0 10113MSMSMS\nMS12002010174291.MS-200001030003072908850220970288829575477332200001'"}, {"id": "c84cfe8470cb11125e4f78bc", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top five most frequent procedures that patients received during the same hospital visit after receiving extirpation of matter from left common iliac vein, percutaneous approach.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "\n##\n\n\n##\n##\n##\n\n##\n##\n\n###03. What is the maximum number of times patient 1003948742 was given a medication since 02/21000?\n\n\n### SQL:\n\n### Question:\n\nWhen was the last time that patient 1003948742 was prescribed a medication since 21000?\n\n\n### SQL:\n\nSELECT MAX(prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1003948742 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' GROUP BY admissions.hadm_id )"}, {"id": "e6301d5787e165024081b9d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was patient 10022017 prescribed for within the same day after undergoing bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach in 10/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "a46388d3c77f04af56eb9f4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last famotidine dose that patient 10001725 was prescribed on their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'famotidine' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f25132faa310ec15ed1ccd71", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 32168 in the family of a person with react-indwell urin cath?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "9bcb25bfb75bf11f00162db1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the dose of lactated ringers that last month patient 10006053 was last prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND prescriptions.drug = 'lactated ringers' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "3e6c40802e7951b28402583b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input time of patient 10027602 since 11/26/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e5c3587bfbb2d97b71b9e953", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much duloxetine has been prescribed to patient 10007795 in 05/2100 in total?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug = 'duloxetine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'", "rejected": "null"}, {"id": "5d3b63e510deecde492912dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat culture was patient 10021666 first tested?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "##\nSELECT%10s"}, {"id": "b440a7a78eb175aad7326406", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease retrieve the daily minimum amount of patient 10005817's albumin 5% input on the last hospital visit.\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "0967cb08f218348731670915", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know what type of blood patient 1903 has?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n##\n\n##SQL\n\n\n##\n###03. What was the total number of times patient 1000398835's last diagnosis of hepatic abscess drainage, percutaneous, open endoscopic in 21000?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000398383 ) AND strftime('%Y', diagnoses_icd.charttime) = '2100' )"}, {"id": "8dc71388fea9c3fd6452055a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism detected in the last microbiological examination of patient 10019172's urine on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "aa513e26eaa857febb6f4db0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new drugs for patient 10004733 today compared to the earlier ones yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n### Question:\n\nWhat were the top three most common microbiology tests that followed the diagnosis of ischemic heart disease, unspecified since 1 year ago?\n\n\n### SQL:\nSELECT T3.test_name FROM ( SELECT T2.test_name FROM ( SELECT microbiologyevents.test_name, DENSELSETS.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100167400 AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) GROUP BY T1.test_name ) AS T2 ) AS T3 WHERE T3.C1 = 3 ) AS T4"}, {"id": "8c389720f8914eabd76867e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most common prescriptions in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "\u2097\n 1.202000030301772384919868410'"}, {"id": "064e1e18ab989d89c93ed694", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with acute post-thoracotomy pain within 2 months after first being diagnosed with accidents occurring in residential institution in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in residential institution' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute post-thoracotomy pain' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "953f77740c16c1a9a435f427", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top three most frequently taken specimens for patients within 2 months after receiving percutaneous [endoscopic] gastrostomy [peg]?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "9162de3307e705f564c4492d", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the top four most common treatments.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "..\n....\n\n.s\n\n\n.\n.'1k2o/ .\n.m.0..MS  -2\nMS131:PAMS.<MS.PA:3182267211808116139?"}, {"id": "4ead555e8bf055e8e8c7bc2f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients left the hospital during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": ".\n] :( )\n\n.\n </.. (.1 d.)\n\n EMS 1t0MM110120200002001908200009921070114609?\n\n\n0350.00001's 0400039'"}, {"id": "db2dac9cf4438079183f8b61", "query": "Convert the question below to SQL query.\n\n### Question:\nOn their last hospital encounter, how old was patient 10038081?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\n\n##\n\n##\n##\n##\n### SQL Code of the last hospital visit for patient 10022184554?\n\n\n### SQL:\n\nSELECT admissions.disch_time FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100218454 ) AND admissions.disch_time IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "61d45a73e8a0469f9bf963be", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me if patient 10020944 is male or female?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944", "rejected": "\n\n##\n\n##\n##\n##1. What was the first time since 03/01/21000 that patient 100018081 was prescribed 0.9% neostatin?\n\n\n### SQL:\n\nSELECT admissions.disch_dates FROM admissions WHERE admissions.subject_id = 100018081 AND strftime('%Y-%m-%d', admissions.disch_outtime) >= '2100-03-01' ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "91e430cc8aa46185aee7b418", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost for a patient suffering from collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "afc288ae1efdf1107f545e9d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10004720 receive the last prescription of soln and bag at the same time since 12/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'soln' AND admissions.subject_id = 10004720 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bag' AND admissions.subject_id = 10004720 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "fde6441b3751a0976d557a92", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most common treatments for patients who are 30s?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n##\n\n## Question:\n\n##: What is the change in the total white blood cells count of patient 1000274085 last measured on the first hospital visit compared to the value second to last measured on the first hospital visit?\n\n\n### SQL:\nSELECT T1.value - ( SELECT T2.value FROM ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100274085 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "21725d6a5831671fc4d0dc87", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10016742 come to the ER?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.admission_location = 'emergency room'", "rejected": "\nSELECT\n\n## question:\n\n\n## what is the minimum total volume of output for patient 100164045's output since 03/20/21000?\n\n\n### SQL:\n\nSELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-20'"}, {"id": "612f8fa49f7f4fdc5d2bc4b6", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the diagnosis that patient 10039997 received last during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "8940911fa3f2d95d03fc272e", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most common treatments for patients aged 40s in 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL DESC ORDER BY COUNT( procedures_icd.charttime ) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 )"}, {"id": "f854c9821a5c5435e850b71e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most frequent procedures that patients received in the same hospital encounter after being diagnosed with other forms of acute ischemic heart disease.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other forms of acute ischemic heart disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "bf62c5424509b587645d8c69", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the diagnosis price for anoxic brain damage, not elsewhere classified?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anoxic brain damage, not elsewhere classified' ) )", "rejected": "\n##\n\n##\n##\n\n##\n###code:\n\n### SQL\n\n### SQL\n\nSELECT SQL SELECT SUM( ( SELECT COUNT( DENSEMS-icd_procedures.procedures_valuenum FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'aspiration of brain' AND strftime('%s', d_icd_procedures.charttime) >= '2100-03-31' )"}, {"id": "ae5ec3820a0b5ba66f56bc5a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who underwent drainage of pericardial cavity with drainage device, percutaneous approach in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "45e27a5adb524da103b1963d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10027602 had the maximum red blood cells value in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c99ab73b237415f36d5185ab", "query": "Convert the question below to SQL query.\n\n### Question:\nReveal the three most frequently prescribed medications during this year.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": ".3 (\n U. T. D.....\n1 Thereic\n. rained_.1!\nMS.'\n PMS.MS\n0,1\n. 111. The 120111'\n\n\n1001: 252212117138744184200348000187703217672492379's'"}, {"id": "4f3f80819d74ba44d60716b2", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent medications that patients were prescribed in the same month after being diagnosed with cerebral edema.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral edema' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "\n## SELECT T1 FROM d_labevents WHERE d_labevents.itemid IN ( SELECT prescriptions.itemid FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473338 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) ) AND strftime(prescriptions.starttime,'%Y-%m-%d') = '2100-04-16'"}, {"id": "ec6f5b5ee913d4563f6efb5e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the arterial blood pressure diastolic difference of patient 10021118's body last measured on the last ICU visit compared to the value first measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "b3017b420fe13c0d01fb5e63", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038081 had platelet count tests in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y',labevents.charttime) = '2100'", "rejected": "null"}, {"id": "fa36faf004e431ac9be12d1f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 13329 experienced any side effects during a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'transfusion of blood and blood products, autologous, initial procedure' AND admissions.subject_id = 100197777"}, {"id": "825c5c877128209aef4d391e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the cost of a procedure known as excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic.\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) )", "rejected": "null"}, {"id": "c0ed5f3463fb838c2206713f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since patient 10004733 got his last diagnosis of proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site on their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ed28ed3c3395b0fa906c9c51", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 57050 have a past overseas travel experience?\n\n### SQL:\n", "chosen": "null", "rejected": "..\u2019..\n. .. P1 - T.\n.. 1-\n \u2013 d.\n.\nat.\n.CMS\n -d.,1/J\nMS. excited-116011 21121'sMSPA.111004191 How toMSPA's the 1.20101842837428586's ICU.'\n##'s'"}, {"id": "423eabf79f7a6b056f9dea1e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum monthly number of patients diagnosed with personal history of traumatic brain injury since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of traumatic brain injury' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "1020215MSPAMS?4PAQ 1000000837250058537784577985'"}, {"id": "887f1892fedc575d080e8217", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the heart rate difference of patient 10013049's body measured at 2100-06-24 12:00:00 compared to the value measured at 2100-06-24 11:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 12:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 11:00:00' )", "rejected": "null"}, {"id": "5d52acdcbf16edca0723fc3e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type during patient 10007795's last entry into the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "o. C\n\n. me.')  (:\n's..-3 ,MS . 1MSantX'sMS 9"}, {"id": "eec30a374f5a614dddb5c128", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the methods for taking caphosol?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'caphosol'", "rejected": "MJ:\n\n\n.3',.. (.. (\n11ic E.7(had  (\n Convert.)\n\n'.  . (m of and\u2014"}, {"id": "2119bd77a1e8ac16f5216980", "query": "Convert the question below to SQL query.\n\n### Question:\nExiste-t-il a genetic test that is recieved by patient 54700?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left heart ventricular cava with drainage of other body cavities, percutaneous approach' AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND strftime('%Y-%m-%d',procedures_icd.charttime) = '2100-01-03' )"}, {"id": "7b241688629b0769f326af90", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005909 had lab testing since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',labevents.charttime) >= '2100'", "rejected": "null"}, {"id": "37bfc037c806a2407d309d50", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum transitional epithelial cells value of patient 10018081 during their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'transitional epithelial cells' )", "rejected": "null"}, {"id": "79cd6dad6ad9f5ff2c2684e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of that first specimen test patient 10029484 got since 11/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "def6d375a2be3ced2d907c6d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the various ways to consume 5% dextrose (excel bag)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = '5% dextrose (excel bag)'", "rejected": "\n##\n### SQL:\n\n## SELECT SUM(procedures_icd.procedures_icd.cost) FROM procedures_icd JOIN admissions WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100274456 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other lymph node' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )"}, {"id": "adfe9182219ecbbfa21f841f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the output patient 10004235 had for the first time on 03/24/this year?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-24' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "960af01d63ac5e922c0eb129", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common specimens being tested for patients who were diagnosed with personal history of irradiation, presenting hazards to health within the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of irradiation, presenting hazards to health' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "5780c98a714da7aa7512b363", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10021666 urea nitrogen tested in their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "\n\n##\n\n##\n##\n##\n#####04.0 SELECT SQL"}, {"id": "6d09ba5be77b8bf9cc8b08a8", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total volume of input for patient 10005817 since 04/03/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03'", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03'"}, {"id": "d3f3a4406592054ad20c2093", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10022017 get the microbiology test for the last time since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.starttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m-%d',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "866f0e3f587b1c8992a48c02", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat time was the first time the respiratory rate of patient 10020740 was less than 24.0 on 04/14/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 24.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-04-14' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "47f5715cbbaf2be1e8505994", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time in which patient 10039831 had the minimum respiratory rate since 253 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-253 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f6066d140303a698b6edceea", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic treatments were executed since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "37cae934208b2a009d5fa703", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038081 received any other endoscopy of small intestine treatment since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "3c7a16e5114441d4d413d8fd", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list patient 10011398's daily minimum weight on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.starttime FROM admissions WHERE admissions.subject_id = 10011398 ) ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "0f1253fab8016b9da9f6e223", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10015272 in 06/this year was given a asparate aminotransferase (ast) lab test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "d73c8f5b0105e85440aa6baf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the maximum yearly number of patients diagnosed with glucocorticoid deficiency since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'glucocorticoid deficiency' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT COUNT DISTINCT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'glucocorticoid deficiency' ) AND strftime('%Y', admissions.admittime) >= '2100' )"}, {"id": "9180a61f2fffcdf3b80778e7", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there a code that matches icd-11 for male gen inflam dis nec in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT COUNT(*) FROM icd_procedures_icd WHERE icd_procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y', icd_procedures.charttime) >= '2100'"}, {"id": "d0d4ddd524dec4c4fd73c769", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the patient count for midazolam prescription since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "74357f5fe76f72bc4084d3b0", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 23070 have overseas travel history?\n\n### SQL:\n", "chosen": "null", "rejected": "\n..\n1.1re.=.1._MS\n)MS11C1MSPAMSMSCARCHPA Tally,MSPA TLONG T2010010120-0306'"}, {"id": "6fd61e60148bb599c1a2a048", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the sex of patient 10009035?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10009035", "rejected": "null"}, {"id": "1e04b4d24fdf02742f3ee567", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism present in patient 10037861's last blood culture microbiology test since 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "f5024826f56df8252bfc76ad", "query": "Convert the question below to SQL query.\n\n### Question:\nTally up the number of patients who received a ck-mb index lab test since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb index' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "SELECT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.itemid FROM labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb' ) ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')"}, {"id": "7234f29b92615d05cfbde52f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10036156 receive an input for the first time in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) ORDER BY strftime('%Y-%m-%d',inputevents.starttime) ASC LIMIT 1"}, {"id": "53fca8bfc5f88cb4209eec38", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how old patient 10035185 was on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "d535385fb695da44b2b142d3", "query": "Convert the question below to SQL query.\n\n### Question:\nAnd how to find the code that shows icd-11 for mitral valve disorder in icd-10.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "1bbc56c2fd1aad4535efd121", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the top five most frequent diagnoses that patients were diagnosed with within the same month after receiving hemodialysis?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "338a9d532066c9b092d97b39", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10018328's age on their first hospital encounter was what?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180815 )"}, {"id": "e8be8d8ac70685f324507cdc", "query": "Convert the question below to SQL query.\n\n### Question:\n...when was the last time that patient 60219 had a medication that should be taken regularly?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT MIN(T1.starttime) FROM ( SELECT admissions.starttime, admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100044333 ) ) AND transfers.outtime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1 )"}, {"id": "dba558e5efd6207a1ad84c29", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10031757's chloride, whole blood last measured on the first hospital visit greater than the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "92360fdf128eef86912196c6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10004235's minimum value of atypical lymphocytes in 03/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'atypical lymphocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'", "rejected": "null"}, {"id": "8521d760a18e114ce1c608b3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10039997's gender?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10039997", "rejected": "\nSELECT\n\n### SQL Query:\nSELECT SELECT d_icd_diagnoses.cost FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified dyslipidemia'"}, {"id": "3f7e59eb07f66f58689fdf28", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate how many drugs patient 10009049 was prescribed.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 )", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 )"}, {"id": "982fb7efe92d6f33dcdb9848", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five diagnoses associated with the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-6 month') GROUP BY admissions.subject_id, diagnoses_icd.icd_code ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-6 month') GROUP BY admissions.subject_id, diagnoses_icd.icd_code ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.C1<= T2.C1 ) AS T3 ON T3.C1<= 5 )"}, {"id": "6b2bc626482c4ebd317ba6ea", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what was patient 10012552 diagnosed with for the last time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "1cd31dccc70c46d3c3d8d825", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the drug that patient 10016150 was last prescribed in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "122180d2410c37fb1d467316", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the count of ICU visits for patient 10020740 since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "7bd7e129fb3ef8370555bf1b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test was first given during their last hospital encounter to patient 10011398?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "67bced596c4d40cf8cba1fb9", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 12410 have experience with overseas travel?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10018938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "341d7a85d3366d8be3f55673", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were administered fluoroscopy of superior vena cava using other contrast, guidance in 2100, what were the top three most common treatments that they received within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "54714e162bde7b10c34ed1c1", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the first hospital visit, what was patient 10012853's age?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "CMSSE.PA 0.PAIR, 28217158447854388 AND MONTHPAYLUNG<br>"}, {"id": "34e14f0320cc416a7c84ff9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 9619 is scheduled for the earliest hospital visit?\n\n### SQL:\n", "chosen": "null", "rejected": "fusion'th--. (\n _. .\n.\n 1\n1 04PAMS;-0PAMSKMS\nMSMSMSC1.PA's. What is the code's the total\n\nMSGPA's.\n\n\n' AND admissions.drug oncol'"}, {"id": "30c85360417e25270068544b", "query": "Convert the question below to SQL query.\n\n### Question:\nPresent the count of ICU visits for patient 10004422 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND strftime('%Y',icustays.intime) >= '2100'", "rejected": "null"}, {"id": "0a507e5e6d94656aec03e31d", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the first ICU visit, when did patient 10025612 have their last input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2de4e7fa2f4e70e798676fe5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common output instances since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT T1.drug FROM ( SELECT admissions.drug, DENSE.COUNT( procedures_icd.charttime) AS C1 FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100012175 AND strftime('%Y',procedures_icd.charttime) >= '2100') GROUP BY procedures_icd.drug ) AS T1 WHERE T1.C1 = 3"}, {"id": "3eb0479be3a32cecf1cfc9a1", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell the daily maximum dose of or crystalloid intake that patient 10026354 received since 07/08/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-08' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "e5b66a1b55593f1824235d1a", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide a list of the three most common diagnoses that patients were diagnosed with during the same month after undergoing the resection of vessel with replacement, thoracic vessels procedure in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'resection of vessel with replacement, thoracic vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "b06238b6f95478036e95125a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat diagnosis did patient 10016742 receive in 2100 for the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "\n##: SELECT SQL"}, {"id": "776dd1b6516976e76141adf0", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 3242 have a family history of malign neopl prostate?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100160585 AND admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'malign neopl' ) )"}, {"id": "5b078faf4cef1188372987db", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001217 been administered any nacl 0.9% in 12/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'", "rejected": "null"}, {"id": "9c85a8ada2ee0422d27bcb39", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common diagnoses that followed within 2 months for those who received insertion of endotracheal tube in this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "0a32f1c36ff8b32b47e43478", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me, was packed red blood cells given to patient 10007818 on 07/04/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-04'", "rejected": "null"}, {"id": "016d92926546ac6ede02409b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the anion gap percentile of 11.0 among patients of the same age as patient 10014729 during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.0", "rejected": "null"}, {"id": "bb4344288238a4637074b5b3", "query": "Convert the question below to SQL query.\n\n### Question:\nCount how many patients were discharged from hospital throughout this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "MSMS.\n.00241112107266917430009187?"}, {"id": "0920f71c3325e1a9f1fa383b", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who took neutra-phos in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'neutra-phos' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "null"}, {"id": "486aad9ca1f13f573fabc677", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the cost for the drug sodium chloride 0.9%?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium chloride 0.9%' )", "rejected": "null"}, {"id": "c7841b68bdb2089ac264a977", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most common events in 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "ce36c547c1a37852e65fc5c3", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you get me the top four diagnoses that have the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "=PAMSPAMSMSMSPA-0218 0098714772317008220906'"}, {"id": "da5f3dae68433524c0462406", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients diagnosed with nontraumatic subarachnoid hemorrhage from left posterior communicating artery before, what are the top four most common treatments within the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nontraumatic subarachnoid hemorrhage from left posterior communicating artery' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "93a6f19b82de2d952049362e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10006053 get a microbiology test for the last time?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "\n1181.\n##1.\n0001701868465224250'"}, {"id": "94556faa4ba7d0ff0917653d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10002428 get a blood culture microbial test for the first time since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f58bd3fca803b73088423ede", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat does it cost to get automatic implantable cardiac defibrillator in situ diagnosed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'automatic implantable cardiac defibrillator in situ' ) )", "rejected": "SELECT SHOW T1 FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of other device into superior vena cava, percutaneous approach' )"}, {"id": "129db1a32dcacde0529b996c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is a drug that should not be administered during cont inv mec ven 96+ hrs?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT prescriptions.drug ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020038 ) AND prescriptions.drug = 'cont inv mec ven 96+ hrs' AND datetime(prescriptions.starttime,'start of day') >= datetime(current_time,'-96 day')"}, {"id": "b7b81b39be99bf34446ee242", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism found in the last microbiological mrsa screen test of patient 10039997?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "4a41f13171a4d40a9cb9e53b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did the hemodialysis procedure take place?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' )", "rejected": "\n####\n\n\n### SQL Query:\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100142356 ) AND strftime('%Y', diagnoses_icd.starttime) >= '2100' )"}, {"id": "bbd2daaab53a49a1140c416c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10022041 get diagnosed with in the last hospital encounter for the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "6408991bd45a8b1bed727d8d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the daily minimum input of or packed rbc intake that patient 10005817 is getting since 11/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or packed rbc intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-11'"}, {"id": "70628d63be371358ecd526de", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich medication was patient 10009628 prescribed during the same hospital encounter following the extracorporeal circulation auxiliary to open heart surgery procedure in 10/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10009628 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10009628 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "9dfacc2c7888378be3ee3aac", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the five most common microbiology tests in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n\na2d '\n 1 (30.-1s11212192130000319320725180'"}, {"id": "612076c066409c1c13b808e5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the common method for taking lidocaine 0.5%?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lidocaine 0.5%'", "rejected": "20B00170480730-038070794999438810"}, {"id": "f65f6f053430f63b922aef1d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the first time that patient 10004733 was diagnosed with other iatrogenic hypotension on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f1cc5fc4c2d7e41e0b9536dd", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the specimen test that patient 10022281 last received in their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND microbiologyevents.spec_type_desc = 'blood' AND microbiologyevents.charttime IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1 )"}, {"id": "7e02a75185f21e8220b45851", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. holmes's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "\u0401saMSMSSS 1380024020019321901200876110-0902598189'"}, {"id": "5a47ea8047b87b5f311738fc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was a excision of dental lesion of jaw procedure done in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "c9fe1f1b8ec77f4a772615c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time, on the last ICU stay, that patient 10025612's heart rate was greater than 75.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 75.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "27f8b6790566d088a96745de", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of stay for the first stay of patient 10007928 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "bf1ccb5ac4a847d66be6bc96", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism detected in patient 10027602's first mini-bal microbiology test on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "2694b78056d19869dc331d60", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of that output that patient 10021938 first had since 01/15/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-15' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "69d6df3a555ac16f922234f9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first specimen test that was given to patient 10023239 since 04/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "82497b82db1a47d9940db063", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when the last asparate aminotransferase (ast) test of patient 10015272 was conducted in 06/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "520806edc7c74c0bded54199", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of blood patient 85700 has.\n\n### SQL:\n", "chosen": "null", "rejected": "--221a CSver\n\n.\n 19.'s 111124, 22102219784921759003080001: What is the maximum o20000's time of the last urine was prescribed to patient 10003908508 since 07/21000?\n\n\n\n2.1. What was the first prescription of lactated rt/rt/rt-tb (oral) prescribed to patient 10003908508?\n\n\n3. What was the total amount of glucose (blood) prescribed to patient 10003908508 on the last occasion?\n\n4. What was the total amount of glucose (blood) prescribed to patient 10003908508 on the last hospital visit?\n5. When was the last time patient 1003908508 had the maximum heart rate?\n\n\n"}, {"id": "bf7d668907b28a333bad876e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most common tests conducted on specimens since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": ".\nMS TMS2..5.70.1511)\n\n-1\n\nd31003301116\n?\nMSPA.MSPA 1.\n\n2140.116348403137 1\n##04.186277795587129 0.\n% 031. 0110035751"}, {"id": "a1b5fd9738bdb0ab96eb89a9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication that patient 10004733 was prescribed for during the same day after receiving enteral infusion of concentrated nutritional substances since 05/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "e474a2417040aa88bad3b8f1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed at the emergency department in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "1 ...\n\n\n 1\n\u0429-DB'MSy01MS\n.(\n\n\n\nXPA 2MSMSPPA Episode C. 25982202100-0006'"}, {"id": "a14b794e12f6637f98c72ade", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients aged 40s , what are the top three most common diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT T1 AS C1 FROM ( SELECT d_icd_diagnoses.icd_code, DENSE_COUNT( diagnoses_icd.charttime) AS C2 FROM diagnoses_icd JOIN admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) ORDER BY C1 DESC, C2 DESC ) AS T2"}, {"id": "2dfbec4e54ac5d6edf34216d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10002495's first measured rdw-sd in 06/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "eedf0ba9662962adc4283987", "query": "Convert the question below to SQL query.\n\n### Question:\nThe last time , when was patient 10002495 prescribed insulin and atorvastatin at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10002495 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'atorvastatin' AND admissions.subject_id = 10002495 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2142e73a54b9782926053e6a", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits patient 10021118 had since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "8db3a499f8e4f04b7f55b1a4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat procedure was given to patient 10005909 two times during the last month?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "null"}, {"id": "8bfd5025332346ae9908634c", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10016810's total output since 06/01/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-01'", "rejected": "null"}, {"id": "d66c3f48f55c47d9fb861e1f", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the ICU visits of patient 10031404 during the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\nSELECT SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')"}, {"id": "6bade51b85498f959d6a659c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10004235 weigh the first time it was measured in 03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1d69c2e9a177101cfd62efed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last asparate aminotransferase (ast) value in 10/this year for patient 10019172?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a4ca19a5c33291f0beacd6c2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that the heart rate of patient 10018081 was, in the current ICU encounter, less than 85.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 85.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f782fdf63ed4c6c75950ea24", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was last prescribed to patient 10007818 through the iv bolus route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'iv bolus' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2e7f18557b9d9530eddacca0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first time patient 10004733 visited careunit neurology during their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "21defa558d017db6239565f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the drug which should not be administered during the insert intercostal cath procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT DISTINCT admissions.drug FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nac (intravenous) (bolus)' ) AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' ) AND strftime('%Y-%m',transfers.intime) >= '2100-04' )"}, {"id": "ec01a1e86108eda854c5cd91", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10038992 had the absolute basophil count minimum value on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "f7dd12718e496d0937b3d1be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 1.9 in a phosphate lab test conducted at the same age as patient 10007928 on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.9", "rejected": "null"}, {"id": "c8111e2baf3638b5ee8951da", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test has patient 10007795 received for the first time since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "61dc7e082e6c06af309663c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10002495 have the last maximum mcv value in 06/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "434dfa0e21a4e11280d53e6e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10005909's daily average value of body weight in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "bae6bdda5b9a9cb808040a25", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10019777 weigh difference last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY chartevents.charttime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY chartevents.charttime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "bab50704d08c2ce170bffce0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time the o2 saturation pulseoxymetry of patient 10021487 was measured on the last ICU stay at less than 98.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7f8e8713a9f47bec5ebb47bb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients discharged from the hospital in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n.12001020001300132001820440.0.0.0400219' AND 04"}, {"id": "6b9aea1e113e3ec6de66929b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most commonly performed lab tests for patients who were previously diagnosed with cholangitis in the same hospital visit, in this year?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cholangitis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "\nSELECT SELECT d_labtests.label FROM d_labtests WHERE d_labtests.itemid IN ( SELECT diagnoses_icd.itemid FROM d_labtests WHERE d_labtests.charttime IS NOT NULL ) AND datetime(d_labtests.charttime,'start of year') = datetime(current_time,'start of year') ) AND strftime('%m',d_labtests.charttime) = 04"}, {"id": "d5e1e8e66d78933ac955b076", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021487 have the last respiratory rate observed to be less than 14.0 since 09/07/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 14.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-07' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0c54d58c887f5d5cfcec260c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most frequently tested specimens for patients within the same hospital visit after receiving bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "2366c7c9140924ccf9f4b123", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients last year left the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "The\\'-. of2o.0')\n.MS.' 11Gard.\nPAZ1101%202027220000203507900008698404700333594543646978287898832797446976827270003'"}, {"id": "c205b51f6231b94810bd8849", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 05/this year, when did patient 10018328 receive their last medication via the po/ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "88a7b298bbf40e3593b5f065", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most common specimens tested after receiving arteriography of other intra-abdominal arteries in the same month since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "fb56d23182d69a8dbd3d3643", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you list the single rooms that are available today?\n\n### SQL:\n", "chosen": "null", "rejected": "MS. $\n. ofe al 1 d.  (d =ia1\nMS.\n  J1_- (0CMSd1\nMS.\n.MS 10MSMSPA,11's'\n\r'\n01218030183110720'"}, {"id": "d4f9d7cf2cdd1caea918a666", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the costs of other psoriasis diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other psoriasis' ) )", "rejected": "....\n.2.-\nMS.'M(MS(.\n\n-21S\n GROUPSPAMSMSGMSMSMSA.MSMENSPAY.\n\rST00000300024549000128'"}, {"id": "adb4dc30adc6acdfe49dc9c0", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to last measured on the first ICU visit, is the arterial blood pressure mean value of patient 10005817 less than second to last measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "563951219388e9d8f1ba0f30", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since last time that patient 10004733 stayed in careunit neurology in their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "fb908288af351cf6ad047aec", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequently tested specimens throughout this year.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT\n##\n##\n\n###03. Show the first time that patient 100021487 was first prescribed 0.25% neostatin 0.9% dextrose 5% (ns) since 10/2100?\n\n\n### SQL:\nSELECT admissions.starttime FROM admissions WHERE admissions.subject_id = 10021487 AND strftime('%Y-%m', admissions.admittime) >= '2100-10' ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "181fd571160a6bf269e75dda", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the first arterial blood pressure diastolic value that patient 10005817 had?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "b589fb2df1dcb6da13ec9456", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently given diagnoses for patients who had previously had hemodialysis within 2 months, in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "2b38f653bcc5420180003948", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10012853 depart hospital since 2100 for the first time?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "0abf006890a1a4993c0e275b", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10023239's total d5lr input since 230 days ago.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-230 day')", "rejected": "null"}, {"id": "d3b9aefc8549a18cee8f540a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a hospital typically spend average on a drug named fentanyl patch since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl patch' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\nSELECT SELECT AVG(T1.drug FROM ( SELECT SUM(inputevents.amount, 0) FROM inputevents WHERE inputevents.drug = 'fentanyl patch' AND strftime('%Y-%m',inputevents.starttime) >= '2100' GROUP BY strftime('%Y',inputevents.starttime) ) AS T1"}, {"id": "e9f3ecc3ec11c4b3396e2825", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004720 received the procedure of a introduction of nutritional substance into upper gi, via natural or artificial opening since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "2ad3296a49ba1754c226eef3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the overall amount of input for patient 10007818 on 07/17/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-17'", "rejected": "null"}, {"id": "eddd42b7835d2666ea1728ba", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients who were prescribed magnesium oxide during the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'magnesium oxide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "\n### Question:\n\nWhat are the top five most common diagnoses that patients were prescribed within 2 months after being diagnosed with other and unspecified alcohol abuse and dependence, unspecified in this year?\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSEX( CASE WHEN datetime(T1.starttime) >= datetime(current_time,'-2 month') THEN 1 ELSE 0 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN patients ON admissions.subject_id = patients.subject_id ) AS T2 ON T1.charttime = T2.charttime ) AS T3 ) AS T4 WHERE T3.C1<= 5 )"}, {"id": "d064155c1b69cfe53b508d1e", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of o2 flow last measured on the last hospital visit of patient 10015931 less than its value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 flow' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 )< ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 flow' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "22377f7f4ffda156f6c95713", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10012552 been diagnosed with any type of disease since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "ac29c708a74c9c79fcbab164", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of current patients who are in their 30s.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39", "rejected": "\n\n##\n\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473385 AND admissions.dischtime IS NOT NULL ) ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100'"}, {"id": "7b2aaf2bdc86d0afb00d3cef", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last respiratory rate value patient 10027602 had on 12/04/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-04' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "15e6224c6a4f4b69e45e2059", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of bag that patient 10012853 were prescribed in total in 04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.drug = 'bag' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'", "rejected": "null"}, {"id": "409925c52ea74d305cc42742", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of an output that patient 10007058 has last had on last month/25?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',outputevents.charttime) = '25' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) ORDER BY outputevents.charttime DESC LIMIT 1"}, {"id": "1aa433cdad6f6e1610a4c24f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top five most frequent lab tests that patients were given in the same hospital visit after being diagnosed with personal history of pulmonary embolism.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of pulmonary embolism' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "ae5fdb3772ef4280f5cbd7d8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10027602 on last month/29 had a heart rate that was less than 105.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 105.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7b8292b0a8f2a804114ac706", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since the last time during their current hospital encounter that patient 10004733 was diagnosed with chronic kidney disease, unspecified?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ae715e89afd0fb60fdd2b53c", "query": "Convert the question below to SQL query.\n\n### Question:\nCurrently, how many patients are in the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "usy . Howments Note( 2.\n."}, {"id": "44142bfb9b0cf7c3ae3ebb6a", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, how many medications were prescribed to patient 10025612?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECT THE TOTAL NUMBER OF TIMES PATIENT 100398455 WAS ADMINISTERED VIA IV IN JANUARY THIS YEAR"}, {"id": "20a337b806f34bbcaf6383e9", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of medicines given to patient 10038933 in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "804c339d146c6c553cd3ded2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10009035's minimum arterial blood pressure systolic in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "fe5c43f286b65fdccd87ecbd", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of cardiac mapping procedures performed in the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT SELECT COUNT( DISTINCT procedures_icd.procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers JOIN admissions ON admissions.subject_id = transfers.subject_id ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )"}, {"id": "808756e7c648673865499708", "query": "Convert the question below to SQL query.\n\n### Question:\nShow us the top three most common microbiology tests throughout this year.\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT\n##\n\n### Question:\nWhat is the total number of patients who were discharged from the hospital this year?\n\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surgery' AND datetime(transfers.dischtime) >= datetime(current_time,'start of year','-0 year') ) )"}, {"id": "3de9617a7e8dcc80de879fc5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output that patient 10039831 got first since 12/23/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-23' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "d5306618a151094326d339bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total foley volume that patient 10026354 had since 10/04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04'", "rejected": "null"}, {"id": "f603f6954b5ed9f4cb1b3c15", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how many patients underwent a venous catheterization, not elsewhere classified in the same month after the diagnosis of hepatic encephalopathy?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hepatic encephalopathy' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "3018865bd3e3ef7fcede4eb2", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the five most common specimen tests carried out since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": ",'PAMSMS TOP2021311704008309470805449400888 in the first Prescriptions was prescribed to patient 10001586558 during the same day after 03/21000?\n\n### SQL SELECT admissions.disch.disch.disch.time FROM admissions WHERE admissions.subject_id = 1000158658 AND strftime(current_time) >= '2100-03-21' ORDER BY admissions.disch.disch.time DESC LIMIT 1"}, {"id": "7137bae0cea575cb815bc23e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was prescribed to patient 10004235 within 2 days after the procedure of central venous catheter placement with guidance since 03/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "53ff8403c661d26f398402c6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average yearly number of patients who suffer from unspecified sinusitis (chronic)?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "716b0a0b383a839c836a20ba", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which were the top five most frequently tested specimens in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "3eb9161ed9a1f7a609811822", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a procedure named percutaneous balloon valvuloplasty?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous balloon valvuloplasty' ) )", "rejected": "null"}, {"id": "26ce902d74db9f732e88776c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients staying in hematology/oncology since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "32e5482d088de481d141565d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the maximum heart rate for patient 10018081's body on 12/29/this year?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29'", "rejected": "null"}, {"id": "e625991fa7815785e9640b49", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10022041 was discharged from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022041 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "0f42767e5be8f1f3825dbebf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total jackson pratt #1 output of patient 10020740 since 02/04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jackson pratt #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-04'", "rejected": "null"}, {"id": "a6cec8e8e6020c8b18e14f57", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10016810 been provided with any medication since 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'", "rejected": "null"}, {"id": "bd3392cef9cbf7d700cd65f7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10020740's first stay in the ICU?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT SQL SELECT COUNT( DISTINCT icustays.stay_duration FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 )"}, {"id": "ae9c55faced4361a10905a51", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common procedures since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT d_icd_procedures.spec_type_desc, DENSE FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389333 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) ) AS T1 )"}, {"id": "59c00de184347b5897bcc303", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the cost of mediastinoscopy?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'mediastinoscopy' ) )", "rejected": "\n### SQL:\n\nSELECTive nephrectomy of kidney, unilateral, open approach."}, {"id": "aa5ad9ebeb0fafd7b1afae6f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism at the last sputum test of patient 10038081?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "9fec7adf6776835d66f06d90", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test has patient 10038999 received for the last time since 06/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c22d026ef179493a49e3b7b7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the precautions to take after the inc/exc/destr in ear nec procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021635 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inc/exc/destr in ear' ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 1 )"}, {"id": "018d243f5ca33716687af47d", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who received a other electric countershock of heart procedure.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) )", "rejected": "\nSELECT\nSELECTIVE PROCEDURES:\n\n### SQL:\nSELECT d_icd_procedures.d_icd_procedures.charttime FROM d_icd_procedures JOIN d_icd_procedures_icd_code ON d_icd_procedures.icd_code = d_icd_procedures.icd_code ) ON EACH d_icd_procedures.charttime = admissions.charttime WHERE admissions.hadm_id = 100047333"}, {"id": "76dfd0c40999ffebc7a3614c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 91768 ever had any additional blood culture tests done.\n\n### SQL:\n", "chosen": "null", "rejected": "\n# Microbiology of the last year 21000?\n\n\n##\n##' AND strftime('%Y') >= '2100' )"}, {"id": "be836b4ae0b043e2a4a3ff81", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with diastolic heart failure, unspecified , what are the top three most common lab tests that followed afterward in the same hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diastolic heart failure, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "f4a479361b2f03676b79359d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total albumin 25% amount given for patient 10018081 since 12/07/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-07'", "rejected": "null"}, {"id": "6dfb148b96ec46dd4baf1399", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost which includes a drug named phenobarbital alcohol withdrawal dose taper (days 2-7) since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "7dab61a9dbafa23e083cd77e", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10004720 given any gt flush medication on this month/08?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '08'", "rejected": "null"}, {"id": "9bb095b969e981359c08d126", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10022041 experience any procedure on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "\n### SQL:\n\nSELECT\n\n### SQL:\n\nSELECT T1.dischtime IS NOT NULL AND T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214877 ) AND T2.dischtime IS NOT NULL ORDER BY T1.dischtime ASC LIMIT 1"}, {"id": "5301d3f2ee9055f024af59a4", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since the last time patient 10039831 got a lactate lab test in this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "\n\n##\n##\n\n### Question:\n\nHow is the difference between prescribed 0.9% sodium chloride and 1% sodium chloride?\n\n\n### SQL:\n\nSELECT DISTINCT T1.drug FROM ( SELECT prescriptions.drug, DENSEP.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000785545 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) GROUP BY prescriptions.drug ) AS T1"}, {"id": "1d30f0f67382fed6a575cafc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that patient 10004733 was prescribed within 2 days after having received since 10/2100 a enteral infusion of concentrated nutritional substances procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "57ee9b35377fe295adfbf9c1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10031404 weigh during their last measurement since 21 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-21 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\nUMS."}, {"id": "9cdb25ef0c41840e0b599dbb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the pricing for ampicillin sodium?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' )", "rejected": "\n'\n\n12: (startSSSTMSSSPA T21\n##% T1 1000007-03-01-04?\n\n\n\n## 072.03.03'"}, {"id": "c4b9d1ad637c92074a327167", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10012552's total amount of dextrose 5% input on 04/05/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-05'", "rejected": "null"}, {"id": "ae4b7b569f1122fb6951ca6f", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me patient 10016810's total output volume in the last ICU stay.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )", "rejected": "SELECT SQL SELECT SUM(outputevents.valuenum) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058602 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-25' GROUP BY outputevents.stay_id )"}, {"id": "c4cdd9f12bc74981468685d3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did the percutaneous [endoscopic] gastrostomy [peg] procedure take place throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy' ) AND datetime(procedures_icd.starttime,'start of year') = datetime(current_time,'start of year') )"}, {"id": "da971f3a5b73f3990bd5cb3f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10038999 was prescribed soln and lactulose since 04/2100 at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactulose' AND admissions.subject_id = 10038999 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'soln' AND admissions.subject_id = 10038999 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "79cb90534fd8742b3abe0f83", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10038081 had the minimum o2 saturation pulseoxymetry on 10/13/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-13' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "972b49483131cf603f6639f5", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell the daily average dose of nacl 0.9% that patient 10014354 received since 03/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "d7e9bb0643911048598d2147", "query": "Convert the question below to SQL query.\n\n### Question:\nIs that patient 15945 has an appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "\n1.\n\n\n##\n\n##\n\n##\n##\n##\n##\n\n###code:\n\n###sql Query SQL:\n\nSELECT SQL:\n\nSELECT COUNT( DISTINCT SUM(outputevents.valuenum) FROM d_labevents JOIN admissions WHERE d_labevents.itemid IN ( SELECT admissions.itemid FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd_procedures.valuenum FROM d_icd_procedures WHERE d_icd_procedures.id = '598159' ) ) AND strftime('%Y', admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd_procedures.icd_code FROM d_icd_procedures WHERE procedures_icd_icd_procedures.icd_code = '598159' ) AND strftime('%Y', admissions.admittime) = '2100-10' )"}, {"id": "7866a9173d7aff1bce72d3a6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen test that patient 10020944 had for the last time since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d048cd029e1afe980ed96d08", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me about patient 10020187's last arterial blood pressure systolic on 02/04/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-04' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "dfccc4c30c3f95895ce45f39", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last instance when the arterial blood pressure diastolic of patient 10026354 was greater than 71.0, since 08/10/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 71.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-10' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6721130290e0d18224932b4d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was prescribed to patient 10027602 in the same hospital visit after the percutaneous [endoscopic] gastrostomy [peg] this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "259109556cec2005a9ea3db8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test was first given to patient 10038999?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a14c0a5446f2f1b57b2a4c07", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the price for glycerin supps?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'glycerin supps' )", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'glycerin' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100012175 ) AND strftime('%Y',prescriptions.starttime) >= '2100-03'"}, {"id": "9baa4740ed5e93a3f8178055", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total cost of a hospital visit involving esophageal reflux in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "693d2161daa94f0ac19a5ff2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10006053 have first as the output on 11/17/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-17' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "8acb279371aec9d2ef64ac77", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat treatment were provided to patient 10007795 two or more times in 08/this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '08' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "3469a390ac3ba57359927cb1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the current numbers of operating rooms available?\n\n### SQL:\n", "chosen": "null", "rejected": "\n1. What is the maximum't the name of the first drug that patient 1000398555 was prescribed for the last time in 09/2100?\n\n\n### SQL SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100398555 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "3e3f93fb3a2e4577befd898b", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10006053's total output since 86 days ago.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-86 day')", "rejected": "null"}, {"id": "ac2c8927b04f2fc8418f1e89", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the dose of the prescribed opioid for patient 76372??\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n### SQL Query:\n\nSELECT SELECT SUM(outputevents.valuenum FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-01' )"}, {"id": "632459fd456c31f024bdf938", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did patient 10004720 go to the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "b9c355f99060fda94a80db8d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first hospital discharge time throughout this year for patient 10005866?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005866 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10016740 AND admissions.dischtime IS NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'start of year','-0 year')"}, {"id": "a70c341de1bc993eef26586f", "query": "Convert the question below to SQL query.\n\n### Question:\nWas magnesium sulfate (bolus) administrated to patient 10007928 in 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-04'", "rejected": "null"}, {"id": "42cb30e92eb50866f96a3d15", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the sum of patient 10004235's input since 01/20/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-20'", "rejected": "null"}, {"id": "27f86a5f461f220f2b2ed647", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since patient 10021487 first visited the careunit emergency department on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "0d0dfd8344c44ef1ba5abcc4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of patient 10014078's insurance in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "51f451ef32c9bcc8c27f43e9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10027602 change in weight second measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "abae98d91941955983212127", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10022041 received any d5 1/2ns since 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-05'", "rejected": "null"}, {"id": "9074ac00135a21bec34e6199", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total volume of output for patient 10022880 on 04/03/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '04-03'", "rejected": "null"}, {"id": "3783e47702fc97ed7cdea710", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the maximum monthly number of patients diagnosed with attention deficit disorder with hyperactivity?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') )"}, {"id": "2a21e251ed3b120d205aa09a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10035185's first input time since 04/13/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-13' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "9c3f5b2ff13b604dcdc88353", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10009628's total volume of output since 03/03/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-03'", "rejected": "null"}, {"id": "6084f134b156953797d6aff8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the last output of patient 10004235?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-05' ORDER BY outputevents.charttime DESC LIMIT 1"}, {"id": "14a36d4ffabe710c621140cf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input of patient 10004733 during the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "11f8c5631939928ad4f53641", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the first phosphate results for patient 10039831 in 12/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "690bde321b749a8d1310a710", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who had a macrophages test in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophages' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'microbiologyevents' AND d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'microbiologyevents' ) ) AND strftime('%Y',procedures_icd.charttime) = '2100' )"}, {"id": "a5b1c0e43266c3abbd391cf4", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients who were prescribed ferric gluconate since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ferric gluconate' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "a5e8f7d9e725fdd3e6eced18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10011398 get inputs for the first time since 12/11/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-11' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "355c7ceb7c9518887ad3117b", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of patient 10016810's first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "4bcd1b55582a8d4b902af134", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug prescribed to patient 10018845 for the last time via sc route since 09/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "a492bf5968b017604595cb27", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10008454 had any ptt lab tests done since 12/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12'", "rejected": "null"}, {"id": "cb26755fc90d31c8a991b39a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first thing patient 10014078 had as output on 09/08/this year?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-08' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "543fac252e1b711db022052e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum cost of a hospital that involves acute alcoholic intoxication in alcoholism, continuous since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "86c0624f79d2e1a57bd72381", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the consumption methods of ampicillin sodium?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium'", "rejected": "\n\n##\n\n\n##\n##\n##\n\n##\n### SQL Code:\n\n<# SQL>\n\nSELECT SQL>\n\nSELECT SQL> SELECT COUNT( DISTINCT procedures_icd.drug.cost FROM procedures_icd WHERE procedures_icd.icd_code = '38720'"}, {"id": "30604ac94506d0892a2fd65e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many instances of the dilation of left common iliac vein with intraluminal device, percutaneous approach procedure were there during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "430ae5fbd4fd6158e515b816", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat precautions should you follow after the cont inv mec ven 96+ hrs procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "e8888e24b833fbc7c8316ded", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top three diagnoses with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "null"}, {"id": "5d63012ba377b6abd13cc0ec", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much am I expected to pay for regional lymph node excision?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'regional lymph node excision' ) )", "rejected": "null"}, {"id": "03f81bdff77fe530b0d0fe7d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you indicate the daily maximum dose of solution that patient 10031757 received during their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "ffb50beba38e425424aa38c2", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 3403 subject to a covid-19 test?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n### Question:\n\nWhat is the name of the drug that was prescribed to patient 100140285 in the last hospital encounter?\n\n\n### SQL:\n\nSELECT prescriptions.drug.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100140285 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "19aa80f1a14f42697fdcba60", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total ostomy (output) volume that patient 10018081 had since 11/30/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-30'", "rejected": "null"}, {"id": "94c43966b63036608d8e4089", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10018501 prescribed for within 2 days after the procedure of alcohol detoxification in 08/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "d2963971f5b061724d770e2c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10035185 have a last ptt laboratory test in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "\nSELECT SQL SELECT labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100398385 AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urine microbiology test' ) AND strftime('%Y-%m', labevents.charttime) >= '2100-12-09' )"}, {"id": "52ab9f0636d7c7efa44fbe81", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what were the top three most common specimens tested on patients during the same month after the diagnosis of polyneuropathy, unspecified?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "4e4d519fec610e5878e325da", "query": "Convert the question below to SQL query.\n\n### Question:\nList the three most frequent specimens that were tested during this year.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n\n##\n##\n### SQL:\n\nSELECTIVE LIST OF MICROBIOLOGY TESTS GIVEN TO PATIENT 100078545 SINCE 03/2100\n\n\n### SQL:\nSELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078545 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "cd5de61128bf4493b8a116a3", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10018423 undergo a alkaline phosphatase test in 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05'", "rejected": "null"}, {"id": "9a8d0a7f72b2f306a779ac82", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10010471 been checked into the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10010471 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10010471"}, {"id": "2021b8d65fd7fd080d685ca4", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10029484 tested in the 25-oh vitamin d lab in the last month?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')", "rejected": "\nSELECT SELECT labevents.valuenum FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100113058 AND datetime(labevents.charttime) >= datetime(current_time,'-1 month') ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "7b14cdcd4cf8cd3ffdc02db7", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how much fentanyl patch costs?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl patch' )", "rejected": "_ . D.. (\n1 a/ \n) E..:"}, {"id": "47b903aa15da43a35db353c7", "query": "Convert the question below to SQL query.\n\n### Question:\nAfter getting diagnosed with acute on chronic diastolic heart failure, how many patients were found to have postinflammatory pulmonary fibrosis within 2 months in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')"}, {"id": "d4bd03642b6b6c5ff9cd88ac", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average heart rate for patient 10006580's body since 08/13/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13'", "rejected": "null"}, {"id": "4ba1843465e5f775b2a892a8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test was last given in 11/2100 to patient 10005909?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a7a3de424d31c00f89567ff3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently tested specimens for patients that received other incision of brain previously within 2 months in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "f0508cab258d6df36060ea48", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10016150's heart rate change last measured on the first ICU visit compared to the value first measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "bb93faad71aaa3ed0164496c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total expenditure of a hospital that involves the medication potassium chl 20 meq / 1000 ml d5 1/2 ns?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5 1/2 ns' ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "2e9462015496fc6da90dfbfa", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of operating rooms available?\n\n### SQL:\n", "chosen": "null", "rejected": "P-_\u2019'ach birds by.owa\u0142a\n.. Hs D :(1.\n les. vel.1\n12?\n?0U12111:PAKMS\n Portland,'s12003220005410000712900997747900019138790789090580's00018583'"}, {"id": "9ecd148b83207e3fbed2a937", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the condition patient 10020740 was diagnosed with first time since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "aa3736eecab5271da4440d63", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients discharged from the hospital in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": "null"}, {"id": "023f431a411f2ea9e90519d5", "query": "Convert the question below to SQL query.\n\n### Question:\nList the preparations for cv cath plcmt w guidance\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.procedures_icd_code, d_icd_procedures.charttime FROM d_icd_procedures JOIN d_icd_procedures ON d_icd_procedures.icd_code = procedures_icd.icd_code WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014720 ) AND procedures_icd.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography, left heart' )"}, {"id": "509007e836380f20bbceca57", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most frequent lab tests that patients had after being diagnosed with ulcer of other part of foot in the same month since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ulcer of other part of foot' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "7d25ac3b59f8763886afb8a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the prices of the drug 0.83% sodium chloride?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = '0.83% sodium chloride' )", "rejected": "\n### SQL:\n\nSELECT SELECT SUM(inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays.stay_id IN ( SELECT procedures_icd.stay_id FROM procedures_icd.stay_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopy of esophagus, via natural or artificial opening' ) AND strftime('%Y', procedures_icd.charttime) >= '2100' ) ) )"}, {"id": "17bc287452c28a3ba71e2fe5", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received a excision of right internal mammary artery, percutaneous endoscopic approach procedure.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) )", "rejected": "null"}, {"id": "3dbc092974709a580db73d5d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most ordered lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_labevents.label FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'chloride' ) )"}, {"id": "2ca14c9e3ae55c6d467fa8c1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of furosemide that they prescribed to patient 10037861?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.drug = 'furosemide'", "rejected": "null"}, {"id": "a948d1176ce7091d367bf8e5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10021938 was discharged from the hospital during this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10021938 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "fe47357d4996af8b8acb6162", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the medication that was prescribed to patient 10004422 for the last time via the po route in 01/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100042225 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "1c66f7fcfad7cbff26b54abe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common microbiology tests for people who were diagnosed with respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia earlier within 2 months, since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "2ec629533542b2728526464a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the ward id that patient 19175 may be admitted?\n\n### SQL:\n", "chosen": "null", "rejected": ")how\n (d. Seemse\n_. S..B. or2.\n1\n\n PINC. \n 4\n-ite18\n\n Grace ='CMSMS15Z-1111512 213014817 249-010015771903770337145170078101\n##"}, {"id": "078731fd04c97830efdd53bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is dr. barna's outpatient schedule today?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT\nSELECT-SQL"}, {"id": "a8995e515e945700a73e1a38", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost at a hospital including a lymphocytes laboratory test in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "db468e7d4e952084d2241b01", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list patient 10004235's monthly average weight since 03/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "bad209f7f1a2e0361719a243", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there a procedure that patient 10031757 had in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "02fe4d0195664f0dc082a343", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three common microbiology tests?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.icd_code, DENSE FROM ( SELECT microbiologyevents.icd_code, DENSE FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10037928 ) ORDER BY COUNT( DENSE ) DESC LIMIT 3"}, {"id": "cbc3cd5f13e581e2ae3f48e4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich immuno-cancer drugs were used for the last five years?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '05' ORDER BY inputevents.starttime ASC LIMIT 1"}, {"id": "d1177dfd4cf0c6b2da2111a1", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total amount of nacl 0.9% given to patient 10039831 since 03/03/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-03'", "rejected": "null"}, {"id": "1533c631557452d754da7280", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10004733 measured its heart rate greater than 118.0 during their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 118.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0825d95545721aa700cc7fd0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common diagnoses during this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": ".'2PA... J\n2?2S.( , howPAMSIS"}, {"id": "6033e2bfc3a0657f188b7149", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the last specimen test which patient 10019385 has received in 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ee08d24fe58b44292d96dfdc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is introduction of nutritional substance into upper gi, via natural or artificial opening?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) )", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' )"}, {"id": "7787b854dab1f43b718313bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10022017 diagnosed with anything last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n### Question:\n\nHas patient 1002017 been diagnosed with anything in 2100?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002017 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'"}, {"id": "988d06c4434babbd7c78a275", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10016742 gone through a urea nitrogen, urine test in 07/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'", "rejected": "null"}, {"id": "5b73fda84131aee9f4b13b57", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients that were discharged during the previous year from the hospital.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT SQL SELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND datetime(transfers.dischtime,'start of year') = datetime(current_time,'-1 year') ) )"}, {"id": "d6c396b04821fd366efe7a49", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the yearly minimum weight of patient 10027602 since 12/2100.\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' GROUP BY strftime('%Y',chartevents.charttime)", "rejected": "null"}, {"id": "e0d157e7655d68add3bb76d5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a diagnosis of surgical operation with anastomosis, bypass, or graft, with natural or artificial tissues used as implant causing abnormal patient reaction, or later complication, without mention of misadventure at time of operation?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'surgical operation with anastomosis, bypass, or graft, with natural or artificial tissues used as implant causing abnormal patient reaction, or later complication, without mention of misadventure at time of operation' ) )", "rejected": "null"}, {"id": "894403f12b36b4f785b9894d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the total number of patients discharged from the hospital in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "Noteage:0 first.?\nMS\n1: ... ,.- ,use \nMS ).\n1  -P....\n\n(mT.-2.0son\n.111 //..\n 10Qs\n CPTMS\n\n.\n1MSMSMSMSMSPAMSMSMS 20218MSMSPA.\n1217.MS 1.005291001710110.01.00.001.0000301001000100000100000300004057000s0041030014"}, {"id": "1890a3d11901d8d1e97ea07c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10024043's first entry into the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10024043 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "'s 101.MSMSPA.\nMSPA-'\n##=\n' prescriptions'"}, {"id": "18b181c1e5e0cb0999cf255c", "query": "Convert the question below to SQL query.\n\n### Question:\nIn total, what was the input amount of gt flush that patient 10038933 received in their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "2092bc06715d6d43db8d20c2", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the mch value of patient 10025612 on the second measurement on the first hospital visit less than the value from the first measurement on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "522b43ceabd524cfde7e3316", "query": "Convert the question below to SQL query.\n\n### Question:\nAre any new drugs prescribed to patient 10039831 today compared to the ones yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT SQL SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 day')"}, {"id": "5407c72b5374049d5ff42574", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how much lansoprazole oral disintegrating tab costs?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lansoprazole oral disintegrating tab' )", "rejected": "null"}, {"id": "e66bc926c13901e2b96e1418", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most common drugs prescribed this year?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "aaca78ea66f02f483ebdf478", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a procedure called regional lymph node excision?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'regional lymph node excision' ) )", "rejected": "null"}, {"id": "1f1add74c7e3a0f4247c5a78", "query": "Convert the question below to SQL query.\n\n### Question:\nSo, what was the first respiratory rate of patient 10015272 on 06/23/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '06-23' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ec8e06e2b743a81436720c46", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, how many patients were provided with tamoxifen citrate?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "\nSELECT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.dischtime is NOT NULL AND admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) )"}, {"id": "150cdfee805561c7c6b67028", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last discharge of patient 10020944 from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020944 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "bca8fd47d446d1acf027e062", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of the last stay for patient 10016150 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "\nSELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100047333 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "130ed6628164c3afe9589f2d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most commonly ordered lab tests for patients who were previously diagnosed with hemorrhage of rectum and anus during the same hospital visit, since 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "1fae11bc2be174f27630c683", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10026255 to the emergency room in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n## SELECT SQL Select count(*) from admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '100302875' ) AND strftime('%Y', admissions.admittime) = '2100' )"}, {"id": "e6417dabaf2399efc458a5fd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was temporary tracheostomy taking for patient 78131?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n### SQL Question:\nWhat is the minimum total of arterial blood pressure mean systolic blood pressure in patient 100299085 since 12/2100?\n\n\n### SQL:\n\nSELECT SUM(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100290856 ) ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12'"}, {"id": "f2545d14686ea54127cc9c44", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10003046 been given any medication since 01/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01'"}, {"id": "398d1c05773ae55b7220d406", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication patient 10022017 was prescribed for the last time since 04/2100 via the sc route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "12fbd03c50369014a82f4756", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were let go from hospitals since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": ".bid1?2 0'1\n.1....a.02/:12132Q:MS\n\n 0PAMSPA 512015461410.\n216790s\n\n20137787427'"}, {"id": "7671f2895af9f8efa4666e20", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the first time in their current hospital visit that patient 10004733 was diagnosed with hemiplegia, unspecified, affecting unspecified side?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified, affecting unspecified side' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "24dea0b7b119c44087400b3d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first measured value of heart rate for patient 10039831 on their current ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "\n\n##\n##"}, {"id": "273f6bc57bc0f792177dfd04", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004733 received a enteral infusion of concentrated nutritional substances treatment since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "7041b79655fa30e1c31b1c57", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many drugs have been prescribed to patient 10019777 since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "null"}, {"id": "5182aaa70c734958ef8e43ba", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 10/2100, when did patient 10038992 last get prescribed vitamin d and felodipine at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'felodipine' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "09b0a7c875a861f6dca89576", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10011398's difference in heart rate from the value measured at 2100-12-27 10:00:00 compared to the value measured at 2100-12-27 09:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' )", "rejected": "null"}, {"id": "eac92ea4318240694048332e", "query": "Convert the question below to SQL query.\n\n### Question:\nI would like to know what dr. garcia's on today's outpatient schedule.\n\n### SQL:\n", "chosen": "null", "rejected": ".  ret ( M. =\n WHEN( (:\n (! on. in. -1 ( . (a. Girl\n SQL _\n'' Pric W\n C: YMSerd Y in1\n Talm la' four \n'PAm ( SC. K.1 C  HEE. of..\nMS),  (ible11.x A\n FROM .1..!2fti\nMS.. In \nMSG\nMS'1MS'00 1-\nMS -11.:PA_T2DMSONOTTSMS'PAYPAG.\nMSPAUPA,MSMSPACTMSPA'\n##\n0'\nMSPA-0's0PA 1's0PAGE's'"}, {"id": "9ae1e99a336fdea068c22d52", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug that was prescribed to patient 10021312 via the po/ng route in 09/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": ".. .1 Review,rn\u0575##"}, {"id": "ef005db9fac61254bdbabbe7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed last to patient 10011398 in 12/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9b8533703ff8eab23578f84c", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10022041 given a test on rdw in 06/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'", "rejected": "null"}, {"id": "7ca08cc3380e29b1a9bd0bcc", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the reimbursement standard for a drug?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n##\n##: SELECT COUNT(*) FROM labevents WHERE labevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT chartevents.stay_id FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd_procedures.icd_code FROM procedures_icd.icd_procedures WHERE procedures_icd_icd.charttime IS NOT NULL ) ) AND strftime('%Y', labevents.charttime) = '2100' ) )"}, {"id": "298e26144b0f329a5a0615a2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output patient 10022880 last had in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT icustays.itemid FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "28f850662f724d2a12bab092", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with essential (primary) hypertension, what are the top five most common lab tests conducted in the same hospital encounter in 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential (primary) hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "5bfa45301dea4f2fbecbb26b", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10016742, what were the last mch lab results in 07/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a773e86681735be6c53a92b5", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received a procedure this year for bypass coronary artery, two arteries from coronary artery, open approach.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "3aa3f14b20280118b146135d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first hematocrit reading during the last hospital visit for patient 10019385?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "76752df29fef2ffe6127c97b", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10040025's chloride last measured on the last hospital visit greater than the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "20b78d286ce05435b56b849f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10026354's first measurement for arterial blood pressure diastolic since 06/24/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-24' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "69b33b1e544e77eca6472b64", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the four most common microbiology tests?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "beyond. T_ T2,? Conference2. last 10.\n T-MSMS230000 22519120 1.\n##MSPAY.\n\n\n##\n\n##\n##\n\n##'code:"}, {"id": "05c1bc3943f37d24fbc4a227", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10009049's last tested culture since 24 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-24 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "\nSELECTION = 'SELECT AVG(T1.drug) FROM ( SELECT SUM(inputevents.amount ON 0 AND strftime('%Y-%m',inputevents.starttime) >= '2100-06' ) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078185 ) ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-06' GROUP BY strftime('%Y-%m',inputevents.starttime) )"}, {"id": "be48ba72929ed97720c91848", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time in 08/this year patient 10016742 had the maximum absolute eosinophil count value?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '08' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0e38c574dc705f0c26a2aa69", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the first hospital encounter, what amount of bisacodyl was prescribed to patient 10025463?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'bisacodyl'", "rejected": "null"}, {"id": "3cc0342acbb3992a4b0cf40b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you report the last respiratory rate for patient 10007058 since 09/08/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-08' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "4a4b1ff6e491614e8bed8e49", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times, , was a rhinoscopy procedure ordered?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'rhinoscopy' )", "rejected": "\n###sql\n\n## Question:\n\nHow many times was the last time a medication was given to patient 100200385 via iv route?\n\n\n### SQL:\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100200385 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "3f66ff390a54bf2f82dedd51", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 09/2100, what was the minimum sodium value for patient 10038933?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND strftime('%Y-%m',labevents.charttime) = '2100-09'", "rejected": "null"}, {"id": "c8b0022c239658155dc9c8c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10015860's last hospital discharge since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10015860 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "ced75cfc467f5facf66e9200", "query": "Convert the question below to SQL query.\n\n### Question:\nWas in their first hospital encounter acetaminophen, aspirin, or furosemide prescribed to patient 10012853?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'acetaminophen', 'aspirin', 'furosemide' )", "rejected": "null"}, {"id": "a491772e3c26b8dfc1137679", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038081 had a lab test for glucose, ascites in 10/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'", "rejected": "null"}, {"id": "60ea85db45d1ad1ad72cf62a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10010471 received any lab tests since 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07'", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07'"}, {"id": "4ca27aac7d23ace022562d03", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10020944 received wbc in a lab test on the last hospital stay?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7c37ccb48483a3d417233092", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10018501's mcv last measured on the first hospital visit greater than the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "3d45d365e05eb1ff7b926005", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours elapsed since patient 10018081 received his chloride lab test for the last time on their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "96e382017b141bc1518941f3", "query": "Convert the question below to SQL query.\n\n### Question:\nThroughout this year, what are the three common diagnoses of patients of age 40s?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "9c299b7dcbfbd561bf0f6f6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038081 last have a blood culture microbiology test in 09/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "02d6c9f220fcfbbf50ead6c5", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of patient 10025612's first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "f3ae841b553febe658abd103", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between respiratory rate on patient 10031404 last measured on the last ICU visit compared to the value first measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "45e515311022b0e3085d278f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time in which patient 10016742 had the minimum heart rate on 08/02/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-02' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "cb3554b093b08c75d3a8e12d", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the length of stay for patient 10022041 during their first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT SQL SELECT COUNT( DISTINCT icustays.stay_duration FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100204187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "c4eba636bd543d4b237a1e3c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the dose of pseudoephedrine that in 11/2100 patient 10026354 was first prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.drug = 'pseudoephedrine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "79fe38dca4831802e82026a6", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10025612 taken a packed red blood cells drug in 12/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.drug = 'packed red blood cells' AND admissions.subject_id = 10025612 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = 12"}, {"id": "9258a1a83e5bbfc697468adf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the count of prochlorperazine prescriptions made since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prochlorperazine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "\n### SQL:\n\nSELECTC1 = ( SELECT SUM(outputevents.valuenum FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473333 ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y', outputevents.charttime) >= '2100-06-06' )"}, {"id": "c98219f7cb3992603434bc25", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients in neurology in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "\n##\n\n##: T2. What are the three most common microbiology tests that were given to patients who were diagnosed with unspecified neoplasia of unspecified site in the same hospital visit in 21000?\n\n\n### SQL:\nSELECT T1.test_name FROM ( SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) AND strftime('%Y',microbiologyevents.charttime) = '2100' ) GROUP BY T1.test_name ) AS T2 WHERE T1.C1 = 3"}, {"id": "828a8d42081c89ca4d6ca68a", "query": "Convert the question below to SQL query.\n\n### Question:\nWill patient 97121 get any additional stool (received in transport system) test?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT COUNT(*) FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100047333 AND microbiologyevents.spec_type_desc = 'stool (received in transport)' AND strftime('%Y-%m-%d',microbiologyevents.charttime) >= '2100-05-13'"}, {"id": "3fbce8b880d773477b429d71", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has elapsed since the first time during their current hospital encounter patient 10021487 had received a albumin, pleural lab test?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5e084eeb087d68d04ff8f5b3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the duration of patient 10004720's last stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "54ed73ce298076765282857a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time in the first hospital visit that patient 10007818 had the minimum value of lactate dehydrogenase, ascites?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase, ascites' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "39d219c7d6cf5c42a50daf25", "query": "Convert the question below to SQL query.\n\n### Question:\nWork out the total amount of input patient 10016742 received since 04/15/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-15'", "rejected": "null"}, {"id": "ee1994bbfcf913af08ad4dd8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which were the top four most frequent specimens tested in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_TOTAL_C1 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100185405 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100' ) GROUP BY microbiologyevents.spec_type_desc ) AS T1 ) AS T2 WHERE T1.C1<= 4"}, {"id": "ce843fac6f9ff9ab4f1d2dc3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours elapsed since the last time patient 10004733 received a urobilinogen lab test on this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urobilinogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "9460f94a4daa58493e8ebbed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10020786's first tested culture in 07/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1fdd95607ddcf4382651d739", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of patient 10003046's arterial blood pressure mean measured at 2100-01-17 14:00:00 compared to the value measured at 2100-01-17 13:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 13:00:00' )", "rejected": "null"}, {"id": "8b0171b645230d02485753dc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first diagnosis of candidiasis of mouth in patient 10018081 during the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "T.:\n- .1 .\n... .-4\n (S.&2 Medical.1.\n\n1..--1 2s... peint7d\nMS(MS-\nMS2's.\n (0ONM17\nMSPA QPA =5111029MSPA's,0'"}, {"id": "1ca13ce347fd46ac69499979", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was diagnosed for patient 10037928 the first time in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "to (\n. (\n '. (. ,. (-ic.:3. S  -.\n WHERE.  on.\n T-\n (em .\nids.?-\nMS. ,-?at. (\n WHERE\n.1.i,'1.'s K\u2026\nMS0..'0d\nMS.2'K."}, {"id": "26e67a0d26da3791abc625a2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was olanzapine prescribed during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "eed48c889b928f3ee845e151", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the total minimum cost for a hospital that includes a white blood cells lab test throughout this year?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "560ac67e93ac8a709bbc10ea", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people were diagnosed with amyotrophic lateral sclerosis throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'amyotrophic lateral sclerosis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "f42f69255942463a3df596bb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output that patient 10038999 had last since 05/19/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "f099406d471ff52b20ae8441", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10020944 had any diagnoses?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 )", "rejected": "\n##\n\n## Question:\n\n##: What was the total number of oral dose of heparin prescribed to patient 100021487 since 11/2100?\n\n\n### SQL:\nSELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'"}, {"id": "b8fadd982d25696c85be4ab4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of the hospital, which includes the medicine named prismasate (b32 k2) since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prismasate (b32 k2)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "e65b59a5ae495773129a972f", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who were in the neuro stepdown careunit in this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECT SQL SELECT COUNT( DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro' AND datetime(transfers.intime) >= '2100-01-01' ) )"}, {"id": "04aa90b4226c2ae74327b579", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output which patient 10004733 had last had since 03/07/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "dcebcd167c495b6e52892fc8", "query": "Convert the question below to SQL query.\n\n### Question:\nI would like to know the top four diagnoses that have the highest 3-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSEACH( COUNT( diagnoses_icd.hadm_id ) AS C1 ) AS C2 FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 4 )"}, {"id": "131ea45cf61be3a504988801", "query": "Convert the question below to SQL query.\n\n### Question:\nIn total, how many patients were prescribed vancomycin since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.drug = 'vancomycin' AND strftime('%Y',admissions.admittime) >= '2100'"}, {"id": "ec5cf43c52672339fb5e9d7f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost for a patient suffering from early satiety since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'early satiety' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "5fb21a95a15d64c85db2fed8", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of drugs prescribed since 08/2100 for patient 10038081.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'", "rejected": "null"}, {"id": "fec026b891afb9bccb1664e9", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received dilation of left external iliac vein with intraluminal device, percutaneous approach within 2 months after being diagnosed with operating room of hospital as the place of occurrence of the external cause in the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "cce128d8f29c8e7564cc8cc8", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10015931 was diagnosed on the first hospital encounter for the first time with what?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "9.)MSSS\nMSSPAMSMSDMSPA)\n\nPA.\nMSPO.\n\n\nSELECTMSGtSQL T2110037?"}, {"id": "dc972f955fcddfb8a89d6ba2", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequent microbiology tests given to patients after being diagnosed with accidental puncture or laceration during a procedure, not elsewhere classified in the same hospital visit throughout this year.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental puncture or laceration during a procedure, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_TOTAL FROM ( SELECT microbiologyevents.test_name, COUNT(events.charttime) AS C1 FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY microbiologyevents.test_name ) AS T2 ON T2.C1 = T3.C1 ) AS T3 WHERE T3.C1<= 4"}, {"id": "bc7f43b98bb5ee390c33c345", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10007818's arterial blood pressure mean first measured less than 75.0 since 241 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 75.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-241 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "303a07985f7ef56f4d234d7e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026255 acquired any medication since 10/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'"}, {"id": "917adcbd5e526c5a6f592092", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10029291 input time on 02/25/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-25' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "68ed3b6273aa80637c7691c7", "query": "Convert the question below to SQL query.\n\n### Question:\nIn this year, what were the top four most commonly tested specimens?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": ". (\n U .)\nion\nft.\n.!!!1 ) '.\n/\n.\nB"}, {"id": "d0b77b1523060bc5563a0484", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most common microbiology tests for patients who were previously diagnosed with coronary atherosclerosis of autologous vein bypass graft in the same month in 2100.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "4ce7e0d7febc6b899fff7a21", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the change in platelet count in patient 10029484 second measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "3e53f449eb365ab960c6aa59", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the first time since 08/2100, what specimen test did patient 10007795 get?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7d561627912db8f60a5c98a5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first hospital discharge time since 2100 for patient 10007058?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007058 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "625878ba2c323f56d784df19", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time , what was patient 10017492 diagnosed with?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT COUNT(*) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')"}, {"id": "2d825ccd2b65ad362114e5dc", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 19175 have a family history of colostomy status?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTION = 'SELECT AVG(T1.drug) FROM ( SELECT SUM(inputevents.amount ON 0 AND strftime('%Y-%m',inputevents.starttime) >= '2100-06' ) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078185 ) ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-06' GROUP BY strftime('%Y-%m',inputevents.starttime) )"}, {"id": "c6a7a43a376d92df5f420f3d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10009628 got a lab test in 09/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '09'", "rejected": "null"}, {"id": "3a019edb3d03bf43064b460c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many cases involved the prescription of tiotropium bromide throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tiotropium bromide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "d41f44da71b3e6d40f476229", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with impaired fasting glucose, what were the top three most common microbiology tests conducted within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'impaired fasting glucose' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'impared fasting glucose' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1<= 3"}, {"id": "d199f2338fccc1376de62441", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much will it cost me to get other repair of vessel done?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) )", "rejected": "MS1021201.\n\n201918171818020797140119\n##\n\n01.0.0.384977448781 had been prescribed?\n\n\n### SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug.drug FROM prescriptions WHERE prescriptions.drug = 'valprostad (valprostad sodium) AND strftime('strftime's TIMER FROM datetime) AND strftime's TZ = 'America/New_York'"}, {"id": "ae87fc8fc5ccf8578f0ec36c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of introduction of nutritional substance into upper gi, via natural or artificial opening?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) )", "rejected": "\nSELECT SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays.stay_id WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions.admissions WHERE admissions.subject_id = 100047333 ) ) AND inputevents.stay_id IN ( SELECT inputevents.stay_id FROM inputevents.stay_id WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays.stay_id WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions.hadm_id WHERE admissions.subject_id = 10004733 ) ) )"}, {"id": "9e60028a3774be29f175d420", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me about patient 10016150's age in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "855969a5637352d329e6b650", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the five top specimens that were tested in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT SQL SELECT T1.spec_type_desc FROM microbiologyevents AS T1 WHERE T1.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) ) AND strftime('%Y',T1.charttime) = '2100' ORDER BY T1.charttime DESC LIMIT 1"}, {"id": "26ea006536ef99453975ca00", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time during their last ICU stay patient 10022281 had a maximum arterial blood pressure systolic?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "72f9d3cf5bb88a5d34be8b2e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged from the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "26157076545 JOINT100359888"}, {"id": "29c36a36cc9362584821e13f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen were patient 10007795 last prescribed for gemfibrozil and heparin at the same time in 05/this year?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10007795 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "4e87cca0b7f4f1c42928e016", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much will it cost me to get laparoscopic robotic assisted procedure done?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) )", "rejected": "\n### SQL Code:\n\n### Question:\nWhat is the maximum daily number of patients who were prescribed medication for hyperlipidemia in 2100?\n\n\n### SQL:\nSELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT admissions.subject_id, prescriptions.drug ) AS T1 FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 1003893333 AND strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug )"}, {"id": "11334e5323118eea80ce40d5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most common procedures in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "ON INTAC\nPAMSMSPA T-00000000004771688658 )0009'"}, {"id": "41d4111e19341a6ad736ebe7", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum o2 saturation pulseoxymetry in patient 10007058 since 11/25/2100.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-25'", "rejected": "null"}, {"id": "5cccb67414afa9206d2624db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total or ebl output in patient 10027602 since 11/10/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10'"}, {"id": "8f1e4140fd54d60a4a21a46e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was first prescribed to patient 10021938?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "\n( 1201011800187000002170175019?000061375928428242583829477?\n\n\n0900399999 - Adjusted for injection (parenteral) since 04/2100?\n\n\n0900399999 - Adverse drug reaction in current hospital visit, not elsewhere, initial encounter since 21000?\n\n0900399999 - Adverse drug reaction in current hospital visit, not elsewhere, initial encounter, not in hospital, not in emergency room since 21000?\n\n0900399999 - Adverse drug reaction in current hospital visit, not elsewhere, initial encounter, not in emergency room, not in intensive care since 21000?\n0900399999 - Adverse drug reaction in current hospital visit, not elsewhere, initial encounter, not in emergency room, not in intensive care since 21000?\n\n0900399999 - Adverse drug reaction in current hospital visit, not elsewhere, initial encounter, not in emergency room, not in intensive care since 2100?\n0900399999 - Adverse drug reaction in current hospital visit, not elsewhere, initial encounter, not in emergency room, not in intensive care since 2100?\n0900399999 - Adverse drug reaction in current hospital visit, not elsewhere, initial encounter, not in emergency room, not in intensive care since 2100?"}, {"id": "084fbed97d37b17fe3de08f7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10010471 first receive an input since 12/11/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-11' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "\nSELECT SQL SELECT MIN(T1.dischtime FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078545 ) AND strftime('%Y-%m-%d', admissions.admittime) >= '2100-12-11' ) )"}, {"id": "4fc4f2f5fc3e5813dc2fe4dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time since 141 days ago patient 10010471's o2 saturation pulseoxymetry was less than 100.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 100.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-141 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d92a728db326dded231e11ba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time of input for patient 10004733 on 12/28/this year?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-28' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "42ab873a23dd37a3c747c4a1", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total amount of nepro (full) given to patient 10018081.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nepro (full)' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "737c9f23dfb633b9095279c8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10006580 last have since 05/19/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "1be1e6defcae4bbde53aafe6", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes an appointment have been had by patient 17462 in other department?\n\n### SQL:\n", "chosen": "null", "rejected": ""}, {"id": "e76aa0d663560abbc03fe1a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was a drug that patient 10004733 was prescribed for within 2 days after receiving enteral infusion of concentrated nutritional substances on the current hospital encounter?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND admissions.dischtime IS NULL ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND datetime(procedures_icd.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "ffdfd1a0a23a14c7d23101f8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top four most frequent lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n.110112)\nMSMSSECMSMSPA-01.\n\n1. What is there a. The code:\n\n\n031.0.0.08"}, {"id": "64417089c0eeb8c42da6c9c2", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who were given the phosphorus since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "0 (7\n 211.\n12101019324196879160196039418s Clinic'\n##0019's last time?\n\n\n##110.04.0' AND strftime Hour is less than strftime Hour is?\n\n0100145458"}, {"id": "71319107f961de47a8a7b439", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the mchc value of 34.6 among patients of the same age as patient 10026354 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.6", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 40s ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ) AS T1 WHERE T1.valuenum = 34.6"}, {"id": "a61a197e35f3b625c9540a0a", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top four most common specimens tested for patients previously diagnosed with obstructive chronic bronchitis with (acute) exacerbation within 2 months?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'obstructive chronic bronchitis with (acute) exacerbation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "e925cbf7b7c9050c2dd7ae1a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the method of disinfection in a quarantine?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\n### SQL:\n\nWhat was the last time patient 100200385 was discharged from the hospital in 2100?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100200385 AND strftime('%Y', admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "f3e6b14c287555d01d71ea6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich method of disinfection in the quarantine room is?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\n### SQL:\n\n### SQL:\n\nSELECT the first time patient 100044457 was prescribed a medication?\n\n\n### SQL:\n\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100044457 ) AND strftime(prescriptions.starttime) >= '2100-08-03' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "53b8eec71a9ed17879d3e723", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that during their last hospital encounter patient 10037928 had the maximum of eosinophils?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "827992b8de480860fb744924", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the current hospital visit, how many days passed since the first other fluid overload diagnosis of patient 10021487?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e3050cd2b1f00826b18a4be8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price for ursodiol?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ursodiol' )", "rejected": "\n.CHDrugid:\n\n1.\n##\n\n##\n\n\n##\n## A question:\n\n\n##: What was the name of the drug that was prescribed to patient 10033684621 on their first hospital encounter?\n\n\n### SQL:\n\nSELECT prescriptions.drug.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 1001708555 ) AND admissions.subject_id = 1003684621 AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "0b6a628ddf97a2a792d52b70", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people were given prescriptions for plasmalyte?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'plasmalyte' )", "rejected": "\n##\n\n### SQL:\n\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( 'bisacodyl', 'metoprolol', 'acetaminophen', 'dextrose 5%', 'acetaminophen', 'acetaminophen with pseudoephed' ) AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100174053 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'"}, {"id": "ad774524efc3f3d6d731eb6f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average arterial blood pressure systolic in patient 10021487 on 12/09/2100.\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-09'", "rejected": "\nSELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100047333 AND admissions.dischtime IS NOT NULL AND admissions.dischtime IS NOT NULL AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m-%d',transfers.intime) >= '2100-12-09'"}, {"id": "a962b9d8317a6e4edbdd29f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently prescribed drugs in the same hospital encounter to the patients aged 40s after they were diagnosed with acute embolism and thrombosis of left iliac vein in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute embolism and thrombosis of left iliac vein' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "426f5871dfa620cca1f14a84", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the percentile for mcv of 89.0 among patients in the same age as patient 10020740 on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 89.0", "rejected": "SELECT DISTINCT AVG(T1.C1) FROM ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' )"}, {"id": "50231ace46e9680780376e5f", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most frequent procedures that patients were given within the same hospital visit after receiving parenteral infusion of concentrated nutritional substances in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "db710bbbad258467ce5d73b8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen given to patient 10011398 for the first time in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m-%d',microbiologyevents.charttime) = '2100-09-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "69b677906abcc409eb49619a", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most frequent diagnoses.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "T:  K1:_ KensisMS-10 C-MSuenD22B1100/12201214822118142's1.001.\n1.\n##\n\n"}, {"id": "15a45174676987c6a3c0c4af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile does a urea nitrogen value of 15.0 for patient 10001725 place in today on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 15.0", "rejected": "null"}, {"id": "c0cedb965b06326bbddb2eb4", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients discharged from the hospital since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "\n### SQL Select the top three most frequent diagnoses that occurred within 2 months after a diagnosis of other and unspecified neoplasms of kidney, unspecified in 2100.\n\n\n### SQL:\nSELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473337 ) ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )"}, {"id": "06ba722e2ac0589ffacd1249", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since the last time on this hospital visit patient 10039831 received a lab test for creatinine?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0156bbc7fa6f2c54a9587d76", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10020187's weight differ from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "cb29881e7d27f8f23e3a8502", "query": "Convert the question below to SQL query.\n\n### Question:\nGive a count of the number of ICU visits of patient 10004720 during their last hospital visit.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "b3c91b713aa0b269e1c13630", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10007818's total output since 06/07/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-07'", "rejected": "null"}, {"id": "e1e75ab26d91e343b7b0ea17", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last value of patient 10038933's lab test for glucose in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "cd68238c19445383f9469b6b", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the temperature celsius level of patient 10005817 second measured on the last ICU visit greater than the first measurement on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "a5245904049b7aae3a154666", "query": "Convert the question below to SQL query.\n\n### Question:\nWas hydrochlorothiazide, vial, or atenolol ordered in their last hospital encounter for patient 10016810?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'hydrochlorothiazide', 'vial', 'atenolol' )", "rejected": "null"}, {"id": "fdc2cf2c322ae8d1a991cb88", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 01/2100, how much did patient 10031757 weigh during the first measurement?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "45153a5a7e5066d969dc5e94", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the three most common lab test given in 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSELONS.label FROM d_labitems JOIN d_labevents ON d_labitems.itemid = labevents.itemid WHERE datetime(labevents.charttime) >= '2100' ) GROUP BY d_labitems.itemid ) AS T1 WHERE T1.C1 = 3 )"}, {"id": "81fecc104d9ef8ac42378b81", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most common treatments for patients aged 20s since 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "dc05a582149cb9a35f095c0b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four diagnoses of patients with age 20s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n\n##\n\n##: Convert\n\n\n### SQL Query:\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100207405 ) AND datetime(current_timezone='+00:00') >= datetime(current_time,'-1 year') ) = '2100-05-03' )"}, {"id": "ff9d739f6aef4f0e6a4fad34", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most common laboratory tests undertaken by patients in the same month following a diagnosis of personal history of other venous thrombosis and embolism since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other venous thrombosis and embolism' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "7e6b0e29fe9f32760b7fcfc5", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the organism found in patient 10016742's last bronchial washings microbiology tests?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "b5663ddc7aca6f9697850d1b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen is the earliest next hospital visit of patient 73652?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-15'"}, {"id": "7a9d8c4e3514be8609110241", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a hospital typically spend minimum on a drug named morphine sr (ms contin)?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'morphine sr (ms contin)' ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "d8a47bc9987e7055d48e418b", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent output instances during this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "c85d0450240f7e339aaec76c", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021666 have lab testing in 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'", "rejected": ".112107MS1: 90231-21220-039008613708878838"}, {"id": "aa46c093a028ee5e0201520e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total hospital cost that includes introduction of nutritional substance into lower gi, via natural or artificial opening.\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\n1220000196420174956s.\n\n\n'1322389'"}, {"id": "c3627e6abec2c90a0651a0e7", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most commonly prescribed medications within the same hospital visit to patients in their 50s who were diagnosed with chronic obstructive pulmonary disease, unspecified since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic obstructive pulmonary disease, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "0e367ae3e283e0d271d94ef9", "query": "Convert the question below to SQL query.\n\n### Question:\nCan i tell if patient 1205 has need prphyl vc vrl hepat in hisher family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "6d3fe547b78cd9bdc187e610", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many instances of drainage of peritoneal cavity, percutaneous approach procedures have been completed since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "3d6bc048c7a115f4b80288d2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen is the earliest of patient 31880's next visit to other departments?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-10' ORDER BY outputevents.charttime DESC LIMIT 1 )"}, {"id": "1e644096c1912f2f70a3c917", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10015860's insurance name during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "368dc6fa47ea7885905c48d5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is olanzapine (disintegrating tablet) taken?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'olanzapine (disintegrating tablet)'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine (disintegrating tablet)'"}, {"id": "53f61d8664a94f987c1568f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the drug to avoid during the exc/dest hrt lesion open.\n\n### SQL:\n", "chosen": "null", "rejected": "G\nMS?_OVERSMS"}, {"id": "2fc3c2a9b1a1bd5aa4960ca3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007795 first leave the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "SELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007959 AND strftime('%Y', admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1"}, {"id": "12416e6dc0819028affaf96f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the id of the ward where patient 55281 can be admitted?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 100180815"}, {"id": "dc198d4ae3abb990cb9902e1", "query": "Convert the question below to SQL query.\n\n### Question:\nName the three most frequently prescribed drugs during the same hospital encounter following a diagnosis of acute and subacute necrosis of liver during this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "48ea16ef9a9f1871ed032c14", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most often performed treatments for patients aged 60 or above in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT T1.drug FROM ( SELECT d_icd_drugs.drug, DENSEXPRINT(count( procedures_icd.charttime) ) AS C1 FROM procedures_icd WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY d_icd.drug ) GROUP BY d_icd.drug ) AS T1 ) AS T2 WHERE T1.C1<= 3 )"}, {"id": "fa66404961f86fa8e6bfa1a2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10010471 was first discharged since 2100 from the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10010471 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10010471 ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "ab750c2c23f2234be8a906a3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10021487's first cardiac complications, not elsewhere classified diagnosis in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3cf174e9abff40de817ec43c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total volume of foley patient 10026354 had since 07/09/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-09'", "rejected": "null"}, {"id": "e07bc2b8ae12376224aac0c9", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most prevalent procedures for patients aged 40s since 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 3 )"}, {"id": "65209ec4d53fcc5e5cd03c87", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total amount of or ebl of patient 10018081 since 10/03/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-03'", "rejected": "null"}, {"id": "b9e107def562596e07c5c476", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost including a ck-mb index lab test?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb index' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": ".\n\n  \n .y.1-\n\n\n .: 2:\n\n..te?\n\n0\n 0..-01.... -.1MS\n\na.MSMSPAMSMS10MSMSMSPAY5247\n     21487 1.MSFBIANAZPAGEMSPA)\n\n\n\n01.10. Clin 1.1.\n1.\n\n121449500000 AND 0001091589005000120 AND 011700 AND 032010-0'"}, {"id": "f9f35588ccc8bc79535ff166", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the three most common treatments since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "with\n)) /.\n' ,\n T ..\n (-\n...\n ,.\n.,\n\n.ology -} (. F\n's"}, {"id": "ffed9e72b74c6090bd75fda4", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the drug which patient 10022041 was prescribed in the same day after having had a open reduction of fracture with internal fixation, humerus procedure since 03/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022041 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022041 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "315e7c004443575bb2996afc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10015272's last maximum chloride value in their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "01a258cef08c0eb27a9ef878", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat methods are used to ingest emtricitabine-tenofovir (truvada)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'emtricitabine-tenofovir (truvada)'", "rejected": "null"}, {"id": "0ec4625b3835bfe71dc91495", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is today's outpatient schedule with dr. smith?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100017258 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "c3771288ef450c465644693b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug that was prescribed to patient 10021487 via the pr route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "82de427493ba0005e55da2e9", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top five diagnoses with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime)< 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 ) AS T5 WHERE T5.C3<= 5 )"}, {"id": "45b7526b9941e4579af43e6c", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top five most common outputs in 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_TOTAL FROM outputevents WHERE datetime(outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) ORDER BY COUNT( outputevents.charttime ) DESC ) AS T1"}, {"id": "8dea7b9b04a6934cbc300217", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dose of readi-cat 2 (barium sulfate 2% suspension) patient 10038992 had been prescribed last month?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')", "rejected": "null"}, {"id": "01c9d2fa980c7d5a47334903", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the type of blood of patient 13440?\n\n### SQL:\n", "chosen": "null", "rejected": "Y 2\n/MSMS2\n1111802218488015667?\n##101000218s' T2\n%\n'12500-01-04'"}, {"id": "01389011a3cea028b226b95b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of insulin prescribed to patient 10020740 in total in 05/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'insulin' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'", "rejected": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'"}, {"id": "d5f52e490438032a22fb5129", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the dosage of the prescribed opioid for patient 9619?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\nHow many times was patient 100014255 discharged from the hospital in 2100?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.disch_time FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100042515 ) AND strftime('%Y', admissions.disch_time) = '2100' )"}, {"id": "2be33c796f39654a64acc2af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly tested specimens for patients who were diagnosed with chronic osteomyelitis, site unspecified previously within the same month, throughout this year?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic osteomyelitis, site unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "d0f91c264e749335cf895ad0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the reimbursement standard for gene and chromosome testing?\n\n### SQL:\n", "chosen": "null", "rejected": "'##\n\nMSMSPACT1100.1.303175867469920'"}, {"id": "b1baeec40f8e02dc63c8b5e3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10031404 was prescribed for during the same hospital visit after undergoing drainage of pericardial cavity, percutaneous approach since 02/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10031404 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity, percutaneous approach' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "7c84a7a9dd72cfd25b8b859c", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received a procedure since 2100 for extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y', admissions.admittime) >= '2100' )"}, {"id": "5b3ff38fc5977d41f2919e7f", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most commonly prescribed drugs since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "( determ\n...\n .0es\n\n9.-.isser C3\n.:-T\nTSM >PAMS VBMS2MSMSPA TIMEMS sierpMSPA-19210.20.\nMS.0\n"}, {"id": "99327791c62b40dd242f407a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does the drug phenobarbital alcohol withdrawal dose taper (days 2-7) cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' )", "rejected": "null"}, {"id": "d9cc62f7c052734452299128", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of drugs patient 10037861 was prescribed?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 )", "rejected": "null"}, {"id": "0bbe49c0248359c39268f075", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen will patient 57023 be able to visit other departments?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "2ddc5aa70252d046606081e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat organism was found in patient 10004733's first sputum test since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "72faafda75d4e4a844d6cd9d", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease provide the three most common tests performed on specimens since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n### SQL:\nSELECT SQL SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents.spec_type_desc WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND strftime('%Y',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "d487fac15a8ce3ed54ed440e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the four most common lab test given?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "6\n1.24' )\n 21. 1. 233570080878122s' microbiome's test result.\n\n\n\n##\n\n## 03/23/21000 was the last time patient 1000197777 was prescribed with 0.5% dextrose d5% nephron's soln in 10021?\n\n\n\n### SQL:\nSELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( '0.5% dextrose d5% nephron's soln' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100197777 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-03-03' )"}, {"id": "e99894fa240f028ed3221457", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed in 2100 with pericardial effusion (noninflammatory)?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pericardial effusion (noninflammatory)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "a69b592f91b063a29a0fb688", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10012853 receive a laboratory test on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "\nSELECT SELECT labevents.spec_type_desc FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100074055 ) AND labevents.charttime IS NOT NULL ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "133bff217be024035d5957e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the urea nitrogen value last measured on the first hospital visit of patient 10027445 greater than first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "7cbf3d09dcab163910469c88", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism detected during the first urine microbiology test of patient 10037861 since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "eec94693605289856658f678", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the daily maximum weight of patient 10003046 in 01/this year.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '01' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',chartevents.charttime) = '01' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "56fd4c77a08d2c69466f3daf", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is readi-cat 2 (barium sulfate 2% suspension) typically consumed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)'", "rejected": "SELECT DISTINCT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01'"}, {"id": "75349759bb3df71a7b6f7649", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10038081 was prescribed medication via the iv route in 10/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "df4054d39dfcc41a5f36e76b", "query": "Convert the question below to SQL query.\n\n### Question:\nAt what time did the last incident of patient 10020944 having a maximum respiratory rate occur on 03/12/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-12' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7b2e4a56a587f857df255484", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the value of 30.0 in calculated total co2 among patients of the same age as patient 10038999 on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 30.0", "rejected": "null"}, {"id": "a739dee00e50021190bd7f13", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10014078 have his first microbiology test on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a6fe11704f68e1f821cfc45e", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of people who were diagnosed with postprocedural heart failure following other surgery since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural heart failure following other surgery' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "null"}, {"id": "aa9cf98a6cfcfc591fd1d744", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum yearly number of patients affected by other specified hypotension?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified hypotension' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified hypotension' ) ) AND strftime('%Y', admissions.admittime) = '2100' GROUP BY admissions.subject_id )"}, {"id": "9be565c02f7de4786c3e5b1a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 23224 an appointment in another hospital department?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n### Question:\n\nWhat is the name of the drug that was prescribed to patient 100285454?\n\n\n### SQL:\nSELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100285445 ) AND prescriptions.drug = 'aspirin (aspirin ec' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "33c954c2cec837a4ccd734f7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total output that patient 10014354 had since 07/09/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-09'", "rejected": "null"}, {"id": "44d5008230190a09f20e3682", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10022017 undergone a free calcium laboratory test since 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'", "rejected": "null"}, {"id": "79e773e17e3c570dd78813ae", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic treatment in the same month after having been diagnosed with other diseases of bronchus, not elsewhere classified since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "97a0f29ee6e3bbd8082d3ad1", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you think patient 31615 has an appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "\n SP'ote\n. P-.\n ' to\u20192. during 1  . TMSd2. (i \nMSia C1 FMSd's61-ONNOTAMSM,91PAMSDON's..\n\n nobody'sSSMS1:MSPA (1:PAYX149812012900.184840.40."}, {"id": "2040aaebd3c0a403ffa1269c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication patient 10026354 was prescribed for the first time via iv drip?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": ".1\n's\n's1\n100112PAZMSMSPAZ' AND 'PAINCICK, what is the last C1\n##'"}, {"id": "cbcb60f4c34e7c1afabdf477", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost for a hospital including tests in the rheumatoid factor laboratory?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id )"}, {"id": "cdeaa55f2c3e7ba95eec9c4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021487 have the minimum value of creatinine first in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.valuenum ASC LIMIT 1"}, {"id": "99ce32579f34baf63f28f671", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the current hospital visit, how many hours passed since the first physical restraints status diagnosis of patient 10004733?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'physical restraints status' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "02c83f838a71d8a05881f29c", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients in med/surg since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "\n\n##\n\n##\n\n##\n\n##\n### SQL Code of the last time patient was discharged from hospital in 21000 from the hospital?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10038000253 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "a49ff217e1eaf845efa42727", "query": "Convert the question below to SQL query.\n\n### Question:\nSince the first diagnosis of patient 10018081 with pure hypercholesterolemia on their current hospital encounter, how many days have passed?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "25036a06119f918d2956f2e6", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total amount of output since 11/16/2100 for patient 10010471.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-16'", "rejected": "null"}, {"id": "93d41c56811abbf4da9b30fe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10012552 has had the minimum arterial blood pressure mean?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "46ff832eeb6e9d538497577e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the count of patients who left the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) ) AND strftime('%Y', admissions.dischtime) >= '2100'"}, {"id": "c11781d3de0756093079a3b6", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the five most common microbiology tests since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "a9a9222a8d37bab9e6d5a6a2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many instances of the anastomosis of hepatic duct to gastrointestinal tract procedure were there?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' )", "rejected": "\n##\n\n\n##\n##\n\n####\n\n###code:\n\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002014856 AND admissions.dischtime IS NOT NULL ) AND admissions.hadm_id = 100196459"}, {"id": "b64c62eb05aaad4071af83a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the common method for taking lorazepam?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lorazepam'", "rejected": "(.):.?.8- \nage...0\n (\n.'0g\n''1'PAMS."}, {"id": "ab8619ab9a2d54411ff482fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug patient 10021487 was prescribed with within the same hospital visit after having received a enteral infusion of concentrated nutritional substances procedure throughout this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "e5fd2ddd2acd6b3e34d429da", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 26262 been provided with additional eye test?\n\n### SQL:\n", "chosen": "null", "rejected": "MSZ\n\n235257201512455188 )\n\n\n"}, {"id": "df115de912364769eda352c1", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10007058's total amount of cath lab intake input since 07/17/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cath lab intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-17'", "rejected": "null"}, {"id": "3db50784b5c5fd5267669673", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since patient 10039831 stayed in the careunit discharge lounge for the first time in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "a252cc04ca403620d3979914", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10004720 prescribed the drugs glucose gel and glucagon at the same time for the last time in 12/this year?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucose gel' AND admissions.subject_id = 10004720 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10004720 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "c5d9d0626f74f9062b8f7509", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most frequent specimens ordered for patients after being diagnosed with hesitancy of micturition during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hesitancy of micturition' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_T1.C1 AS C2 FROM ( SELECT microbiologyevents.spec_type_desc, COUNT(microbiologyevents.charttime) AS C1 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 JOIN ( SELECT admissions.hadm_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 ON T3.C1<= 4 ) AS T4 WHERE T4.C1<= 4"}, {"id": "540b84764bb982f9853d1621", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038999 been diagnosed with any diseases in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'", "rejected": "\n## SELECT sum(prescriptions.amount FROM prescriptions WHERE prescriptions.drug = 'prednisolone' AND strftime('%Y',prescriptions.starttime) >= '2100-08'"}, {"id": "398270a5b400092bfc10afcb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018081 first have the minimum amount of base excess in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e8433f2ef9b3e709b1fe04cf", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of people who were diagnosed with other disorders of muscle, ligament, and fascia since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other disorders of muscle, ligament, and fascia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "null"}, {"id": "ab6219b3365eb3a41f89b20b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many drugs were given to patient 10036156 last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT(*) FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10036156"}, {"id": "43a04bb201473909218db1f2", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a epithelial cells lab test performed on patient 10018081 during this month?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')", "rejected": "null"}, {"id": "54afc6318164ae9f335372fe", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any new medication in the prescription of patient 10018081 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "46b514f0b026c008b760e05e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the last hospital discharge of patient 10020786 occur since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020786 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "a5d91ebb2b0d935b9c493f9f", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, has patient 10019172 been diagnosed with any illness?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'", "rejected": "null"}, {"id": "d55a49b733c16c813474898b", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most common diagnoses for patients with age 50s this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT T1.drug FROM ( SELECT d_drugs.drug, DENSEXC.count( T1.C1 ) AS C2 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 0 AND 50 AND datetime(current_time,'start of year') = datetime(current_time,'start of year') ) GROUP BY admissions.subject_id, diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 5 )"}, {"id": "ad2310914d9164e853dba7ed", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of total foley that patient 10007058 had since 11/23/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-23'", "rejected": "null"}, {"id": "fd430b3bc6f281ccc988453c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since the last time patient 10021487 has received a glucose-lab test on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "2dd85238210fd7a67447c15c", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients with altered mental status, unspecified who were diagnosed in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "\nSELECT SQL SELECT COUNT( DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )"}, {"id": "77eb3ba985eb3df7b7b03d98", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the oxycodone-acetaminophen dose that patient 10022281 was last prescribed in 06/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND prescriptions.drug = 'oxycodone-acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "7fc9012c75133098e145243a", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most frequent procedures that patients were given within 2 months after receiving occlusion of right vertebral artery with intraluminal device, percutaneous approach throughout this year.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "e7db6c421273de71b7f9b8a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average cost to the hospital that involves personal history of other diseases of digestive system?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other diseases of digestive system' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\n##\n\n##\n\n##\n##\n\n##\n####\n\n### Question:\n\n\n### SQL\n\n### Question:\n\nWhat was the last time, patient 1001800853 was discharged from the hospital since 21000?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 1001800853 ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "85e6a823fac4aece9e3933ba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10011398 get the microbiology test for the last time in 12/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100113987 ) AND datetime(microbiologyevents.charttime) >= '2100-12-02'"}, {"id": "b555ee213c4e95edc4e8b7e9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first time that patient 10021487 was diagnosed with acute and subacute necrosis of liver in this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "bfd7a42fc2f55f570373a0ef", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the average value of monocytes for patient 10006053?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' )", "rejected": "1.\n\n##\n\n\n##\n##\n##\n\n##\n##\n##\n#### Question:\n\n\n###03. Which of the following four diagnoses was the last one for patient 1000256408 during the first hospital encounter in 21000?\n\n\n### SQL:\n\nSELECT T1.icd_code FROM d_icd_diagnoses WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100256408 ) AND strftime('%Y-%m', T1.starttime) = '2100' )"}, {"id": "07032b1d51ef6d34a32ed424", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most commonly prescribed medications since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": ")XMS020121-0918030-1371982881327 '05.\n\n09/03/03/21000'"}, {"id": "fa30ead3c41cae309bafcade", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost including a rbc, pleural lab test since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, pleural' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n### SQL:\n\nSELECT SELECT COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'excision of other endolymph node with drainage' AND strftime('%Y-%m', d_icd_procedures.charttime) >= '2100-03'"}, {"id": "da332c7d00584e07d7258bc1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10018081 last received a laboratory test of calculated total co2 in this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J', current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND transfers.dischtime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1 )"}, {"id": "a7419fe163e1296529d925bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the first bronchoalveolar lavage microbiology test of patient 10007818 in 07/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "bf8b6952af8be73056244b36", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of a hospital visit that includes injection of anesthetic into spinal canal for analgesia in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection of anesthetic into spinal canal for analgesia' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "d15a1a7326a3a55f3c297a21", "query": "Convert the question below to SQL query.\n\n### Question:\nHow can i disinfect the room in which there is a quarantine?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT\nSELECT SELECT AVG(T1) FROM ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100130560 ) ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' )"}, {"id": "efa49770d1b09991933af299", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019777 gone to an emergency room throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND datetime(transfers.intime) >= datetime(current_time,'-1 year')"}, {"id": "db0b8e8e0ddcba04c82bb7f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10010471's last measurement for o2 saturation pulseoxymetry on 12/17/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-17' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "2f063a729b9dbc37fab1ac6c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last hospital discharge time for patient 10029484 throughout this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10029484 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "\nSELECTIVE C1 for the first time on 01/12/2100.\n\n### SQL:\nSELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND chartevents.hadm_id IN ( SELECT chartevents.hadm_id FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND strftime('%Y-%m-%d', chartevents.charttime) = '2100-01-12' ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "218edde218dc6a20ef8e8fad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a drug named tobramycin sulfate?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' )", "rejected": "1.\nSELECTMS.\n\n\n##\n##\n##C10003 AND strftime '2100-04-02-07'"}, {"id": "8b46dd72123cd9ad13f039d6", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what to prepare before the non-invasive mech vent procedure\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'non-invasive mech vent' )"}, {"id": "1e7b6f713dc28ec89c51ea69", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently performed treatments for patients in their 40s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "2887bbdedda7de0f5fc0f9e7", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of stay for the last stay of patient 10001725 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "14f2e18dfb1791ca5f77f750", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost that includes a procedure named laparoscopic partial cholecystectomy?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic partial cholecystectomy' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "d518a22ef06007a9c93db34b", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients during the last year who received a introduction of other therapeutic substance into peripheral artery, percutaneous approach procedure.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "8fa8ed75a85186090d9db649", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10008287 been prescribed any prescription drugs since 28 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-28 month')", "rejected": "null"}, {"id": "224e861c8a991fe5103027e4", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10020944 to the emergency room on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "7eeded34f8349746d03bfc12", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the precautions after the spinal canal explor nec procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014035 ) AND procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal canal explor nec' ) ) AS T1 WHERE T1.C1 = 1 )"}, {"id": "bf7b0e75c5c6bf62f8ebec79", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10014729 received any piggyback in 03/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',inputevents.starttime) = '03'", "rejected": "null"}, {"id": "416bb5f6b916ace9fd639fbc", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve patient 10015272's daily average weight on their last hospital visit.\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "6a0ee1b4229838dcbe29e41a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of times cepacol (menthol) was prescribed in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cepacol (menthol)' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "fdfb891b48bcb50c80bc3db0", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 10211 have an appointment in other department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 100158608"}, {"id": "6874b240b1ee6575829fb705", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich were the three most commonly ordered procedures for patients previously diagnosed with streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus] during the same month, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "87058b47fe38c6fb7cbdc89a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first time patient 10018081 had a o2 saturation pulseoxymetry that was less than 98.0 since 354 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-354 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "dba831b22948cb6030f2a0dd", "query": "Convert the question below to SQL query.\n\n### Question:\nCount how many current patients are aged 30s.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39", "rejected": ". BY.\n d ( first. (,- T1 WH )ight P1 in '. WHERE\n WHERE1..\n GROUP'i  (2.   P Little*:.2 S\n'\n\n Hospital DT Pm. TH.....-1 ,2's\n SELECT &.\nMS,\nMS..1. KMSiley\nMS.\n..\n ) .\n\n\n./..\n,0_\n N4sn."}, {"id": "ebe871c89f963463b9c8c4be", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the time when patient 10014729's o2 saturation pulseoxymetry was less than 95.0 for the last time on 03/06/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 95.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-06' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "107acacd9df083f664395e57", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times patient 10018501 came to the hospital in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10018501 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "y_or-\n 2.%)\nMS\n.\n-APMS.20.01?213.17212217.\n )0721161168080150237030101399981117's 00"}, {"id": "3c573f4b3f5561f9da5c2ca0", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who stayed in the previous year at trauma sicu (tsicu).\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'trauma sicu (tsicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "1...m.E'K 6M\n.s.v1\n.11-412\nMSPAMSPAMSMSMSK, 00000254710041 )001400999067090700319'"}, {"id": "b7b00a485da3ac7c2a9f4f8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10026354 during their first hospital admission?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10026354 ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n##\n### SQL Convert the total number of patients who had a wbc count lab test since 2100.\n\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND strftime('%Y', labevents.charttime) >= '2100' )"}, {"id": "6316365253c771062657103d", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the number of patients who underwent introduction of other therapeutic substance into heart, open approach.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) )", "rejected": "\n### Question:\n\nWhat was the first procedure performed on patient 100389480's body since 05/2100?\n\n\n### SQL:\nSELECT procedures_icd_code FROM d_icd_procedures.icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389480 ) ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ORDER BY procedures_icd.charttime ASC LIMIT 1 )"}, {"id": "2aeb48ba6aa5bb661580a085", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first time patient 10027602 had a heart rate that was less than 97.0 on 12/02/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 97.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-02' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ea3505754407fd4d8ea5fdd8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much difference is there in pco2 levels among patient 10009035 last measured on the first hospital visit compared to the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "8de8d255ebcc53e5933862db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10011398 generate last on this month/26?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '26' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "\n##\n\n##: SELECT SQL SELECT COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeital lymph node aspiration' ) AND strftime('%Y', d_icd_procedures.charttime) >= '2100'"}, {"id": "91985b654c4167748be8c66b", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the first hospital encounter, was patient 10008454 admitted to an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\nSELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100047333 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "99abc2a37fa7ff26ae5a4483", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the three most common treatments.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n\n\n121941900272172735262189125898928902427'"}, {"id": "261c55328ac8ffc4792c6e5e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost for a hospital visit that involved a uric acid lab test in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'uric acid' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "77b6bd619a1302c0e9f16e66", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was last prescribed to patient 10039708 via the ih route since 08/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "0f29c76985468daa67aa9e6d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the charges for a procedure called replacement of stent (tube) in biliary or pancreatic duct?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of stent (tube) in biliary or pancreatic duct' ) )", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of stent (biliary or pancreatic duct)' ) )"}, {"id": "fc72497b8c3f4de11b1c418f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the percentile of the magnesium value of 2.4 among patients of the same age as patient 10011398 during the last hospital visit.\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.4", "rejected": "null"}, {"id": "1558f54b2c3bec57f2893d4f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequent procedures for patients aged 30s?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "MS%(\n 20 1120011-021882271683451450058348228'"}, {"id": "4ad4465cd7b99c50bc48d1df", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of current patients whose ages fall within the 50s.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59", "rejected": ".\n\n1 MSGPA'sMS Vs.MSPAGMSPA-100.00267688213'"}, {"id": "ed9a4d3d34a8ae1c9e013631", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10040025 was prescribed a medication in 03/2100 via the po/ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "40c4039e5ddeb88faf4449aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top three most frequent procedures patients had within 2 months after being diagnosed with personal history of malignant neoplasm of large intestine since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "46c7a622bf32b53e152dc112", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10027445 was prescribed for the first time in 08/this year glucagon and insulin at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "75b0b6062a202e39dc311504", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 26.2 in a mch lab test conducted at the same age as patient 10038081 during the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 26.2", "rejected": "null"}, {"id": "3bea1d4c8791561006ff719f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you name the procedure/treatment that patient 10015860 was given two or more times since 06/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "081ba7feccd490013f102984", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total ondansetron dose prescribed for patient 10001725 on their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'ondansetron'", "rejected": "null"}, {"id": "99da27a442847a01bbdb593a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the count of famotidine prescriptions made?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'famotidine'", "rejected": "\n### Question:\n\n### SQL:\n\nSELECT the total number of patients who were discharged from the hospital in 2100.\n\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' ) AND strftime('%Y', admissions.dischtime) = '2100' )"}, {"id": "d7fb401aec234c8c77430b13", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total hospital bill for a visit that involves a cholesterol, pleural test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, pleural' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "23e582ea53646d1236eee37e", "query": "Convert the question below to SQL query.\n\n### Question:\nIn total, what was the input amount of dextrose 5% that patient 10027602 received on 11/23/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '11-23'", "rejected": "null"}, {"id": "8ce0acf858783aaaafbc6c86", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10012552 was measured heart rate greater than 78.0 in the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 78.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6fae636a877faa698dbc3148", "query": "Convert the question below to SQL query.\n\n### Question:\nThis year, how many patients were provided with lidocaine 5% patch?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine 5% patch' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\nDRMSPA: 100488139"}, {"id": "08ae61222ba27e2b2592fc0d", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last year, was patient 10001217 at the emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "),M.  o 0MS\nd11-112.160 the_PA 91.MSPA-1100.100346917489389'"}, {"id": "1d35d6275c13a75467d5621f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent endovascular (total) embolization or occlusion of head and neck vessels within the same hospital visit after the diagnosis of attention deficit disorder with hyperactivity, in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "1b7a372bc73c1b3e5e13c41d", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10004422's total jackson pratt #1 output on 01/20/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jackson pratt #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-01-20'", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100167409 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "f29d59d1bda4d4afd44edace", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the single rooms available?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n*\nMSPA:\n##\n(\n1.\n##\n\n\n##\n##\n##\n##\n\n### Question:\nHow many times has patient 1000185045 been prescribed medication since 10/21000?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100185045 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-10'"}, {"id": "0a8c46b684e72300d29c18aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was prescribed to patient 10010471 for the last time?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d6a206ecc5cbf7eeccb7956b", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who underwent other electroshock therapy this year, what were the top five diagnoses they received within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "d53298425ae0be6acf19c43b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen for the first time in 08/2100 was patient 10031404 prescribed atorvastatin and acetaminophen at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'atorvastatin' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "4cff67cd8d6c534a4e2e5214", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know what type of blood patient 98517 has?\n\n### SQL:\n", "chosen": "null", "rejected": "?\nop. 22"}, {"id": "89f547ad3bff27fb734acf00", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10015931, when was your last blood culture microbiology test in 12/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND datetime(microbiologyevents.charttime) >= datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12'"}, {"id": "6cdbe56001fefce8414c07e1", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001217 visited an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room'", "rejected": "null"}, {"id": "5d18dc5b86410f1a0b68d571", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the diagnosis cost of urinary tract infection, site not specified?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) )", "rejected": "null"}, {"id": "725d74abd24c1af33ef5d212", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10002428's first microbiological test occur?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f1a1f3815a708dd84505b5d4", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10011398's average value of arterial blood pressure systolic on this month/27.\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '27'", "rejected": "null"}, {"id": "7e7384bd8b07edde5e574ef1", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of time for patient 10019172's last stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT strftime('%J', icustays.outtime FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "437ed2f1fe3f680053f1e3de", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of cases of inspection of tracheobronchial tree, via natural or artificial opening endoscopic that occurred since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "0edf383920d07410f686cb96", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 03/this year, when did patient 10019777 first receive the immature granulocytes test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immature granulocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT T1.starttime FROM labevents WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND T1.test_name = 'immature granulocytes' AND datetime(T1.charttime) >= datetime(current_time,'start of year','-1 year') AND strftime('%m',T1.charttime) = 3"}, {"id": "03126bd2f49e133b299a8f4d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was olanzapine prescribed since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "ust 1.\n-1.cals('s.'\n12MS101121 CANASECANAMSPA 1912215681566s0000005993593"}, {"id": "683c48b602131b125efece68", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time in 03/this year, when was patient 10019777 prescribed vancomycin and iso-osmotic dextrose at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic dextrose' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f86dbfb605a8cf22c7785807", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of glucagon that they prescribed to patient 10015931 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'", "rejected": "null"}, {"id": "620fed67edcc618c82c9bb68", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours is it since patient 10004733 last received the magnesium lab test on their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1eb6a80e3bcffd099385b474", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10020944 have the maximum sodium value for the last time in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8e22c703d632798f42282434", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last dose of nifedipine in 11/2100, prescribed to patient 10021938?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.drug = 'nifedipine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "86faa6e8dce319c5aa190e7c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the checklist you need to follow in advance of your egd with closed biopsy procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100262555 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ORDER BY procedures_icd.charttime ASC LIMIT 1 )"}, {"id": "39292afed1a39dd0e0b8a031", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who stayed during the last year at pacu.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "\nSELECT\n##\n\n##\n\n##\n##\n### SQL Select the top four most frequent lab tests performed in 21000 for patients who had a diagnosis of other and unspecified viral hepatitis without hepatic coma within 2 months after the last hospital discharge.\n\n\n### SQL:\n\nSELECT T1.test_name FROM ( SELECT d_labevents.test_name FROM d_labevents WHERE d_labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002148358 ) AND datetime(d_labevents.charttime) >= '2100-01-05' ) GROUP BY T1.COUNT( T1.C1 ) )"}, {"id": "9906646cfa86ce749ac4d08e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat methods are used to ingest tramadol?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'tramadol'", "rejected": "MSPA and the first:\nTESTMSGtZ"}, {"id": "db19b59987d48a9194568ad4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat should not be administered during a proc-vessel bifurcation procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1 FROM ( SELECT COUNT( DISTINCT procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions.subject_id = procedures_icd.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'procedures_icd.procedures_icd' ) ) AS T1 ) AS T2 ON T1.C1<= 1"}, {"id": "1c7af8d5ad19cc00a657ccc2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027445 get a microbiology test for the first time since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c72ddd4c729a31793b216593", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average absolute monocyte count value of patient 10004720 since 10/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute monocyte count' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'", "rejected": "null"}, {"id": "70fb08c9ae39f471ccb4c81a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top five most common procedures conducted?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\n##\n\n##\n\n##: T1"}, {"id": "bc8f51d9cc16b51ab2a55aaa", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who had their uric acid tested.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'uric acid' ) )", "rejected": "\n##\n\n##\n\n#####sql\n\n## Question:\n\nHas there been a drug prescription that was given to patient 100296545 on the first hospital stay?\n\n\n### SQL:\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100296545 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "7e3bfc9f7e3650b093d26545", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the time of patient 10031757's first hospital discharge throughout this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10031757 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "SELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10031757 AND datetime(admissions.admittime) >= datetime(current_time,'start of year') = datetime(current_time,'start of year')"}, {"id": "f1308ea9b8bbc94c5e296e34", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does the neutrophils change in patient 10004733 last measured on the current hospital visit compared to the first value measured on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "78444405504330982a1f5e0a", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with esophagitis, unspecified, what were the top four most common microbiology tests conducted within the same hospital visit in this year?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophagitis, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "f91d231f21466c6950751d92", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide me with the name of the diagnosis patient 3277 received in the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "\n20117110517079706501575553713119"}, {"id": "776aa437e8c7772107f91170", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021312 have any prescriptions for medicines on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "mPA'\n1.0000000060803417170308501917888989999999999999' AND strftime their hospitalized during this month?\n\n\n\n## Convert the output of the drug isoformycin to isoformic acid dose prescribed to patient 1002058555 since 01/01/21000?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT prescriptions.dose_val_rx, prescriptions.drug FROM prescriptions JOIN admissions.subject_id = 1002058555 WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002058555 ) AND admissions.dischtime IS NOT NULL AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' )"}, {"id": "7c81288ded12d53cddc28dea", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, which are the three most frequent lab tests given to patients in the same month after they are diagnosed with atherosclerotic heart disease of native coronary artery without angina pectoris?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery without angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "24c0ef475388f60e725ccbc1", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10037861 receive the procedure of a right heart cardiac catheterization in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "64cfab5e3bed0dbdd7d74834", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen heparin and aspirin were prescribed to patient 10016150 for the last time in 05/this year at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "15e5163ccc3e3c1f766d7f6a", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the red blood cells level of patient 10021312 last measured on the first hospital visit greater than the second to last level measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "c26f64ab0e5b645c25c3281c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the total minimum expenses for a hospital involving a laboratory test for potassium, whole blood in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "1d509edaa223f304f5ee3b9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was first prescribed to patient 10007058 since 09/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "243503fcb552e825a3b62d0c", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the patient 10018423 a male or female?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10018423", "rejected": "SELECT SQL SELECT 1 * ( CASE WHEN strftime('%Y', microtime(current_time) - strftime('%Y', admissions.admittime) ) - strftime('%Y', diagnoses_icd.charttime) ) FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcohol intoxication, unspecified' ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100' )"}, {"id": "2d8f9dd2fbaff9e32a728bc4", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any phenobarbital, atenolol, or sodium chloride 0.9% ordered for patient 10018501 in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND prescriptions.drug IN ( 'phenobarbital', 'atenolol', 'sodium chloride 0.9%' ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "27f061fabd9f7d2e99e832c3", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total amount of dextrose 5% given to patient 10021487 since 10/04/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-04'", "rejected": "null"}, {"id": "e63b87cee280daecb46a2af6", "query": "Convert the question below to SQL query.\n\n### Question:\nSo, the first asparate aminotransferase (ast) test result for the patient 10019172 was?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) ) AND labevents.charttime IS NOT NULL ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "7a87b3514162ac542fd54a50", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10014354 get the creatine kinase, mb isoenzyme lab test in their last hospital visit for the first time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5a36e2b8accac68f5996e75c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost that includes a procedure named excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "c8d18210963921f83f907052", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most commonly diagnosed conditions since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n0*\n(\n##\n\n##\n\n##\n##\n##\n\n####### Question:\nWhen was the last time patient 100202685 was discharged from hospital in this hospital this year?\n\n\n### SQL:\n\nSELECT admissions.disch_time FROM admissions WHERE admissions.subject_id = 100202685 AND admissions.hadm_id IN ( SELECT procedures_icd_icd_procedures.icd_code FROM procedures_icd_icd WHERE admissions.subject_id = 100202685 AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100202685 ) ) AND datetime(admissions.dischtime) = '2100-02-03' ) = '2100-02-04' ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "b6ebd9e060d890c353600a6a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first measurement of respiratory rate that patient 10008287 had since 268 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-268 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "093bd4e875cc23f9739cdd09", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output of patient 10020740 for the last time on 06/15/this year?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '06-15' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "51c4e6f08f5029501e961a4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10009628 receive an input for the first time on 10/02/this year?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '10-02' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "86831d5ce56c04ce7f23fd47", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients left the hospital during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "GMSline:7'MS.1\nd.USTMS'sPAMSMS\n\n\nCANC81246.K10018658849775820."}, {"id": "e27430eb77cfd3fc0183209f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the last microbiological examination of patient 10001725's urine in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "515fbb81432c9872301c377a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich drug was the last one prescribed for patient 10007818 in 07/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2869bb3db5897f9d72d506b0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly prescribed medications for patients who were previously diagnosed with other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle within 2 months?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "0b19e40d278a97e915037e52", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what were the new prescriptions for patient 10039831 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n##\n### SQL:\n\n### Question:\nWhat was the total amount of magnesium sulfate that patient 100165400 was prescribed in 10/this year?\n\n\n### SQL:\nSELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100165400 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = 10"}, {"id": "08421f07d795de9a81dbc4b1", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 08/11/2100, when was the last input time of patient 10039831?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT MIN(inputevents.starttime) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1"}, {"id": "ffefdb9195190d8fcb86fa14", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost for phenytoin sodium (iv)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium (iv)' )", "rejected": "::m\n\n11110 001:112181 timeMSSSM.PAINTMSMSPA T11     0000177340088810'"}, {"id": "5eed4e1b791b78ba28273ed6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the first time in the current hospital visit that patient 10021487 was diagnosed with closed dislocation, multiple cervical vertebrae?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed dislocation, multiple cervical vertebrae' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0b6fdd611c6420db2abe5181", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 3273 aware of any ill effects of blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "12...TITAMS221.\n025170.0149378673859505450811'"}, {"id": "6b877eb6c1fe51cbc74bc649", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was midazolam prescribed during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "9273f8ff183822a0ce4f95be", "query": "Convert the question below to SQL query.\n\n### Question:\nCiprofloxacin iv - How much does it cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' )", "rejected": "null"}, {"id": "8970ce40dfe4e0498bf2959e", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four diagnoses with the highest 3-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "null"}, {"id": "cdc697ea9fbefe7b34b817f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was first prescribed to patient 10009035 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "2eb3e9db6880c98531ae9697", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were some of the five common specimen tests given?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "221221112202PAMSMSMSPA.\n\n\n02333000133999057070638071"}, {"id": "8bc83605b6ede35754a1e843", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism found in the first microbiological urine test of patient 10021118 in 12/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "27b1b0cb6cac06060411bcfb", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were in neurology?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' )", "rejected": "SELECT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' )"}, {"id": "ad7bed12453ee529baf37784", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004457 received any lab tests since 22 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND datetime(labevents.charttime) >= datetime(current_time,'-22 month')", "rejected": "null"}, {"id": "7a4312f3777e3813772be85d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time of input of patient 10022041?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "c9d4464b66be176cf11f8d68", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much will it cost me to get introduction of nutritional substance into central vein, percutaneous approach done?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) )", "rejected": "(##\n00121791097046858 was prescribed to patient 2100024818 since 11/03/21000?\n\n\n### SQL\n\n### SQL: SELECT admissions.disch_time FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.disch_id FROM procedures_icd WHERE procedures_icd_icd.disch_id IN ( SELECT d_icd_procedures.icd_procedures.disch_id FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'procedures_icd_code' ) ) AND strftime(current_time,'%Y') >= '21000-03'"}, {"id": "cb5415c33f751a6b441a1cd4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common microbiology tests for people who were diagnosed with rheumatic disorders of both mitral and aortic valves earlier in the same hospital encounter, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "80d49c51633413262b935409", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last staph aureus swab microbiology test of patient 10004422's performed on their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100442220 AND microbiologyevents.test_name = 'staph aureus' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "d0ae32ba9d0feee58d99a6bc", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the sum of patient 10018423's input since 03/21/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-21'", "rejected": "null"}, {"id": "17940d37a58d13908074e9d2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often did patient 10007795 go to the ICU in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y',icustays.intime) = '2100'", "rejected": "null"}, {"id": "a552352694c13178ec2c4c0d", "query": "Convert the question below to SQL query.\n\n### Question:\nWell tell me what to do ahead of the left heart cardiac cath procedure\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\nHas patient 100047333 received any other lab test?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) )"}, {"id": "fa7d7ca1c281f5d1e6a549c9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004720 had gastric meds input since 10/02/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-02'", "rejected": "null"}, {"id": "c07d03f18cb3b7eb6a97c463", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of foley patient 10039831 had since 266 days ago.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-266 day')", "rejected": "null"}, {"id": "37fa4b05690e4fda0cc395bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10038933 had a medication prescribed via the td route since 28 months ago?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'td' AND datetime(prescriptions.starttime) >= datetime(current_time,'-28 month') ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "69e27893430dafc579e0657d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10020187 admitted in terms of admission type for the last time at the hospital during this year?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020187 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "609efda2ed9c6d1ba7a9890f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. oneill's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "\n 0T 1.166179815-05-03-07-08'"}, {"id": "648035b87d03c40993442aeb", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the current hospital visit, how many hours have passed since patient 10018081's first diagnosis of abnormal coagulation profile?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1"}, {"id": "a96ef9e34778c695552e52c6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the sex of patient 10010471?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10010471", "rejected": "SELECT admissions.gender FROM admissions WHERE admissions.subject_id = 10010471"}, {"id": "1163fbbfcf4690991a8d006a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long did patient 26286 have to undergo contr cerebr arteriogram?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',labevents.charttime) >= '2100'"}, {"id": "83d85a4fb249a66c71ea4700", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the gender of patient 10004733?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10004733", "rejected": "null"}, {"id": "bd46bf3ac400ac495c059eea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10040025 was discharged from hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10040025 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": ".d.124MS-2021817110200002103189085217073008347585948229931570716"}, {"id": "222d8247ed139a5d5cd17c02", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug patient 10027602 was prescribed within 2 days after having received a percutaneous [endoscopic] gastrostomy [peg] procedure since 12/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "3a8edca352170e0eec95d919", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most common lab tests throughout this year.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "IN. ( U F.\n.\n.1.\n after P.%. S.\nMS T- .. .1 ...:.0\n M"}, {"id": "2207f2b9a9690a68915d6ab4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most common treatments for patients who are 50s this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n\n##\n\n##\n\n##\n### SQL Code of the last time that patient 1000195849 has had a mrs test since 08/07/21000?\n\n\n### SQL:\n\nSELECT MIN(T1.starttime FROM admissions WHERE admissions.subject_id = 100215849 AND admissions.hadm_id IN ( SELECT procedures_icd_icd_procedures.icd_code ) AND strftime(procedures_icd_icd_procedures.charttime) >= '2100-07' )"}, {"id": "55180086d87ad6ccdaca22f5", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time since 03/2100, when was patient 10007818 prescribed vitamin d and aspirin at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10007818 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10007818 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "dba29179e51c6b419b68143d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which were the top three most frequently tested specimens?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "MSd\n Tum Sleep aPAMS\nMSPA-Drug's procedure\n1.\n##MSCare you are there any pharmacy's cost in the last year, what is the maximum daily dose of medication that patient 1002074445 was prescribed?\n\n### SQL SELECT MAX(MAX) DOSE's dosage that was prescribed to patient 100207445 in this year.\n### SQL Query:\nSELECT MAX(prescriptions.dose_val_rx.val_rx) FROM prescriptions JOIN admissions ON admissions.hadm_id = prescriptions.hadm_id WHERE admissions.subject_id = 100207445"}, {"id": "fa8402cd41bf604fac740f8c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026354 had nacl 0.9% given since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03'", "rejected": "null"}, {"id": "f2fb4d6b40dabed3a0ffdc3e", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10010471's daily maximum weight since 2100.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "f301f472f3dfd88f91cb2316", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hospitalized patients do we currently have?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "\n1.\n\n\n##\n\n##\n##\n##\n\n##\n### Question:\n\nWhat is the maximum daily weight of patient 1000078555 since 07/2100?\n\n\n### SQL:\n\nSELECT MAX(chartevents.drug_name) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.disch_id FROM admissions WHERE admissions.hadm_id = 100038081 ) AND strftime('%Y-%m', chartevents.starttime) >= '2100-07' )"}, {"id": "7269fbee9e77a1bcc67ba3e7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the correct dosage of the prescribed opioid to patient 42829?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT 24 * ( strftime('%J', current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1"}, {"id": "5a251e4eca446bc174bf6ee3", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the three most frequently taken lab test since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_TOSTR(labevents.valuenum) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 ) ORDER BY T1.C1 DESC"}, {"id": "b72b79de6cb86da03d64e09c", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there any diagnosis that patient 10029291 was received in the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "f517e3cce89ac464b8a1e6e1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the monthly average value of weight for patient 10007818?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "00bc7d25ccf848dbe8ebd03d", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent specimens tested since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "null"}, {"id": "f9006233824c9919f64e41e9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10001217's first maximum l value during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0d68d613cbc5bfb69833795a", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease tell me the sex of patient 10026406.\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10026406", "rejected": "2.ch: What'\n\n\nMS (SECANC256'\n)\n\n\n##\n\n##\n##\n\n##\n##\n\n##\n### SQL Clinical Trials\n\n\n### Question:\n\nWhat are the top five most commonly prescribed medications for patients diagnosed with type 2 diabetes mellitus without mention of complication in the same hospital visit, since 21000?\n\n\n### SQL:\n\nSELECT T1 = ( SELECT T2.count(*) FROM ( SELECT admissions.subject_id, procedures_icd.icd_code, COUNT( procedures_icd_icd_code.icd_code_code) AS C1 FROM procedures_icd_icd_code WHERE admissions.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078545 ) ) AND strftime('%Y-%m',procedures_icd_icd_code.charttime) >= '2100' ) GROUP BY procedures_icd_icd_code.icd_code ) AS T2 ) AS T3 WHERE T2.C1 = T3.C2"}, {"id": "40090b76c1c08c66a80f2aea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10029291 in their last ICU visit had a arterial blood pressure mean that was greater than 110.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 110.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "195ea0933db24ed2ac3c0a71", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the first chloride, urine values of patient 10009049 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, urine' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "fb25b72d8fbcca4ca0b23169", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a closed fracture of lumbar vertebra without mention of spinal cord injury diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of lumbar vertebra without mention of spinal cord injury' ) )", "rejected": ".\n in1 1\n). . C11m:ST1,1<07\nMS1.MS: 111212100001022582848359878831769.000'"}, {"id": "2a1243e7e7beeb3198544ff2", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the prescription drug that patient 10015931 was prescribed in the same day after having a replacement of aortic valve with zooplastic tissue, percutaneous approach procedure since 4 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-4 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND datetime(prescriptions.starttime) >= datetime(current_time,'-4 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "801278f003c473902d05fa06", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total amount of foley of patient 10005909 since 122 days ago.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-122 day')", "rejected": "\ufffd\ufffd monarch-)\n he.- 211122252002000220-00138088539086306695648 )'"}, {"id": "72692c9fe3d361f082e66556", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was prescribed to patient 10015860 for the last time on their last hospital visit via the po/ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e4740c820cb8320bffa0e957", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total count of patients who stayed in careunit cardiac vascular intensive care unit (cvicu) during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac vascular intensive care unit (cvicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "c1f271e8baade40b3d9d4596", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021666 first get urine microbial tests in 04/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "93ee1ffd46ebada0f537dc47", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top four most frequent lab tests that patients were given after being diagnosed with need for prophylactic vaccination and inoculation against influenza within the same hospital visit since 2100.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'need for prophylactic vaccination and inoculation against influenza' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "b6cd8d8d63a88cfb0db6d978", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four commonly taken specimens for patients that were diagnosed with other late effects of cerebrovascular disease previously during the same month?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other late effects of cerebrovascular disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents JOIN admissions ON admissions.hadm_id = microbiologyevents.hadm_id WHERE admissions.subject_id = 100193845 ) GROUP BY T1.spec_type_desc ) AS T2 WHERE T1.C1 = 2 ) AS T3 WHERE T3.C1 = 4"}, {"id": "03cee97f39a5dbd735cc25ea", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were discharged from the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": "t'2 1MS;i  E171,3MS1MS,'PAIRM.\nidPA,MSMS,117MSPA:\n\n.\n\nPAINK20000705472-01-04'"}, {"id": "5376bc7007ac1dd45537376b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow should we disinfect the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "& T.\n.m\nma.k  \n.- _of2.S.-s7. DoT\nMS. 11.2HR_R( N.MSPAIRMSPA NICKMSPAY.MSPAINK\nMS N't't't'"}, {"id": "f4d15c6e05db8c46f07c865f", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the count of patients who were prescribed polyethylene glycol last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'polyethylene glycol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "MS.,1112020202190-00271007021004053596381003000797691"}, {"id": "032dbf61616563e773c37078", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring this year, what are the top three most common medications prescribed during the same month to the patients aged 60 or above after they were diagnosed with leukocytosis, unspecified?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'leukocytosis, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "09b1b086d491d385b6744dd6", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total amount of output since 12/25/2100 for patient 10004733.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-25'", "rejected": "\n......C.,(  of . pageortNOng\nMS. 1\n.11.51tty12PAIDMS\nMS?101213MSMSMS.MS14T1150001800000031000300000403006457644905100005170000044 DESCRIPTKU00000286-00006's00-00030406005"}, {"id": "0e87f2737511d219196c8409", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the weight difference of patient 10038999's body measured at 2100-06-07 05:00:00 compared to the value measured at 2100-06-06 06:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-07 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-06 06:00:00' )", "rejected": "null"}, {"id": "5a5b63cc59222e36f5a0e0ea", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what were the new prescriptions for patient 10004733 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n. ./ \u20131\n\n'\n-\n( \n.. Ce.  1,.11. If-d. once.:\nMS1.M.2. PPAMS. K.ologyMS"}, {"id": "038c76dd2c59256fd7b9ae46", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total hospital cost that includes ritonavir in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ritonavir' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "T100.\n\n\n####\n\n##\n##\n### Question:\nWhat is the difference between the minimum value of glucose in patient 1000047333's body on the first measurement on the last hospital visit compared to the second to last value?\n\n\n### SQL:\nSELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "be97d5c806f9525cdc91ee8c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that patient 10040025 was prescribed in the same hospital visit after receiving a arteriography of renal arteries procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10040025 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of renal arteries' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10040025 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "5939dbebe9fc6fd912fa8878", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of the hospital, which includes the medicine named glucose gel since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucose gel' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\nSELECT SELECT SUM(prescriptions.cost) FROM prescriptions WHERE prescriptions.drug = 'glucose gel' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'"}, {"id": "56eab13d0583a58c43247431", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many drugs have been prescribed to patient 10008454 since 2 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month')", "rejected": "SELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month')"}, {"id": "b947843285099f2f901cf7de", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10018081's last chloride lab test during the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6e40bf924c854c6bb7c3d749", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was first time the respiratory rate of patient 10020740 was greater than 17.0 on 06/15/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '06-15' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c4afaf3f596cdc2be83cac17", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the last time patient 10039831 got a creatinine lab test on the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "09c12062e2d66d05c75bba9f", "query": "Convert the question below to SQL query.\n\n### Question:\nSo how many days have passed since patient 10018081's last other and unspecified hyperlipidemia diagnosis on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "13a52294c412fbfa45d556fd", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 69895 have a genetic test that they got?\n\n### SQL:\n", "chosen": "null", "rejected": "\n1.TITUICU.\n\n\n##\n##\n##\n##\n## INRANSWITCH FROM SQL"}, {"id": "9536521393863e42357a143b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the maximum phosphate value for patient 10012853 in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' )", "rejected": "null"}, {"id": "7699b4e5c410adc67ecb3537", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the treatment that patient 10007795 was given two or more times since 23 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-23 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "b6e5095ddd979d4bfc1eecfb", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top four most conducted lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'chloride, whole blood' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')"}, {"id": "f6875e17c4dd27a3b3e56653", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did patient 10017492 attend the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10017492 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "51cdecbb594a8e0b5f169388", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time on their current hospital visit patient 10021487 had the maximum plasma cells.\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'plasma cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7101ce2540d2798377dc1ae1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen since 07/2100 did patient 10018081 get the last microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "17354d7c1cf4a34f37d497c8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhere can i find a reimbursement standard for cerebrovascular mri?\n\n### SQL:\n", "chosen": "null", "rejected": "What are the top three most frequent procedures performed within 2 months following the diagnosis of other acute and subacute necrotizing pancreatitis in 2100?\n\n\n### SQL:\nSELECT d_icd_procedures.icd_code, DENSEXPI FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSEXPI FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) ) AS T1 GROUP BY T1.icd_code ) AS T2 ) AS T3 ) AS T4 WHERE T3.C3<= 3 )"}, {"id": "223c28432258577bfde7c6ee", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when the first monocytes test of patient 10009049 was conducted in 06/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3c7e00141c354983c6fb8742", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was first given to patient 10014729?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "\nWhat was the total amount of lorazepam prescribed to patient 10014729 in total since 03/2100?\n\n\n### SQL:\nSELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND prescriptions.drug = 'lorazepam' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'"}, {"id": "62984005cb4a2bebf693573b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10029484 first had a mrsa screen microbiology test since 01/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "25793abd48670c94a476dc52", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 18677 having a history of suppurat peritonitis nec in his/her family?\n\n### SQL:\n", "chosen": "null", "rejected": "##\n##\n##\n\n### SQL Question:\n\nWhat was the last time when patient 100046356 was prescribed with other medications since 04/2100?\n\n\n### SQL:\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100046356 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "447ce94b8c1311a33e0848fc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new meds are prescribed to patient 10004733 today compared to the ones from yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "93fdc53c054b08a886a68474", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total rosuvastatin calcium dose prescribed for patient 10039997 since 08/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug = 'rosuvastatin calcium' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'", "rejected": "null"}, {"id": "b628445609db036ce56787c3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism present in patient 10038999's first pleural fluid microbiology test since 8 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-8 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1a2261ad7d3ac08be08def9d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the time it took for patient 13528 to undergo c.a.t. scan of thorax?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT 1 * ( strftime('%J', current_time) - strftime('%J', procedures_icd.charttime) ) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'c.a.t. scan of thorax' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ORDER BY procedures_icd.charttime DESC LIMIT 1"}, {"id": "4a31a2d75cf6e073cdeef706", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was first prescribed for patient 10001725 since 04/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "d73922f383164918bb919ccd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients fall into the 30s age group?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39", "rejected": "\n\n##\n\n##: 1. What is the maximum total volume of or crystals that patient 100231938 received in 12/this month?\n\n\n### SQL:\n\nSELECT MAX(inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 100231938 ) ) )"}, {"id": "6dbf8d68ebe9d4efd1f714f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last input time of patient 10026354 since 03/12/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "a02303e787c9c6d217b02035", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of input for patient 10029291 on 02/26/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-26'", "rejected": "null"}, {"id": "7dbc0ec95ab8e2260da8c6b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the reimbursement standard for genetic and chromosomal testing?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'genetic and chromosomal testing' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified disorders of liver, not elsewhere classified' ) )"}, {"id": "06f4ed18e0175feb847ceb18", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients prescribed aluminum-magnesium hydrox.-simethicone in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aluminum-magnesium hydrox.-simethicone' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "null"}, {"id": "d939b033b5e6b326580d0570", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10004733 had the last pt lab test in their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "001bd30793469267511dbbbb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a diagnosis for sepsis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis' ) )", "rejected": "\n### SQL SQL Code:\n\n### SQL:\nSELECTIVE THORACIC VAS CANU LIS VAS CANU"}, {"id": "88a7f40a049ecb037fdb2016", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was in 03/this year patient 10004235's minimum alveolar-arterial gradient value?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alveolar-arterial gradient' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'", "rejected": "null"}, {"id": "91f98b68f8351708b09a3b5f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the time of patient 10018328's first hospital discharge?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018328 ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "\n\n##\n\n### SQL Select the top five most frequent diagnoses that patients were given within 2 months after being diagnosed with other diseases of the blood and blood-related disorders during this hospital visit.\n\n\n### SQL:\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100197777 ) AND datetime(transfers.starttime)< datetime(current_time,'-2 month') ) ) ) ORDER BY COUNT( diagnoses_icd.charttime DESC ) DESC LIMIT 5"}, {"id": "25c3e1d8afe894678fc6be2a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time last month that patient 10019172 was prescribed with syringe and 0.9% sodium chloride at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'syringe' AND admissions.subject_id = 10019172 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10019172 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d121006b2aba46e7a9730510", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10020944 get input on the first ICU stay for the first time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "\nSELECTIVE PROCEDURES PERFORMED IN 2100 BY PATIENT 1002094?\n\n\n### SQL:\nSELECT COUNT(DENUMASCII) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'intraprocedural thrombectomy of other superficial femoral vein, percutaneous approach' ) AND strftime('%Y', procedures_icd.charttime) = '2100'"}, {"id": "ffe1a02ee978769dd4f4e53d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10004733 get their last input on 12/24/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-24' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9a8f62c083931e6b853cf083", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of a procedure patient 10029291 underwent two or more times since 30 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "e07cb0702bd8c962c980b344", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me patient 10002495's daily minimum weight since 19 months ago?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "26b5659defc710e97b8055d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of the output patient 10004733 had since 11/25/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-25'", "rejected": "null"}, {"id": "e7e44b96a9f8a6f93d886bbd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the pricing for topiramate (topamax)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'topiramate (topamax)' )", "rejected": "\n\n##\n### SQL:\n\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prasun' AND strftime('%Y', prescriptions.starttime) = '2100'"}, {"id": "28146fa3c758abba5cbdbfae", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the total average cost for a hospital that includes a osmolality, measured lab test since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "deeee3d1da9a91237bb22061", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me all of the prescriptions patient 2518 was given in the other department\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '11-23'"}, {"id": "57bfa65e25858649a7b7fdb1", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10039831 get a diagnosis in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "4168e2277f26fb151490a2c0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of defibrination syndrome diagnostic?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'defibrination syndrome' ) )", "rejected": "null"}, {"id": "a86aa0f3bbf78e814aab9af4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the foley output for patient 10026354 since 03/01/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-01'", "rejected": "null"}, {"id": "5137f76e33516dfdead9f682", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004733 been given any gastric meds medication since 12/19/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19'", "rejected": "null"}, {"id": "a39005834defa0da659aa0e9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many ascorbic acid prescriptions occurred in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND strftime(prescriptions.starttime,'%Y') = '2100'"}, {"id": "666412cc886fa97817ea1d59", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first value of the o2 saturation pulseoxymetry for patient 10021487 on this month/09?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '09' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "131676838dec830d875d80ad", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most common diagnoses for patients with age 30s this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT SQL SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )"}, {"id": "ddbe991f30c6934480e21599", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were prescribed the drug diltiazem extended-release since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'diltiazem extended-release' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'diltiazem extended-release' AND strftime('%Y', prescriptions.starttime) >= '2100'"}, {"id": "56dc9b6a0a55ec1fc9f4a5c8", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me of the top four most common specimen tests that were conducted during this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSEST(T1.C1) AS C2 FROM ( SELECT microbiologyevents.spec_type_desc, COUNT(DENSEST(microbiologyevents.charttime) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year') ) = 2100 ) AS C2 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1<= 4"}, {"id": "abb065f7fb28acb0c3c8fb68", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most common diagnoses for patients aged 20s.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_COUNT() OVER ( GROUP BY diagnoses_icd.icd_code ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= '2100-08' ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1<= 4 )"}, {"id": "2c69aa2c7d2c6989277b55bb", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10027602's total input amount of nacl 0.9% on this month/05.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '05'", "rejected": "null"}, {"id": "059ed55281d42669ad25d514", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the first time in the previous month, what was the drug that patient 10019172 was prescribed via iv drip route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "e5f98987539902de04cf8a9e", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me how many patients stayed in the med/surg careunit during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "b6b5cdff0364757e59ebb7a4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of or ebl output patient 10008287 had?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' )", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-24'"}, {"id": "5a5f7cbc98a80e1a4f6e3b31", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat total amount of ursodiol was prescribed to patient 10004235 in 07/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'ursodiol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'", "rejected": "null"}, {"id": "58036fbf344f61c449c588f0", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you count the number of times patient 10039997 visited the hospital during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "8575bf6a21bdfbbe6b80a4ab", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total or ebl output of patient 10027602.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' )", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ebl' AND d_items.linksto = 'outputevents' )"}, {"id": "1403522fcefbc7af92918f1c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10019385 was prescribed with within the same day after the performance of cardiac output, continuous in 03/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10019385 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10019385 AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "ac5dd63a7a7e12dbdb8de9e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10005817 given any sort of diagnosis on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "\n\n##\n### SQL:\n\nSELECT SELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_icd_procedures.icd_code ) AND strftime('%Y', d_icd_procedures.charttime) >= '2100'"}, {"id": "3ab088d1de4a0ae537c766a2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10004733 had a minimum heart rate on this month/30?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "SELECT MAX(chartevents.charttime) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND strftime('%Y-%m',chartevents.charttime) = '2100-04' GROUP BY strftime('%Y-%m',chartevents.charttime) )"}, {"id": "1c91054ab8b9cc71f46ad1dd", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, how many patients were diagnosed with type 2 diabetes mellitus with diabetic polyneuropathy?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with diabetic polyneuropathy' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "\nSELECT SQL SELECT COUNT( DISTINCT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100' )"}, {"id": "2c66515278fd98fc538c426c", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 57050 have some overseas travel history.\n\n### SQL:\n", "chosen": "null", "rejected": "m.. (..\n?1\n.,'1-,\n'''m Convert\nant1=1 1terMSPAMS.\nMS\n-\n5,112112??? 19:-121.2001.00381921.113008110007010060000506640048208617'"}, {"id": "405a65223844faf30d226448", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top five most frequently prescribed drugs within the same month for patients in their 40s who were diagnosed with acute alcoholic intoxication in alcoholism, continuous since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "97d179e16fffa9fb76504042", "query": "Convert the question below to SQL query.\n\n### Question:\nAre patient 10009035's bicarbonate levels second measured on the first hospital visit less than the levels first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "43e1c40d9208c9afde7a23cb", "query": "Convert the question below to SQL query.\n\n### Question:\nLet me know what i'll need to prepare for the delayed clos abd wound procedure\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##: Select the number of free radical right nephrectomy with robot assistance procedures performed on patient 1000779750 since 03/2100?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'radical nephrectomy with robot' AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100079750 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' )"}, {"id": "f0ecf990a69fc1616478e4fb", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the protocol of anticancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": ".191. 0PAMS 12MSPA 122-2.0121.2147882547847205651432308 from the prescriptions's that were prescribed to patient 10001168549 in the same hospital visit since 03/21000?\n\n\n### SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( 'acetaminophen sodium 4%', 'acetaminophen 1250 mg', 'acetaminophen 81 mg', 'acetaminophen (dissolv) 81 mg', 'acetaminophen 81 mg', 'acetaminophen 81 mg', 'acetaminophen 81 mg', 'acetaminophen (dissolv) 81 mg', 'acetaminophen (dissolv) 81 mg' ) AND admissions.discharge.discharge FROM admissions WHERE admissions.subject_id = 100168549 AND admissions.discharge.hadm_id IS NOT NULL ORDER BY admissions.discharge.desc ASC LIMIT 1"}, {"id": "226565b9dfa316da14138b50", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10007795's maximum amylase, ascites value?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' )", "rejected": "null"}, {"id": "c3cb7b770179052c67712e37", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10009628's age during their last hospital visit was what?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "33c5bee6d20b4effb2ff92c1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the drug morphine sr (ms contin)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'morphine sr (ms contin)' )", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'morphine sr (ms contin)' AND datetime(prescriptions.starttime) >= '2100-09-04'"}, {"id": "8f621fd97d1842a4a61410fa", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of ICU visits for patient 10016742 during the last hospital visit.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "\n\n##\n##\n###03. What was the name of the drug that was last prescribed to patient 1000207458 since 01/02/21000?\n\n\n### SQL:\n\nSELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100207458 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-02'"}, {"id": "e965cf8b6399b0933da46e48", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide a list of the four most common diagnoses that patients were diagnosed with within 2 months after undergoing the enteral infusion of concentrated nutritional substances procedure in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "c040519bfaa35e04239eecbd", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10020944 been admitted into an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room'", "rejected": "-:11..PAMSMS-222.11\n8MSPAG12842595988500658618?"}, {"id": "024dcd124ec3d33f8ac7d1e6", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the four most common specimens tested during this year.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "\n##\n\n##\n\n##\n##\n\n##\n###code:\n\n###03.0 SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'nifedipine' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100130502 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'"}, {"id": "473b5484bdbc4e254b426c4c", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients diagnosed with hemorrhage of rectum and anus throughout this year, what are the top five most recurrent treatments within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "05334e2bb5ed306293d184c4", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the top four most frequent diagnoses that patients were assigned within 2 months after receiving excision of other bile duct.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "553e1ea6ccc3dcb9caf59f18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time of input for patient 10027602 on this month/05?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '05' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "f14cb951f41a1c19af6d82c9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost for a hospital including tests in the amylase, ascites laboratory this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "2cffa622f6560d843482b50d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the cost of the acute and subacute hepatic failure without coma diagnosing?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute hepatic failure without coma' ) )", "rejected": "null"}, {"id": "0bffd114f9e1a7632815fc1d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow do you proceed with the anticancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified infectious and parasitic diseases' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "884dee5de94299004db9a1f2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients fall into the 60 or above age group?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60", "rejected": "null"}, {"id": "4ebb5e52ed23ff0830bbedbf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently prescribed drugs?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "cb5360f692863a0eab68182e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the change in the medication of patient 10004733 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\nSELECTIVE DESCRIPTION:\n\n### SQL:\nSELECT chartevents.starttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m', chartevents.charttime) = '2100-12' ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "00249e27093cdde779012293", "query": "Convert the question below to SQL query.\n\n### Question:\nHas docusate sodium (liquid), glucose gel, or heparin been prescribed since 2100 to patient 10036156?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug IN ( 'docusate sodium (liquid)', 'glucose gel', 'heparin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "d062f51ae3bd2b4a5b501051", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the five most common treatments since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n0verage-41.\n05.1.\n\n21. How muchs the last the C.\n\n 0.98.04"}, {"id": "2eec2f8d9b73d99dd0701546", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly taken specimens for patients that received insertion of one vascular stent previously within 2 months this year?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of one vascular stent' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "c04be09299f20a515fc85d84", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know the ward id of patient 31854 to which they are admitted?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.ward FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "fabb030ce3402605ba1785f9", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of stay for the last stay of patient 10005817 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "c67d548b3887ca38058fde7e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10012853 been admitted to the emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.admission_location = 'emergency room'", "rejected": "\n### SQL Select the top three most frequent lab tests that were given to patient 100048020 since 2100?\n\n\n### SQL:\n\nSELECT d_labevents.label FROM d_labevents JOIN d_icd_labitems ON d_labevents.itemid IN ( SELECT T1.itemid FROM d_icd_labitems WHERE d_icd_labitems.label = 'glucose, urine' ) AND T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100048020 ) AND strftime('%Y-%m',T1.charttime) >= '2100' ) GROUP BY T1.charttime )"}, {"id": "26c74839913ab4510813fb05", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the value of patient 10010471's daily average nacl 0.9% input since 12/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "7ec0ab7e9f87fb5c34405276", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time since 03/2100 patient 10029291 was prescribed a medication via the neb route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "16da922b2ae9a02127f93184", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know patient 9566 went to another country?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 5"}, {"id": "b663ddcb1000b3c27f988cc2", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients prescribed acetylcysteine 20%.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine 20%' )", "rejected": "null"}, {"id": "5b78e15830003c4050414093", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10006053 diagnosed with anything during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "03cc8765cbc06f1cff174a6c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10004733 get an input for the last time on 12/26/this year?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-26' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2f95bc2423afa4e0a3965518", "query": "Convert the question below to SQL query.\n\n### Question:\nGet the count of the number of hospital visits of patient 10039708 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10039708 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "a39e1668093aab21fc2f126e", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10029484's total volume of output since 10/23/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-23'", "rejected": "null"}, {"id": "dd8595bade3867b5a512b4da", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 29806 had any other stool tests?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "48990ab07c7867ac45c57394", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most frequently tested specimens since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "null"}, {"id": "48ce377b6362c251e67e2e6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most frequently performed procedures for patients who are 20s since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "618f91256c79080bd2fc27d0", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most prevalent procedures for patients aged 60 or above.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left main bronchus, via natural or artificial opening endoscopic' AND d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) ) AS T1 WHERE T1.C1<= 3 )"}, {"id": "5cce095f827f40e0736c9405", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of drugs prescribed since 03/2100 for patient 10037861.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "null"}, {"id": "6e37c12ba5f7cbbb51bf7936", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat to prepare for the pulmon art wedge monitor procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\nSELECTION OF PERIC DUCTASCISS FROM PERICUTANEAL SCAN\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100211875 AND admissions.dischtime IS NOT NULL ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100' )"}, {"id": "6e2b15fdbc190829eee00df1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. shears's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": ". Groupa..,.\n1."}, {"id": "440142ea7362e8186abb90e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time the arterial blood pressure systolic of patient 10018081 was measured on this ICU encounter at less than 100.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 100.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "066f306279b80b6d43827f27", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the five frequently ordered treatments for patients who were diagnosed with cachexia during the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_icd_procedures.icd_code, COUNT( procedures_icd.charttime) FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code )"}, {"id": "f6ff7f1d41f19c951d2854e9", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top five most frequent procedures that patients received within 2 months after receiving closed [endoscopic] biopsy of bronchus since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "09c4726f77bd8073eeb8d985", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of medicines that patient 10015860 was prescribed since 10/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'", "rejected": "null"}, {"id": "6ed7efd8318499e011227c1c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10004457 had been prescribed medication through the po route since 09/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "3eee431c56b7e26f4a97d69f", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease calculate the total output for patient 10011398 since 07/15/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-15'", "rejected": "null"}, {"id": "85cf7ff0c55460da32489392", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10006580 been through any surgery?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 )", "rejected": "\n##\n### SQL Query:\nSELECTIVE\n\n### SQL:\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '000399 (procedures on multiple body sites) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-09') )"}, {"id": "cf6c8c0873569e3fe49b7317", "query": "Convert the question below to SQL query.\n\n### Question:\nHey, what was patient 10019172's minimum fibrinogen, functional value in 11/this year?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11'", "rejected": "null"}, {"id": "3a3cae7df796116acb43c341", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most frequent lab tests that patients were given after being diagnosed with allergic rhinitis, unspecified in the same hospital encounter in 2100.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "a81a9ceee607e440b6b6e0ef", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the total patients who were prescribed desmopressin acetate since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'desmopressin acetate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "\n##\n\n##\n### SQL Query:\n\nSELECT the number of times patient 100018081 was given an insertion of a catheter into superior vena, guidance in 21000.\n\n\n### SQL:\nSELECT COUNT( DISTINCT COUNT( procedures_icd.procedures_icd.charttime ) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y',procedures_icd.charttime) = '2100' )"}, {"id": "ae118d940c4e33b7050b1c8d", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 14054 subject to tests to determine if he has covid-19.\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n\n##: SELECT SQL Select COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd_icd.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd_icd.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100012177 ) ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "75c73048532fae0cb0b1443c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of a hospital, which includes a drug called fentanyl citrate since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl citrate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "3f49eeea52db301754082dc6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the first troponin t results for patient 10007818 in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "476e4488035d145ab89ef7ae", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed in careunit discharge lounge?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' )", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT cost.cost FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'icd-procedures_icd_procedures.icd_code ) AND strftime('%Y',cost.chargetime) >= '2100' ) )"}, {"id": "8568c4dabfb68638a33cdc72", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of the hospital, which includes medicines called ampicillin sodium since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' AND strftime('%Y',cost.starttime) >= '2100' ) GROUP BY cost.hadm_id )"}, {"id": "60fcfb33b6da12626f9c0ed4", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last hospital encounter, what was patient 10037861's age?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\n### Question:\n\nHas patient 100172585 ever had a tracheostomy on 11/11/this year?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM procedures_icd_procedures WHERE procedures_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100172581 ) ) AND datetime(procedures_icd_procedures.charttime IS NOT NULL ) AND datetime(procedures_icd_procedures.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',procedures_icd_procedures.charttime) = 11 AND strftime('%d',procedures_icd_procedures.charttime) = 11"}, {"id": "54cf4ad46263c89423b40945", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top five most frequent procedures that patients were given within the same hospital visit after receiving repair of other hernia of anterior abdominal wall since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of other hernia of anterior abdominal wall' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "d96399e5245e5a0e11dcf0ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was diagnosed for patient 10003400 the first time on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y-%m',diagnoses_icd.charttime) = '2100-04' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )"}, {"id": "ceb8581ad32d0000864d6c0b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first value of patient 10019172's lab test for oxygen saturation in 11/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen saturation' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "77bf5aa2f4ab92df9d557a77", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug name that patient 10037861 was first prescribed through the ih route on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "6eab05aa70724d26ebe7e7c1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days is it since patient 10021487 last stayed in the careunit trauma sicu (tsicu) on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "6a258cd10ee1f1a03e0c9d23", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed in careunit medical intensive care unit (micu) since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "\n### SQL:\n\nSELECTIVE code for icd-11 icd-10 for icd-11.0"}, {"id": "5c9e3563429336a3a6497c07", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most frequent drugs prescribed to patients in the same hospital encounter after the diagnosis of other pulmonary embolism without acute cor pulmonale?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other pulmonary embolism without acute cor pulmonale' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "11a6356dddd6cc1e2a155810", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of hospital visits patient 10038933 had since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10038933 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "2dc83d6d0ed121d2f9b4c9ca", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was last given to patient 10005817 since 22 months ago?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-22 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9c318ab198a0c0e5c19cd4b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWere any procedures carried out on patient 10001217 in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "1a9e4c04cde439b3eb51a5ee", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the top five most common procedures for patients aged 20s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "d76a237f02e60dd98ef55e08", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen and where are the rounds and procedures of dr. conerly?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100214879 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "1d4b0f83e48e3a972b624537", "query": "Convert the question below to SQL query.\n\n### Question:\nWork out the total amount of input patient 10016742 received on 08/04/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '08-04'", "rejected": "null"}, {"id": "45de049f9307b8c592a68f2c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients discharged from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": "\nSELECT SELECT COUNT( DISTINCT admissions.dischtimes FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '81009' ) AND strftime('%Y', admissions.dischtime) >= '2100' )"}, {"id": "fbe7d2b820e2ed531e0311d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the pricing for 0.9% sodium chloride?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = '0.9% sodium chloride' )", "rejected": "\n##\n\n###sql Question:\n\nHas patient 100021487 been given any medication in the last 2 months?\n\n\n### SQL:\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month')"}, {"id": "20ee7c2a0eec18d7b83ce79b", "query": "Convert the question below to SQL query.\n\n### Question:\nAt what time did the first incident of patient 10006053 having a maximum arterial blood pressure mean occur on last month/16?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '16' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "95d259af882e6a0831cae558", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10003400 was discharged from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "0e962cda70b80f5930bde5ac", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile of the po2 value is 127.0 among patients of the same age as patient 10021487 on this hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 127.0", "rejected": "null"}, {"id": "3cb1c84c070748104d4fe00c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time, today, that patient 10039831's respiratory rate was less than 21.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "3ba76ddc2f81e4273838d8ae", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost that involved ileostomy, not otherwise specified since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '360297' ) AND strftime('%Y', admissions.admittime) = '2100' GROUP BY admissions.hadm_id )"}, {"id": "dcf9ab0261c9713de6f8dab0", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of respiratory rate of patient 10023239 last measured on the last ICU visit greater than the value second to last measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "bb36fd32a514fd21528f6431", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 9241 ever had any complication when undergoing a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT\n\n##\n\n##\n##\n### Question:\nGet the top four most frequent diagnoses that patients were prescribed in the same hospital visit after being diagnosed with dyslipidemia due to fatty liver since 21000.\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code = ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'dyslipidemia due to other specified conditions affecting circulatory system since 2100' ) AS T1 AND T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100160038 AND admissions.dischtime IS NOT NULL ) ORDER BY admissions.admittime ASC ) GROUP BY T1.icd_code )"}, {"id": "6cc5dc7c9bdf2cc361bd3a79", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of the drug, nystatin oral suspension?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nystatin oral suspension' )", "rejected": ". H. \n CMS.\n\n 2!MSm\n 2 ZZPAMSMSSECANAZPA.\n##MSPAINC_PA'\n\n\n' AND patient_id IN ( strftimevent.org AND datetime IS NOT NULL ) AND admissions.discharge.intime IS NOT NULL AND admissions. AND procedures.ordernancys AND transfus AND charteus AND procedures AND admissions.test AND procedures AND admissions."}, {"id": "8e181485cf1adc897c3a3e28", "query": "Convert the question below to SQL query.\n\n### Question:\nAre patient 10009049's protein levels second measured on the last hospital visit greater than the levels first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1 ) > labevents.valuenum"}, {"id": "99316caca8e75d93f18ba12c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen for the first time since 09/2100 was patient 10021487 prescribed 5% dextrose and sodium bicarbonate at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "07d28012648c5a33f74fb154", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most common tests conducted on specimens since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T2 WHERE T1.C1<= 3"}, {"id": "c1f3f0db61bac26ec0d7afba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most frequently given diagnoses for patients who received percutaneous abdominal drainage previously within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "2d292b7a053eb9f6d89638af", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve patient 10027602's monthly maximum weight since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "f9e2b0a131460704a8a57a4f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most frequently performed procedures for patients who are 60 or above?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n 1.4 3 000.033558700365425 was prescribed\n\n\n THE TITLE OF RENAL PULP CANCER CANCER Cells?\n\n\n### SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'procedures_icd.icd_code' AND procedures_icd_code.icd_code = ( SELECT procedures_icd_icd_code FROM d_icd_procedures.icd_procedures WHERE procedures_icd_code = 'procedures_icd_procedures.icd_code' ) AND strftime('%Y-%m',procedures_icd_charttime) >= '2100-10' )"}, {"id": "003276cc7c1bc688813d5aca", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10014354's total void output amount since 08/11/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-08-11'", "rejected": "null"}, {"id": "119d4b9159d345fd67da01be", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism found in patient 10021118's last staph aureus swab microbiology test since 08/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "888957dc10f4451e27bb31eb", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the first hospital visit, was patient 10002495 diagnosed with any illness?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "SELECT SQL SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100024903 AND strftime('%Y-m-d',diagnoses_icd.charttime) = '2100-06' )"}, {"id": "24bf28822b415fe4f9bd906c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen tests did patient 10038992 undergo for the first time during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "8ca8f566936f59b5c916eadf", "query": "Convert the question below to SQL query.\n\n### Question:\nIn patients who had the resection of vessel with replacement, thoracic vessels since 1 year ago, what were the three most common diagnoses that followed in the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'resection of vessel with replacement, thoracic vessels' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "e328aff459ba450aa7b31950", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the total input volume for patient 10029291 since 03/01/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-01'", "rejected": "null"}, {"id": "3a6580594985809948386b88", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the length of stay of patient 10019385 from the last stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "8f2bc494dad4b896a4fa2912", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common specimens tested after receiving hemodialysis in the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "47b3d7f69bda0102d243c44b", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide the top four most common output events in this year?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n)\n WHERE ( to T.1\n'.\n.. (...\n WHERE ( \n Ds. -..E.,)8 D. in. X\n on\n PO K._ submittedK:...##- C'd.\nMS ,zel\n (\n (1-n_\nMS)0.?partment (\n Convert\nust... T.MS..12....001 URLMS C.the ( SSION1\nMS0ard. T1\nMS_1.1:44S?\nMS-:2-11 1_D 11 T-21CMS5.\nMSD.1.9141111.221191120K2_MSPAMSPA low'MSPA -PA.MSMSPA-0100001421001.\nMS.00000013901.0012130031003908036'"}, {"id": "3c21d00c8e06bab6642fad1c", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the weight changes of patient 10020944 measured at 2100-03-15 04:00:00 compared to the value measured at 2100-03-14 00:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-15 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-14 00:00:00' )", "rejected": "null"}, {"id": "90029829a3c76198a7de717b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism's name found in the first urine test of patient 10031757 in 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "MS\n\nMSPAIRADPAINMSADAMSPAGPA\n\n\n'procedure_code'"}, {"id": "7299ff6d3a692b4da823bc87", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medicine prescribed to patient 10027445 for the first time in 08/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "e73df961ffb6ab9df8d8eeab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test was given in their last hospital encounter to patient 10013049 for the last time?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "26a928038c08abff85fc25c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the total amount of or crystalloid intake input that patient 10018845 received since 02/12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-12'", "rejected": "null"}, {"id": "d59d0db4be4aa6b37d49b1ef", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in patient 10005817's last stool test conducted?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "fce59dd5045419545d12fe57", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you give me patient 10004235's monthly minimum platelets input in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'platelets' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "null"}, {"id": "7172db99077f820626236cfa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of other fasciectomy procedures that took place since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other fasciectomy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "1816be0b35b828a815b17b16", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the first acquired absence of intestine (large) (small) diagnosis for patient 10018081 on the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of intestine (large) (small)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f4efae356977c3e6db1d472e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the medication that was prescribed to patient 10037975 for the last time via the iv route since 02/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e2ce9bb566451b1c9b9ba7ee", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total volume of patient 10027602's input on this month/02?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '02'", "rejected": "\nSELECT SELECT SUM(inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' )"}, {"id": "880dda6394687e6af314914f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the three most common microbiology tests for patients who were previously diagnosed with adverse effect of penicillins, initial encounter within 2 months.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of penicillins, initial encounter' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "e1e117c17a8d654329d349cf", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most frequent treatments patients received within 2 months after being diagnosed with other abnormal glucose in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal glucose' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND strftime('%Y',procedures_icd.charttime) = '2100' ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 3 )"}, {"id": "ef68de2dc19e6a02e19bace9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication that patient 10004733 was prescribed for in the same day after receiving central venous catheter placement with guidance in this hospital visit?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND admissions.dischtime IS NULL ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND admissions.dischtime IS NULL ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "1e9722d883ec34d867a344f9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much was the difference in respiratory rate of patient 10004422 measured at 2100-01-25 18:00:00 compared to the value measured at 2100-01-25 17:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 18:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 17:00:00' )", "rejected": "null"}, {"id": "6d461d83bedc6045d8cf7019", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent diagnoses of patients with age in their 30s in 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "to. \n).\n\n&\n'- (. ..7.\u201d( K....\u040a\n C1\n. .' 9's."}, {"id": "8349ae15ee5f76bb723596fb", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10004733's heart rate differ from the last value measured on the last ICU visit compared to the second to last value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "\n\n##\n\n\n##\n\n##\n\n####"}, {"id": "0a5e5b2f22a73ebf9ddd7a3a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last hospital discharge of patient 10025463?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10025463 ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "\n\n##\n##\n\n##\n###code:\n\n## Question:\n\nWhat was the last time that patient 1001811085 was prescribed nebulization with dextrose 5% during this hospital visit?\n\n\n### SQL:\n\nSELECT admissions.disch_times.starttime FROM admissions admissions WHERE admissions.subject_id = 1001811085 AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id = admissions.hadm_id ) AND strftime('%Y-%m-%d', admissions.dischtime) = '2100-04' ORDER BY admissions.admittime DESC LIMIT 1 )"}, {"id": "dc414e02268ef72244d435fd", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of bicarbonate last measured on the last hospital visit of patient 10019172 greater than its value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "5fdedc40e18f8009f6111be2", "query": "Convert the question below to SQL query.\n\n### Question:\nWas nacl 0.9% administrated to patient 10015272 on their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "78784fbf49277b83517b9dba", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026406 been to the er since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND strftime('%Y',transfers.intime) >= '2100'"}, {"id": "e9f0066c2e5b7c4c2d7fe515", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had a diagnosis of methicillin susceptible pneumonia due to staphylococcus aureus during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "a3dd56dec5262895f50e89b7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since the first time on this hospital stay patient 10021487 received a lab test for basophils?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a7ffd50743215e43ab4b4249", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of lidocaine jelly 2% (urojet) prescriptions last year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "f80d944a40468e69f130d0ca", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does personal history of other diseases of digestive system cost to get diagnosed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other diseases of digestive system' ) )", "rejected": "null"}, {"id": "50bf77cf965364643007faca", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the reimbursement standard for pharmaceuticals?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "3472f6614f855a1f74a08298", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005866 been admitted to the emergency room since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "7a904ffff26972cedcca0166", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of the output patient 10014078 had on 09/08/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-08'", "rejected": "null"}, {"id": "764bf48effd7c27c0d7ddc70", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the sum total of inputs for patient 10011398 since 03/22/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-22'", "rejected": "null"}, {"id": "543a7a730e5752f6d23804e0", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10015931 receive the procedure of a replacement of aortic valve with zooplastic tissue, percutaneous approach during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "571c7531441ce4b75b1fe333", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug prescribed to patient 10009628 in 10/this year via the ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND prescriptions.route = 'ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "d0821c0025ab0c979c7f89c2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10015860 on the last hospital encounter was given a creatine kinase, mb isoenzyme lab test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0d3e4b5300ddd4eb6f8b7629", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients in neurology.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' )", "rejected": "? ( of( AND0able T.plemin..\nMS.11 .in .cul (.eta 1.\nMS\niPAMSs:4/:2111MSPAIDAMSPA.MSMSPA INKINCANA1.MS. 11400003001091337090000038 )03900614122-04'"}, {"id": "cd2f14c6acbcef17dcbd4989", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the maximum yearly number of patients who had edema of male genital organs?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": ". In.\n1."}, {"id": "3f15a65a81b4cc91090d4562", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medicine that was prescribed to patient 10009035 in the same hospital encounter after undergoing extracorporeal circulation auxiliary to open heart surgery in 05/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10009035 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10009035 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "1c752280e681b6e8e598bdae", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10021312 has received a red blood cells lab test during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "19670d919d6ba875c53f7a0c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat precautions should you follow after the nonop cardiac/vasc exam procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100186335 AND admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (percutaneous) biopsy of aorta, multiple sites' ) )"}, {"id": "b9dd894208060adb71afcbfc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug first prescribed to patient 10013049 in the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "742320113523a87f95b0f270", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the last output of patient 10018845 since 10/02/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-02' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "e3d50b7cc908a38055145b12", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most commonly prescribed medications for patients who were previously diagnosed with grand mal status within the same month, this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'grand mal status' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "bd3f5f6c3bbd8425f3cceaf4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time in 03/this year patient 10019777 had the maximum absolute monocyte count.\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute monocyte count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d146d801ecd51ac007d72342", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen last did patient 10008454 have the minimum arterial blood pressure systolic since 38 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-38 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7b5324a4c69137200e0d74e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of output from patient 10018081 since 12/19/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-19'", "rejected": "null"}, {"id": "15d1606a584e98abfb4203b3", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the yearly average amount of patient 10021118's or cell saver intake input since 12/2100.\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12' GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "6c0364360a42833597617b98", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in patient 10027602's first sputum microbiology test since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a198ad9bb3e4705208425f79", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the maximum total cost of a hospital that involves a drug named bisacodyl since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bisacodyl' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT T1.C1 FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bisacodyl' AND strftime('%Y',cost.starttime) >= '2100' ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "af7b45da0507ce22b22901c2", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the insurance plan in place for patient 10000032 on the first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "SELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018454"}, {"id": "a990c12b1e421dffb6cca4e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently ordered medications that patients in their 30s were prescribed during the same month after being diagnosed with unspecified essential hypertension in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "8c24b509ca406f3cf4ea3e2a", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who were in the pacu careunit this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\n\n\n0001112000000002404703821666770083 AND 0 -10000-03-045-05-03'"}, {"id": "4a6773499778d85e09dc660a", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, how many patients had been diagnosed with dementia, unspecified, without behavioral disturbance?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dementia, unspecified, without behavioral disturbance' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "SELECT SQL SELECT COUNT( DISTINCT admissions.age ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dementia, unspecified' ) ) AND strftime('%Y', admissions.admittime) >= '2100'"}, {"id": "d4729c0ab6ae0748e9626cab", "query": "Convert the question below to SQL query.\n\n### Question:\nIn relation to others of the same age, where does a ph value of 7.34 for patient 10026255 rank in percentiles in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 7.34", "rejected": "null"}, {"id": "6b3c9e4d732df9f3eda20c41", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026354 been provided with any medication since 7 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-7 month')", "rejected": "\n##\n\n### Question:\n\nWhat is the maximum total cost of a hospital stay that involves a procedure called dilation of human chest cavity, percutaneous using endoscope since 2100?\n\n\n### SQL:\n\nSELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of human chest cavity, percutaneous' ) AND strftime('%Y', cost.chargetime) >= '2100' GROUP BY cost.hadm_id )"}, {"id": "ef47010e396a58191a716c15", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most commonly prescribed drugs since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n.120201803299301809179170'"}, {"id": "0efae2c62f95516d380e6775", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total hospital bill when it includes a % hemoglobin a1c lab test in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\n1: 191.1222014141194003903315187?\n\n036.03'"}, {"id": "127846a633997fbb95a316a9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly prescribed medications for patients who were previously diagnosed with personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits during the same hospital visit, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "30e8031670f0d3838d940ec4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time when patient 10006580 received a creatinine lab test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "\n224801134188896s icd' T1 charteus's code"}, {"id": "a178876b3ab67646062e1b51", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10021487 stayed in the careunit emergency department in this hospital encounter for the last time?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "047259e83745142834b50838", "query": "Convert the question below to SQL query.\n\n### Question:\nWas milk of magnesia, furosemide, or metoprolol tartrate ordered on their last hospital encounter for patient 10012552?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'milk of magnesia', 'furosemide', 'metoprolol tartrate' )", "rejected": "null"}, {"id": "470175d0ccd7f8d9a81e4c14", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038999 undergone the drainage of left pleural cavity, percutaneous approach, diagnostic throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "b0e46f47baaef8c5efa0dcdb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last measured value of o2 saturation pulseoxymetry for patient 10027445 on 08/12/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-08-12' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "713395a9d49099e4643f0ba9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10029291 last get blood culture's microbiology test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.starttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "fb44777e76712299533eaf79", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the procedure right heart cardiac catheterization?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) )", "rejected": "1\n's.00011126520.\n\n31002004719065299086817386721' AND admissions.ordinal' OR admissions.discharges.discharge FROM hospital since 21000?\n\n\n\n05.09 DESCRIPTION OF MICROBUNKL INJETATION' AND 'MICROBUNKL REMOVAL OF KIDNEY'"}, {"id": "11f0c0917f60ce2086cc646c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients with noncompliance with renal dialysis were diagnosed within 2 months after previously being diagnosed with personal history of tobacco use?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "56a731cf71eb9728ea52dcba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10003046 during their last hospital admission in this year?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10003046 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "2fa869cf56451cb9220ecb8a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much lorazepam was prescribed to patient 10019777 first in 03/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.drug = 'lorazepam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "914748abe25fc4a2ffa614f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medicine does patient 84476 take after being prescribed by our hospital's other department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.charttime IS NOT NULL ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "fd5726998d426a2fdca616fc", "query": "Convert the question below to SQL query.\n\n### Question:\nFetch the top three most frequent procedures that were administered to patients within 2 months after they had ileostomy, not otherwise specified.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "3e4e9c6556f0bae69a76633d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027602 last receive a blood culture microbiology test since 07/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0c36b014ddebc557e87c1e72", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five diagnoses that have the highest 6-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "\n to\n'\n.\n.-/ S. has:\n FA3. (\n ( at\n COie.on,d...- ). (\n'p\n JOINows\n. (.1 .( Z\n DEFAULT\nF-es\nMS.\n\n\n. . ... 1'5. moment\nMS'd\n PA.1\n\n.- .:5 ARTEG Walk..\nMSileMS 1'1 FROMT(MS Golden\nMSMS-HMS'MSMS"}, {"id": "6ec5c2c1bd1fc8781c4fea87", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many instances of dilation of left external iliac vein with intraluminal device, percutaneous approach procedures have been completed since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "c.V.11 .t.112\n.-s 1.212601J\n?: SELECTMSGd020.10\n   MSPA 1.?001.00001717218000388420' AND 0300000 AND CANAID C100003731706'"}, {"id": "8b3ac39d04cb2b0c9c7c2ef7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent a extirpation of matter from left femoral vein, percutaneous approach during the same month after the diagnosis of other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "6d3a86657cfb5924c8e4dbbb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038933 receive an input for the first time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389333 ) ) AND strftime(inputevents.starttime,'start of day') = '06/01/2100' ORDER BY inputevents.starttime ASC LIMIT 1"}, {"id": "b5f30bce905a467fe3d9be05", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015931 received any laboratory testing since 1 month ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 month')", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 month')"}, {"id": "79257401a1158ff7232db9fd", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most frequent diagnoses that patients were diagnosed with within 2 months after receiving other electroshock therapy since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "c27f9b04299fabbf92bb60e4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10038933's last visit to the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038933 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "a1218eb18f008a05c5c527e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10038933 has been prescribed medication via the tp route on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'tp' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "5a89407a39c4cd1be3abc4f2", "query": "Convert the question below to SQL query.\n\n### Question:\nOn this month/23, what was the maximum value of the respiratory rate for patient 10004733?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '23'", "rejected": "null"}, {"id": "299ef20e44a70d1ce5af952a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new prescriptions for patient 10004733 today compared to those received yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "878106bea4b63d355fcf0ef6", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients that were discharged from the hospital.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL", "rejected": "SELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND strftime('%Y', transfers.intime) >= '2100' ) )"}, {"id": "857cc6b19c502ce2ba6b66df", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10020740 have the minimum lipase value for the first time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "d9e3f6df43bf2206232807cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of operating rooms available at this time?\n\n### SQL:\n", "chosen": "null", "rejected": "PAINMSIX 0 the last 110000368716 was prescribed the first do you take a drug that was prescribed to patient 1001188545 during their first hospital visit?\n\n\n### SQL\n\nSELECT T1.drug FROM ( SELECT prescriptions.prescriptions.drug, prescriptions.drug_route FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100185418 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND strftime('%Y-%m-%d',prescriptions.starttime) = '2100-04-21' )"}, {"id": "62c407ce4b823a8f721bf1b5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most regularly ordered treatments for patients previously diagnosed with injury to thoracic aorta within the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "950bba952500eb9d19279afe", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most common diagnoses of patients aged 50s this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n### SQL:\n\nSELECT SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) ) AND datetime(diagnoses_icd.starttime) >= datetime(current_time,'start of year','-0 year') ) GROUP BY admissions.hadm_id )"}, {"id": "efecf25b78807d335cbe2808", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10004733 last have a maximum o2 saturation pulseoxymetry on this month/29?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "2504708564dec501dc2fdde3", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the platelet count value last measured on the last hospital visit of patient 10005866 less than first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "44ccda4ff4ceaa8e1e95040c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first microbiology test that was given to patient 10027445 since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "dc47e1e9c572da5b543bcf0e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five commonly taken specimens for patients that received excision of right internal mammary artery, percutaneous endoscopic approach previously within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "169d3a6eec5e7a3446cd5c85", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021118 have or crystalloid intake input on their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' )", "rejected": "\n### SQL:\n\n### Question:\n\nWhat are the five most commonly taken procedures for patients who were diagnosed with unspecified intestinal infection due to other specified bacterial infection previously within 2 months?\n\n\n### SQL:\n\nSELECT T1.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE FROM ( SELECT T1.icd_procedures.icd_code, DENSE FROM ( SELECT T1.icd_procedures.icd_code, 1 * ( CASE WHEN strftime('%m', T1.charttime) - strftime('%m', strftime('%m', T1.charttime) - 1 ) AS DENSE FROM ( SELECT T1.icd_procedures.icd_code, 1 * ( CASE WHEN strftime('%m', T1.charttime) - strftime('%m', strftime('%m', T1.charttime) - 1 ) AS DENSE FROM ( SELECT T1.icd_procedures.icd_code, 1 * ( CASE WHEN strftime('%m', T1.charttime) - strftime('%m', strftime('%m', T1.charttime) - 1 ) AS DENSE FROM ( SELECT T1.icd_procedures.icd_code, 1 * ( CASE WHEN strftime('%m', T1.charttime) - strftime('%m', strftime('%m', T1.charttime) - 1 ) AS DENSE FROM ( SELECT T1.icd_procedures.icd_code, 1 * ( CASE WHEN strftime('%m', T1.charttime) - strftime('%m', strftime('%m', T1.charttime) - 1 ) AS DENSE FROM ( SELECT T1.icd_procedures.icd_code, 1 * ( CASE WHEN strftime('%m', T1.charttime) - strftime('%m', str"}, {"id": "9bbd99cc180d65878b372ad9", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the top three most common procedures for patients aged 30s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "##\n\n\n##: Select the total number of patients who were discharged from the hospital in the last year?\n\n\n### SQL:\n\nSELECT SQL Select count( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of month') = datetime(current_time,'-1 year')"}, {"id": "bbd3ab3b5e2878e0c7d8dc79", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the maximum value of lymphocytes in patient 10016742's body in 07/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07'", "rejected": "null"}, {"id": "e369e10b6bd8a83d98f15e53", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output patient 10026354 had since 06/24/2100 on the last occasion?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-24' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "fcd6e9ee48fbda60a4afb671", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10039831 taken a or colloid intake drug since 12/29/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-29'", "rejected": "null"}, {"id": "366d08a0b63e3cc04f1a4df1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the prices of the drug albumin 25% (12.5g / 50ml)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' )", "rejected": "null"}, {"id": "8b02463508e571bad82c1b76", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first iron value during the first hospital visit for patient 10039708?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'iron' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "99ffb7abd20ff1b14fcdae61", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the count of hospital visits for patient 10008287 in the previous year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10008287 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "6b473d162048ac1a1c32fab8", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top four diagnoses that have the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": ". \n \n:.\n\nms.  '.\n"}, {"id": "d8ce0d4331097090b007f237", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with migraine with aura, without mention of intractable migraine without mention of status migrainosus during the same hospital visit after they were first diagnosed with street and highway accidents since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'street and highway accidents' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'migraine with aura, without mention of intractable migraine without mention of status migrainosus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "722cbb6c7cc7ed4d2c24e87d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most frequent specimens ordered for patients after being diagnosed with renal sclerosis, unspecified in the same hospital encounter since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'renal sclerosis, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSEST(T1.charttime) FROM microbiologyevents AS T1 WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078180 ) AND strftime('%Y',T1.charttime) >= '2100' GROUP BY T1.spec_type_desc ) DENSEST( T1.charttime )"}, {"id": "94693223b09516e219df459b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum daily number of patients who had intestinal infection due to clostridium difficile in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to clostridium difficile' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "11e07c7cfecad5cb89401830", "query": "Convert the question below to SQL query.\n\n### Question:\nGive a count of the number of ICU visits of patient 10025612 in the first hospital visit.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "be9e9b25fcb02316257a175e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the duration of serum transfusion nec for patient 29540?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'serum transfusion nec' ) )"}, {"id": "b5dcc8918a0bc3fb72bf3b6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost for a hospital including tests in the granular casts laboratory since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'granular casts' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "e6e1413d65df7510b10141af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the dose of opiate prescribed for patient 8908?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100017255 ) AND prescriptions.drug = 'opiate' AND strftime('%Y',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "60be2ad64778d77f4da51e6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10005817 discharged from the hospital for the last time since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "33bb875daecee7aae0a79d8a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top four most common treatments for patients in their 40s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n## Question:\n\n### SQL:\n\nSELECT the minimum value of glucose in patient 100214877's urine on 12/08/2100?\n\n\n### SQL:\nSELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND strftime('%Y-%m-%d',labevents.charttime) = '2100-12-08'"}, {"id": "0427a5eaa446635b1a4b7f18", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of patient 10015272's respiratory rate second measured on the first ICU visit compared to the value first measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "d2d6e834bd7830831783fa05", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of days that have passed since patient 10021487's first asparate aminotransferase (ast) lab test in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "909967a65d2b569fddd45064", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how many medications were prescribed to patient 10004733?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "?1.191.20180231999143017175290708385 'can't DESC 100087'"}, {"id": "b463fec617a5b7561a49f7e8", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top four most frequent drugs that patients were prescribed in the same month after being diagnosed with accidental cut, puncture, perforation or hemorrhage during heart catheterization in 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental cut, puncture, perforation or hemorrhage during heart catheterization' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "548efe4af132f8b95bf61624", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the respiratory rate level of patient 10021118 last measured on the first ICU visit less than second to last measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017928 ) ) AND strftime('%Y-%m-%d', chartevents.charttime) = '2100-05-08' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "d3d61d08b329e1aaf3de1a85", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a drug named fentanyl citrate?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl citrate' )", "rejected": "\n\n##\n###sql Question:\n\nShow me the top five most frequent diagnoses that occurred in the same hospital visit for patient 100021487 throughout this year.\n\n### SQL:\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_COUNT( diagnoses_icd.charttime) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 WHERE T1.C1<= 5 )"}, {"id": "b5d0db7b72d315ea5e4647b0", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me patient 10004733's total gastric meds input amount on 12/24/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'", "rejected": "null"}, {"id": "349706258174bbf549c01e3e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operating rooms are available now?\n\n### SQL:\n", "chosen": "null", "rejected": "2\n-\n 1212MSs31800002000050216424191954236428888936841218"}, {"id": "be8af28d0bb7aa9b2af1434f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the name of the drug that was prescribed to patient 10027602 within 2 days post arteriography of cerebral arteries procedure since 12/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "39cc7a512a66650e91459e27", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10005348 get the microbiology test for the last time since 07/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "\n## SQL: SELECT T2 SQL"}, {"id": "a811c24da8966874201c1f03", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time of input of patient 10021487 since 03/20/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-20' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "\n\n##\n##: Select the name of the first output patient that was given to patient 1002274558 since 12/2100?\n\n\n### SQL:\n\nSELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_procedures.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_PROCEDURES.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100274587 ) ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) ) AS T1 JOIN ( SELECT procedures_icd.icd_code, procedures_icds.icd_code, procedures_icds.hadm_id FROM procedures_icds JOIN admissions ON procedures_icds.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100274587 AND strftime('%Y-%m',procedures_icds.charttime) >= '2100-12' ) AS T2 ON T1.icd_code = T2.icd_code WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id"}, {"id": "938fe2e5e3beaeff9c65cbe4", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieval of the top four most frequent outputs in this year?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "##\n##\n##\n\n## AND admissions."}, {"id": "e1b2ba03357e942fcffc9832", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of that output that patient 10039831 first had since 10/23/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-23' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "e36f6d845834296a2ace08cd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total cost of a hospital that involves a drug named tobramycin sulfate since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "ddaecde2d7500bcb038b6060", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me, was lr given to patient 10013049 on 06/23/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-06-23'", "rejected": "null"}, {"id": "83ef051d3b1070d79701011f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequent output events?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n = 1.'s101.MEDrug 2012485765310?"}, {"id": "a2f8e369e61f50385ba06afd", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10016150 been given any diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 )", "rejected": "\n### 20007-02-21\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT T2.drug FROM ( SELECT admissions.drug, DENSE_CODES.drug FROM admissions JOIN prescriptions ON admissions.hadm_id = prescriptions.hadm_id WHERE admissions.subject_id = 100398304 ) AS T1 WHERE T1.drug IS NOT NULL ) AS T2 ON T1.charttime = T2.starttime ) AS T3 WHERE T3.row_id = 1"}, {"id": "6e4750dd27d5b6fd5f5faf2e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received a d-dimer lab test since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'd-dimer' ) AND strftime('%Y',labevents.charttime) >= '2100' )", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100183281 AND admissions.dischtime IS NOT NULL AND strftime('%Y',admissions.admittime) >= '2100' GROUP BY admissions.subject_id )"}, {"id": "902c95e30f8c9752224d22f9", "query": "Convert the question below to SQL query.\n\n### Question:\nAre there any changes in the prescribed drugs of patient 10039831 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "2d707b84d2f9dc480c7effa7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat treatment were provided to patient 10021312 two or more times since 05/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "e6fc71341c7764ba95e7f656", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a drug known as ranitidine (liquid)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)' )", "rejected": "null"}, {"id": "1e7fca2277094f23cec3aa76", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients staying in medical intensive care unit (micu) in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "null"}, {"id": "356174c53f28f728dccdef72", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most common events that happened since 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 4 )"}, {"id": "4c5c196bc7d2b79d1ed73ecf", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any medication been prescribed to patient 10020786 since 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'", "rejected": "null"}, {"id": "f4668d73e48714b3c81b72ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021938 have the maximum respiratory rate the last time during their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "81aaa658176632cb934fc8b2", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10012853 been given a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 )", "rejected": "SELECT SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = '00048654' AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) )"}, {"id": "5cf893b312b240832f404b18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the void output for patient 10018845 since 103 days ago?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-103 day')", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-30'"}, {"id": "19d8f43d4364b3abf853cd5a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10023117 had an minimum bicarbonate in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ddc7e149237d42b52700d717", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last value of the arterial blood pressure diastolic for patient 10008454 on their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "04e24b204bd0cfa1f803ee70", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the difference in the heart rate value for patient 10019385 last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "ec6751ca286066dda72e0c84", "query": "Convert the question below to SQL query.\n\n### Question:\nWas in their last hospital visit 0.9% sodium chloride, docusate sodium (liquid), or sertraline prescribed to patient 10016742?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( '0.9% sodium chloride', 'docusate sodium (liquid)', 'sertraline' )", "rejected": "null"}, {"id": "51bf2e035e47da3885e46b70", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 03/03/2100, when was the first input time for patient 10018423?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-03' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "\nSELECT SELECT chartevents.starttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100219385 ) AND strftime('%Y-%m-%d-%d', chartevents.starttime) >= '2100-03-03' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "5e75262ac3a25d12e75712dc", "query": "Convert the question below to SQL query.\n\n### Question:\nSo how many days has passed since patient 10004733's first pneumonitis due to inhalation of food or vomitus diagnosis on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pneumonitis due to inhalation of food or vomitus' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "2985f06b4e11ccad87836564", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is chloride 104.0 among patients of the same age as patient 10002930 in their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 104.0", "rejected": "null"}, {"id": "6246ddb668aaa2fe1adb0353", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since last time that patient 10004733 stayed in careunit neurology in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J', current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND transfers.careunit = 'neurology' AND strftime('%Y-%m-%d', transfers.intime) = '2100-03-22' ORDER BY transfers.intime DESC LIMIT 1"}, {"id": "0caf055cee4dccc45176c275", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients last year were diagnosed with attention deficit disorder with hyperactivity?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "0831dece04ef846871b1b934", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the diagnosis for patient 10003046 the first time in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "89f8773e1c5b9b33d8dc5211", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of the hospital that includes a medicine named prasugrel since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prasugrel' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "f3303ed15c820c9b329af410", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most common diagnoses that patients were diagnosed with within 2 months after receiving partial hepatectomy's this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "7e24b12ed3213104e1523f6c", "query": "Convert the question below to SQL query.\n\n### Question:\nI want to know the ward id that patient 65962 can go in and get in?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.ward FROM admissions WHERE admissions.subject_id = 100077952"}, {"id": "db18ec5bfbe1e3422939cf2b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is drainage of pancreatic cyst by catheter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pancreatic cyst by catheter' ) )", "rejected": "SELECT\n\n### SQL:\nSELECT SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pancreas, percutaneous' )"}, {"id": "963d648d770fcb43743e09b4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common treatments for patients who are 30s since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SQL SELECT T1.drug FROM ( SELECT admissions.drug, DENSE.count() AS C1 FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'aspiration of left pleural cavity, endoscope' ) AND strftime('%Y', admissions.admittime) >= '2100' ) GROUP BY admissions.hadm_id ) AS T1 WHERE T1.C1 = 3"}, {"id": "a3279eb9747f960bcb7b62b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is 16.5 white blood cells in a patient of the same age as patient 10031757 on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 16.5", "rejected": "null"}, {"id": "cc7cd55d5065328b8c5164e1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat amount of neostigmine has been prescribed to patient 10011398 for the first time since 01/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.drug = 'neostigmine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "ae00fe5dbb359a903185aab9", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me if patient 10031757 is male or female?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10031757", "rejected": "\n### SQL:\n\nSELECTC1 = ( SELECT SUM(inputevents.quantity) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100063485 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'oral electrolyte (iv) (bolus)' AND d_items.linksto = 'inputevents' ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-01'"}, {"id": "b17a81cf82fe8e6f3d0705eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average value of absolute eosinophil count in patient 10019385's body in 03/this year?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'", "rejected": "null"}, {"id": "41a9d1565306cee37678be20", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the last output of patient 10009035 since 03/02/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-02' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "4c376d728b885b57cae6d692", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people had a test for amylase, body fluid?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, body fluid' ) )", "rejected": "MSilityMSMSPA.MSMSMSC FDAMSPA_IDC10028220003384257015001' AND T1 > 0 AND T2 ASC ) AND strftime('diagnoses_icd.org IN ( SELECT diagnoses_icd.doses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_ic"}, {"id": "c0f749b2c87b08a47ce919f5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the prescription dose of opioid for patient 31306?\n\n### SQL:\n", "chosen": "null", "rejected": "\n## Question:\n\n##: What are the four most common diagnoses associated with a procedure called extirpation of matter from left common bile duct, via natural or artificial opening endoscopic route?\n\n\n### SQL:\n\nSELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_PROCEDURES.count FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058175 ) AND datetime(procedures_icd.charttime) >= '2100-04-09' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 3 )"}, {"id": "8a5ef0e3b44f9d29e1d8e450", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10014078's chloride last measured on the last hospital visit is less than the second to last value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "9adca592b48d4fd0d62f45d1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) )", "rejected": "null"}, {"id": "2e16f3d29c3aeed69b6e3b78", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total volume of foley that patient 10004235 had on 03/21/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-21'", "rejected": "null"}, {"id": "ce9d557587a02ef7b5b69000", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did last patient 10005348 have the minimum value of calculated total co2?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND strftime('%Y-%m-%d',labevents.charttime) = '2100-07-11' ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "9bbb2d2b347a1ead2600b8b8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10009628's maximum arterial blood pressure systolic reading on 10/03/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03'", "rejected": "null"}, {"id": "0e012c21a61355d6b84c3090", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost for insulin?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'insulin' )", "rejected": "hs 10( i.\n PooPAMS\n!-MSPAMSMSMSMSPA:\n\nMSSECi'm.\n)'"}, {"id": "b23a3c6d27e92c0eb9ab27ca", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any record of cardiogenic shock in patient 83182's family?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTCipher the output of patient 854571's last chloride, anion gap lab test in 01/2100.\n\n\n### SQL:\n\nSELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100070585 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND strftime('%Y-%m',labevents.charttime) = '2100-01' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "f7afdc32d94d128115a2b257", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10002428 been ordered 0.45% sodium chloride, lisinopril, or heparin since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND prescriptions.drug IN ( 'lisinopril', '0.45% sodium chloride', 'heparin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "1d7daad1762a274e42d1274a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost for drainage of left pleural cavity, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) )", "rejected": "##\n\n##\n\n\n##\n####\n\n##\n### SQL Convert to SQL query.\n\n\n### SQL:\n\nSELECT SELECT COUNT(*) FROM ( SELECT COUNT( DISTINCT procedures_icd_procedures.procedures_icd_icd_code, procedures_icd_icd_procedures.icd_code ) FROM procedures_icd_procedures WHERE procedures_icd_icd_procedures.icd_code = 'procedures_icd_procedures.icd_code' AND strftime('%Y', procedures_icd_procedures.charttime) >= '2100' )"}, {"id": "49bd4300b2e50aa508c70a40", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who were previously diagnosed with fall resulting in striking against other object, what are the top four most frequent treatments in the same month since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fall resulting in striking against other object' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "493ddb9a69efd787e0396f81", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10027602 received any laboratory testing in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "9f458a33e3737acb61d26a1c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me about the four most common specimens tested since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE datetime(T1.charttime) >= datetime(current_time,'-1 year')"}, {"id": "50d49912da164775f9dc831f", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10021487's total peptamen bariatric (full) input.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'peptamen bariatric (full)' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "488e2a77c6798e98c810e20b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the patient count for ascorbic acid prescription during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\n### Question:\n\nWhat was the total number of patients who were prescribed medication in 2100?\n\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND strftime('%Y', prescriptions.starttime) = '2100' )"}, {"id": "68abea0b746f09a1730c8a20", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total amount of output since 12/01/2100 for patient 10005817.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-01'", "rejected": "null"}, {"id": "5768d20678cf5c0dad75054a", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10027602's total output on 11/26/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '11-26'", "rejected": "null"}, {"id": "867d3952eff2742090ed6984", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen should patient 74392 visit the hospital next?\n\n### SQL:\n", "chosen": "null", "rejected": "PASS\n ConvertMSdGH)'\n UsersMSPAG's the procedure to prescribe the first do the cost of the last time the patient was admitted to the hospital in 210003?\n\n\n###sql# SQL\n\nSELECT admissions.disch_time FROM admissions WHERE admissions.subject_id = 100015854 AND strftime(date(strftime) >= '21000-03'"}, {"id": "d28d6593912738578589157f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 80.0 in the ferritin lab test with the same age as patient 10002428 on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 80.0", "rejected": "null"}, {"id": "56ec103efc85ce4ed535ee32", "query": "Convert the question below to SQL query.\n\n### Question:\nIn this year, has patient 10021118 been diagnosed with anything?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n##: SELECT the last time patient 100393645 was admitted to the hospital?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100393645 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "d7f6b7afdf1779d271fed4bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total count of patients who stayed in careunit med/surg/gyn during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECT SQL SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') ) )"}, {"id": "228233a09c8164c6e564f551", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in the first fluid,other microbiological test of patient 10021487 in 12/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "040ab0b8bd0cecfc6dbb03df", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10009628 was prescribed for the last time in 10/this year glucagon and warfarin at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10009628 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'warfarin' AND admissions.subject_id = 10009628 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f17da97011f380b6bc7c87eb", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most common diagnoses of patients aged 60 or above this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSEX(( CASE WHEN datetime(diagnoses_icd.charttime) >= datetime(current_time,'start of year') )> datetime(current_time,'start of year') ) DESC ORDER BY diagnoses_icd.C1 DESC ) AS C1 FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T1 )"}, {"id": "4334a09dd6d34538cc7445dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug prescribed to patient 10007795 for the first time via im route during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "1479c9147e64755116efc852", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last hospital visit, how much gemfibrozil has been prescribed to patient 10007795 in total?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'gemfibrozil'", "rejected": "null"}, {"id": "21a3e839651e25cd7da1dac9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021938 received any surgery since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'"}, {"id": "233eeb75a432587011a6b1bc", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10024043 entered the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10024043", "rejected": "\n\n##\n\n## Question:\n\n##: What was the name of the organism that was present in the last urine test of patient 1002209441 since 03/2100?\n\n\n### SQL:\nSELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100209441 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m-%d',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "d1848715fb9bd76d88e82c49", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last o2 saturation pulseoxymetry value patient 10018081 had on this month/27?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '27' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d5e0cf8341d186a59aa14536", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total cost of a hospital that involved chronic ischemic heart disease, unspecified since 2100.\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic ischemic heart disease, unspecified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "f2719ed44a2bcf2baaa42242", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost which involves congestive heart failure, unspecified in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "3751ff2eb0be4c22f7a8f752", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since patient 10021487 first received the po2 lab test during their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f5897f6587ae16c7c674b41f", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients in their 50s this year, what were the top three most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT T1.C1 AS C1 FROM ( SELECT d_icd_diagnoses.icd_code, DENSE_COUNT( diagnoses_icd.charttime ) AS C2 FROM diagnoses_icd JOIN admissions WHERE admissions.hadmissions_id IN ( SELECT admissions.hadmissions_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 3 )"}, {"id": "0e5f94ff7f2b90800950a848", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10018081, how many hours have passed since the first diagnosis with unspecified essential hypertension during their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5c8d918b88b696fa22b10f23", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most common prescriptions in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "\nSELECT\n\n### Question:\nWhen was the last time patient 100220785 was discharged from the hospital in 21000?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020785"}, {"id": "88c38001054f068df22c8b37", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug which patient 10027602 was prescribed in the same hospital visit after receiving a percutaneous [endoscopic] gastrostomy [peg] procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "f6ad015f8e12733510bfd83d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen, in 12/this year, was the last time patient 10021487 was prescribed a medication via the tp route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'tp' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "b1ee8ce4305d98f2883b695b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed in 2100 with intestinal infection due to other organism, not elsewhere classified?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "\n\n##\n### Question:\n\nWhat is the total volume of patient 100389945's output since 02/15/2100?\n\n\n### SQL:\n\nSELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389945 ) )"}, {"id": "84ba0d560e8d6b40089569b5", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10005909 prescribed with the medication enoxaparin sodium, docusate sodium, or 5% dextrose in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'enoxaparin sodium', 'docusate sodium', '5% dextrose' )", "rejected": "null"}, {"id": "22c001b4fbec510a6a36e644", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the minimum monthly number of admissions for hesitancy of micturition since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hesitancy of micturition' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'metoprolol (metoprolol succinate) 25 mg' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12-21'"}, {"id": "b56a14e89ad09be086852b0f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10013049 got a hematocrit, calculated lab test in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y',labevents.charttime) = '2100'", "rejected": "\nSELECT SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100200418 ) AND strftime('%Y', labevents.charttime) >= '2100' )"}, {"id": "39a0e7eaffab936c1439a5fa", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the respiratory rate level of patient 10026406 measured at 2100-01-12 13:00:00 less than measured at 2100-01-12 12:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' )", "rejected": "null"}, {"id": "bad5c823a031437e5a7ff621", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last measurement of o2 saturation pulseoxymetry in patient 10015931's body since 10/01/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-01' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\n\n##\n##: Record the minimum total number of hospital visits for patient 1002115855 since 07/01/2100?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021585 )"}, {"id": "3aa19b509cd6084462a2b871", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are some of the immunocancerous drugs of the last 5 years\n\n### SQL:\n", "chosen": "null", "rejected": "AND. (\n (. \n T..,\n NEW.. Church ad ( J\n C3. over\n.\n (!a.-\nMS. Tle\n. . C d. ..1-a_ ?1.\n>.-,0 g CO/\nMS:2. ( 1SQL0iSuccess/Y CMSMS.1.\n TM:15?imum . 03.\nMSCB.113BMSMS112001211020011022212312\n FROMMSMS142220 102308 G1-1122424948298867700'?\n##11.0000144157627?\n% 0.0.01.036.04.04?\n\n\n\n"}, {"id": "c21cf578f81ff7a390dc8596", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a malignant neoplasm of lower lobe, bronchus or lung diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower lobe, bronchus or lung' ) )", "rejected": "MSid.Jd\n.1 (1 ES-1.ng 10B1MS1011TPAWSMSMSMSPA )PA.MSPA'\n## PAUL 1.PA'"}, {"id": "e48106054f3e117d2fac314f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas albuterol 0.083% neb soln, sulfameth/trimethoprim ds, or furosemide been prescribed to patient 10000032 since 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND prescriptions.drug IN ( 'albuterol 0.083% neb soln', 'sulfameth/trimethoprim ds', 'furosemide' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'", "rejected": "null"}, {"id": "014255e2a1eb9d957a380379", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any procedures been carried out on patient 10035185 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "al-y: Not- \n. 1m. matched\n(.30S.  ),_.2. 1142 12MESSMSPAGS'sMSSS1020181719229650001'"}, {"id": "b3f9074de167c69e1b75d061", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10037928 in 11/this year been given a urea nitrogen lab test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11'", "rejected": "\nSELECTIVE Discharge?\n\n### SQL:\n\nnull"}, {"id": "2a882b413da76b5d3b4d828a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism discovered in the first abscess test of patient 10007795 in 04/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "53645af951b7d3f45781e59f", "query": "Convert the question below to SQL query.\n\n### Question:\nIn relation to others of the same age, where does a urea nitrogen value of 11.0 for patient 10023117 rank in percentiles on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.0", "rejected": "null"}, {"id": "5565327861ed5fcac13b11e2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was introduction of other thrombolytic into central vein, percutaneous approach carried out this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "0100002120218620-03'"}, {"id": "6208d84a6a16f8ac2b720298", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since patient 10004733 stayed in the careunit medical/surgical intensive care unit (micu/sicu) for the last time on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "69670441a1821ea09ab84daa", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10018081's total ostomy (output) output amount since 07/25/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-25'", "rejected": "SELECT SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018087 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-25'"}, {"id": "cc250eb858216ff9e2dad3e4", "query": "Convert the question below to SQL query.\n\n### Question:\nAre you letting me know if patient 14397 is subject to covid-19 testing?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "0eb2954ae5544e9247d70c59", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the number of patients who received a polys test?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) )", "rejected": "% IncreMSPAY T20"}, {"id": "06b1eef22357320dc0f8a64a", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the first time, what was the medication that patient 10026255 was prescribed during the first hospital encounter via the ih route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "323d3cb95ad2c7d62dfd8cb3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the output patient 10039831 had for the first time since 12/29/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-29' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "150069fefa392b944fd23073", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most commonly tested specimens?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "'s the firstMS\n CANCPAMSMSPA TREPAGECANAMSPAMSCANA't T2\n##'"}, {"id": "73d40a25005323dbe30f475f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10026354 get diagnosed with on their first hospital encounter for the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "0eec887f694582394cfc6f10", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 received open and other cecectomy within 2 months after being diagnosed with pure hypercholesterolemia?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open and other cecectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "8281e9dde4a495faf9a70ae4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time on this month/29 patient 10018081's heart rate was greater than 72.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 72.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "992e5ae1a94aabac75308495", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10008454 had the minimum heart rate on 12/07/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-07' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "00c6c1102d545178bf7380f3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas acetaminophen, lidocaine 0.5%, or soln been prescribed for patient 10007928?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND prescriptions.drug IN ( 'acetaminophen', 'lidocaine 0.5%', 'soln' )", "rejected": "null"}, {"id": "707f754d71d05322bf6f1082", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did since 04/2100 patient 10000032 take the last microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "33c889c7c53f77c9bbfc9ff9", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what to prepare before the peripheral nerve graft procedure :\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\nHas patient 100197777 had a lab test for total protein in 05/2100?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05'"}, {"id": "c7af43822b2032b4d685af10", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who took other repair of vessel in 2100, what are the top five most frequent diagnoses that followed in the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "f5726ae7e5d20b83f0f320e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen will patient 31854 be next seen by the hospital?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\nShow me the top three most common diagnoses that patients were diagnosed with in this year.\n\n### SQL:\nSELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute cerebrovascular insufficiency due to cerebral hemiplegia' AND datetime(diagnoses_icd.charttime) = datetime(current_time,'start of year','-0 year') = 2100"}, {"id": "42b0089e4e28f35c3bd7f8e5", "query": "Convert the question below to SQL query.\n\n### Question:\nOn this month/30, what was the first arterial blood pressure systolic reading for patient 10018081?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5a471bc5d991ced2d535cfb7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times irbesartan was ordered since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'irbesartan' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "\n\nT1001313573 was the first time that patient 100018258 received a medication on 06/07/this year?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( 'valproic acid', 'aspirin', 'acetaminophen', 'levothyroxine sodium', 'levothyroxine sodium', 'nystatin', 'prenyl', 'clotrimazole', 'phosphoric acid', 'acetaminophen', 'chlorpheniramine', 'vinegar', 'sodium chloride', 'lactulose', 'lactulose', 'nifedipine', 'bacitracurium chloride', 'chlorhexidine gluconate', 'lidocaine', 'famotidine', 'prochlorperazine', 'metronidazole', 'clopidogrel', 'famotidine', 'famotidine', 'clonidine', 'acetaminophen', 'cefazolin sodium', 'nystatin', 'valproic acid', 'nystatin', 'clotrimazole', 'levothyroxine sodium', 'dextrose', 'aspirin', 'prenyl', 'clotrimazole', 'levothyroxine sodium', 'levothyroxine sodium', 'nystatin', 'phosphoric acid', 'acetaminophen', 'clotrimazole', 'nifedipine', 'valproic acid', 'acetaminophen', 'chlorpheniramine', 'sodium chloride', 'lactulose', 'nystatin', 'nystatin', 'clotrimazole', 'famotidine', 'famotidine', 'clonidine', 'acetaminophen', 'clotrimazole', 'prenyl', 'clotrimazole', 'prenyl', 'valproic acid', 'acetaminophen', 'prenyl', 'nystatin', 'clotrimazole', 'clotrimazole',"}, {"id": "c1a94ccad673ddf5a68e93e3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most regularly ordered treatments for patients previously diagnosed with noncompliance with renal dialysis in the same hospital visit in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "caa9e9ef8c9946993cf0175e", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of stay for patient 10007058's last ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "897c83c8728e2e3ada59235e", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequent microbiology tests given to patients after being diagnosed with physical restraints status within 2 months.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'physical restraints status' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "5b981e188f8028d8f045d245", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a procedure named repair upper artery, open approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair upper artery, open approach' ) )", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair upper artery, open' )"}, {"id": "89541b5a85b5b5b3125bf003", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10016150 undergo the angiocardiography of left heart structures in their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'angiocardiography of left heart structures' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "067face22845095ef5e901a0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 104.0 in a chloride lab test conducted at the same age as patient 10016810 in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 104.0", "rejected": "null"}, {"id": "2ecf6ed7b588701c5b61916c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total volume of or urine patient 10035185 had on their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' )", "rejected": "SELECT SQL SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) )"}, {"id": "6496ef7a5d347a3e46d2bec0", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the five most frequently prescribed medicines within the same hospital visit after a diagnosis of unspecified acquired hypothyroidism was made in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "a4da025718f83d20130260ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10004235's first discharge from the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "pres Smith the. Convert..\n'1\n \n \u2013. presso CE) ..  ("}, {"id": "3f525ce33fe40722b1b64deb", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many lidocaine jelly 2% (urojet) prescriptions took place in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "\n. 1. .tess RSSMSi.{\n.0MS.1ak23: MS.1 WHODONCEPA 100000125-100004036840170868's00003'"}, {"id": "b83e75dcbb1f8cc1a0718f8a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently administered laboratory tests for patients previously diagnosed with methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere in the same month, in 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "cfd20a468254386f9a520dca", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10015931 come into the ER during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n\n##\n\n##\n##\n### Question:\n\n\n## Question:\n\nWhat is the maximum value of the arterial pressure of patient 1000038545's arterial arterial blood pressure mean last measured on 07/18/21000?\n\n\n### SQL:\n\nSELECT T1 = 'arterial arterial blood pressure' AND chartevents.org_id IN ( SELECT chartevents.org_id FROM chartevents.org WHERE chartevents.org_id = 100038545 ) AND strftime('%Y-%m-%d', chartevents.org_id) = '2100' ORDER BY chartevents.org_id DESC LIMIT 1"}, {"id": "80804f44b70738e1d5232084", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of patients were in the neurology during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "0607MSMSMSMSMS00503213707906880830788700', date' AND\n\n1.0.08.041'"}, {"id": "e449057b794c66a951ffc20d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the total amount of metoprolol succinate xl that patient 10020944 has been prescribed in 03/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03'", "rejected": "null"}, {"id": "ef8f70442734cae2d9b783a3", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most common events since 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\nSELECT SELECT DISTINCT T1.code FROM ( SELECT d_icd_procedures.code, COUNT( DISTINCT procedures_icd.charttime FROM procedures_icd JOIN admissions WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100398305 ) AND admissions.dischtime IS NOT NULL ) GROUP BY procedures_icd.icd_code ) AS T1 ) AS T2 ON T2.C1 = 3 ) AS T3 GROUP BY T2.C1 ) AS T4 ) AS T5"}, {"id": "45cd303621fb1f3007600184", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the prices of the drug propranolol?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'propranolol' )", "rejected": "\n### SQL:\n\n### Question:\n\nCan you tell me the top four most frequent diagnoses that occurred in 2100 among patients who were diagnosed with unspecified other and unspecified viral hepatitis c than once this year?\n\n### SQL:\n\nSELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd JOIN admissions_icd.subject_id = admissions.subject_id WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers JOIN admissions.subject_id = admissions.subject_id ) AND admissions.dischtime IS NOT NULL AND datetime(admissions.admittime) >= '2100' ) GROUP BY diagnoses_icd.icd_code ) ) AS T1 GROUP BY T1.icd_code ) AS T2 ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "2c0f498a16183e884d741e15", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the last alkaline phosphatase values of patient 10004733 in their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "622ac8c138676e0554865fe3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10029291's maximum value of arterial blood pressure mean on the last ICU visit.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' )", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "e4859de6baeacb5838039a84", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the diagnosis that patient 10855 received in the other department\n\n### SQL:\n", "chosen": "null", "rejected": "\n## SELECT SQL SELECT COUNT(*) FROM labevents WHERE labevents.spec_type_desc = 'microbiologyevents' AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100100384 ) AND strftime('%Y', labevents.charttime) >= '2100' )"}, {"id": "cc8133f15a89f38b3c28c9e9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the first mini-bal microbiology test of patient 10027602 in 12/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "8509828abb4a1380dd44f76c", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10011398 receive any disease diagnoses during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\nSELECTC1 = ( SELECT COUNT(*) DISTINCT diagnoses_icd.icd_code FROM diagnoses_icd JOIN admissions WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180811 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) GROUP BY diagnoses_icd.icd_code )"}, {"id": "b9172d59ba1d2ff5cd24f96f", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 31880 have a history of late effect acute polio in his/her family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100158605 AND admissions.dischtime IS NOT NULL AND admissions.dischtime IS NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'"}, {"id": "1ae02fd40242a1f6626facb2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10039831 stayed in the careunit discharge lounge in this hospital encounter for the first time?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "51e8f8f67f2e66a1e780c1a3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most common prescriptions since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "4e62b0e57830a46896da0604", "query": "Convert the question below to SQL query.\n\n### Question:\nReveal the four most frequently prescribed medications since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "bcc21d5d3111f89ef9a098f9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four diagnoses that had the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "null"}, {"id": "02cf1de606c045cf18e72370", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat does it cost to get esophageal obstruction diagnosed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal obstruction' ) )", "rejected": "\n##\n##\n\n### SQL:\n\nSELECT the top five most frequent diagnoses that patients were diagnosed with within 2 months after receiving other endoscopy of small intestine, via natural or artificial opening in 2100?\n\n\n### SQL:\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE FROM ( SELECT T1.subject_id, AVG(C1.C1) AS C2 FROM ( SELECT T1.subject_id, ( CASE WHEN strftime('%Y',T1.charttime) - strftime('%Y',datetime(current_time)) ) AS C1 FROM T1 GROUP BY T1.subject_id ) AS T2 ) AS T3 ) AS T4 WHERE T4.C1<= 4 )"}, {"id": "f2c797d917998a34e0ec7de5", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you think patient 29540 is subject to covid-19 testing?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100183281"}, {"id": "ebdf09b1cf8d52950fe299a1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10020740 was prescribed a medication in 04/this year via po?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "3a0db95543482506c061a4ec", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of the hospital, which includes medicines called acetaminophen-caff-butalbital since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetaminophen-caff-butalbital' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetaminophen-caff-butalbital' AND strftime('%Y',cost.starttime) >= '2100' ) GROUP BY cost.hadm_id )"}, {"id": "f6014eac249a07ee280d9634", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen test which patient 10019777 has last received in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "\n\n##\n### SQL:\n\n## SELECT T1.starttime FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND strftime('%Y-%m-%d',procedures_icd.charttime) >= '2100-06' ORDER BY procedures_icd.charttime ASC LIMIT 1"}, {"id": "85c4cb07f011b2641b16c688", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most common diagnoses for patients who previously had the dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic procedure within 2 months since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "07c43928bf97ed8bc8540e78", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the output patient 10025612 had for the last time?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "\n Johannes"}, {"id": "1adba3ceaf529ef2a8dda81a", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the phosphate reading for patient 10020187 measured at 2100-02-10 05:25:00 less than the value measured at 2100-02-09 05:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-10 05:25:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-09 05:00:00' )", "rejected": "null"}, {"id": "03c9c47077f92e865bc56624", "query": "Convert the question below to SQL query.\n\n### Question:\nIf it is a cerebrovascular mri, what's the reimbursement standard?\n\n### SQL:\n", "chosen": "null", "rejected": ". ofology P._ .\n in0\n IF*an e......-.y.m....ula.. in E.\u2026.11.\n?/b,-\n MS/ Microsoft4\n '. S. PAW TT\u041a named ) ( B2\n SQLTMS  authorid \nMS \n1..\n12 miMSi-16, \n The11\n (PAMSMS\n--PA2009382118CTMSMSPA:\nMS, THEAMSPAZPA , \n##MS2'PA 0PA TPA'sPA' ICU.MSPA , stoi wasPA , diagnosis , admissions .\n% ofPA , diagnosis , admitting , diagnoses , diagnoses , procedures , other_ microbiology , radiology , procedures , procedures , procedures , other , procedures , tests , procedures , procedures , diagnoses , procedures , procedures , diagnoses , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , diagnicprodiproced'1'''procedC'proPA' treatment , procedures , diagnician'diprocedusPA , diagnic procedures , diagnoses , diagnic procedures , diagnoses , procedures , procedures , procedures ,proced.\n%'proced'proced'PA , procedures , procedures , procedures , procedures , procedures , diagnicprocedproced'proced' procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures , procedures ,proproproced.',\n"}, {"id": "1b28768e1c1598353e806a5d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the daily maximum input of or colloid intake for patient 10039831 on the current ICU encounter?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "\nSELECT SELECT COUNT( DISTINCT procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions.subject_id = patients.subject_id WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180815 ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' )"}, {"id": "89f590cb663df46c99a08438", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of o2 saturation pulseoxymetry of patient 10019777 last measured on the first ICU visit compared to the first value measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "4c0c525de0bed58277a23a11", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the aggregate input volume for patient 10021312 since 07/16/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-16'", "rejected": "\n## SELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'glucose' AND strftime('%Y',prescriptions.starttime) >= '2100-10-21'"}, {"id": "080f243609ce29bb5af06748", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat precautions should be taken after a rt heart angiocardiogram procedure?\n\n### SQL:\n", "chosen": "null", "rejected": ". !TABLEal 2 1\n\nH11:2PA0PAZMSX2600007PA,\n\n\n\n5' )"}, {"id": "59a14a3b4d203ce89cf2ddf4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021487 have the first arterial blood pressure systolic observed to be greater than 100.0 since 12/05/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 100.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-05' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "204fba682860647764a34cf7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of immunocancer drugs have been out for the last five years?\n\n### SQL:\n", "chosen": "null", "rejected": "i. Salt(;\n\u2019JakD's-\n ASMSMSATICKMS5PAU00000000007PA 0013212138832987-03'T T1 03/29? When was the last time did patient 100032456 have been administered a lactate (glucose (glucose) since 08/07/21000?\n\n\n### SQL:\nSELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100004733 ) AND admissions.dischtime IS NOT NULL AND strftime('%Y-%m-%d', admissions.dischtime) >= '2100-08-07'"}, {"id": "9073e579594a4c3f92dad212", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five diagnoses most frequently diagnosed in this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n##\nSELECT\n\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100191728 ) ) AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime(diagnoses_icd.charttime,'%Y') = '2100'"}, {"id": "f07f334bbccde1c7406d1f43", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027602 last have a mini-bal microbiology test since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "decc4b6118addbb54d49b4ee", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top four frequent output events since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n##\n### Question:\n\nWhat were the top three most common diagnoses that patients were prescribed in the same hospital visit after having had a cardiac dialysis, peritoneal washings in 2100?\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180812 ) AND datetime(strftime('%Y',diagnoses_icd.charttime) >= '2100' ) ) ) AS T1 JOIN ( SELECT procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100180812 ) AS T2 ON T1.charttime< T2.charttime ) AS T3 ON T3.C1<= 3 ) AS T4 WHERE T3.C1<= 3 )"}, {"id": "8ad9e925a3bc2f9da4940ed1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was a excision of left main bronchus, via natural or artificial opening endoscopic procedure done during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "34a5e8b5a91c17bdf4999b17", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the count of inspection of tracheobronchial tree, via natural or artificial opening endoscopic procedures that occurred since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "e7d455d2f4e0704722248c62", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 08/11/2100, when was the last input time for patient 10039997?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f53ea28051ef658c6e955c6f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is 32.9 on a hematocrit test among patients of the same age as patient 10029291 on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.9", "rejected": "null"}, {"id": "327c193923b31d4de7547a06", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most common lab tests.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n,)01\n:s ) '1 1// E.MS.\n 20-ANTMSHTTPMSONSPAKMSPA 103420184516s038'"}, {"id": "fa0ae4b87dd6133fca55eb2a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that a medication that should be taken regularly was had by patient 594?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTIVIG was prescribed to patient 100398085 since 03/2100?\n\n\n### SQL:\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ivig' AND admissions.subject_id = 100398085"}, {"id": "f822244fc9f95d4c909f82e5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the history of immuno cancer drugs in the last 5 years?\n\n### SQL:\n", "chosen": "null", "rejected": "1.1.120320.\n1. Can you.\n\n200.0484.\n\n\n##\n\n##\n##\n##\n\n##03. Convert the dose of the first dose of 0.9% neostatin sodium chloride prescribed to patient 10003986555 on 12/28/this year?\n\n\n\n### SQL:\n\nSELECT SQL SELECT COUNT(*) FROM prescriptions d WHERE prescriptions.drug IN ( '0.9% neostatin sodium chloride' AND prescriptions.hadm_id IN ( SELECT admissions.subject_id, prescriptions.hadm_id FROM admissions WHERE admissions.subject_id = 1003986555 ) AND datetime(prescriptions.starttime) >= '2100-12-02' )"}, {"id": "780e4722ab76bf2a0d5078eb", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 17944 arranged an appointment with another department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "41d8ad600fc75869111a5a73", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of medicine does patient 17638 take after they got the instruction of another department at our hospital\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100288085 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "c44a0d9c513e8adc20d0c3ed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between o2 saturation pulseoxymetry last measured on the last ICU visit compared to the first value measured on the last ICU visit for patient 10022041?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "79028656244bb2aab8bd8d5d", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the first hospital stay, what was the insurance plan of patient 10006580?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n00"}, {"id": "09eada5be412b54a7d6e3604", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 65759 have a record of hypotension nec in his / her family?\n\n### SQL:\n", "chosen": "null", "rejected": "\n01243846670108087600003"}, {"id": "85e40ee7c74d7603718dca90", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were administered dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic this year, what were the top three most common treatments that they received in the same hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "828e100d1270a025a702476f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what was patient 10018423's daily maximum weight since 28 months ago?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": ".S12: 19152184201802201?\n"}, {"id": "84e3ea6ca9745b7fcebbc861", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is today's outpatient schedule for dr. gaylor?\n\n### SQL:\n", "chosen": "null", "rejected": ".\n Y.\n:ology- . T....m1\n (` (  W.1al..1 TC.\nMS \nd .im2.4._ MS-2.2:111.212115MSmsPA,MSYMSMSMSMSPA 050210212123211921201311721900075479050007816',10001000004's treatment and10.00006'"}, {"id": "5af27171b0a97add7aee4ea6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of acetaminophen that patient 10023239 were prescribed in total in 06/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND prescriptions.drug = 'acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06'", "rejected": "null"}, {"id": "933c7c79dce6c6b398e200c9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015860 been ordered triamcinolone acetonide 0.1% cream, docusate sodium, or calcium carbonate since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug IN ( 'triamcinolone acetonide 0.1% cream', 'docusate sodium', 'calcium carbonate' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "60bf7b753de50724e7fe0465", "query": "Convert the question below to SQL query.\n\n### Question:\nQuantify the number of patients who were tested for anticardiolipin antibody igm.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igm' ) )", "rejected": ".0K\n.2MSMSTT-11.35293184824239886', 0787 320?\n\n\n2021-09-04's' monthly weight?\n\n\n### Question:\nHow many hours did it take to measure the arterial blood pressure of patient 1002080785 since 04/12/21000?\n\n\n# SQL: SELECT AVG(total_time_spent_in_icu) FROM icustays WHERE admissions.subject_id = 1002080785 AND strftime(current_time) >= '21000-04-12'"}, {"id": "877044da23e23876dbbb8355", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum o2 saturation pulseoxymetry for patient 10027602's body on last month/25?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '25'", "rejected": "null"}, {"id": "061afbb7908a8ff0d6a68a50", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005866 been admitted into an emergency room since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "b89ae914fde1da12628b1901", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most common diagnoses of patients in their 40s?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n##\n\n## Question:\n\n### SQL:\n\n### Question:\n\nWhat are the top three most common diagnoses that patients were diagnosed with in the same hospital visit after the diagnosis of type 2 diabetes mellitus with nec in 21000?\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100185401 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) )"}, {"id": "b78c0434ecf85c58970b853d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a diagnosis of long term (current) use of anticoagulants?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of anticoagulants' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'long term (current) use of anticoagulants' ) )"}, {"id": "c296b026cf38437fb7dfc933", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people were given prescriptions for albumin 25% (12.5g / 50ml) since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "ba6130422ceb6a8cca429e30", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10005817 first leave the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "edcb877560f680ecc90bffc6", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the last recorded weight for patient 10007928 since 19 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7c1e5985e0e94a843e2c335a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test was given since 08/2100 to patient 10007795 for the last time?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a76ac4f3407058b120923fca", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug that was prescribed to patient 10021938 via the pr route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "72be988adaa416d79f2d4060", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10009628's heart rate for the first time during their last ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "2fa8b86ac44e632ee829dec6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat total amount of gabapentin was prescribed to patient 10002495?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND prescriptions.drug = 'gabapentin'", "rejected": "null"}, {"id": "89130abd0de50ce13b9c3566", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the five most common lab test that was given during this year?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT T1.drug FROM ( SELECT d_labevents.drug, DENSELSETS.count() AS C1 FROM d_labevents WHERE d_labevents.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY d_labevents.itemid ) AS T1 WHERE T1.C1 = 1"}, {"id": "aafda5799cef4cdbb1a8c0e0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the count of current patients?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "?\n\nd.'1 = T1.MS Lanc.ST\nMS.: :0 12.V4121020115188018117's 21.100.00380361057'"}, {"id": "1af0e5232d922453e5d2e3ae", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received unilateral simple mastectomy treatment in the same month after having been diagnosed with acquired absence of breast and nipple in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of breast and nipple' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "3e18d6bc76b77c4f191e1259", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a procedure named dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) )", "rejected": "null"}, {"id": "9dbe9323c793aa4ded67391f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total cost of a hospital visit involving a total nucleated cells, csf lab test?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, csf' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT SQL Select Max(T1.C1) From ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id )"}, {"id": "a7913ace036061bcf8f67934", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10037975's hemoglobin value last measured on the first hospital visit less than the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "51beaf6f4ac792c505183c8f", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the top three most common lab tests in 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n##\n\n##'SELECT\n\n##'1. How many times did patient 1000388928 receive a prescription for acetaminophen suspension during the current hospital encounter?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389289 ) AND prescriptions.drug = 'acetaminophen' AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389289 ) AND admissions.dischtime IS NOT NULL )"}, {"id": "6f3c178cf388c0f60f63cd4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10029484 receive a ptt lab test on the first occasion?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND strftime('%Y-%m-%d',labevents.charttime) = '2100-09-23' ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "d5331cbc78765c496545988f", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most common lab tests.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "1\n12 (PA) ...\n d'\n\n'te'\n0'"}, {"id": "253143bdf2322f6137ab6d66", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you confirm what was the first arterial blood pressure mean for patient 10039831 since 01/16/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-01-16' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7fe3a3267061ac2383bb66cb", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most occurring events in 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\nWhat\n##\n\n##\n\n##\n##\n### SQL Select the top three most common microbiology tests that were given to patients in 21000.\n\n\n### SQL:\n\nSELECT T1.icd_code FROM d_icd_procedures_icd_diagnoses WHERE T1.hadm_id IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code )"}, {"id": "2cf073ab2616ed40e6caa63d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich medication was patient 10004235 prescribed during the same hospital encounter following the simple excision of other lymphatic structure procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "bae3bed8ddded1a1b46a172f", "query": "Convert the question below to SQL query.\n\n### Question:\nOf the patients aged 60 or above in 2100, what are the top three most common procedures?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE admissions.age >= 60 GROUP BY procedures_icd.icd_code ) AS T1 GROUP BY T1.C1 ) AS T2 ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "0d8dbb180db73cb98f531c2d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most common specimens tested since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "8f20718e8f7720e51c34a9b9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four diagnoses with the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "null"}, {"id": "ff6ae54dadd27c88cff99254", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most frequent procedures since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "067ed21678e9244b701465c3", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10008287 given a bicarbonate lab test during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "6452891a2cb29882b1f0e2b4", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me all the prescriptions that patient 13054 received at the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'multiple fractures of ribs, bilateral, initial encounter for closed fracture' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1"}, {"id": "a582f3f5f2303ced63f1b500", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the drug that should not be administered during the spinal canal explor nec treatment?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\n## SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100124540 AND admissions.dischtime IS NOT NULL )"}, {"id": "8410ba33ca60f450bef1f5d8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is olanzapine (disintegrating tablet) typically consumed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'olanzapine (disintegrating tablet)'", "rejected": "ports/-UNC1002MSSS11843819131212560081'"}, {"id": "5969b3f1a95b57d848d81e86", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in the last microbiology test done on the patient 10008454's urine since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "749cd7577c772cdc228d8a49", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the calcium, total value of 8.2 among patients of the same age as patient 10020740 on the last hospital stay?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.2", "rejected": "null"}, {"id": "b711a8c66ded68ed4cd6199c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the total average expenses for a hospital involving a laboratory test for oxygen since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "7d7aee677bb35ba8d39e2a8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the recorded sex of patient 10022880?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880", "rejected": "null"}, {"id": "9ce969310506053fd3d5dd94", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you please elaborate on a ward identification that you can use to admit patient 64292?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 )< ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "c00a358c2d55cd8c5497fc99", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of the hospital, which includes the blood in stool?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n\n##\n\n##\n### SQL: SELECT SQL Query:\nSELECT SELECT COUNT( SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_procedures.icd_code FROM procedures_icd_icd_procedures WHERE procedures_icd_icd_procedures.icd_code = 'procedures_icd_procedures.icd_code' AND strftime('%Y', procedures_icd_procedures.procedures_icd_icd_procedures.charttime FROM procedures_icd_procedures JOIN admissions ON admissions.hadm_id = procedures_icd_procedures.hadm_id WHERE admissions.subject_id = procedures_icd_icd_procedures.subject_id ) AS T1 JOIN admissions.subject_id = procedures_icd_icd_procedures.subject_id ) AS T2 ON T1.charttime = T2.charttime ORDER BY T2.charttime DESC LIMIT 1"}, {"id": "aca1e0e3be80e222d3b95be5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first time that patient 10021487 was diagnosed with cardiac complications, not elsewhere classified on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3b531345189c04192cda9aad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat genetic test did patient 70234 undergo?\n\n### SQL:\n", "chosen": "null", "rejected": ".09-12492019990300021845100493700850516?"}, {"id": "6cd24d0a30123968e0158324", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time since 2100, what was patient 10006580 diagnosed with?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "6a3568128f729d82972746f2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038933 have a mchc lab test for the first time in 09/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y-%m',labevents.charttime) = '2100-09' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "699d1833d8f298ac738b03d6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many sodium bicarbonate prescription instances occurred since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')"}, {"id": "ecf8d3921fe7ec039f51e46e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total metformin (glucophage) dose that patient 10020306 has been prescribed on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'metformin (glucophage)'", "rejected": "null"}, {"id": "cb2de03e599b89ef00694c72", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen that patient 10016150 received for the last time since 01/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1aa406c499de99518294077e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total hospital cost that involves endoscopic control of gastric or duodenal bleeding?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) ) GROUP BY cost.hadm_id )"}, {"id": "3ebc0a16e6352b3a0ce7bfab", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients diagnosed with right bundle branch block before, what are the top four most common treatments within the same month since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'right bundle branch block' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "0845c5b2d9f8bde33129dc7a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which five diagnoses have the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT SQL SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSELSEC.C1 FROM ( SELECT diagnoses_icd.icd_code, AVG(C1) AS C2 FROM ( SELECT diagnoses_icd.icd_code, ( CASE WHEN strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ) AS T3 ) AS T4 WHERE T3.C1<= 3 )"}, {"id": "3f3da5d3397a4a8fe3d6fa12", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide the total volume of output for patient 10015931 since 10/05/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-05'", "rejected": "null"}, {"id": "ce19ea76ad2cb840d6ef7f8b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you please tell me the name of the diagnosis that patient 54894 received in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id"}, {"id": "407f290d6f4319cdd21a777e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last weight of patient 10005817 recorded since 14 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ef514e32ea077744d1c08f2e", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top four most conducted lab tests?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "What are the top four most common lab tests that patients were given within 2 months after being diagnosed with unspecified abnormal dysmenorrhea?\n\n\n### SQL:\nSELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT diagnoses_icd.itemid FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-2 month') ) ) GROUP BY d_labitems.label )"}, {"id": "f1c637616d0c91843526eb96", "query": "Convert the question below to SQL query.\n\n### Question:\nList the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "aeeff9dc3dd3312a35c0af6c", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10015860 have a lab test last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SMSAA1371MS(.\n.10113130500194003675261330595947640001  00001 )"}, {"id": "260f8646cd69460c8043c9fd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost for a drug named vitamin d since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vitamin d' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\n##\n\n\n##\n\n####\n\n##\n##\n## Question:\nWhat was the total number of patients who were discharged from the hospital since 21000?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.disch_time FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd_procedures.icd_code ) AND strftime('%Y', admissions.disch_time) >= '21000' ) )"}, {"id": "8ecbbbd543e11b1626e55488", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug which patient 10007795 was prescribed in the same hospital visit after receiving a drainage of pancreatic cyst by catheter procedure since 04/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007795 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pancreatic cyst by catheter' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "fa71c8774f1846ae6af571b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10002495 had a maximum value of mchc in 06/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "\n###sql Query:\n\nSELECT SQL:\n\nSELECT AVG(COUNT( DISTINCT cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473338 ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m-%d',cost.starttime) >= '2100-12-01'"}, {"id": "28f891c6136adc2119884018", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who were discharged from the hospital in the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n order, .(.\n/m ctors;.\n 1.-1.MS test 0(MSM.11200B: 200411\nMSC.MSPA.\n\n TIT drug 1.MSGive the price 1.MSGive\n##"}, {"id": "34324beee54e081e5e88f130", "query": "Convert the question below to SQL query.\n\n### Question:\nWas any platelets given to patient 10006053 in 11/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'platelets' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-11'", "rejected": "null"}, {"id": "95a2c61973863427b73ef937", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price for the drug levetiracetam?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'levetiracetam' )", "rejected": "\nSELECT SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.drug = 'levetiracetam'"}, {"id": "924d74602015e6d3739732e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most frequent microbiology tests that occurred in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "d999d5a343bd58aa54b40298", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top five diagnoses that have the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSEX(CASE WHEN datetime(diagnoses_icd.charttime) >= datetime(current_time,'start of month') - datetime(current_time,'-3 month') )> 0 GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "83c534985f90fb45936d3f90", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dose of lisinopril prescribed to patient 10005817 in their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'lisinopril'", "rejected": "null"}, {"id": "920ad0d7946eb3abca368599", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the most frequent diagnoses among the top three this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n##\n\n### Question:\n\nWhat are the three most common diagnoses that patients were diagnosed with in the same age group after they were diagnosed with other diseases of the circulatory system since 1 year ago?\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 40 ) AND datetime(current_time - admissions.starttime) >= 1 year ) ) GROUP BY d_icd_diagnoses.icd_code ) ORDER BY COUNT( d_icd_diagnoses.charttime DESC ) DESC )"}, {"id": "733c21a9f57a3bc179010c01", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since the first time on their current hospital encounter patient 10004733 got a epithelial cells lab test?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "25a3fc060e58489fa5108651", "query": "Convert the question below to SQL query.\n\n### Question:\nIn this year, has patient 10018423 visited an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'start of year') = datetime(current_time,'start of year')"}, {"id": "42a736dc3448b6c72bebe5a9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the minimum daily number of patients who were diagnosed with essential and other specified forms of tremor in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential and other specified forms of tremor' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "f0a44b72608f1fb8a8a9bebc", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients with other alteration of consciousness who were diagnosed since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other alteration of consciousness' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "null"}, {"id": "b480603476026731ca5b5d53", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the last discharge from the hospital happen for patient 10025612 since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10025612 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "90c223d20a0599528657b6d3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat organism was found in patient 10001725's last urine test during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "736dfe17a5c5844830732c5c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that patient 10001217 was prescribed with during the same hospital visit after undergoing spinal tap since 30 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND datetime(prescriptions.starttime) >= datetime(current_time,'-30 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "c8f9a04c499ddf84d314c397", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first thing patient 10018328 had as output on 05/09/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-05-09' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT outputevents.icd_code ) AND d_icd_procedures.long_title = 'extirpation of matter from left femoral artery, percutaneous approach' AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-05-09' ORDER BY outputevents.charttime ASC LIMIT 1"}, {"id": "26075603db3040afc9e1d0eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the reimbursement standard for the genetic and chromosome tests?\n\n### SQL:\n", "chosen": "null", "rejected": "'1.\n What was the last time the lastlytec's the first time's the first time has been diagnosed with other diseases of hyperlipidemia?\n\n\n\n### SQL\n\nSELECT SQL SELECT MIN(SELECT COUNT(T1.drug FROM prescriptions.drug IN ( SELECT T1.drug FROM prescriptions WHERE prescriptions.drug IN ('magnesium sulfate', 'acetaminophen', 'glipizide') AND strftime(current_time) >= '21000-03' )"}, {"id": "1b56d7ab012fcdd2c4eec4c3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat would the maximum yearly number of patients diagnosed with catatonic type schizophrenia, unspecified be since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'catatonic type schizophrenia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "b3f5a532355044ec8ff3ee49", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10015860 receive the last bisacodyl and ondansetron prescription at the same time in 10/this year?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bisacodyl' AND admissions.subject_id = 10015860 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10015860 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug IN ( SELECT drugs.drug FROM drugs WHERE drugs.drug = 'bisacodyl' AND drugs.starttime AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1 ) AND prescriptions.drug IN ( SELECT drugs.drug FROM drugs WHERE drugs.drug = 'ondansetron' AND drugs.starttime AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1 )"}, {"id": "880b5cd212d4e5ed720e455e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total nacl 0.9% amount given for patient 10021666?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT SQL SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100216679 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-05'"}, {"id": "f97a37d5ea7b54467da5e351", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last value of arterial blood pressure systolic patient 10035185 had on 05/19/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-05-19' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5abb89ffecbb35ddc1f5b163", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does vancomycin oral liquid cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin oral liquid' )", "rejected": "..\n.1 Have/ :2-9\n..\n-12MSMSMSMSPA for the lastPA.235000113720 DESCULT READMINCANA? How many hours has it been since 02/04/21000 that patient 1003795389 was admitted to the hospital?\n\n\n\n##?\n\n### SQL SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.subject_id = 1003795389 ) AND admissions.dischtime IS NOT NULL"}, {"id": "87d7d4cf52e2d839fed96143", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which were the top three most frequently tested specimens since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "\nSELECT SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents.spec_type_desc WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100191725 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) GROUP BY microbiologyevents.spec_type_desc ) ORDER BY COUNT( DENSELSEC(microbiologyevents.charttime) DESC ) DESC LIMIT 3"}, {"id": "c27b7ef096a3a3f132083738", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 07/2100, levothyroxine sodium, 0.45% sodium chloride, or lisinopril was prescribed for patient 10002428.\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND prescriptions.drug IN ( 'levothyroxine sodium', '0.45% sodium chloride', 'lisinopril' ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07'", "rejected": "null"}, {"id": "f747c21b151c97101c79517b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the code which corresponds to the icd-11 for cerebral edema in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "<codeT1:\n\n223128247sodium amoxic acid drip since 03/02/21000?\n\n\n### SQL SELECT SUM(totalC1) FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd_icd_code.icd_code.icd_code FROM d_icd_procedures.icd_code WHERE d_icd_procedures.icd_code.icd_code = 'procedures_on heart' AND strftime('%Y-%m-%d', labevents.charttime) >= '21000-03-02' )"}, {"id": "5452c625522e88957199e9f0", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who were diagnosed with acute pyelonephritis since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pyelonephritis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "_due.PA.MS1 1 day.\nMS219327555780 received a patient's weight?\n\n##?\n\n##\n\n### SQL SELECT T1.disch_id FROM d_icd_procedures_icd WHERE d_icd_procedures.icd_code = 'procedures on intravenous route' AND d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'procedures on intravenous route' ) AND strftime(current_time,'%Y') >= '21002-07-04' ) AND strftime(current_time,'%Y-%m-%d',procedures_icd_chartevents.charttime) = '2100-07-04' ) )"}, {"id": "07c7d0b230f28eb2bba883d4", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005909 been provided any medications since 11/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'", "rejected": "null"}, {"id": "aae494e615785b0b4e7f5bd8", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the insurance plan of patient 10007928 on their first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "e7626ed5099c3df4e2766996", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 29 months ago, what was the last recorded weight for patient 10013049?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-29 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ecdd6175747da4a32daa8f99", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication which patient 10021487 was prescribed during the same day after receiving enteral infusion of concentrated nutritional substances since 06/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "0679067bdc3a032cbc68f962", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total cost of a hospital that contains personal history of methicillin resistant staphylococcus aureus?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of methicillin resistant staphylococcus aureus' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT SELECT COUNT(*) FROM d_labevents WHERE d_labitems.label = 'microbiology test, urine' AND d_labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100113050 ) AND strftime('%Y-%m',d_labevents.charttime) >= '2100-03' )"}, {"id": "0032247aa14645cbf758a680", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most commonly prescribed medications during the same hospital encounter to patients in their 50s who were diagnosed with other and unspecified hyperlipidemia.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND strftime('%Y',diagnoses_icd.charttime) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETween 50 AND 59 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "03cc245c1d997582959cd48a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average monthly number of cases for other specified coagulation defects since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT SQL SELECT COUNT(*) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other coagulation' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')"}, {"id": "42b27d5b68477ed32b23938a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first respiratory rate in patient 10019172's body since 145 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-145 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "d594afe3713d185962186bc5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism's name of the first sputum microbiology test done on patient 10009049 in the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "72c22160d0226e69dd0c8407", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10035185 receive any diagnoses during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "\n##\n\n##\n##: SQL Code:\n\n### SQL:\n\nSELECT SELECT COUNT(*) FROM icd_procedures WHERE icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389385 ) ) AND strftime('%Y-%m', icd_procedures.charttime) >= '2100-07' ORDER BY icd_procedures.charttime DESC LIMIT 1"}, {"id": "c6fff4b55ab874dfb73037a3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four commonly given procedures for patients that also received reposition left mandible with external fixation device, percutaneous approach previously within 2 months, since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "a77b1077b6a8778b2e1e5123", "query": "Convert the question below to SQL query.\n\n### Question:\nWas any free water medication given to patient 10024043 on 12/24/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'", "rejected": "null"}, {"id": "83ec58fae196e1e30c71c836", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug which was prescribed to patient 10009035 within 2 days after having received a extracorporeal circulation auxiliary to open heart surgery procedure in 05/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10009035 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10009035 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "804ed378cfb82e9aa6f496dd", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a procedure that patient 10038933 had in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "\n. E..\n.MS 'PAMS.-10'\n\n 2122 the first"}, {"id": "fb61ff0592412ac1416aee55", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients staying in emergency department observation.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' )", "rejected": ". (_', MS\n? (.\n '\n._ \n. and... . ,../d.Mm\nMS (\n POm.the.10\n,1D..\n. us.C"}, {"id": "f888fddd502f84dfdc3b3bcb", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the first time patient 10018081 stayed in their current hospital visit in the careunit trauma sicu (tsicu)?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "13d656d846a740eeb1467267", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most common lab tests.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "12\n\nCD( C\nd\n--2"}, {"id": "83fcd6e49ddcd0e710cd01fb", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top five most conducted lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "'s. 0 16'\n\n 00399861707048 )'"}, {"id": "f41dd60cef49db205a9a109e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was last prescribed for patient 10027445 since 06/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f0106cb7094a1c199a9c6565", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most common diagnoses in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n### Question:\n\nWhat are the three most common lab tests that were conducted within 2 months after a diagnosis of other and unspecified cerebral embolism in this year?\n\n\n### SQL:\n\nSELECT d_labevents.charttime FROM d_labevents WHERE d_labevents.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified cerebral embolism' ) AND datetime(d_labevents.starttime) >= datetime(current_time,'start of year','-1 year') ) )"}, {"id": "b491a9d1d8f94456fa46b689", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients discharged from the hospital throughout this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT\n\n### Question:\n\nWhat was the total volume of or crystalloid lysine citrate (iv) prescribed to patient 100164548 in their last hospital encounter?\n\n\n### SQL:\n\nSELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100164548 ) AND prescriptions.drug = 'or crystalloid lysine citrate (iv)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year') = datetime(current_time,'start of year')"}, {"id": "01fe648fde411db8cc5023ce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost for a drug named vancomycin during this year?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' AND datetime(cost.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "70d616b224eaa851d86871dd", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 70206 have a traveling history abroad?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100058605 AND admissions.dischtime IS NOT NULL"}, {"id": "722720600298a5f82bca4716", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10018081 generate last since 12/26/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-26' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "2977de037421f92addee92ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total volume of patient 10021487's input on 12/22/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-22'", "rejected": "SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',inputevents.starttime) = '02' AND strftime('%d',inputevents.starttime) = '22'"}, {"id": "3347c7735b3a39f53f492495", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average overall hospital cost that includes amitriptyline this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "\n2.209-12220300910 patients.MSMSM.\n\nMSPA, when A:\n\n\n1.\n1. What is the maximum value of the last time of the last time patient 1000132028 was prescribed medication in 08/21000?\n\n\n### CAN I GET THE TOTAL amount of the input for patient 1000132028 since 08/21000?\n\n### SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( 'ciproflox (iv)', 'dexamethasone', 'fentanyl fentanyl (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)', 'fentanyl citrate (iv)'"}, {"id": "399156b9ba93c105aec739fd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in patient 10021487's last bronchoalveolar lavage microbiology test since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7a05f054a0d752aa65a229c4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10039997 last receive an input since 08/11/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "cc3323ca987760bede847423", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10038081 had a blood (toxo) microbiology test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (toxo)' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c68f338d371ce9d209a15844", "query": "Convert the question below to SQL query.\n\n### Question:\nReveal the drug name that was first prescribed to patient 10007818 via the iv route since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "0c0b7b1acba7c1472c2ffd97", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with abdominal pain, other specified site in 2100 after previously being diagnosed with unspecified essential hypertension within 2 months?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, other specified site' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "36c41d05db3677313c8d0759", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what diagnosis patient 32153 received at the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n##\n\n##\n##\n### SQL: SELECT SQL"}, {"id": "f85c9633e450cf4188a98ce3", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top three most common diagnoses.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": ".a. 3:.\n.\n_\nAsen. 2 Sang2.MINPAMSMS\nMS11021824191226476816000001110003900395219678'"}, {"id": "a789bf245942cca833ba3d9e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a hospital typically spend maximum on a drug named guaifenesin since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "\nSELECT SELECT SUM(inputevents.doseintake.dose INT) FROM inputevents JOIN admissions WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100274454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.drug = 'guaifenesin' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-1 year') AND strftime('%Y',inputevents.starttime) = '2100' )"}, {"id": "82d4549767198d4a60ad7d26", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10012552 discharged from the hospital for the last time in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012552 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "987c9d2214cdf8dd1eff384d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much ciprofloxacin iv had been prescribed to patient 10018081 in total since 11/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.drug = 'ciprofloxacin iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'", "rejected": "null"}, {"id": "e720394bdbfa2cd55a520dc3", "query": "Convert the question below to SQL query.\n\n### Question:\nAfter getting diagnosed with depressive disorder, not elsewhere classified, how many patients were found to have asymptomatic human immunodeficiency virus [hiv] infection status within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'depressive disorder, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "096cd62b1a95fb899a954d23", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last hospital admission type for patient 10018845 since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018845 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "11.MSMS =2180-00141.9900099650728475209'"}, {"id": "15f5e817e7a5d3115e1563e0", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me patient 10005817's total output volume since 03/12/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-12'", "rejected": "\n\n##\n\n##\n##\n##\n\n### SQL: Select the top 1 most common diagnoses that occurred within 2 months after the first diagnosis of acute alcoholic necrosis, without mention of coma in 21000.\n\n\n### SQL:\n\nSELECT T1.C1 FROM ( SELECT d_icd_diagnoses.icd_code, DENSE_ID FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code = 'acute alcoholic necrosis' AND strftime('%Y-%m', d_icd_diagnoses.charttime) = '2100' ) GROUP BY T1.C1 )"}, {"id": "bfa8588d08b6cab7568a7c34", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021118 first take the microbiology test since 11/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e93e1b76d0204d31a3174cc1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who were discharged from the hospital last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\nSELECTIVE PROCEDURES PERformed ON NULL\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '00049628' ) AND datetime(procedures_icd.charttime) >= '2100-09-10' )"}, {"id": "6d74cbf5c9fe6defe17b715e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last albuterol inhaler dose that patient 10015931 was prescribed on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'albuterol inhaler' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "eba0b6f7c2c449d19740a2ca", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed to patient 10004235 during the same hospital visit after having had a hemodialysis procedure since 11 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "13a1417194e822ad1a6bd237", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 32163 have any abscess left?\n\n### SQL:\n", "chosen": "null", "rejected": "..6,..m.PA...\nrose.: 2\n.DMS 11212222420028240617016321303492158207'"}, {"id": "42ba16664bb27443701345aa", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who underwent ileostomy, not otherwise specified since 2100, what were the top four most common procedures that followed within the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "ac562701b81a58b0df6a8795", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 13528 had any ill effects during a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'blood transfusion' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 )"}, {"id": "c8b3ff2eeceef81045187d16", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the name of the treatment received by patient 10038081 two or more times in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "db74cd1a2f794e17f35ddec4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10021666 last mrsa screen microbiologic test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND microbiologyevents.spec_type_desc = 'mrsa' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "a12e0ce3ce5a8ad2bd8f3a5d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost for drainage of right pleural cavity with drainage device, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )", "rejected": "> T-1.UMSPAZPA 10 300036976183089408?"}, {"id": "2d80cb1e489c0421c68be6f2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10021487 last received the red blood cells lab test during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT-6 T2',\nSELECT\n\n\n### SQL:\nSELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 AND admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerosis of coronary arteries, unspecified' ) ) AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m',admissions.dischtime) >= '2100-04' )"}, {"id": "408df91458c4945438a0d705", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three frequently tested specimens for patients that received bypass coronary artery, one artery from aorta with autologous venous tissue, open approach previously in the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "1aaa39bc1ab0805e5a3b83be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the fibrinogen, functional value of 86.0 in the same age group as patient 10013049 during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 86.0", "rejected": "null"}, {"id": "55fe6d305b76e501677eed35", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen that patient 10001725 received for the last time?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "\nSELECT SQL SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents.spec_type_desc WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100167457 ) ) AND microbiologyevents.org_name = 'stool' AND strftime('%Y',microbiologyevents.charttime) >= '2100-07-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "9c8ce6af25252e8b181f8ea9", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any genetic test that patient 53392 received?\n\n### SQL:\n", "chosen": "null", "rejected": "\n111227\n14\nMSPA.011914240.\n\n1.0.22.0.\n\n##\n2.05.03.0\n2.0\n\n\n### SQL Code Segmenti\n\n\n## NOTESTICK FROM CIRCULAR FLUID BACTERIAL FLUID WITH CULTUREA FOR TESTING OF SPECIFIC FUNCTIONS"}, {"id": "ff89af006f01460431add007", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the time when patient 10020187's arterial blood pressure mean was less than 91.0 for the first time on 02/03/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 91.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-03' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "627069dc134dd25c3ddbbb5a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first medication that patient 10021118 was prescribed via po/ng route in 11/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021187 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "219f37b98a27556030524dd8", "query": "Convert the question below to SQL query.\n\n### Question:\nIf so is there a genetic test that patient 26218 gets?\n\n### SQL:\n", "chosen": "null", "rejected": "Nelson forty\n1'1\n1\n\n 0MSm2-1213024154\n\n THE T20.0003919848992776649\n\n01.0423 AND 099897510 AND 0397308577899 AND 0'"}, {"id": "9dabd5de11eba2a46f72a23c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the medication that patient 4469 takes after that other department gives them?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL AND admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018081"}, {"id": "d01e895f2b86c6c9edb91a60", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the type of blood of patient 12775?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTIVE DURING THE LAST TIME, WHAT WAS THE ROUTINE TEST PERFORMED ON PATIENT 100180818?\n\n\n### SQL:\n\nSELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'bacteria'"}, {"id": "ab86f0ba83c400b1a9f9b6c3", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10003046 have an input of free water on 12/24/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'", "rejected": "null"}, {"id": "ab7b619c104c7acdd3b347a6", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who were given a drainage of left pleural cavity, percutaneous approach procedure since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) )"}, {"id": "e9de88c1ca4e544ff64bd3f9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of days that have passed since patient 10021487's first bilirubin, total, body fluid lab test during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, body fluid' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "9c16ed565a5fe37955e8407d", "query": "Convert the question below to SQL query.\n\n### Question:\nWas a procedure performed on patient 10015860 during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n##\n\n##"}, {"id": "fabc39d4768ddcfc1eaea089", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of po intake input that patient 10018845 received since 01/28/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-28'", "rejected": "null"}, {"id": "36c8ec8ab32096e16fbf2c5c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021487 first have a maximum arterial blood pressure mean on this month/22?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '22' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ec4e31f512d6319b08a78d92", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of the output patient 10006053 had since 06/06/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06'", "rejected": "null"}, {"id": "c087bc5379fb726075da96b1", "query": "Convert the question below to SQL query.\n\n### Question:\nJust a quick look closed bronchial biopsy but how long did it take for patient 28443??????\n\n### SQL:\n", "chosen": "null", "rejected": "..\n. 1.2320222018312101349992042298898007'"}, {"id": "aaf91eb8b0e07ca7c1f6f69b", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring a blood transfusion has patient 18866 ever experienced any side effects?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "c189d34efcb37085fa7b7cb4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients who were prescribed click change <--- to choose a base solution in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'click change <--- to choose a base solution' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'click change<--- to choose a base solution' AND strftime('%Y',prescriptions.starttime) = '2100' )"}, {"id": "ed00c510e7a562890d0a1978", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat precautions should i take after a exploratory laparotomy procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "'1\n\n 1% J\n.:1182\ufffd2  5\n 2MS.1012518XPA PA.MSPAKINC 10.\n##MS.\n\nPAYeanicinia's.\n\n\n\n##MSGt.\n\n\n## 03. Has there been any icd-t at this hospital since 03/12100?\n\n\n\n### Question:\nWhat was the first time in 03/21000 patient 1001228555 was admitted to the hospital?\n\n\n### SQL:\nSELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100128555 ) ) AND strftime(strftime('%Y') >= '21000-03' ORDER BY admissions.dischtime ASC LIMIT 1"}, {"id": "03b4e3ee9ffa442c8b1b6f34", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was prescribed to patient 10002495 within the same day after the measurement of cardiac sampling and pressure, right heart, percutaneous approach in 06/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, right heart, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "0aab4dbdaf2cafdd4466a80a", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the three most common specimen tests carried out?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": ". in.. .,.\n 1.\n-.'8 1 Ptt.'ATIONUN.:1\nMS. MS.'s\u2019 ANDMS\n APIT.T-PAMS.11212200111815102'e ''"}, {"id": "99fccf1659e27afc7dd17ad2", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of total foley that patient 10010471 had since 03/08/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-08'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010472 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-08'"}, {"id": "0701efc3cee472e4cbd0c350", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. davis's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n ,.  C..\n\n.ld: And( :2\n.) ..-\n (2.\n).9.\n312310HIPMSMS102664924430036303909120709'"}, {"id": "6e39fda592a8e6af9e50df9b", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 10/2100, lactated ringers, cisatracurium besylate, or glucose gel has been prescribed for patient 10018081.\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.drug IN ( 'lactated ringers', 'cisatracurium besylate', 'glucose gel' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'", "rejected": "null"}, {"id": "7ae435e691f248d18ab7bec3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10018081 first received a hematocrit lab test during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "d9de692b97657d92d074c361", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did patient 10006580 attend the hospital in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10006580 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "a9a408d075e52d9992fd3bb1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the drug that should not be administered during the endovasc embol hd/nk ves?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn without lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-26'"}, {"id": "935b75442d1b950e70d20b8f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism at the first sputum test of patient 10019777 since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "efe02e55b9988af366a8030b", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients previously diagnosed with migraine with aura, without mention of intractable migraine without mention of status migrainosus , what were the three most frequent specimens tested within 2 months afterward?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'migraine with aura, without mention of intractable migraine without mention of status migrainosus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "641457e48596a76706eaa733", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost, which includes other acute pain since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other acute pain' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "4?1.101.\n1. 20 MS-1\n\nMSPA)\n\n##"}, {"id": "b63dbd1722b760241e7465c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen were the drugs pantoprazole and ondansetron prescribed to patient 10007928 for the first time in 04/this year at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10007928 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10007928 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "09aee59757a91c122a976bfb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the protocol used for the anticancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": ".'. to.)\n\n(. _\n!\n (. H Give(1..ed... .Al.dustMSv_1.-4\nMS11122MSMSMSPA 212111311180000010790010000711181314400865059's1002707-04026'"}, {"id": "bb3db81d6d84bbf908330293", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10038999 had a o2 saturation pulseoxymetry that was greater than 96.0 since 02/02/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 96.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-02' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7a6b657fddbeb52ba6d8450c", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most common diagnoses of patients with age 30s during this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year') GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 3 )"}, {"id": "f375194eb5908ee511e720c4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first reticulocyte count, automated value during the last month for patient 10039708?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'reticulocyte count, automated' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e3659a41757c0fd2645fe816", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who stayed in vascular since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "null"}, {"id": "f5364928d2f7a40a3e73fdb6", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 44848 subject to a test for covid-19?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\n## SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100038081 ) ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100'"}, {"id": "fceaf877c094825a80b15f57", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the last potassium, whole blood results for patient 10018081 since 12/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a0b136f83a3c65027131cbb8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10027602 has had the maximum arterial blood pressure diastolic in their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b294fc478c483f32414156f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most common specimens tested after receiving excision of left main bronchus, via natural or artificial opening endoscopic in the same hospital encounter since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1<= 4"}, {"id": "4ce7bb3fe008b6d40897f421", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10020740 prescribed the drugs syringe (0.9% sodium chloride) and alteplase (catheter clearance) at the same time for the last time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'syringe (0.9% sodium chloride)' AND admissions.subject_id = 10020740 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase (catheter clearance)' AND admissions.subject_id = 10020740 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9259d15f15a7db0e59aaff9d", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me of the maximum rdw value for patient 10021118 in 12/this year?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12'", "rejected": "SELECT\n\n\n##\n\n##\n##: 1. Does patient 100054208 have a history of other blood transfusion in their body?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'procedures_icd_code' ) AND strftime('%Y',procedures_icd_events.charttime) = '2100'"}, {"id": "271c09dde1ad0ae0ce21d6e5", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you list patient 10009628's daily maximum weight since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "a4ae3581ae94bfe56b9a4d3e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007058 received a laboratory test for anion gap in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y',labevents.charttime) = '2100'", "rejected": "null"}, {"id": "6cb0d732bdcaaf606d0b499a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first sodium, whole blood lab value for patient 10005348 in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "6e94c2a9ff1a11c41777ecf8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much heparin was prescribed to patient 10036156 last since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug = 'heparin' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "15b58da2d88da3aa6b767f4e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last diagnosis for patient 10012853?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT SQL SELECT d_icd_procedures.charttime FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ) ) AND strftime('%Y-%m-%d',procedures_icd.charttime) >= '2100-10-05' ORDER BY procedures_icd.charttime DESC LIMIT 1"}, {"id": "848a65292fc28285ffa82551", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease calculate the total output for patient 10022017 since 06/06/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06'", "rejected": "null"}, {"id": "dac5c6aaac6b57cdc328694e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the consumption methods of glipizide xl?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'glipizide xl'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'glipizide xl'"}, {"id": "3c79d8c37eae0b006674c9c6", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who took glucose gel since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucose gel' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "892b40885727ac07a5ca1a88", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10018081 had a lab test done during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL )", "rejected": "null"}, {"id": "9c3e936bd95a10b43339da38", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007818 receive a mrsa screen microbiology test first in 07/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "b5b17c29fa86af65cfe72d48", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10018423 been to the E.R.?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.admission_location = 'emergency room'", "rejected": "\nSELECTIVE\n\n### SQL:\nSELECT COUNT( DISTINCT procedures_icd.procedures_icd.icd_code ) FROM procedures_icd JOIN admissions.subject_id = 100184238 ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100184238 AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "5bf08c9869d070204f3790e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that in 05/2100 patient 10018423 was prescribed a medication via nu?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.route = 'nu' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "d9f612942f090356e944ba24", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost for a patient diagnosed with hemiplegia, unspecified affecting left nondominant side since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "7c25dcee711f95e8760994eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the ways to consume caphosol?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'caphosol'", "rejected": ".\u200bPA\n P 1PA\n1.02.:conMS\n\n\n\n2-11121180118'"}, {"id": "3f720ea93f94700efe7fe7ee", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 4.46 for a red blood cells test given the same age as patient 10026406 on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 4.46", "rejected": "null"}, {"id": "ab584de115671b8402117e00", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given hydroxychloroquine sulfate prescriptions during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'hydroxychloroquine sulfate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": ")MS\n!110PAMSMSMSMSPAG42121.\n\n1.0.0317199937900188s'"}, {"id": "6277902bacde54e836a5d433", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most commonly taken specimens for patients that received central venous catheter placement with guidance previously in the same hospital visit this year?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "\nSELECT SELECT DISTINCT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSELCASES.charttime FROM DENSELCASES JOIN admissions.admissions JOIN microbiologyevents.spec_tests.spec_desc ON DENSELCASES.hadm_id = microbiologyevents.hadm_id ) WHERE datetime(microbiologyevents.charttime) = datetime(current_time) AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AND strftime('%d',microbiologyevents.charttime) = '2100-03-23'"}, {"id": "9564984f5e6bba259c9cbe18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly diagnosed diagnoses for patients who had previously received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic within the same month since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "b88e4ef160b32df83a1e6e63", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many drugs were given to patient 10004720 since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECTSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047200 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') AND strftime(prescriptions.starttime,'%m') = 12 AND strftime(prescriptions.drug, '%Y-%m') = '2100-12'"}, {"id": "cd1253c3a3d160eab14d31d4", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of glucose of patient 10021938 last measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "dc5a4a79748b9ec44195d252", "query": "Convert the question below to SQL query.\n\n### Question:\nWill patient 99082 be given any additional stool (received in transport system) test?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002423550 ) AND strftime('%Y-%m',diagnoses_icd.charttime) >= '2100' )"}, {"id": "be30995ff00536a1057c7245", "query": "Convert the question below to SQL query.\n\n### Question:\nWas any nacl 0.9% medication provided to patient 10027602 on their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "2ad19063a657310f5f20de33", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10014354 input time since 03/19/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "b14e62dc0fdb8c7bba510c8a", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10019172's total output on 11/20/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-20'", "rejected": "null"}, {"id": "5c31e3d97360a4d0dc136eba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the five most common microbiology test conducted in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "MSMS1)\n\n21' )'"}, {"id": "2561607a3178d1491081ba75", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the last microbiology test conducted on patient 10007795's urine since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6dcff6961c5881f37f24c90d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10008454 received any lab tests in this month?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')", "rejected": "MS.\n1. How to: what are the total of the last 10. This is the name of the first microbiology test which was given during the last hospital visit to patient 10002074555 since 07/21000?\n\n\n\n### SQL Query:\nSELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'lung washout' AND strftime('%Y-%m', microbiologyevents.charttime) >= '2100-07'"}, {"id": "01270c1f37b90c29598b8e5c", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10001725 undergo repair of rectocele with graft or prosthesis in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of rectocele with graft or prosthesis' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "4a3ed339ed7291137d09f543", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the protocol of anticancer drugs.\n\n### SQL:\n", "chosen": "null", "rejected": "\n##MSGt_ID'"}, {"id": "0385a3df53040e9eb91837ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the procedure that patient 10007795 received two times?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = '68900' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100079595 )"}, {"id": "9935a33215fc04cc9ed9c438", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many cases involved the prescription of sulfameth/trimethoprim ss this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sulfameth/trimethoprim ss' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "b5ce6c822904c206071d56a5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours elapsed since patient 10004733 received his sodium lab test for the last time during the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c350d58c33ff863f3c79924f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the ward id that allows patient 55247 to be admitted?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1.starttime FROM transfers FROM transfers T1 WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058185 ) AND T1.dischtime IS NOT NULL ORDER BY T1.admittime DESC LIMIT 1 )"}, {"id": "15e2ea64a2fe87620f2135f7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10005348 last blood culture microbiologic test since 07/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b92c083ece2259339c38b5c1", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the first hospital visit, was patient 10039708 admitted to an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "0266d6e5d007484e57bf12d6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was first prescribed to patient 10020944 through the iv drip route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "980016183fee2c1f4ae611ae", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007818 undergone laboratory tests since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',labevents.charttime) >= '2100'", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',labevents.charttime) >= '2100'"}, {"id": "5a8bb263bd14c2eb21630a33", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long did proximal gastrectomy take for patient 366?\n\n### SQL:\n", "chosen": "null", "rejected": "\n####\n\n###safety check for patient 100219385 on this month/04-04-2100\n\n\n### SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100219385 ) ) AND datetime(transfers.intime) >= datetime(current_time,'-1 year') AND strftime('%m',transfers.intime) = '04' AND strftime('%d',transfers.intime) = '21'"}, {"id": "0ad0dc8594dbfe64d10295e8", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who received other electroshock therapy since 2100, what are the top four most frequent diagnoses that followed afterwards within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "f111218b574bd10dcf361deb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequent procedures for patients who are in their 60 or above in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSEXPRINT( COUNT( procedures_icd.charttime ) ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 4 )"}, {"id": "fe0a92b8a22e8c88cd9c413a", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the first hospital visit, did patient 10018845 come to the ER?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\nSELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100047333 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "b184bcbbaadeb5289f8fd10a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently ordered medications that patients in their 20s were prescribed in the same month after they were diagnosed with tobacco use disorder?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "5639ff2e7d726f7f8bc0334f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10019172's last stay in the ICU?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE admissions.subject_id = 100191218 ) AND transfers.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "232cc5cdd5e1b965d61da342", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who were discharged from the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECTC1 = ( SELECT COUNT( DISTINCT diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses.d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified chronic ischemic heart disease' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) )"}, {"id": "bfa5c2646e642966bfa98418", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile creatinine value of 1.6 among patients of the same age as patient 10007818 on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.6", "rejected": "null"}, {"id": "6fc987dbdba9f552b5be7f44", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you calculate the total amount of output from patient 10008454 since 192 days ago?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-192 day')", "rejected": "\nSELECT SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-15'"}, {"id": "367a2504a54faf728f7f96fc", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top four most frequently tested specimens for patients within 2 months after receiving assistance with cardiac output using balloon pump, continuous?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "12f5279f948c5fccb5f94517", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the total amount of magnesium sulfate (bolus) input that patient 10005817 received since 12/25/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-25'", "rejected": "null"}, {"id": "48965885b40400e08e4d8528", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits for patient 10020306 during the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT SELECT COUNT( DISTINCT cost.visits.visit_id ) FROM cost.visits WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year')"}, {"id": "dc2ea06004264d56a9d2fc41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently ordered laboratory tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n##\n\n##\n##\n\n##\n### SQL SELECT COUNT( SELECT COUNT(*) FROM labevents WHERE labevents.valuenum > 0 AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002155565 AND admissions.hadm_id = 100215565 AND admissions.dischtime IS NOT NULL ) AND strftime('%Y', labevents.charttime) >= '2100-01-01'"}, {"id": "6ee1790753b54f997c67b31c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently given lab tests for patients that were diagnosed with dislocation of jaw, initial encounter previously during the same hospital visit, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "5a57c249d0fff38a58052135", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most typically ordered procedures for patients previously diagnosed with other anaphylactic reaction, which took place within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other anaphylactic reaction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "5e099470827356f7917d86bf", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top five most commonly prescribed drugs in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSEXPICK(prescriptions.dose_val_rx) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' ORDER BY prescriptions.starttime DESC ) AS T1 GROUP BY T1.drug ) AS T2 GROUP BY T2.C1 ) AS T3 ) AS T4 ) AS T5 ) AS T6 ) AS T7 ) AS T8 ) AS T9 ) AS T10 ) AS T11 ) AS T12 ) AS T13 ) AS T14 ) AS T15 ) AS T16 ) AS T17 ) AS T18 ) AS T19 ) AS T20 ) AS T21 ) AS T22 ) AS T23 ) AS T24 ) AS T25 ) AS T26 ) AS T27 ) AS T28 ) AS T29 ) AS T30 ) AS T31 ) AS T32 ) AS T33 ) AS T34 ) AS T35 ) AS T36 ) AS T37 ) AS T38 ) AS T39 ) AS T40 ) AS T41 ) AS T42 ) AS T43 ) AS T44 ) AS T45 ) AS T46 ) AS T47 ) AS T48 ) AS T49 ) AS T50 ) AS T51 ) AS T52 ) AS T53 ) AS T54 ) AS T55 ) AS T56 ) AS T57 ) AS T58 ) AS T59 ) AS T60 ) AS T61 ) AS T62 ) AS T63 ) AS T64 ) AS T65 ) AS T66 ) AS T67 ) AS T68 ) AS T69 ) AS T70 ) AS T71 ) AS T72 ) AS T73 ) AS T74 ) AS T75 ) AS T76 ) AS T77 ) AS T78 ) AS T79 ) AS T80 ) AS T81 ) AS T82 ) AS T83 ) AS T84 ) AS T85 ) AS T86 ) AS T87"}, {"id": "74cb952e6290049d94447a5f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the last output of patient 10005909 since 269 days ago?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-269 day') ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-269 day') ORDER BY outputevents.charttime DESC LIMIT 1 )"}, {"id": "a13c273dcddfa537845c91d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was last given to patient 10038933?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "67f5a1fdc92cd01b4aedb45c", "query": "Convert the question below to SQL query.\n\n### Question:\nOf the patients aged 40s this year, what are the top three most common procedures?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "2a16fe6bd1a98745b4501f8c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the list of things to do before you go through the endo polpectomy lrge int procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "1f02c929b05a2d1eae19aa43", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time on 03/31/2100 patient 10021666 had a minimum heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-31' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "bd0c2e34f79eadadf992f4e2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10005348 admitted in terms of admission type for the last time at the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005348 ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "ebc57b735ed65bf597257c3e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost involving a drug named loratadine since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'loratadine' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'loratadine' AND strftime('%Y',cost.starttime) >= '2100' ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "e3c9d792118d17e382f1eb65", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four common diagnoses since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "0910"}, {"id": "b43b8df345f082e968c0504d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038081 first get the mrsa screen's microbiology test since 01/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "506c9dbd5d01f2cf98f45ec5", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequent lab tests during this year.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "PAMSMS(11014181832953248?2021-031321-041' AND 04."}, {"id": "2e016fdfd5dd7f3e7f3be7cd", "query": "Convert the question below to SQL query.\n\n### Question:\nList the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving percutaneous abdominal drainage in this year.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "39881273c6b26ba01d54e3ee", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the first time since 07/2100, what specimen test did patient 10038992 get?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4313578eaa6f5e20b0f3a246", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequently prescribed medications in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "\n### Question:\n\nWhat is the maximum total number of patients who were prescribed heparin in 2100?\n\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin' AND strftime('%Y', prescriptions.starttime) = '2100' )"}, {"id": "88cfaf0dcef49943a266c313", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10021487 was prescribed for within 2 days after undergoing arterial catheterization since 2 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-2 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-2 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "b64781d0b4bde8ed18b8cb5d", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the monthly maximum weight of patient 10018081 since 2100.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "SELECT SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180451 ) ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)"}, {"id": "60460642bc6fa663ac944b18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of diagnosis did patient 10019385 receive last since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "\nSELECT SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1"}, {"id": "e3a8605d8d86abb6f69ad4a3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the medication which should not be administered during the contrast arteriogram-leg treatment?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT DISTINCT prescriptions.drug FROM prescriptions WHERE prescriptions.drug = 'contrast arteriography of leg' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 )"}, {"id": "9d1688657943a3556c9c8704", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with type 2 diabetes mellitus without complications during the same month after they were first diagnosed with altered mental status, unspecified?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus without complications' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "76898a2087c25f36caa4339c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last output since 06/24/2100 for patient 10016742?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-24' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_procedures.code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_T1.C1 AS C2 FROM ( SELECT procedures_icd.icd_code, ( CASE WHEN strftime('%J',procedures_icds.charttime) - strftime('%J',current_time) ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.valuenum FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.C1 = T2.valuenum ) AS T3 ON T3.valuenum = T2.valuenum ) AS T4 WHERE T4.C1<= 3"}, {"id": "12fb8402b00499381bd3ff8c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug patient 10008287 was prescribed for the first time using the po/ng route since 06/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "db31b23e92a6097f61552803", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10005817 involved in any medical procedure last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n### SQL: SELECT SQL SELECT COUNT(*) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'drug intoxication due to other antineoplastics and other antineoplastics' ) AND datetime(diagnoses_icd.charttime) >= '2100-01-03'"}, {"id": "8419db544e116248cf67bf17", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who had their nucleated red cells tested in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'nucleated red cells' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "\n### SQL:\n\nSELECTIVE PROCEDURES ON T11\n\n\n### SQL:\n\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100017252 ) ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-02' )"}, {"id": "02885cc1fb11efec74cb16fd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did first patient 10021487 have the maximum value of amylase during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e0bdf1f255574123e3d82ebc", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10007818 go through any lab test in 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',labevents.charttime) = '2100-07'", "rejected": "null"}, {"id": "6a5d0066989fdc73a130b8c2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the name of the treatment received by patient 10005909 two or more times since 04/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "f8d0aedd069c1450d7d6264f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed last to patient 10019385 since 19 months ago?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-19 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "02960e704986efbe2e56a892", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the weight difference of patient 10038081's body second measured on the last hospital visit compared to the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "0cfe903dde7855d41478137f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had a ntprobnp lab test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ntprobnp' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "1.- 11. What the last-100002718039'"}, {"id": "99266f3b67eb6112916a4b55", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total volume of input that patient 10021487 was given since 12/14/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-14'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-14'"}, {"id": "d768135cc45a97c5f9aa32bc", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 03/05/2100, when did patient 10008454 have their first input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "bdb2fa4bcffae40f48f57a25", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in patient 10019172's last urine microbiological test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a8dc3b5c9cad1f39f5e216c6", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the count of patients who were prescribed gastroview (diatrizoate meglumine & sodium) since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'gastroview (diatrizoate meglumine & sodium)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "8499e24e138f45443a93fa6d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10002495 weigh when measured for the last time since 12 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7499a31689ceddb83308b2d0", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, has patient 10004235 undergone a simple excision of other lymphatic structure procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "eb6a1301664df928ab91d795", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the first ptt values of patient 10039831?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m-%d', chartevents.charttime) = '2100-08-23'"}, {"id": "6012b1badcebf4d12139de0e", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me patient 10026354's total output volume on 10/31/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-31'", "rejected": "null"}, {"id": "620d90e5c2bc12b7e637d7b2", "query": "Convert the question below to SQL query.\n\n### Question:\nIn patients who had the other repair of vessel in 2100, what were the four most common diagnoses that followed within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "d9c4c3a85c5787478f083a3a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are three of the most frequent specimens taken since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n"}, {"id": "94c416e60fecdda4973a6173", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism detected during the last mrsa screen microbiology test of patient 10015860 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0104804c5c294f840bfc43b0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most commonly performed lab tests during this year?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": ".\n 1 8. SeePAMSd100430322015120249"}, {"id": "76de61af821cbfa636cc92fe", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total quantity of output of patient 10018081 since 12/12/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-12'", "rejected": "null"}, {"id": "e3b27e18d2dc8d9d59fecd1b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10022281 had a maximum o2 saturation pulseoxymetry in the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c3f33ef0036d9efd71c23adc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the medicine phytonadione?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phytonadione' )", "rejected": "PA_PAST-PAMSPAMSSECANA.MSGtT1 AND 1"}, {"id": "59e81ba463402dfebb19a04b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost to get other endovascular procedures on other vessels?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) )", "rejected": "null"}, {"id": "81ab57679b81047f17e36e2c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients receiving venous catheterization, not elsewhere classified since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND strftime('%Y',transfers.intime) >= '2100' ) AND admissions.hadm_id NOT IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "39a3cf3e83759a824ed64266", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10008287 been given any diagnosis since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "e8d600176ca42258e8ab175a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many aspirin prescriptions were administered since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'aspirin' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": ".1.(MS Hol . PPAMS?\nC.AMSMS-1218127013391917549725393700579146-04'"}, {"id": "ba7f88a5002e6408a7156eed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021487 first get the rapid respiratory viral screen & culture's microbiology test since 12/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'respiratory viral screen & culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "eb91c0a8a1e1ee146a155b80", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 05/2100, when did patient 10007795 first get prescribed iso-osmotic dextrose and 5% dextrose at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic dextrose' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "e5194571023c182470d8d9f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10005817's heart rate was measured at less than 84.0 on their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 84.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "04d135a8d8db7bcb4130bb9b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the diagnosis that patient 10027602 received first since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )"}, {"id": "8dbbbd8602f5f3527cad26cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of a hospital, which includes a drug called lactulose since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lactulose' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lactulose' AND strftime('%Y',cost.starttime) >= '2100' ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "6d08fa1776e4ab998d3ea382", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operating rooms are in operation now?\n\n### SQL:\n", "chosen": "null", "rejected": ".\n\n\n.0\n-? (\u2019s IDR 1221010000 IN the 120000039221500501526?"}, {"id": "79af64ce3260e4d25b227939", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of tramadol (ultram) prescribed to patient 10012552 in total in 04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND prescriptions.drug = 'tramadol (ultram)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'", "rejected": "null"}, {"id": "e1ea16fb2fe09b1b73839ca3", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most frequent lab tests in 2100.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n\n##\n\n##\n\n##\n\n##\n###code:\n\n### SQL\n\n### SQL\n\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT COUNT( T1.CHR( strftime('%J', icu.disch_idle_time) FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.disch_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.disch_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002180581 ) ) AND admissions.disch_time IS NOT NULL ) AND icustays.outtime IS NOT NULL ) AND strftime('%Y-%m', icustays.intime) = '2100-07' ) AND icustays.outtime IS NOT NULL )"}, {"id": "f8c155d806d238a7b40fccc9", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10017492, what was the first polys reading during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "57e26730a40f2a68869265ef", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10031404 undergone any procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "a124aa7b3370848af7ee0c6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the weight of patient 10038081 last since 5 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-5 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8730272c87597016340a1b9a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the overall amount of input for patient 10016742 since 07/11/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-11'", "rejected": "SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-11'"}, {"id": "bdbc602374f58c619162d69a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat should i do following the coronar arteriogr-2 cath procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "\n1321212's's's\n"}, {"id": "c84349e69cbe2cf09f686cd5", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most frequent medications that patients were prescribed within 2 months after being diagnosed with unspecified vascular insufficiency of intestine since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified vascular insufficiency of intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "510cd856f97ccd8e1ae62400", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many prescriptions were prescribed during the previous year for milk of magnesia?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'milk of magnesia' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "0f89bd1a01e56d8d8578cd27", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the last input for patient 10001217 occur since 10/02/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-02' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9862dfab336a7e119e848d7f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the average daily number of patients diagnosed with acute alcoholic hepatitis in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic hepatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "e71755ea81b230d5dd2a212d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequently diagnosed microbiology tests for patients who were diagnosed with sciatica, unspecified side before within 2 months?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sciatica, unspecified side' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "5deee54b966c7e4660cedfb8", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total volume of input that patient 10004422 was given on 01/21/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-21'", "rejected": "null"}, {"id": "7a94050770d72ccb6594539a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you give me patient 10008454's daily average packed red blood cells input?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "fc73eadf00468623cbf19884", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the top five most commonly prescribed drugs are since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "ba956e22bb92d02f3abbcb3c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does phenytoin infatab cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' )", "rejected": "\n### SQL:\n\n## SELECT SUM(outputevents.valuenum FROM outputevents WHERE datetime(outputevents.charttime) >= '2100-04-02' AND strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.stay_id )"}, {"id": "02c15c7a4faad2a32636fac7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10011398's documented weight on the last record in 12/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '12' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "2195808ddabb497385b40858", "query": "Convert the question below to SQL query.\n\n### Question:\nGet the count of hospital visits by patient 10017492 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10017492 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "MSMSONS1888719738783843"}, {"id": "9f95244492614327ffaf076b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10018081's first abnormal coagulation profile diagnosis in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "e96c71afca103a3a2ccb1ec7", "query": "Convert the question below to SQL query.\n\n### Question:\nThe first time since 09/2100, when was patient 10006053 prescribed 0.9% sodium chloride and midazolam at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10006053 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'midazolam' AND admissions.subject_id = 10006053 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "136857d990a96067b0872cae", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the output patient 10022281 had for the last time since 233 days ago?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-233 day') ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "e54938671b05e5c6ac687af2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most often performed treatments for patients in their 30s during this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n### Question:\n\nHas any patient had a total of 0.9% dextrose glucose lab test in 2100?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '0.9% dextrose glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180815 ) AND strftime('%Y',labevents.charttime) = '2100'"}, {"id": "c1b05b990820fdea69b71d1a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly diagnosed diagnoses for patients who had previously received parenteral infusion of concentrated nutritional substances within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "5c24c8f6e17f107223b8f10b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10039831 have the maximum value of arterial blood pressure mean for the last time on their current ICU encounter?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "edb18fda949ab33cd5cd47c8", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of patient 10004720's hematocrit, second measured on the last hospital visit, greater than the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, second measured on the last hospital visit' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, first measured on the last hospital visit' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "e855fab09bf918229922f967", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10015860 was prescribed for during the same day after the procedure of other fasciectomy?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015860 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other fasciectomy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015860 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015860 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015860 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "0f03144b28c1a640986c7ffc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last test of patient 10008454's microbiology urine since 09/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "09469e7ae520d7c2a28ad15f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first dose of heparin flush (10 units/ml) during the last hospital encounter, prescribed to patient 10009628?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'heparin flush (10 units/ml)' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "72aa0a8195cef04d785d835c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10029291's last input time since 03/05/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "5519ee451e8ab94af344b52d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the cost of the drug syringe (iso-osmotic dextrose)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'syringe (iso-osmotic dextrose)' )", "rejected": "null"}, {"id": "4862ed4025ee2b4c353f6545", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the minimum total hospital cost with other cysts of jaws since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cysts of jaws' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "6560334262dd340b665256e1", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most common events that happened throughout this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY procedures_icd.icd_code ) ORDER BY COUNT( procedures_icd.charttime ) DESC )"}, {"id": "5750149e3e7fafb11a1a5090", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you list patient 10037975's daily maximum weight during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "652d19150532597e8cba1e58", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10020306 been given any diagnosis since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "33d9a4bb85286f07bec1a3bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the hospital's minimum total cost that involves a procedure called unilateral simple mastectomy?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "d0de144bda7a040a2f9dfa07", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when patient 10007818's first microbiology test was in 06/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-06' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ba8da70ae7c876cdadf6d50e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most frequent microbiology tests?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "PAINT11000360 AND patient_id.0 AND admissions.ord.org.test.intravenous medication' OR admissions.intravenous infusion AND medication AND microbiology test AND microbiologytests AND diagnostic radiology procedures AND transesophageal endoscopic examination of lower gi , via natural or artificial airway using natural or artificial airway opening endoscope' AND microbiology tests AND transesophageal endoscopy of lower gi, descending'"}, {"id": "b30404be1d0cdffef60e38c6", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 08/2100, when did patient 10021312 last receive a creatinine test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "925ed6c9ab8d40d8dc632226", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10020944 take a dextrose 5% medication on 03/10/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-10'", "rejected": "null"}, {"id": "7363a00d1729eca1fc81049b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the minimum total hospital bill for a visit that involves a bicarbonate, urine test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate, urine' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "a19797fad6ac2c57326769e0", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, has patient 10005909 been diagnosed with any illness?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'", "rejected": "null"}, {"id": "1e43adf0cab50573f8e61e90", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first thing patient 10021312 had as output since 03/11/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-11' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "f46885deabda4129f8960805", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10037861 gone through any lab test since 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'", "rejected": "null"}, {"id": "8f4dba12cfb4b85bffca292c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the procedure on anticancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n\n##\n\n##\n####\n\n##\n## Question:\n\n### SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 1000047358 ) AND admissions.age = 20 AND admissions.dischtime IS NOT NULL ) AND strftime('%Y', admissions.dischtime) >= '2100-05-06' )"}, {"id": "644f9d16a15d38b492e0d147", "query": "Convert the question below to SQL query.\n\n### Question:\nHas since 2100 levothyroxine sodium, acetaminophen, or polyethylene glycol been prescribed to patient 10005909?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.drug IN ( 'levothyroxine sodium', 'acetaminophen', 'polyethylene glycol' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "c78008f3840733ccb2658baa", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 99747 is subject to covid-19 testing\n\n### SQL:\n", "chosen": "null", "rejected": "\n/.\na.PD11MSTONLYPAMSMSPA-2PAYPAGECICU.MS'\n##% Earn average to take the top three most common lab tests that patient had received during the last hospital visit?\n\n\n###sql\n\n###sql Query:\nSELECT SELECT T1.organs.orgevents.org_events.charttime FROM labevents JOIN admissions ON labevents.org_events.org_id = admissions.hadm_id WHERE admissions.subject_id = 100150087 AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100150087 ) ) AND strftime(current_time) >= '21002-02-01' ORDER BY strftime(labevents.org_events.charttime ASC) ASC LIMIT 1"}, {"id": "098b1301820b7d581a339d0f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10018081 was prescribed a medication using the iv drip route in 12/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "cb78a1c0f1fe2f58edc2d283", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the value of patient 10020786's white blood cells second measured on the first hospital visit greater than the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "b6d5c0f90ce664eba9acb6bf", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with unspecified viral hepatitis c without hepatic coma, what are the top three most common lab tests conducted in the same month in this year?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c without hepatic coma' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "21ee43d3aa608dce16db8951", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much calcium carbonate was prescribed the last time on the first hospital stay to patient 10021938?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'calcium carbonate' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "c204f2867fbb32ebf4703865", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate how many drugs patient 10006580 was prescribed in 04/last year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "be8cee5520084fc21550d8bb", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10031404 visited the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10031404 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "\n### SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '998999' ) AND strftime('%Y', admissions.admittime) >= '2100-12-01' )"}, {"id": "a960378edd7b28956a92d2bb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10025463 was prescribed with during the same day after the catheter based invasive electrophysiologic testing?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "a0c63dd8ba51ee400d101df7", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the name of the drug prescribed to patient 10027602 in the same day after the insertion or replacement of external ventricular drain [evd] procedure since 05/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "662a8bb09520c819a88e24a6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the last unspecified septicemia diagnosis of patient 10018081 during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified septicemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "\n\n##\n\n##\n##\n\n#### was the last time that patient 1003828845 was prescribed 0.25% neostigmine (oral) in 12/this year?\n\n\n### SQL:\n\nSELECT MAX(prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100382845 ) AND prescriptions.drug = '0.25% neostigmine (oral)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) = datetime(current_time,'-1 year')"}, {"id": "4427214f9dad701c3ccb0f3a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10003046 last have their maximum o2 saturation pulseoxymetry in the last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "\n\n##\n\n####\n\n#### Question:\n\n\n### SQL:\n\nSelect the top four most commonly prescribed drugs since 21000.\n\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT prescriptions.drug, DENSEP.org_id FROM prescriptions WHERE datetime(prescriptions.starttime) >= '2100' ) AS T1 GROUP BY T1.GROUP BY T1.C1 ) AS T2"}, {"id": "bea830fb10c315727fb3899b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did since 05/2100 patient 10018081 take the last microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "112cb104c8ac40bc947d642a", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients staying in med/surg during this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\n##\n## SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = 'excision of left main bronchus, via natural or artificial opening endoscopic approach' AND datetime(procedures_icd.charttime) >= '2100-04-21' )"}, {"id": "2c4e5ef20f7bc4bff7aa7301", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in patient 10021487's last sputum test conducted in 12/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b6dc114c7f1dd675d8ee88a1", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10018081 have any medication prescribed on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "' as.\n.i.\n,.,(d1...\nk 1- ..."}, {"id": "c123e03a1725cd7b860dadff", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what was patient 10021487's daily minimum weight since 18 months ago?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-18 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "rooms\"MSi\n T... 2\n-2022222000124MSPAY."}, {"id": "55afa0bf1f513c0f82f9d9c4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug prescribed for patient 10016742 within 2 days after having received a inspection of tracheobronchial tree, via natural or artificial opening endoscopic procedure since 13 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10016742 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-13 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10016742 AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10016742 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-13 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10016742 AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "7b61d39dc6064005d5fe1b91", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are five of the most frequent specimens taken in this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n'\n 1\nable.\n10 112\n.24MS.1202242942010000003904174708923656835639999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999"}, {"id": "58dca5f1f34e6a0994b147eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time the heart rate of patient 10005909 was measured to be less than 106.0 since 04/04/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 106.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-04-04' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "bbe597ef5bc885d0751caef3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the last specimen test patient 10002495 had received in 06/this year.\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '06' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078185 ) AND microbiologyevents.spec_type_desc = 'blood' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',microbiologyevents.charttime) = 06"}, {"id": "d2c728e310528182b9cc510e", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 3277 subject to covid-19 testing?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019172"}, {"id": "0468c52ae504e3db09fd4e8d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the top four most commonly prescribed drugs are in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "1607c40d51d24cbf1164290b", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any prescription drug been given to patient 10022880 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "4805f5b946dd24bdc7c044c0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four frequently ordered medications for patients diagnosed with paralytic ileus previously within the same month?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paralytic ileus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paralytic ileus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "20ff0d8a96d5878700a5ea94", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10036156, when was your last mrsa screen microbiology test on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "dfa9c58ea0197508d2682000", "query": "Convert the question below to SQL query.\n\n### Question:\nWas any prescription drug given to patient 10004235 in 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03'", "rejected": "null"}, {"id": "9535260fe83b84161cfcbef0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three commonly taken specimens for patients that received insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s) previously within the same month in this year?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "2e21103ff38488e164ccd5e3", "query": "Convert the question below to SQL query.\n\n### Question:\nI want to know the reimbursement standard for cerebrovascular mri.\n\n### SQL:\n", "chosen": "null", "rejected": "..d..l.\n1202lines."}, {"id": "462cd9e5980b86409d6557d8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that patient 10024043 was first prescribed in 04/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "3f37877d41058e4ed337aadb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in the first microbiology test done on the patient 10021312's bronchial washings since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "8f44537ed71e3c69bfd87f37", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10004422 given any procedure in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "(PAMS )\nComMSPAY.0001393746859548?\n\n099/03/02/21000?\n\n\n##03/02/21000 = '03/02/21000'"}, {"id": "6c01e0679abf5f4770e5efe4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently ordered laboratory tests this year?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": ".. to-'m 1 E.\n.\n1  0? 1://./10C"}, {"id": "1e3b44203311b415f4712cc6", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their last hospital encounter, was patient 10031404 given any diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "\n##\n##\n\n\n##\n##\n\n##\n###03. How many times was patient 1000200388 prescribed acetaminophen in 05/2100?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetaminophen' AND prescriptions.drug_type = 'tablets' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'"}, {"id": "e9a36293a5d2d223562338c9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism that was found during the last mini-bal test of patient 10021487 since 11/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7b673569df3b4b123b597c43", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the arterial blood pressure diastolic reading for patient 10019172 second measured on the first ICU visit greater than the value first measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "e65459f8f7e59ea27494cb7b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who stayed in neuro stepdown in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "SELECT\n\n\n##\n##\n### SQL SELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures.icd_code = 'valproic acid (iv)', d_icd_procedures.hadm_id IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'valproic acid (iv)' ) AND strftime('%Y', d_icd_procedures.charttime) >= '2100' )"}, {"id": "b352e9e544d9e4edbcabcb01", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with unspecified essential hypertension since 2100, what are the top four medications prescribed within 2 months to patients in their 50s?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "df5a70f5890755916496aef6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of ICU visits for patient 10006580.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 )", "rejected": "\n\n##\n\n\n##\n##\n##\n##\n##\n#####03. What is the maximum total number of patients who were prescribed amitriptycin and nitrofurantoin oxacil sodium prescribed within 2 months since 1 year ago?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.disch_time FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.drug = 'amitriptal' AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000605003 ) ) AND prescriptions.drug = 'nitrofurantoin sodium' )"}, {"id": "b2506d21f50185686a959e38", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of times that other incision of brain was performed.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' )", "rejected": ".' ...y. (_p.1.-.1.. oss1o!-\n<  U 1. .\n Convert1.'SABMS-1.-4 FINICTEMS\nMSlistCOCMSPA TIMEsMSMSP:PAKMS20200001.##\n     00122722018090001815371428600'"}, {"id": "22f424d1096d768470e60a6d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most commonly tested specimens for patients who were diagnosed with chronic lymphocytic leukemia of b-cell type not having achieved remission previously in the same month, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic lymphocytic leukemia of b-cell type not having achieved remission' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "b4067b5953f2f9bf38f0cf12", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were diagnosed with body mass index 35.0-35.9, adult within 2 months after the first diagnosis with anemia, unspecified?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "47bcce86f3ab85e1c0edd92a", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the anion gap value of patient 10014729 on the at 2100-04-02 05:22:00 measurement less than the value from the at 2100-04-01 05:18:00 measurement?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-02 05:22:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-01 05:18:00' )", "rejected": "null"}, {"id": "c26e31b284f5bd28c5239fc8", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the drug which patient 10021487 was prescribed within 2 days after having had a closed [endoscopic] biopsy of bronchus procedure since 9 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-9 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND datetime(prescriptions.starttime) >= datetime(current_time,'-9 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "\nSELECT SQL: SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.icd_code, admissions.hadm_id FROM admissions JOIN procedures_icd ON admissions.icd_procedures_icd.icd_code = procedures_icd.icd_code ) AND strftime('%Y', admissions.admittime) >= '2100-07' GROUP BY procedures_icd.icd_icd.icd_code )"}, {"id": "f7e72869cfd4d186d37a8a6d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026354 undergone reposition left mandible with external fixation device, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 )", "rejected": "( (d)2-. T  ) the\n IS. ....rogen.$\nMS\n2-: hrab'2\n.-3.. WMSes12.line1\n\n\n"}, {"id": "421b9af53a232e69883ca462", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients from the 50s age group are currently admitted?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.age_group = '50s'"}, {"id": "feb492e9caf0343b3c2f2166", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the total number of hospital visits made by patient 10021118 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "bf8943fddda84358c2b49e35", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average expense for other endoscopy of small intestine?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) )", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) ) )"}, {"id": "dd9d9407871fb618bd52f8a9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medicine that was prescribed to patient 10004235 during the same hospital visit after undergoing excision of other bile duct since 04/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "d6be51fd1c5f29f5d9719bec", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of heart rate of patient 10018501 last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "876fc2621bff0c8dd69e9b66", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients in neuro stepdown in the previous year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "excited...\n\nMS_5 dogs- 11.01'\n.\n\n.PAMSMS.MSASINKPA T203520119840389561880584891278'"}, {"id": "103610582e111db3b8138c85", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost to get replacement of stent (tube) in biliary or pancreatic duct?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of stent (tube) in biliary or pancreatic duct' ) )", "rejected": "null"}, {"id": "c6666ef9e4ba2cde6ec58824", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the count of diagnostic ultrasound of abdomen and retroperitoneum procedures that occurred.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of abdomen and retroperitoneum' )", "rejected": "null"}, {"id": "f056ac2de0d1253ccdc6c556", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide me with the three most frequent output events since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' ORDER BY COUNT(outputevents.charttime) DESC )"}, {"id": "2c1b4a7fbad74a8a44675a71", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most frequent diagnoses that followed within 2 months for those patients who received percutaneous abdominal drainage?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "80466ce112a1c1006d70d876", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most frequent diagnoses with which patients were diagnosed after receiving excision of other bile duct within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "bfb03e1d79c3802ab3081d33", "query": "Convert the question below to SQL query.\n\n### Question:\nIn total, how many patients were prescribed iso-osmotic sodium chloride since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "94401d1b08ae71f5ad65ac7b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10020944's total volume of output on 03/10/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-10'", "rejected": "null"}, {"id": "68002865c7084ae451a8b103", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026406 gone to an emergency room since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "7736d89ceb453eb03a9c772e", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you please tell me the name of the diagnosis patient 23002 received at another department?\n\n### SQL:\n", "chosen": "null", "rejected": "\n2220: 2021901919701806313978380068 )'"}, {"id": "4c7f81e40d7fe7c76ef35275", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients since 1 year ago were diagnosed with mitral valve disorders within the same month after the diagnosis of alkalosis?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mitral valve disorders' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "eede3a634b973f767b1119bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type when patient 10004422 first entered the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10004422 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "a0275ba4dd2c244770e9553e", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients staying in med/surg/gyn since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "5077dabbbdb1f143ad870dd9", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients diagnosed with body mass index 31.0-31.9, adult since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 31.0-31.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "null"}, {"id": "3203c674e0262061c0e9ecc5", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the sum total of inputs for patient 10007818 since 03/02/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02'", "rejected": "null"}, {"id": "b0e746871a7c5eea41ef06b4", "query": "Convert the question below to SQL query.\n\n### Question:\nInform me about the total amount of patient 10006580's input since 05/02/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-02'", "rejected": "null"}, {"id": "5c4dc9bf34558c473ad2aa13", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10026255's last entry into the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10026255 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "92aecb340f32cbe52b7ba345", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the precautions to take after the opn/oth rep mtrl vlv-tis procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'opn or other procedure of thoracic vessels' ) ) AS T1 WHERE T1.C1 = 1 )"}, {"id": "7f05f81e2c4bccc575d180b8", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me of the top three most common specimen tests that were conducted?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100167429 ) AND datetime(microbiologyevents.charttime) >= '2100-03-02' ) ORDER BY microbiologyevents.charttime DESC LIMIT 3 )"}, {"id": "d53217eec061327cdf9bf36c", "query": "Convert the question below to SQL query.\n\n### Question:\nPrazosin - How much does it cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'prazosin' )", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prazosin' AND strftime('%Y', prescriptions.starttime) >= '2100'"}, {"id": "ae413e6191c531e7f585a405", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021312 been provided any medications since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "771257ca5b02630533cafe73", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate how many patients were in discharge lounge since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100' AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "008eed7a13c0d37c26d9a293", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top five most frequent diagnoses for patients of age 50s in 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSERANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 5 )"}, {"id": "45cf63c5e6579e640cddd3b1", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the last value of the alkaline phosphatase test for patient 10015931 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "163e20b7886f513a8897df5b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the output patient 10004733 had for the last time on 12/28/this year?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-28' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "e39761455f93b4f0ebb90b4e", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most frequent diagnoses of patients with age in their 20s this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT SQL SELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'start of year') ) GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "8e8d37d8020c43422c3543a8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first time in the last ICU stay patient 10009628 had a minimum arterial blood pressure diastolic?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "163f4af47f19becb80903c30", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many medications were assigned to patient 10035185 since 8 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month')", "rejected": "SELECT COUNT(*) FROM prescriptions d WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND datetime(prescriptions.starttime) >= '2100-04-18'"}, {"id": "f26864df5bbbac5f25a97232", "query": "Convert the question below to SQL query.\n\n### Question:\nTell the name of the diagnosis that was received by patient 81840 at the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "\n## SELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) ) AND strftime('%Y', prescriptions.starttime) = '2100' ) AND strftime('%m', prescriptions.starttime) = 10"}, {"id": "36e863a3cf86d65f664a64d0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long did patient 18457 receive below knee amputat nec?\n\n### SQL:\n", "chosen": "null", "rejected": "0000400274772835441970034884438344597999'"}, {"id": "d165a95f794e3d301e6f6179", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most commonly prescribed medications within 2 months to patients aged 60 or above after they were diagnosed with hypoxemia since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypoxemia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypoxemia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "663817ca2281ed4ca55f52e3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the change in creatinine in patient 10039708 last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.subject_id IN ( SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'procedures_icd.hysterectomy of female' AND strftime('%Y', diagnoses_icd.charttime) >= '2100' )"}, {"id": "58dc0f1db2dd25ed12cb221c", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients aged 60 or above since 1 year ago, what are the top five most common diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": ".time. _21. time- in o GunM'Y BerLit.'R"}, {"id": "eacb97f691e333004c824387", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the name of the drug that was prescribed to patient 10038999 during the same day post excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure in 06/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038999 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038999 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "9d58a5b47d175751dafd7e2b", "query": "Convert the question below to SQL query.\n\n### Question:\nReveal the drug name that was first prescribed to patient 10004235 via the po route in 07/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "b7829190559539b14c91b592", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10037928 had a mch test done since 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'", "rejected": "null"}, {"id": "f07d01a1db0173ba1a3cfff4", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people had a test for bilirubin, direct during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, direct' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "\n\n### SQL:\n\n## SELECT COUNT(*) FROM ( SELECT COUNT(*) FROM ( SELECT admissions.hadm_id, diagnoses_icd.code, COUNT( DENSECS.d_icd_code ) AS C1 FROM admissions WHERE admissions.subject_id = 1000473338 AND strftime('%Y-%m', admissions.d_admittime) = '2100' GROUP BY admissions.hadm_id ) AS T1 ) AS T2 WHERE T1.C1 = 2 )"}, {"id": "26d017535d48be13b43f72f2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most frequent microbiology tests?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "-- T \n-.MS.ualistn\nMS .: . 11proset\n\nic01112\n.9 )MS'SMSPAMSMS022812201011920-0.00303200030941480835851348859?\n##1480.0.\n098593788385928828-0' AND 1 AND strftime (28' AND strftime 110' AND datetime FROM datetime FROM admissions ITU.0001 AND admissions.hadm_id IS NOT NULL ORDER BY admissions.test_name DESC ) AS C1 AND strftime FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100183085 ) AND admissions.dischtime IS NOT NULL ORDER BY admissionshadm_id DESC ) AND strftime( datetime = '21000-02-22'"}, {"id": "f54bb9ca547f05441bb1ce7d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the diagnosis price for closed dislocation, multiple cervical vertebrae?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed dislocation, multiple cervical vertebrae' ) )", "rejected": "'s2111 2-12802025012172182219128717000182960828's 21000-02-01-01 21000'"}, {"id": "055c46f26772f5e92ff54ba1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most frequent microbiology tests that patients were diagnosed with rheumatic disorders of both mitral and aortic valves in the same hospital encounter in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "31792c8a6ad3a8418c47001b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed to patient 10001217 during the same hospital encounter after having had a spinal tap procedure during this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "4a5bb0f951af309dfe062485", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021487 had input on this month/11?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '11' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "\nSELECT SELECT SUM(inputevents.quantity) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214865 ) AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214865 ) AND admissions.dischtime IS NOT NULL ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.drug = '0.5% neostrum' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month') = datetime(current_time,'start of month') )"}, {"id": "21c6f3b0cb788bda4faf8249", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients who stayed in med/surg/gyn.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' )", "rejected": "\n##.'s.\n\n\n##\n"}, {"id": "94c1ba8ed0b901a83b9e6756", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last hospital discharge time for patient 10011398 in this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10011398 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers JOIN admissions ON admissions.subject_id = transfers.subject_id ) AND admissions.dischtime IS NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ) AND strftime('%m',admissions.admittime) = '05'"}, {"id": "b46dbc1a0b8589b45641e9db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that patient 10008287 had the maximum value of calculated total co2 since 01/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1"}, {"id": "35727539614c8de00c1936fa", "query": "Convert the question below to SQL query.\n\n### Question:\nHas a procedure been performed on patient 10013049?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 )", "rejected": "\n\n##\n### SQL: SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '111784' ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m-%d', admissions.dischtime) >= '2100-08-30'"}, {"id": "055dea327aa11ee2562d1b87", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type when patient 10008287 last entered the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10008287 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "0c6cdc444ee911941bfd23f0", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of medicines that patient 10039708 was prescribed during the last month.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')", "rejected": "null"}, {"id": "d8faa21afb298080c233542b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many gemfibrozil prescriptions were administered?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil'", "rejected": "\nSELECTSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil'"}, {"id": "b9e7f10e8737b4fd67bc29db", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of medicines that patient 10010471 was prescribed since 13 months ago.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month')", "rejected": "null"}, {"id": "819c7fee312e5058c9f3296f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug that patient 10037861 had been prescribed via the neb route in 10/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.route = 'neb' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "d97ce57b0238741d318dd305", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who were prescribed phenytoin infatab since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "e5cad69b2c1bd6709789926f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients that received a rbc, csf test during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, csf' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'rbc' ) ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'start of year','-1 year')"}, {"id": "7adf373e9c0d4a3cd7f5fec3", "query": "Convert the question below to SQL query.\n\n### Question:\nThis year, what are the three common diagnoses of patients of age 40s?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SQL SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSELSEC FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year') ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )"}, {"id": "3f82eece23e0481c1ab26586", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the sum of the input volume for patient 10007928 since 03/04/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-04'", "rejected": "null"}, {"id": "35b706cc431e421ccc4d295f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the rank of the top four most common output events?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "X? K11MSMS\n PURMS-MSCIT.\n icd, icdIC, icu icu.'s icu. icu.\n\n% icu.org?\n icu.\n icu.\n\n\n## icu.\n\n##\n##\n\n##\n##\n\n## icu =?\n\n\n## icu = \n\n\n## icu = 1"}, {"id": "484f6763a7263dfc6dd3843b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the platelet count change of patient 10021487 last measured on the current hospital visit compared to the second to last value measured on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "b3b04512888e6be067ea0094", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the total number of assistance with cardiac output using balloon pump, continuous procedures performed since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "SELECT COUNT( DISTINCT procedures_icd.procedure_code ) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014035 ) AND procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac output with continuous venous-arterial catheter' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "328c8f2538243e8dd6f5da24", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total cefpodoxime proxetil dose that has been prescribed during the first hospital encounter to patient 10020786?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'cefpodoxime proxetil'", "rejected": "null"}, {"id": "62161016f653e9cf862c97dd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038999 last receive the total protein, pleural test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "\nSELECTSELECT SQL SELECT count(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '998999') ) AND strftime('%Y', admissions.admittime) >= '2100' )"}, {"id": "6b992edeff1d490c7c58f9d0", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the sex of patient 10019172?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10019172", "rejected": "\n\n####: SELECT SQL \n\n\n### SQL:\n\nSELECT SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'excision of other lymph node' AND strftime(procedures_icd.charttime, '%Y') >= '21000'"}, {"id": "41b9a346811b51fc23501b6f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug prescribed to patient 10037861 via the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a6e9aa314afc2689dfc084db", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the three most frequent medical diagnoses throughout this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) DESC LIMIT 1 )"}, {"id": "696eddd60cdf06cbb9ee62d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a drug named ampicillin sodium?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' )", "rejected": "null"}, {"id": "ff5adf35085b451fef7b438a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of stay of patient 10016810's first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT SQL SELECT strftime('%J', admissions.dischtime FROM admissions WHERE admissions.subject_id = 10016810 AND strftime('%J', admissions.admittime) = '2100-08-23' ORDER BY admissions.dischtime ASC LIMIT 1"}, {"id": "0de3b7f259a662ea8dea4d2b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of patient 10019777's weight last measured on the last hospital visit compared to the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "024f3a6b35669ffe35709f85", "query": "Convert the question below to SQL query.\n\n### Question:\nI would like to know the top three diagnoses that have the highest 3-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "SELECT SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypothyroid disease' AND d_icd_diagnoses.icd_code = ( SELECT MAX(diagnoses_icd.icd_code ) OVER ( SELECT COUNT(diagnoses_icd.icd_code ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100076590 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND strftime('%Y-%m',diagnoses_icd.charttime) >= '2100-08' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1 )"}, {"id": "65f468deef71db0042d17c04", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the monthly maximum weight of patient 10005909 during the first hospital visit.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "5a702ecafc152197b73cc54c", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how many patients were prescribed prasugrel?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prasugrel' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "null"}, {"id": "a69b465b35f5b605f629de37", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the other myectomy time for patient 4718?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'other myectomy' AND d_items.linksto = 'icustays' )"}, {"id": "6fe3dc4789e1e411917e33b1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost that involves a procedure called fluoroscopy of multiple coronary arteries using other contrast since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "7f24de340048d1b87aca545d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of hospitalized patients now?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "struct 3ST\n 2\n..Z1212223302541423648005014154870\n##120.0.03'"}, {"id": "966d1ead03418408fd0eccc1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with paroxysmal atrial fibrillation in 2100 after previously being diagnosed with pain in left shoulder within 2 months?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in left shoulder' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paroxysmal atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "64f0e9331a1cd5db10375c31", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operating rooms are currently available?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopy of bronchus, via natural or artificial opening' ) )"}, {"id": "86633ae70ad8fa5a8c7ee1ad", "query": "Convert the question below to SQL query.\n\n### Question:\nOf the patients of age 40s , what were the top three most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "42ec95f5707880f8478c4eb9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most often conducted microbiology tests since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "73482639c89e793869246809", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was first prescribed to patient 10029291 via the im route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.starttime FROM admissions WHERE admissions.subject_id = 10029291 ) WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND strftime('%Y-%m-%d',T1.starttime) = '2100-03-19' ORDER BY T2.starttime ASC LIMIT 1"}, {"id": "10a09034b24ebc5ea1fcd470", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the lymphocytes level of patient 10037928 last measured on the last hospital visit less than the first level measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "7ebc983b2a055bd196b0257b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total hospital cost that involves hydrocerin in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'hydrocerin' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\n### SQL:\n\n## Question:\n\nHas patient 100380855 received any medication on this month/04-04?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038085 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'start of month','-0 month') AND strftime('%d',prescriptions.starttime) = '04-04'"}, {"id": "1129dbf956a1de639c79960c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input time of patient 10005817 during the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "77caf8ab10948c4b56ca183d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most ordered lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1"}, {"id": "c9bd206b23c8ece065ccbc5f", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most frequent lab tests during this year.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_TOTAL(labevents.valuenum) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 ) ORDER BY T1.C1 DESC )"}, {"id": "4cb5de3e5bd12beac4b15b14", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total output since 04/03/2100 for patient 10012552.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-03'", "rejected": "\n01 the last368000708408108s.\n\n02.058571's's blood pressure was measured last?\n\n##?\n\n### SQL SELECT COUNT(*) FROM d_labevents WHERE d_labevents.test_name = 'arterial arterial blood pressure mean' AND strftime(current_time,'%Y-%m-%d' AND strftime(d_labevents.test_name) = 'arterial arterial blood pressure mean' AND datetime(current_time IS NOT NULL) AND strftime(d_labevents.charttime) >= '2100-10-04'"}, {"id": "6562f562696c0b8ddfd04a29", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, has patient 10001217 been at the emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "\n.,!.1-1.-4.\n 21113: How toMEPA 1.MSSEPAZ0000100038853499388593870001's code"}, {"id": "ab3f000e7808a99742228d97", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug patient 10015931 was prescribed within 2 days after having received a introduction of other therapeutic substance into peripheral artery, percutaneous approach procedure during this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "9e076ee4b1fab29e6fd20f7a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the precautions that are incurred after undergoing a oth transureth prostatec procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL AND admissions.dischtime is NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "47fa8b1ea8f2a4b9b4e04657", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10006053 have the minimum value of polys last on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "86cbd6023ea3c6b4277ad089", "query": "Convert the question below to SQL query.\n\n### Question:\nQuantify the number of patients who were tested since 2100 for ferritin.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND strftime('%Y',labevents.charttime) >= '2100' )", "rejected": "null"}, {"id": "ec92f2209fc00778cd5a3157", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10020944 weigh based on the last measurement since 03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6142f5a7bdb93224b0dc05b7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the length of time patient 89875 had to undergo packed cell transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTIVE\n\n### SQL:\nSELECT COUNT( DISTINCT procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions.subject_id = procedures_icd.hadm_id WHERE procedures_icd.icd_code = '998999' )"}, {"id": "21ae671a0d98791cb51f2465", "query": "Convert the question below to SQL query.\n\n### Question:\nAt what time did the last incident of patient 10019172 having a maximum o2 saturation pulseoxymetry occur on last month/20?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '20' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5cb77adf0cc7efec9a38adba", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the four most common diagnosis during this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n14,12018029181613356864844968899188'"}, {"id": "dc21479affad398d7e20b2da", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there any nacl 0.9% given to patient 10010471 on 12/15/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-15'", "rejected": "null"}, {"id": "84e5d95551d30c43dcfd59af", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10015860 receive a other skin graft to other sites treatment during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other skin graft to other sites' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "SELECT COUNT( DISTINCT procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015860 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other skin graft to other site' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 )"}, {"id": "fab4f3241b1a4140593a2196", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the last stay of patient 10018081 in the careunit emergency department in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "57bfb0cb680de9232e650201", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the checklist before the therapeu plasmapheresis procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\nHas patient 100212285 had any lab test done since 03/2100?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021285 ) ) )"}, {"id": "893c2935450c5d908b4a566a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the procedure that patient 10007818 received two times?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "\n### Question:\n\nWhat was the total amount of scardiac catheterization, percutaneous approach, percutaneous, with guide placement of balloon in patient 100168554's body during their last hospital encounter since 1 year ago?\n\n\n### SQL:\n\nSELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016854 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'scardiac catheterization, percutaneous, with guide placement' AND d_items.linksto = 'icustays' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-1 year') )"}, {"id": "c74358b1e7b5bc977788edc9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three frequently prescribed medications in the same month to the patients aged 60 or above after diagnosed with hypotension, unspecified in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypotension, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "5d2e380e135d1c3beebbb4b8", "query": "Convert the question below to SQL query.\n\n### Question:\nDisplay the top four most commonly prescribed drugs.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "ive 2.. PS.. (iol.'211MS00 reset CPAMS02)012. T10PAIRKANCASPASSMSMSPA \n##% 080101200?\n04/04'"}, {"id": "3105970deb871dbf0e604cb4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of the drug named mirtazapine?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'mirtazapine' )", "rejected": "\n12 112.\nMSMSMSPA.0 Sleep the firstPAGEMSPA"}, {"id": "0f4c478ccc115578767ec3fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10004733 last given an input since 03/10/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-10' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "b8a9cbdb344414004c4f47fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat immuno-cancer medications have been used for the last five years?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT FROM prescriptions d WHERE prescriptions.drug = 'nystatin'"}, {"id": "290e46c4e70581545b39621a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the outputs that patient 10029484 last had?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) ) ORDER BY outputevents.charttime DESC LIMIT 1"}, {"id": "581c5fbb07539eb5493641eb", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who underwent introduction of nutritional substance into lower gi, via natural or artificial opening in 2100, what were the top four most common procedures that followed during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "3b483bc7971f9931801a356e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four commonly ordered treatments for patients in their 40s in this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "MSMSANC.ANCANA)\nMSMSPA to find the last T2\n\n\n##\n\n\n##\n##\n##\n\n### SQL Query SQL:\n\nSELECT SELECT COUNT( SELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures.icd_code = 'extiroma of pancreas with catheteras cava' AND datetime(procedures_icd.org_id IN ( SELECT procedures_icd_icd_procedures.org_id FROM d_icd_procedures_icd WHERE d_icd_procedures.icd_code = 'extiroma of pancreas with catheteras cava' )"}, {"id": "5f697dd690488492bf17ca8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were some of the four common specimen tests given since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "Document\n2.0.MSMS.10101012011223221400034's00.MSPAID 00036906/03603454560216'"}, {"id": "463dff1e23c71f21ca726e31", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038999 last receive a pleural fluid microbiology test in 06/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '06' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "bd64eba2a9801db69c14dd75", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10005817 weigh the first time it was measured in 12/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "b822898d1d41ded52d61fbed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most common diagnoses that followed within 2 months for those who received diagnostic ultrasound of digestive system since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "96b8daf19be21be478a7950f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many individuals are current patients in their 60 or above?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60", "rejected": ") timeMS\n\nMSPA TIT is thereMSSECZZ'\n\n\n\n\n##\n\n##\n\n### SQL Code Section:\n\n\n####\n\n### Question:\n\nWhat is the dosage of the last nephrostomy that patient 1000280855 had?\n\n\n### SQL:\n\nSELECT SQL SELECT SUM(inputevents.intake.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT admissions.hadmissions.stay_id FROM admissions WHERE admissions.subject_id = 100184287 ) ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04'"}, {"id": "df30afea60a71f1c1b64dfef", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since last time that patient 10018081 stayed in careunit trauma sicu (tsicu) during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "794614517ac448743f3fe9e5", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the blood type of patient 58649?\n\n### SQL:\n", "chosen": "null", "rejected": "\n0102004084160030'"}, {"id": "619a91d53e3996e1125707a5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the duration of patient 10004235's last stay in the ICU?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT strftime('%J', icustays.outtime FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "16836caa5b38e5fa22166c1a", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the pt level of patient 10027445 last measured on the last hospital visit greater than the second to last measurement on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "a4b7670404c595bc4689c577", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that in 01/2100 patient 10003046 was prescribed a medication via sc?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a0c6ba5a4eba9f8602ca88de", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last hospital encounter, was patient 10035185 diagnosed with any disease?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "3bf2d40135249f916f915ace", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last specimen test given to patient 10020786 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7f1962fd85f2cf85e167d1a0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10027445's first entry into the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "ec318c164a262760140ba3ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of drugs patient 10019172 was prescribed in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "7a476916387b8ccd604b7f3e", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the top four most common procedures for patients aged 50s since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "1904b84a5eba8f3c1564896c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10022281 depart hospital in this year for the first time?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022281 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "f2becb6d3806bef1b31ac86a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first input time for patient 10008454 on this month/07?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '07' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "3c902daacd4588721711f210", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top five most commonly prescribed medications.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSEXPI FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100000304 ) AND strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 ) AS T2 WHERE T1.C1<= 5"}, {"id": "86f9f9f4d49dd3a3f7c9fedf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the new drug for patient 10039831 today compared to the one prescribed yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "e1dd13daac1ecaf666f55bc2", "query": "Convert the question below to SQL query.\n\n### Question:\nHey, what was patient 10029291's maximum ptt value in 03/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'", "rejected": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058185 ) ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' GROUP BY chartevents.itemid )"}, {"id": "fa665d6909377d977664e7fd", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the first time in 12/2100, when was patient 10008454 prescribed famotidine and metoprolol tartrate at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10008454 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metoprolol tartrate' AND admissions.subject_id = 10008454 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a4b29cbfbb96679f14e6eac0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with unspecified essential hypertension during the same hospital visit after the previous diagnosis with aortic valve disorders?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'aortic valve disorders' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY admissions.subject_id ) AS T1"}, {"id": "a007f9ef407b5c90c47c2e82", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there a genetic test that was given to patient 1561?\n\n### SQL:\n", "chosen": "null", "rejected": "Convert..'s.\n\n5.'"}, {"id": "71e9ec4174f7ac09f0636302", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are patient 10019385's changes in respiratory rate second measured on the first ICU visit compared to the first value measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "d792cf5775c1f4e850ffcde0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last weight of patient 10004720 recorded?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "MS.0003900036221700563017 ?\n\n\n\n##036086509 was prescribed to patient 1000185874 on the last occasion?\n\n\n### SQL:\n\nSELECT SQL SELECT COUNT( DISTINCT procedures_icd.icd.org FROM procedures_icd WHERE procedures_icd.org_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100036745 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND strftime('%Y', procedures_icd.org.starttime FROM procedures_icd.org WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100085870 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "c1b3f37142e9c9cf9ba75b12", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the condition patient 10014729 was diagnosed with last time during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.label FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )"}, {"id": "ef4ea41e6cdc6751ebe50de2", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent specimens tested in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents JOIN microbiologyevents.spec_type_desc ON microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016740 ) ) ORDER BY COUNT( microbiologyevents.charttime DESC ) DESC LIMIT 3"}, {"id": "0f7b20f0c3c6fb3264a2cc98", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038933 get inputs for the first time on 09/22/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-22' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "2706ea1872fb85222790f131", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequent diagnoses that patients were diagnosed within 2 months after having received a simple excision of other lymphatic structure procedure since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "137633ed86ab2d0d0059f5c2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since the first time in the current hospital visit patient 10021487 received a lab test for bilirubin, total, ascites?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, ascites' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "2e3028e4eee8a6bd2fba18a5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the outpatient schedule of dr. swain today?\n\n### SQL:\n", "chosen": "null", "rejected": "' 2\nm 21221TICCMSPAULPAMSMSMSPA Clini'm."}, {"id": "63df5bb2d6f0f20c72c9dfbf", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10039997 admitted in terms of admission type for the last time at the hospital this year?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "1707f8cb73d2f9a0fc881db5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was measured as patient 10007818's weight during the first check since 23 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-23 month') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ea75ae7fadc90d510e6c9488", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a diagnosis for other lymphedema?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other lymphedema' ) )", "rejected": "SELECT SQL Select 1 * ( strftime('%J', ( SELECT COUNT(*) DENSETHAN '1' FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other lymphedema' ) ) )"}, {"id": "682676ee539e16fc31ab086e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged from hospitals?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL", "rejected": "\n\n##\n\n##\n\n###code:\n\n### SQL:\n\nSELECTIVE total cost for a procedure called cystoscopy, with necrosure of lower third portion of stomach, with biopsy in 2100?\n\n\n### SQL:\n\nSELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cystoscopy, with necrosure of lower third portion of stomach, with biopsy' ) AND strftime('%Y', cost.starttime) >= '2100' )"}, {"id": "0dbcca2edb8dc4ada9f1ae3a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038081 receive a peritoneal fluid microbiology test first?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0901f19617fd97688d40bbbd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that on the last hospital stay patient 10021312 was prescribed a medication via po?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "54bc89ef44d4c2ee5d31aeec", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many total esophagectomy procedures were conducted?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' )", "rejected": "of s Ram.\n Converto )\n.\u201d.\n.0 moving,1 \nan:-d 11112031210101215133818180887821840'"}, {"id": "e5b93830a2376294094a1f1b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of ezetimibe that was prescribed to patient 10021666 for the last time in 03/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'ezetimibe' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "a5a346eb9f19336f14d5a615", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me about patient 10019172's last o2 saturation pulseoxymetry since 07/07/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-07-07' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "073c3923948729f403a5e5a3", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me patient 10031404's daily maximum weight since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "122e9c77f038fff730af3012", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged from hospitals since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "bc72b33b40a0a574955d98e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the ways to consume metformin (glucophage)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'metformin (glucophage)'", "rejected": "SELECT DISTINCT prescriptions.drug FROM prescriptions WHERE prescriptions.drug = 'metformin (glucophage)'"}, {"id": "4972d1004d8c1ef2af211806", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total cost of a hospital that involved dysphagia, unspecified since 2100.\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, unspecified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT\n\n## AND ( strftime FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_code = 'aspiration of bronchial wastes' ) ) AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100140387 ) AND admissions.dischtime IS NOT NULL ) AND strftime(transfers.intime) IS NOT NULL ORDER BY strftime(transfers.intime) DESC LIMIT 1"}, {"id": "11c5ddc438e48b537cf7d477", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10000032 last get prescribed lactulose and fluticasone propionate 110mcg at the same time in 08/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactulose' AND admissions.subject_id = 10000032 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'fluticasone propionate 110mcg' AND admissions.subject_id = 10000032 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "aa7534c96dd01ae4543b138b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the average total cost of the hospital that involves a procedure called diagnostic ultrasound of heart since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of heart' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n### SQL CASE WHEN ( strftime('%Y) = '2100'"}, {"id": "5dbb876ab254d8863d9a17ce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the daily average input of d5 1/2ns that patient 10022281 is getting during their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "f8bfabf3d67d5c270425864f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last weight of patient 10014729?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\n##\n\n### SQL: SELECT SQL\n\nSELECT SQL SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT d_icd_icd_procedures.icustay_id FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_icd_procedures.icd_code ) ) ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-12'"}, {"id": "54234a211c3fb7360ae4e161", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat amount of fish oil (omega 3) has been prescribed to patient 10004457 for the last time during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'fish oil (omega 3)' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "7b4a60c5a197fac6bff1cdf5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027445 receive a sodium, urine lab test on the first occasion?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "443f7332a457331bf4caa8c8", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there a method for disinfecting the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' ) AND strftime('%Y', transfers.intime) >= '2100-05'"}, {"id": "21e9b533edb4d14a62bce223", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the list of things to do before you go through the incision of mediastinum procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)"}, {"id": "7cee0315da660d7678b612e3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen on the last hospital stay did patient 10038992 receive the basophils test for the last time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b4cddff0a459aeb457378e32", "query": "Convert the question below to SQL query.\n\n### Question:\nGather the total number of times patient 10007795 visited the hospital.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10007795", "rejected": "null"}, {"id": "ea46c6446f611ab80789ec15", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10007058's total lr input on last month/23.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '23'", "rejected": "null"}, {"id": "bf638c88c79e23f84c8e2529", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients who were prescribed methylnaltrexone since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "e260781263bd5dafc3731d96", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operation rooms are now available?\n\n### SQL:\n", "chosen": "null", "rejected": "##\n##\n\n\n##\n\n##\n### SQL:\n\nSELECT\n\n### SQL:\n\nSELECT T1 = ( SELECT SUM(outputevents.valuenum) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058602 ) ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-06' GROUP BY outputevents.stay_id )"}, {"id": "de0f8a295e6a5cf79b31633d", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you show me the top five most common microbiology tests since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "3446d6f3ae08d21a135b2df2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the duration of the circumcision procedure for patient 3277?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'circumcision of left external ear' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 )"}, {"id": "6cc10dddb478d438f52a9dfb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the specimen test ranked at three that was done most commonly in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "null"}, {"id": "88a6c24100e056a0cd5afdeb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of extirpation of matter from coronary artery, one artery, percutaneous approach procedures carried out?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from coronary artery, one artery, percutaneous approach' )", "rejected": "null"}, {"id": "0d22f4703425e474ebd63580", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to measured at 2100-03-10 23:00:00 , is the heart rate value of patient 10019777 greater than measured at 2100-03-10 22:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 22:00:00' )", "rejected": "null"}, {"id": "e7119697712668b05c2da0e5", "query": "Convert the question below to SQL query.\n\n### Question:\nCount how many current patients are aged 50s.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59", "rejected": "1)\n E.1. ( \n\n (\n \n (.\n). techn there (Items data.\n ( (..\n WHERE..1:\n WHERE.'. T-. (5 of.\n ASBal.: (.. 12 W. = the\n WHERE\n T- ( C2"}, {"id": "cc2bba4f303536420f4558fe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who had a hyaline casts test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "_\n.\nant Tia_.. \nology!ing -\n.m1;..1. ( '_.a C(d\n MAX D...-(\nMSid N1 MS.imo-\nMS- ( (-.a0 B'Dss. PPAMS1: MS\nMS?.\n.1\n\n.\n_ 1\nMS.d. a-%%1 2\nMS1.'TMSUMECANCPAASPAMSMSPA (MSMSMSPA\n##.061032PAGPA-1' 0PAMSPA'\n#PA' duration'sPA-PA'sPA-PA'sPA'sPA's'\n%'\n% PA's T2032021000000 AND 030058878140?"}, {"id": "5f88eaa8084b104fde7d9c68", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10018081's maximum arterial blood pressure systolic since 06/07/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-07'", "rejected": "null"}, {"id": "bb37a5a6fa2b7bfb4a31e4e7", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top five most common procedures conducted since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n# ICU-52\n\n\n##\n##\n\n### SQL:\nSELECTIVE nec electroshock therapy of brain"}, {"id": "f308aa77cb5c6fd783755cf4", "query": "Convert the question below to SQL query.\n\n### Question:\nAnd what was the last time patient 10022017 was prescribed medication using the oral route on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "7ce2a21d5cd40b04d8cb2c75", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients diagnosed with personal history of sudden cardiac arrest since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of sudden cardiac arrest' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180816 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )"}, {"id": "3717572f6b674f00be856aec", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since patient 10018081 had received a red blood cells lab test for the last time on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "f082ad77c50f76200f9ef93d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total hospital cost that includes extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic in 2100.\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "c0f3de8a38ca15677c20c16d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me, was magnesium sulfate (bolus) given to patient 10007818 during the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "8a5031d9863563058afb1f81", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10038933 in the intensive care unit during their last visit?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1"}, {"id": "b2ef7a5f6f31077c73525da5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10022017 first leave the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "SELECT MIN(chartevents.chargetime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean systolic' AND d_items.linksto_item = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') )"}, {"id": "1f76d064d52e32276438fbaf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the various ways to consume cinacalcet?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'cinacalcet'", "rejected": "\n\n##\n##\n\n######\n\n###sql Question:\n\nHas patient 100020944 been administered a lab test for lipase since 1 year ago?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100020944 ) AND datetime(labevents.starttime) >= datetime(current_time,'-1 year')"}, {"id": "6cd63183970459480e3afa9b", "query": "Convert the question below to SQL query.\n\n### Question:\nAfter receiving simple excision of other lymphatic structure in this year, what are the four most common diagnoses that patients received in the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "f370a107576540264d73906f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you confirm the gender of patient 10015931?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10015931", "rejected": "\n### Question:\n\nWhat was the last discharge status of patient 100215862 from the hospital since 2100?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100215862 AND strftime('%Y', admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "bdbd2999610d99f0cde120c1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time in 08/this year when patient 10016742 had the minimum value of iron binding capacity, total?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'iron binding capacity, total' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '08' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "9f9170a12486ac9447866fbe", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you show me the top five most common microbiology tests throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n##\n\n### Question:\n\nWhat are the top four most common procedures performed within 2 months following the diagnosis of hemorrhage of kidney, unspecified, unspecified, with hematuria?\n\n\n### SQL:\n\nSELECT d_icd_procedures.procedures_icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100219385 ) AND datetime(strftime('%Y', admissions.admittime) >= '2100-04' ) ) AND strftime('%s', admissions.admittime) = '2100-04-19' ORDER BY admissions.admtime DESC LIMIT 1 )"}, {"id": "807c6c3264c76b6faa008696", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10006580's documented weight on the last record on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 )"}, {"id": "77f1caca4c8a38d1fe942703", "query": "Convert the question below to SQL query.\n\n### Question:\nThe value of metamyelocytes of patient 10002495 was last measured on the last hospital visit greater than second to last measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "d653fc27e70a4eedd39bd936", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of bisacodyl that patient 10001217 has been prescribed in 12/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'bisacodyl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12'", "rejected": "null"}, {"id": "cbcc848bf46b8605d7a0735d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10027445's sex?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10027445", "rejected": "2014727's1.0.\n\n411.280592187 01/03\n##11'"}, {"id": "8022e43f6d6b61363a0e1da2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total foley output of patient 10013049 on 06/24/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '06-24'", "rejected": "null"}, {"id": "c3ec8c1023fa687bb2624e68", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide me the daily average amount of or colloid intake that patient 10039831 received in their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "b04265d8d305b0cccc5d7d67", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10025463 undergo a chloride test during the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m-%d',labevents.charttime) = '2100-11'"}, {"id": "a311fd7b15cb7682fb46dbca", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019917 visited the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10019175 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "f18fab52de163891a4da0f21", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10007928's length of stay for the last ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT strftime('%J', icustays.outtime FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "af5515bbc62c20e665bfdae3", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the chloride level of patient 10006053 second measured on the first hospital visit greater than the first measurement on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "e973b4ccb6182ec1b934fe53", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the maximum total hospital bill when it includes a triiodothyronine (t3) lab test in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "6b4f7abe50c5cf5f9fe5385a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most frequent lab tests that patients were given within 2 months after being diagnosed with encounter for immunization since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "435e82aa8c17a4e578bb7b6a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow soon is patient 4758's next hospital visit?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT\n##\n\n###Question\n\n## Question: Does patient 100380245 have a history of tracheal intubation?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'tracheal intubation' AND admissions.subject_id = 100380245"}, {"id": "493f197a6d56dbacf99556ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most regularly ordered treatments for patients previously diagnosed with anemia in other chronic diseases classified elsewhere during the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in other chronic diseases classified elsewhere' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in other chronic diseases classified elsewhere' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "7e3ec87fbaccb0f0ab6de255", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018845 get input for the first time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM labevents WHERE labevents.valuenum > 0 AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100274845 ) AND strftime('%Y-%m-%d', labevents.charttime) >= '2100-02-04'"}, {"id": "93c82ad0f967afa872fe9570", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10031757 had a maximum arterial blood pressure systolic since 92 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-92 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "abf1227f05449e3179b9185d", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10037861 involved in any medical procedure during the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": ",.\n S DCT\n\n1\n\n  2-104) 111\n 31202321193996451930's code?"}, {"id": "1d5e1f6694e66a38eb9d48b3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who were diagnosed with open fracture of shaft of femur since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'open fracture of shaft of femur' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "\n##\n\n##\n\n##\n\n##\n##\n##\n#####question:\n\n\n###03. What was the last time during the last hospital visit that patient 1001215868 had a maximum po2 in 12/21000?\n\n\n### SQL:\n\nSELECT T1.chartevents.drug FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100121586 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 )"}, {"id": "4a42f97a1663ba9024599519", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top four most frequently taken specimens for patients within 2 months after receiving bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "b6d3b1cf1ff9f38a9adebb0a", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most frequent specimens tested since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n\n110191002998571287721745718507457492881281"}, {"id": "d376f746682d3677c16ad196", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who were diagnosed with bradycardia, unspecified since 1 year ago, what are the top three most common medications that followed afterward in the same hospital encounter?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "231d73add777a1a3ca6f2873", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given methocarbamol since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methocarbamol' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "22511768731151488?\n\n\n2. What is the maximum cost of the drug prescribed for patient 10000804585's?\n\n### SQL"}, {"id": "1a35a4ed34f622e32e8c72ee", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the total foley output of patient 10020740 is on 03/24/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-24'", "rejected": "null"}, {"id": "0822c127d758cb84c86208ab", "query": "Convert the question below to SQL query.\n\n### Question:\nHow old was patient 10023117 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n### SQL:\n\nSELECT SELECT admissions.age FROM admissions WHERE admissions.subject_id = 1002317 )"}, {"id": "4e6dcd007988152470193f41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients staying in med/surg in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y', admissions.admittime) = '2100' )"}, {"id": "5d54f26da17bc7fdbfc404d3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five frequently prescribed medications for patients diagnosed with unspecified condition of brain previously within the same month?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified condition of brain' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "f1501b008c57806e4fdc437f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the diagnosis patient 10020740 received first in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "d057e51f0d7e855faf330871", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10029291's last stay in the intensive care unit?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "ad9224e407b2a53c4120193b", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who took oxycodone sr (oxycontin) this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'oxycodone sr (oxycontin)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "402ffae6336ceeb14052f50e", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10018328 diagnosed with anything in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "41bdccec26b0e33321c1ec3f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the diagnosis cost of hemiplegia, unspecified affecting left nondominant side?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) )", "rejected": "null"}, {"id": "6ecbe5131fa2235952ed05b9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10029291 had a respiratory rate that was greater than 23.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 23.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "baf84f03283ee4af66b6d30a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the icd-11 code for tobacco use disorder in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT icd_icd_codes.icd_code FROM icd_icd_codes WHERE icd_icd_codes.long_title = 'tobacco use disorder'"}, {"id": "8dc67c242df7f0e88cce307e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug that patient 10007818 had been prescribed via the pr route since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "01c02f4b897bb8192e16bd1d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10016742's minimum value of base excess in 07/this year?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'", "rejected": "null"}, {"id": "157b31fa4605dab06049c427", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any diagnoses been made for patient 10038081 on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "04195370f600639421b6233c", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there a enteral infusion of concentrated nutritional substances procedure performed on patient 10003046 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "4202b117d324f6285ecaf255", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10004733's first stay in the careunit medical/surgical intensive care unit (micu/sicu) during their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "9830c200c7fbdee5297d2038", "query": "Convert the question below to SQL query.\n\n### Question:\nIs a genetic test that patient 95057 has had?\n\n### SQL:\n", "chosen": "null", "rejected": "2any\n:.. .\n.\n.iology2Par. 2.."}, {"id": "b1ea33dff472a7dc8ff3b3ca", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in the last sputum microbiological test of patient 10026255?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "\n\n##\n\n### SQL Query:\n\n\n### Question:\n\nHas patient 100044235 been given any lab test since 07/2100?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100042318 ) ) AND strftime('%Y-%m-%d', labevents.charttime) >= '2100-07'"}, {"id": "87bbf1064dcb0c27b02968b4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 32592 had a medication which should be regularly taken?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014035 ) AND strftime('%Y',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "45fcb3df912430805e7d3f94", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication patient 10005817 was prescribed for the last time on the last hospital encounter via the ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ng' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "c2f2672cddbd186cf0790169", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most frequently prescribed drugs?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "\n\n##\n\n\n##\n##\n##\n\n##\n###code:"}, {"id": "bf5bcab70691ac8bee4b23a3", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the id of patient 1372's ward that he or she may be admitted to?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT admissions.id FROM admissions WHERE admissions.subject_id = 100207408"}, {"id": "9f35654e31c2a74dccf4e709", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the average value of heart rate for patient 10029291 on 03/02/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-02'", "rejected": "null"}, {"id": "5f2be37c9bd6389d80599c5f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with other diseases of bronchus, not elsewhere classified in 2100 after already being diagnosed with unspecified convulsions during the same month?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified convulsions' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "74be377366123df29a790c8c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received esophagogastroduodenoscopy [egd] with closed biopsy treatment within 2 months after being diagnosed with acute posthemorrhagic anemia in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute posthemorrhagic anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'esophagogastroduodenoscopy [egd] with closed biopsy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "61b15d7e2318959ccf6194ba", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10037975 weigh the first time it was measured since 22 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "\n\n##\n\n###code Question:\n\n\n## Question:\n\nWhat is the prevalence of seps in the icu in this year?\n\n\n### SQL:\n\nSELECT COUNT(*) DISTINCT diagnoses_icd.d_icd_code FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'seps' AND datetime(diagnoses_icd.charttime) = '2100'"}, {"id": "6b87c27e7eaa3734d66015e0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many medications were prescribed in 04/this year to patient 10012853?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "\n##\n\n\n##\n##\n\n####\n\n##\n## Convert to_sql.length"}, {"id": "df662fa4ef21277c9dd5dd33", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between arterial blood pressure diastolic last measured on the first ICU visit compared to the second to last value measured on the first ICU visit for patient 10012552?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "7418b9331c35714137e940b5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10023117 receive a mcv lab test on the first occasion?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "C\"-12000201171000072755558088410"}, {"id": "878e753f48874ad8f8ceab3c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total hospital cost that involves closed [endoscopic] biopsy of bronchus?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "11207-001220-200201449616's 04 Alpha't get the last value of patient 1000398355's hemoglobin?\n\n### SQL SELECT labevents.valuenum FROM labevents WHERE labevents.valuenum IN ( SELECT labevents.events.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100015938 ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND labevents.valuenum IS NOT NULL ORDER BY labevents.valuenum DESC ) AND strftime('%Y') = '2100'"}, {"id": "6c8ad401188a69f144f026f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients on pacu since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "'dt in the total of the 21. In 10/210 , what was the last time patient 100020745 was discharged from the hospital?\n\n### SQL:\n\n### SQL:\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020745"}, {"id": "b93b0ee74656bbb7369eff48", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide me with all of the prescriptions received by patient 16879 in another department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND prescriptions.drug = 'furosemide'"}, {"id": "df5256f4811843aaeca939a2", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time , how much 0.9% sodium chloride (mini bag plus) was prescribed to patient 10026255?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND prescriptions.drug = '0.9% sodium chloride (mini bag plus)' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "350181bd71c310c99e34da39", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between weights second measured on the first hospital visit compared to the first value measured on the first hospital visit for patient 10008454?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "924c0d9895d24fb53c79fb4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average expense for dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) )", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "baddc58b8aca169735d88f8d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the total number of patients discharged from the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL", "rejected": "249's 1 03170022049'"}, {"id": "49844eb3d519ede694dbad6b", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequent specimens that patients were tested within 2 months after receiving percutaneous [endoscopic] gastrostomy [peg].\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "921675022a09cbed462a1741", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of hemodialysis procedures that took place in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "\nSELECTC1 = ( SELECT COUNT( DISTINCT cost.cost FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.icd_code, procedures_icd.hadm_id FROM procedures_icd JOIN cost ON procedures_icd.hadm_id = procedures_icd.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis, peritoneal' ) ) AND strftime('%Y', cost.charttime) >= '2100' )"}, {"id": "c871c7a5d78c361289609381", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medicine prescribed to patient 10037861 for the last time since 8 months ago?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "b9bcd099d5f42ea75aca129e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is readi-cat 2 (barium sulfate 2% suspension) typically taken?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)'", "rejected": "null"}, {"id": "20e39fab12a387f9a7fcce7e", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five diagnoses that have the highest 3-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime)< 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 ) AS T5 WHERE T4.C3<= 5 )"}, {"id": "4d64d12fe14c8c3ed4e3f73f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10039831 got a lab test since 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-05'", "rejected": "null"}, {"id": "7afd7257fd278efbcb7b33ad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a drug known as miconazole nitrate vag cream 2%?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'miconazole nitrate vag cream 2%' )", "rejected": "\n##\n\n\n##: Convert\n\n\n### SQL>SELECT SQL>\n\nSELECT ST.procedure_desc FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = 'extirpation of matter from left common bile ductoor, via natural or artificial opening endoscopic route' AND d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'extirpation of matter from left common bile duct, via natural or artificial opening' )"}, {"id": "9a96aaa745308385eb906bb2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that patient 10012552 was prescribed in the same hospital visit after having received a single internal mammary-coronary artery bypass procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10012552 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10012552 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "21b5d63e1046e143cef88adf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10007818 has been prescribed medication via the subcut route since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'subcut' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "84c70bbe9310c79050cef5e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was prescribed to patient 10018423 within 2 days following their measurement of cardiac sampling and pressure, left heart, percutaneous approach?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018423 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018423 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018423 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018423 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "062575cdb38e709723edbb54", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10018081 was prescribed for the last time using a po/ng route since 12/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d8f365a561e69cca2b2fea83", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first polys reading in 06/2100 for patient 10007818?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "61943ff9aadb518fc206c477", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a surgery called drainage of pericardial cavity with drainage device, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) )", "rejected": "SELECT\n\n\n####\n\n### SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100007818 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "18844d5794981ced81295346", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the method for disinfecting the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "\n.... (\n.ics1MSNS,.store.. OFV\nMS:11... .\n.\n\n1-11?MSa_\n'\n\n1.\n'\n-'\n\n'IN'"}, {"id": "ad2612489dcd53ed00312d17", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the last time patient 10021487 was diagnosed with injury to liver without mention of open wound into cavity laceration, unspecified in their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity laceration, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e0581975db0c811fc20544d6", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10038933's total multivitamins input amount in their last ICU visit.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'multivitamins' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT COUNT(*) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1"}, {"id": "460140392f817cccb9e244d4", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most frequent lab tests that patients had after being diagnosed with noncompliance with renal dialysis in the same hospital visit since 2100.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "19bbba7c30b65e559cde2364", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most frequent lab tests that patients were given during the same hospital encounter after being diagnosed with dependence on respirator [ventilator] status in 2100.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on respirator [ventilator] status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "e72bc975b9c19bf0df3b5f9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time during their first hospital encounter when patient 10031404 had the maximum value of lactate dehydrogenase (ld)?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "984b06bd38c5e69abd10d736", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most common specimens tested since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n##: SELECT SQL"}, {"id": "695b3083856ab31c0cd2853e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a procedure known as occlusion of right femoral artery with intraluminal device, percutaneous approach cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right femoral artery with intraluminal device, percutaneous approach' ) )", "rejected": "null"}, {"id": "62ce1e3f90c3aa7b3c7ffd03", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the total number of outputs patient 10011398 had since 12/26/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-26'", "rejected": "null"}, {"id": "d2c264c9a4496523fd9581ea", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 10/13/2100, when did patient 10038081 have his first input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-10-13' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "6a4f0f27325a4881d537e381", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the five most common specimens tested since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n### Question:\n\nCan you tell me the total number of patients who were given a procedure called other than drainage of other drainage of peritoneal cavity, percutaneous approach in 2100?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND strftime('%Y', procedures_icd.charttime) >= '2100' )"}, {"id": "6138410041007bba41d241af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10005817 get the glucose lab test in their last hospital encounter for the first time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "73d71dd48759ebd3e31a1e91", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had been diagnosed with unspecified place in hospital as the place of occurrence of the external cause?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified place in hospital as the place of occurrence of the external cause' ) )", "rejected": "null"}, {"id": "d8f6cf3bc53a60de0a9fc811", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10006053 last had a mrsa screen microbiology test in the previous month?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "95b288888e266b0b15c485fd", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most common diagnoses for patients with age 50s during this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT T1.drug FROM ( SELECT d_icd_diagnoses.drug, DENSEXC.COUNT(*) FROM d_icd_diagnoses JOIN d_icd_procedures ON d_icd_diagnoses.icd_code = d_icd_procedures.icd_code ) AS T1 WHERE T1.event_id IN ( SELECT admissions.row_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(T1.charttime) = datetime(current_time,'start of year') ) GROUP BY T1.drug ) AS T2 ) AS T3 WHERE T3.C1<= 3"}, {"id": "b472d5763672be20763ee562", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the previous year, was patient 10020187 to an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND datetime(transfers.intime) >= datetime(current_time,'start of year') AND strftime('%Y',transfers.intime) = '2100' )"}, {"id": "bfd437d57f4e32153e438f0c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in patient 10037975's first sputum test since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "99248704a41adef41854911d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total hospital cost associated with hyperkalemia since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperkalemia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT SQL SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperkalemia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id )"}, {"id": "45b872b3b1c160f0ef5249c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who stayed in careunit emergency department observation since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL AND admissions.dischtime is NOT NULL AND strftime('%Y',admissions.admittime) >= '2100'"}, {"id": "d0236a73c2938bd7a69aac21", "query": "Convert the question below to SQL query.\n\n### Question:\nWas any tpn without lipids medication provided to patient 10020740 on 03/26/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn without lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-26'", "rejected": "null"}, {"id": "64873d6508dd0dea262a7cd7", "query": "Convert the question below to SQL query.\n\n### Question:\nThroughout this year, what are the top five most common microbiology tests that patients were diagnosed with within 2 months after being diagnosed with saddle embolus of pulmonary artery with acute cor pulmonale?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'saddle embolus of pulmonary artery with acute cor pulmonale' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "bc7ad8b3ef9492deca744662", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, what was patient 10008287 diagnosed with for the last time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "MS.4-12 22118151190050039090918487'"}, {"id": "a5681c4eead8c8b2e1968ab1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much furosemide has been prescribed to patient 10027445 in 08/this year in total?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'furosemide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08'", "rejected": "SELECT\n\n\n##\n##### SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug.drug = 'aspirin (aspirin) (aspirin ec) (aspirin buffer) (aspirin ec (aspirin buffer)'s) AND prescriptions.drug.drug = 'levothyrox' AND strftime('%Y') = '2100'"}, {"id": "b6d9cd67e22e2ef748217cd1", "query": "Convert the question below to SQL query.\n\n### Question:\nIn patients who had the extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic since 2100, what were the four most common diagnoses that followed during the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "876f65e64154a3d0ee436ad3", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10008454's o2 saturation pulseoxymetry second measured on the last ICU visit less than the first value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "04f71c7e519351b6f93b7777", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequent diagnoses that patients were diagnosed with within 2 months after receiving diagnostic ultrasound of digestive system since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime)<= datetime(T2.charttime)"}, {"id": "f946291e703d6e542a4a7d37", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the three most frequently prescribed medicines within the same hospital visit after a diagnosis of family history of ischemic heart disease was made during this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of ischemic heart disease' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "ab607c4930656aed65054027", "query": "Convert the question below to SQL query.\n\n### Question:\nHas magnesium sulfate (bolus) been administrated to patient 10005909 since 03/02/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02'", "rejected": "null"}, {"id": "0cd11d35e8ac3515e3c55d6c", "query": "Convert the question below to SQL query.\n\n### Question:\nReveal the drug name that was first prescribed to patient 10014354 via the iv route in 10/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "6866d0c0c9db304d897bd1b8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism that was found in the last microbiology test on patient 10007795's abscess?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "3fa947a7c4c696baf058e932", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of hemoglobin of patient 10006580 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "cac9008f4f2f7e8937a4e13a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four diagnoses with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "1.2830.\n1. I have a total has been a total of the total chloride in patient 1000263542's body on this month/21-03?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents.item WHERE d_labevents.itemid IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.subject_id = 100263545 ) AND strftime('%Y-%m', labevents.charttime) >= '2100-03' )"}, {"id": "416848aeaf8b172ffb8fe4fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently performed treatments for patients in their 30s throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT T1.C1 AS C2 FROM ( SELECT T1.icd_code, DENSEXPRINT(T1.starttime) AS C3 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.age = 30 AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month') ) ) AS T1 ) GROUP BY T1.icd_code ) AS T2 ) AS T3 WHERE T3.C3 = 4 )"}, {"id": "f5565e8dca592ac7658c9ee6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10004720's daily average value of body weight in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "c6e9f8b7ab342b4f62878e06", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10007058 was prescribed medication since 03/2100 via the po route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "1153946181f7d7b47dbdc917", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007818 receive the tobramycin test for the last time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6c5ae1376c35e10f1ed23a4e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were some of the five common specimen tests given since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "28df687aecadf8f1d696c1f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10018845 been given phosphate test for the last time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d84b738e8882f159cbf1debf", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were diagnosed with postinflammatory pulmonary fibrosis, what were the top four most common microbiology tests conducted during the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "dc086ae27c1b78b95332d217", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the o2 saturation pulseoxymetry level of patient 10011398 last measured on the first ICU visit less than the first measurement on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "0577ee51b3ad3c9fcf8fbbae", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average value of oxygen in patient 10014729's body in 03/this year?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'", "rejected": "SELECT COUNT( DISTINCT cost.events WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND cost.event_type_id IN ( SELECT cost.event_types FROM cost.event_types WHERE cost.event_type_id IN ( SELECT d_cost.cost.cost_type_id FROM d_cost WHERE d_cost.long_title = 'extir-percutaneous [endoscopic] lysis of pancreatic ducts, open approach' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') )"}, {"id": "2ace025c677add406539f6bd", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any medication that patient 10039708 has received since 11/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'", "rejected": "null"}, {"id": "99ae2a1c4797235aeeccbd8a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who were prescribed bupivacaine 0.1% since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupivacaine 0.1%' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "c72069fe9515604ba1be94c3", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the first hospital encounter, what was the average glucose value for patient 10013049?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' )", "rejected": "null"}, {"id": "2e5708405e832d182494a66b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of straight cath output patient 10020740 had since 03/06/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'straight cath' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06'", "rejected": "null"}, {"id": "7615134b4fa7ff6ddf73b525", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who were discharged from the hospital in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": "SELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND strftime('%Y',transfers.intime) = '2100' ) )"}, {"id": "7d56993bcf3d2b526fae33a7", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 04/2100, did patient 10007928 undergo a lab test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',labevents.charttime) = '2100-04'", "rejected": "null"}, {"id": "f3249c1cae12b134951c017d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the average total hospital cost that includes a urea nitrogen lab test in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "04c15bde72e4c64e49a380e7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the total minimum cost for a hospital that includes a amylase lab test?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "ce7977eba118e89d42bc63b2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the diagnosis for patient 10029484 the last time during this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "b76a7905227123a769fc9e14", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many individuals are current patients in their 40s?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49", "rejected": "\n\n##\n##\n\n### SQL CodeCare\n\n\n### Question:\n\nHas patient 100143585 received any diagnosis for mitral stenosis?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mitral stenosis' ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100'"}, {"id": "764c1ad18155aabf053779ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug that was prescribed to patient 10027602 during this month via the po/ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "75054e4a84c29aca4b3607df", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of input patient 10021487 has received since 09/07/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07'", "rejected": "null"}, {"id": "781463ec4654dbff8c5df153", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10002930 have any prescriptions for medicines in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "c916df49979cb247be8c50a6", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total volume of output for patient 10039831 since 01/19/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'", "rejected": "null"}, {"id": "9b65257be5477d5e9497e3a6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the immuno-cancer drugs that have been on for the last 5 years.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSEXC.COUNT() AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10014035 AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 year') ) GROUP BY prescriptions.drug ) AS T1 JOIN ( SELECT transfers.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN transfers ON prescriptions.hadm_id = transfers.hadm_id WHERE admissions.subject_id = 10014035 AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "fc668a34c1c8516fc8aa5e48", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the code in icd-10 that corresponds to icd-11 for voice/resonance dis nec?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'catatonic type schizophrenia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1"}, {"id": "439e2e43115263121a562994", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first test of patient 10005348's microbiology urine in 09/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '09' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "29183d163063354c6c818147", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any medication that patient 10021487 has received since 12/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'", "rejected": "null"}, {"id": "17fee8730ce67c5cb81363da", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the diagnosis that patient 10019172 received the last time on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "\nSELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "61f316cdde3e8b077f86a486", "query": "Convert the question below to SQL query.\n\n### Question:\nHow old was patient 10003400 during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": ".\n\u200bM2 12.-_:MSMS112PA 222824915486492019's'"}, {"id": "6c26a6c8707782ccd2a0c56c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first time patient 10004733 stayed on this hospital visit in the careunit medical/surgical intensive care unit (micu/sicu)?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "5f932af6bf46cd7718dfafc4", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me what patient 10001217's last respiratory rate was on 12/05/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-05' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "90edd0b36b71d1dde04a4381", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most frequent procedures since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "MS.-2-007)1PA10017002/00202128051918580610.078180801848391585991 is the date of the last time that patient 1001148591 was discharged from the hospital?\n\n\n\n### SQL SELECT T1.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.subject_id = 1001148591 ) ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "c1bb80af8e65bc3a342a8f5f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you find the three most frequent drugs that were prescribed within 2 months after a swelling, mass, or lump in head and neck diagnosis was given since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'swelling, mass, or lump in head and neck' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "b058cd7f2df41092eaebc377", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the icd-11 code for candidias urogenital nec in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'transfusion of blood' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 )"}, {"id": "475d57ff575806d5690ed031", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their first hospital encounter, what was the last time patient 10001217 had a medication via the iv route prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "c7834523cd66eb840495c036", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most frequently ordered lab tests for patients within 2 months after being diagnosed with acute edema of lung, unspecified?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute edema of lung, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "0f5988ac990c3b052bc99527", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any new medication in the prescription of patient 10039831 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\nSELECT SELECT COUNT(*) FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100398317 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 day') )"}, {"id": "3df2ee46a071840f122d563f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the minimum total cost of a hospital that involves other and unspecified alcohol dependence, in remission in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "5d2dfd7a5a2882eb9da2724d", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were given closed [percutaneous] [needle] biopsy of kidney , what are the top five most common specimens tested afterward within 2 months?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "819929d03e825e64c34b20ad", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me about the most common five output events since 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "28:\n = the first21.\n09001 AND admitting."}, {"id": "e31b6cd38f5311472aa61be6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medicine does patient 80555 take after being prescribed by the other medical department of our hospital?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTIVE DESCRIPTION: The last time patient 8055 was prescribed a drug since 03/2100?\n\n\n### SQL:\n\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND prescriptions.drug = '0.325% sodium chloride' AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "5c292b2eff5ea33b4c5658b2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total cerebral ventricular #1 volume that patient 10027602 had since 03/08/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cerebral ventricular #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-08'", "rejected": "null"}, {"id": "4fbd8deeeee7c2df137faa1a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10039831's maximum asparate aminotransferase (ast) value in their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' )", "rejected": "null"}, {"id": "37f71e9451cf42cb7f4e0c69", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 25951 have a documented record of legal blindness-usa def in his / her family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NOT NULL AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' )"}, {"id": "fd67ddabf75b779af8cfe4ac", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease provide the four most common tests performed on specimens this year.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT# SELECTC1 OR ( strftime ( strftime ) FROM admissions ) AND admissions.discharges.d FROM admissions JOIN transfers FROM careunitesto admissions WHERE admissions.discharges.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers JOIN admissions ON admissions.subject_id = transfers.subject_id WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON admissions.hadm_id IN ( SELECT admissions.subject_id FROM transfers JOIN admissions ON"}, {"id": "ad87f821d1417e88606b21d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly diagnosed diagnoses for patients who had previously received laparoscopic lysis of peritoneal adhesions within 2 months in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic lysis of peritoneal adhesions' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "a1faad0653a8f9dc687564e5", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you calculate the total amount of output from patient 10012552 since 04/02/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-02'", "rejected": "null"}, {"id": "ac42588cbc7e442cc709a753", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 4758 subject to the test covid-19?\n\n### SQL:\n", "chosen": "null", "rejected": "\n.1SS-1.2SEDMSHANA's 1.- Which is the last 011/04.\n##\n04 ICU2135888 was prescribed medication in 04/this year?\n\n\n### SQL SQL:\nSELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( '04/this year' ) AND prescriptions.drug = 'po diltiazem hcl'"}, {"id": "c7fe6ea31f9f71af4dcc0072", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours is it since patient 10004733 last stayed in the careunit neurology in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "SELECT COUNT(transfers.stay_id) FROM transfers JOIN admissions ON transfers.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004733 AND transfers.careunit = 'neurology' AND datetime(transfers.intime) >= datetime(current_time,'-1 year')"}, {"id": "5584a484b396e900b09a1ff9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026406 been to the E.R.?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room'", "rejected": "MSMSMSPAG\n121.\ndiagni'm. What is the cost of the last time that patient 1000039285 was prescribed prescription medications?\n\n##\n\n### SQL SELECT T1.C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.subject_id, prescriptions.drug.drug FROM prescriptions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 1001852555 ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m-%d',prescriptions.starttime) = '2100-05-05' ) AND strftime('%s',prescriptions.starttime) <= '2100-05-06' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "bcf8bddfe8dcd3e449454450", "query": "Convert the question below to SQL query.\n\n### Question:\nSo how many hours has passed since patient 10021487's first traumatic hemothorax without mention of open wound into thorax diagnosis during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic hemothorax without mention of open wound into thorax' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "05a0dd22ccfcd8bac854d247", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10018423 have a performance of cardiac output, continuous procedure on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "48a5e161532f3acc6752f577", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most prevalent procedures for patients aged 20s in this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year') GROUP BY procedures_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 3 )"}, {"id": "8325c8b0200f0d5f16e96fd7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10021487 weigh during their first measurement in 12/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4f7c481bcc13707e66944d07", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three frequently ordered drugs for patients diagnosed with tobacco use disorder previously in the same month, this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSEXC.COUNT(*) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use' ) AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month') ) GROUP BY admissions.subject_id ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = T1.subject_id ) AS T2 ON T1.charttime = T2.starttime GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "40f3aab550a4fd091b0e4468", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10002495 was prescribed a medication during the first hospital visit via sc?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "4be47d4fcbaf07a2f5b1d8ac", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with bite of other animal except arthropod in 2100, what are the top five most common lab tests that followed afterward during the same month?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "5d27d425de44d1e9e60bb681", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the count of patients who were tested for troponin t since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND strftime('%Y',labevents.charttime) >= '2100' )", "rejected": "null"}, {"id": "192595f3a72877272b046e55", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is potassium chl 20 meq / 1000 ml d5 1/2 ns taken?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5 1/2 ns'", "rejected": "null"}, {"id": "97d549d940853218be2a6803", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10021487 last received the protein lab test on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1f0fce096cb3fb07a3c96ef2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the last time during this hospital encounter that patient 10004733 was diagnosed with proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "095a491640c35f9a56195a9d", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who took central venous catheter placement with guidance since 1 year ago, what are the top three most frequent diagnoses that followed within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECTIVE Drainage of peritoneal cavity, percutaneous approach's total hospital stay duration since 2100."}, {"id": "1d3f884b7931238b1dbb1779", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most common diagnoses of patients with age 40s this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": ":\n.....oc.t\u00f6ld\n\n\n.... ,\n\n1. =.owanie-..1\n1 JOHBMS'\n\n\n\n2?MSX22002121500101 0180002042191003003036003824011370.000048342469422000003'"}, {"id": "3f5ac405fb5c105f76ea0b91", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output that patient 10004235 first had during the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "be95e0c0ef52ac9abbba1a3c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of drainage of right pleural cavity with drainage device, percutaneous approach procedures carried out in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "d4677f8cd4b45df639326bef", "query": "Convert the question below to SQL query.\n\n### Question:\nGet the count of hospital visits by patient 10000032 since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10000032 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "0112d30f1318ad87f07d5ace", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the count of quetiapine fumarate prescriptions made since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'quetiapine fumarate' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "4d49aa5a44c5a8b00e811bf8", "query": "Convert the question below to SQL query.\n\n### Question:\nOn their last hospital encounter, what was patient 10006053's age?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "381ee96e607f7191231167cb", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the insurance plan in place for patient 10039831 on this hospital stay.\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL", "rejected": "null"}, {"id": "103e589c49e80280c9f04475", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the time of patient 10022017's first hospital discharge?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "5a217759e9fc00e289c1d8c9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the newly prescribed medicines for patient 10018081 today compared to those yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "f96633ec8fc87fce8f72854a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10008287's gender?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10008287", "rejected": "SELECT patient_id FROM admissions WHERE admissions.subject_id = 10008287"}, {"id": "d126628b6dfa7ff021c37cc5", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 06/2100, when did patient 10039831 receive the first mrsa screen microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a30a6f58cc091f3a0949184c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most commonly ordered lab tests for patients who were previously diagnosed with acute and subacute necrosis of liver within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "54258b49d9028f2fcc83e6d8", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total output since 03/07/2100 for patient 10039997.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07'", "rejected": "null"}, {"id": "e7f9bc2207fce85235ec07aa", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent procedures that patients were given in the same month after receiving injection or infusion of thrombolytic agent since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection or infusion of thrombolytic agent' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "b2690f1d201d900a6e245a5a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the top three most commonly prescribed drugs are?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n201.\n'"}, {"id": "c4fbaf36df80d6e9685e37c1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021312 had a medication prescribed via the vg route since 5 months ago?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'vg' AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "535fa7171aca46e1fa19b72d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that was first prescribed to patient 10003046?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "b661bb18d48da0b0b3f54277", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, how many patients required amitriptyline?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' AND strftime('%Y',prescriptions.starttime) >= '2100' )"}, {"id": "0293a5acee37151a49ceaa8a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any dextrose 50% been given to patient 10016742 since 20 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-20 month')", "rejected": "null"}, {"id": "523f9419c20f37e75f17f229", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of ondansetron that patient 10027445 were prescribed in total?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'ondansetron'", "rejected": "null"}, {"id": "0ac5e8c127eb6f8f74e5d260", "query": "Convert the question below to SQL query.\n\n### Question:\nTotal number of patients who had arteriography of cerebral arteries in this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\n##\n##\n\n### SQL:\n\nSELECT SELECT DISTINCT cost.cost FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100036055 ) ) AND strftime('%Y',cost.chargetime) >= '2100' )"}, {"id": "f6401e3fea26ee15aed66ec1", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the lactate reading for patient 10015860 last measured on the first hospital visit less than the value second to last measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "4e7054c0bde47479f064c4df", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 7112 had a family history of a disease?\n\n### SQL:\n", "chosen": "null", "rejected": "20MS_1.PAGEPAINMSPA T10003120778869 AND admissions.discharge FROM SQL?\n<select the diagnosis code of the last hospital visit for patient 1000214875?\n\n\n### SQL:\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id = 100214875 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "61ac565159bfa5d3f30f2941", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the prescription drug given to patient 10018081 within the same day after undergoing the ileostomy, not otherwise specified procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "837818ce3b6b8d41acc4c4ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first lab test result of the cholesterol, total for patient 10014354 in 10/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a2cf8619107c9912a1bc932a", "query": "Convert the question below to SQL query.\n\n### Question:\nWanna the last time that patient 26799 had a medication that should be taken regularly?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'nac (rectal) (250 mg) (250 mg/500 ml) (15%)' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "fa8dc90654adb35a8f98e8e2", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10005817, when was your last mrsa screen microbiology test since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "45128f30bf831e9b55cca497", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did patient 10026255 attend the hospital this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026255 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT SQL Select count(*) from admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002625 ) ) AND datetime(transfers.intime) >= datetime(current_time,'start of year','-0 year') = datetime(current_time,'start of year') )"}, {"id": "ecaff29ecddb0f78486c9f42", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the maximum total cost of a hospital that involves a procedure called closed [percutaneous] [needle] biopsy of kidney?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "dd84074c0fd0874c556d0511", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often did patient 10018845 go to the ICU?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 )", "rejected": "Get the top five most frequent procedures performed on patient 10018458 during their last hospital encounter.\n\n### SQL:\nSELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018458 ) ) ORDER BY procedures_icd.C1 DESC )"}, {"id": "b93f8cc0aaa5e1bff812dd3d", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there a test that patient 65759 had been given?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT"}, {"id": "8478e6de5e5ee9e5033f7355", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients since 2100 were diagnosed with bacteremia within the same month after the diagnosis of unspecified essential hypertension?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "2fe3354da7c1d59bea4dda70", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the cost for the drug sodium chloride 3% inhalation soln?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium chloride 3% inhalation soln' )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium chloride 3%' )"}, {"id": "cc1b03b3dc9e12a0e0841326", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019385 been to the emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.admission_location = 'emergency room'", "rejected": "\n### SQL:\nSELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "bb02020436904947b9602d44", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the percentile of the red blood cells value of 3.03 among patients of the same age as patient 10010471 in the first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 3.03", "rejected": "null"}, {"id": "1d930d1bc64cf3b52d4cfe25", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total output on 11/28/this year for patient 10027602.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '11-28'", "rejected": "SELECT SUM(outputevents.valuenum) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.starttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',outputevents.charttime) = '12' AND strftime('%d',outputevents.charttime) = '28'"}, {"id": "a975cd9e522a7abecfd9d1ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10001725's daily maximum weight this year?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "_UNKONS24905311887585889"}, {"id": "ba23c3978fa23c419cd21833", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know the ward id of patient 10624 to which they are admitted?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SQL Select admissions.ward FROM admissions WHERE admissions.subject_id = 100030467 AND admissions.dischtime IS NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "edb3cbffb2caabbeb6d54ab6", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most frequent output occurrences.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": ".111012?MSPAGMS2251849342509218 AND NOT-2024 AND datetime AND datetime? NOT IN ( SELECT SQL ) SELECT FROM T2 AND T1 IS NOT NULL AND T3 IS NOT NULL AND T4 IS NOT NULL ) AND ( strftime('%Y') = '21002'"}, {"id": "f11bfe4033fc6ace5d5cf382", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021312 receive any destruction of left main bronchus, via natural or artificial opening endoscopic treatment in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of left main bronchus, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "7a5ad1595bbd2ad7f69bc6ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time the arterial blood pressure systolic of patient 10002495 was measured at a reading less than 101.0 on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 101.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "040d18e997bb872c3314ccba", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what was patient 10008454's monthly minimum weight since 2 months ago?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-2 month') GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "\n###sql Question:\n\n### SQL:\n\nSELECT the number of patients who were prescribed a medication in 21000.\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'clonidine (iv) (iv toal' ) AND strftime('%Y', prescriptions.starttime) = '2100' )"}, {"id": "3b1ed5c49626132195b70ec8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism in the last abscess microbiology test of patient 10001217 since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6fab218a9bcfb128b745f81b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the top four most common diagnoses of patients with an age of 20s?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "102866b5841e8a98e3f1d51b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you list patient 10031404's monthly average weight?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "6bffa26dd035a9778fad2e76", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you confirm what was the last heart rate for patient 10016150?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "f06966c4eb707fc9298cf8ed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10015272 last had the creatine kinase (ck) minimum value?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a5e4283c5899fd833228b799", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most common laboratory tests undertaken by patients within the same month following a diagnosis of alcohol withdrawal since 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol withdrawal' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "ef58c8f426926b9b7c5610fc", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving respiratory ventilation, greater than 96 consecutive hours.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "a5e6297c3b4d206acb9998da", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first microbiology test that was given to patient 10014354 since 4 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-4 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "781ef8abeed146047598411d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how many extracorporeal circulation auxiliary to open heart surgery procedures were done in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "add9d8c55cfa9b469ea183bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top four most frequent output events during this year?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n## SELECT SQL SELECT DISTINCT T1.month FROM d_icd_procedures WHERE T1.hadm_id IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158602 ) ) AND datetime(T1.starttime) = datetime(current_time,'start of month') = datetime(current_time,'start of month') ) AND strftime('%Y',T1.starttime) = '2100' ) )"}, {"id": "48e8561f4462026521fab248", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three diagnoses of patients in their 20s during this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 20 ) AND datetime(current_time,'start of year',diagnoses_icd.charttime) = datetime(current_time,'start of year') ) GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "558b74ae3a2858468e9b6d75", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was a insertion or replacement of external ventricular drain [evd] procedure conducted since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "b210336ce9274694af8855f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was an insurance plan for patient 10018845 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "a260a55497a1c2d08fd300c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen is the earliest scheduled hospital visit by patient 91249?\n\n### SQL:\n", "chosen": "null", "rejected": "3 listened(3M, 10MS010000004's00000518440.04863086993718'"}, {"id": "d17c786dec93d192f68c22dd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10027602 had input on 12/03/this year?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-03' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-03'"}, {"id": "ab35055cb752554bf2ab3c26", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time since 10/2100 that patient 10038992 was prescribed with vitamin d and felodipine at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'felodipine' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "01bc93ed00df686c5593006f", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time, what was the medication that patient 10016150 was prescribed in 05/2100 via the im route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "eee2d17dec0a42b12da8deaa", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, how many patients were prescribed prismasate (b22 k4)?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prismasate (b22 k4)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100177945 ) ) AND strftime('%Y', prescriptions.starttime) >= '2100-01' )"}, {"id": "721bfea157a6426f9d055a41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dose of 0.83% sodium chloride prescribed to patient 10018501 in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = '0.83% sodium chloride'", "rejected": "null"}, {"id": "edf4e6f3df6825947d302e8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10020944 measured its respiratory rate less than 21.0 since 348 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-348 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "bd1e0ce3084fab70f0a0f6db", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any or colloid intake medication been given to patient 10039831 since 07/26/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-26'", "rejected": "null"}, {"id": "2dc6aa9a4ecdf77dc85c452e", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve patient 10018423's monthly minimum weight since 03/2100.\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "c9e6ec1ba862ca6788412403", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top three most frequent medications prescribed within the same hospital visit to the patients in their 60 or above after they were diagnosed with other ascites?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ascites' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "527f4ad3f397267a5cdd7622", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me about the most common three output events.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n.... d. \n\n4-.-'D J. -.\n AND 7.?1.11? W.32.0119UMSMSMSPAK2315 1.1.MSPA's 150003089090778589?'"}, {"id": "78c274657cd4e1d8e8b02190", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most common diagnoses since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": ", \n year.12.11\n2.-21195M03/220.20931.MicroMSMSMSPAMSPA-SQL30036719.0.0.049'"}, {"id": "beb64497e8a5dd3747e96f78", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 38.1 in the laboratory test with hematocrit at the same age of patient 10019568 on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 38.1", "rejected": "null"}, {"id": "51b0ff1fc9bfcd9831928425", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen test that patient 10002428 had for the last time in 07/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '07' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1794f31aaf8abd01fe9c8e47", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the five most frequent microbiology tests since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "3 of17616\n's the last 0 221 189856823727's microbiopsy of the last time is the first time on last month?\n\n\n### SQL\n\nSELECT SQL>\n\nSELECT microbiologyevents.procedures_icd_code FROM microbiologyevents WHERE microbiologyevents.icd_code = 'microbiologyevents' AND strftime('%Y', microbiologyevents.charttime) >= '21001-07-15'"}, {"id": "7c03fe01f161036f720f6d7e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism detected in the first microbiological examination of patient 10019385's urine on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e32a0cfb6a8e66331f21aaa1", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 21134 have any history of depressive disorder nec in his / her family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021487 AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'depressive disorder nec' )"}, {"id": "43ac9cba569c151427df4304", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10021666 have last as the output since 03/28/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-28' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "4e8e76dc6a0595e8d2d83aba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the time of patient 10029291's last blood culture microbiology test in 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "53b45637910db65da16c946b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat procedure was given to patient 10029291 two or more times since 30 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "db10433748c0f29cafd81920", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the dosage of an opioid given to patient 21110?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1 IS NOT NULL FROM ( SELECT SUM(inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214879 ) ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'opioid' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)"}, {"id": "deb948e109129653ea1a4554", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat about the single rooms out there now?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n., 1.121 100000431469986418s 1100316s 01'"}, {"id": "91233f4f7f64dbd5fbd43579", "query": "Convert the question below to SQL query.\n\n### Question:\nPresent the count of ICU visits for patient 10006053 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',icustays.intime) >= '2100'", "rejected": "null"}, {"id": "ed782775b12829eac1c6a491", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism found in patient 10015860's first swab microbiology test in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'swab' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "59a23b41fa280018e0e17257", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of enalapril maleate prescriptions.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'enalapril maleate'", "rejected": "'\n (\n. on.\n.\n..atr , \u0401.1..!\nMS 1.-o. \u2013.1.\nMS 1\u042b 12.1-\nMS\n MSMS 2:PAINMSMSPAMSMSK000000000000281200033321010000005400001140001'"}, {"id": "9dc9d63f50bb54246fc355f2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum hospital cost to include a drug called nicardipine iv since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nicardipine iv' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "B\nm M.\n\n_'?.--PAMS1\n..MSMSPA 30200011.PAY.\n))INK'"}, {"id": "c56c95b8d5030cf37d0e4528", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that patient 10002495 was prescribed within the same day after receiving a assistance with cardiac output using balloon pump, continuous procedure in 06/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "ea10182ca02a264d05d0a0c6", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total 0.9% sodium chloride dose that patient 10001217 has been prescribed during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = '0.9% sodium chloride'", "rejected": "null"}, {"id": "f0229fb196610726d6ec7c44", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was other excision or destruction of lesion or tissue of pancreas or pancreatic duct carried out since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other excision or destruction of lesion or tissue of pancreas or pancreatic duct' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "c3b9775f6f9f3f0a14d7ec29", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the first time in 08/this year, how much scopolamine patch was prescribed to patient 10016742?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'scopolamine patch' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "2cc3cfa013ef1b065613e661", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of a hospital stay involving bariatric surgery status in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bariatric surgery status' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\nSELECTC1 = ( SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = 'bariatric surgery' ) AND strftime('%Y', cost.chargetime) = '2100' )"}, {"id": "2f5d42ba584507b3ec8786a4", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10038081's total tap output since 10/06/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tap' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-06'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-06'"}, {"id": "a718668474f99aed79794a78", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the weight difference of patient 10027602's body second measured on the last hospital visit compared to the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "bc678bd819f6d9fbf32780a6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10021312's first visit to the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021312 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "a25bb889984fbcb71773db73", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the yearly minimum amount of patient 10037975's pre-admission/non-icu intake input.\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission/non-icu intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "8e476e63901b7be2cdb602f9", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me what patient 10027602's first arterial blood pressure diastolic was since 08/13/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "6d5c44e86eb4666c6881716c", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 20589 a person with a family history of any health problems?\n\n### SQL:\n", "chosen": "null", "rejected": "\n## Question:\n\n##: What was the last time that patient 100200454 was measured in 04/2100 for heart rate?\n\n\n### SQL:\nSELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100200454 ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-04' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "1466571b504c531449430ed3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10018081 o2 saturation pulseoxymetry was measured greater than 98.0 yesterday.\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 98.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c3138909fa5b171f0d57fabd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the minimum daily number of patients who had hypovolemic shock in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypovolemic shock' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT SQL SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.icd_code, COUNT( procedures_icd.charttime) AS C1 FROM procedures_icd JOIN admissions.subject_id = patients.subject_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hypovolemic shock' ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 )"}, {"id": "d6ed2ef486b7d554f4160ba6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output that patient 10027445 had last since 06/02/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-02' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "59d3175a30ad9fe65e39996d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times, since 1 year ago, was a open reduction of fracture with internal fixation, humerus procedure ordered?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "5272430cbc48927e9597669b", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 07/26/this year, when did patient 10016742 receive an input for the first time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-26' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "3f228b2d28b47133dbf76724", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the patients with age 30s, what are the top four most frequent diagnoses since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "15: What-1.1232011990-003011830477770929'"}, {"id": "723f3f4a1100077de462dfa3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total hospital cost that includes cefpodoxime proxetil in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'cefpodoxime proxetil' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "16214MSPA 2102018414265085599219s.\n\n12021-03's 01:00:00:00:00'"}, {"id": "63e5457b5b019e78c8dbf939", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most common microbiology tests for patients who were previously diagnosed with neoplasm of unspecified nature of endocrine glands and other parts of nervous system within the same hospital visit since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'neoplasm of unspecified nature of endocrine glands and other parts of nervous system' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "b4ca4b338d97b7278100eed6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time when patient 10026354 was prescribed iso-osmotic sodium chloride and 0.9% sodium chloride (mini bag plus) at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND admissions.subject_id = 10026354 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride (mini bag plus)' AND admissions.subject_id = 10026354 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f8334a7c23e689cadd23c209", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10008454 administered any solution during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' )", "rejected": "10 peT\n.eKSQL. spirit2.MSMUMSMSPAGPAMSMSMSPASTPA PAGEPA"}, {"id": "0d93e83a24f730a575941764", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there any lisinopril, 0.45% sodium chloride, or levothyroxine sodium ordered for patient 10002428 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', '0.45% sodium chloride', 'levothyroxine sodium' )", "rejected": "null"}, {"id": "5f0250669656b6e45463dfba", "query": "Convert the question below to SQL query.\n\n### Question:\nName the four most frequently prescribed drugs within 2 months following a diagnosis of polyneuropathy, unspecified this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "ecfdce415b13a6552ae21b5a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10004235's average metamyelocytes value in 03/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'", "rejected": "null"}, {"id": "b6ac0c7fa5f88067047b90e0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10004720 had the maximum ptt since 12/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "35b0b505d474e73b841b45f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last weight of patient 10029291 recorded since 03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7f9f38f270747ef86246457d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan anyone help me determine the code that corresponds to icd-11 and for preterm nec 2000-2499g in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "..6,..m.PA...\nrose.: 2\n.DMS 11212222420028240617016321303492158207'"}, {"id": "04252ccebd8d2d108f1880fc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most frequent procedures since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n's1?000-0000857032132142111110144067747776."}, {"id": "cc3ae3ee46938d74fbd6ba5e", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who were diagnosed throughout this year with hepatic encephalopathy.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hepatic encephalopathy' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "MS).C1MS-2132110422001-0.038300318019284206s'"}, {"id": "dbb4226192d4ef37cbf426dd", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 07/2100, when did patient 10031757 last get prescribed lactated ringers and metronidazole (flagyl) at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "5df781cee8420b4e67b5b670", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you show me the top three most common microbiology tests since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n.11\nD120221213752211-0.017\n##'010139596180808'"}, {"id": "74758a7e91cabecd02edc1c8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug patient 10021118 was prescribed with within 2 days after having received a performance of cardiac output, continuous procedure in this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "0a7229f1e72f42ee2dc14404", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10008287 had an maximum po2 in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "\nSELECT SELECT MAX(chartevents.starttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100076055 ) AND chartevents.hadm_id IN ( SELECT chartevents.hadm_id FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007605 ) AND chartevents.hadm_id IN ( SELECT chartevents.hadm_id FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007605 ) AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007605 ) AND chartevents.charttime IS NOT NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.d_id IN ( SELECT outputevents.d_items.d_id FROM d_items WHERE d_items.d_id IN ( SELECT outputevents.d_items.d_id FROM outputevents WHERE outputevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007605 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.d_id IN ( SELECT outputevents.d_items.d_id FROM outputevents WHERE outputevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007605 ) ) ) ) ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-09-18' )"}, {"id": "a8704a105b87163e999ca81d", "query": "Convert the question below to SQL query.\n\n### Question:\nAre there new medications in the prescription of patient 10018081 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n### Question:\n\nWhat was the last time patient 10018081 received a lab test that had a value of anion gap's anion gap, urine in 10/this year?\n\n\n### SQL:\n\nSELECT labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap, urine' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "68ee1d315023f57029b6ce03", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the yearly minimum piggyback input for patient 10014729 since 02/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-02' GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "b5e869bff806f007494d55ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat do you do to disinfect the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "MSC.MSHAID's the drug that was prescribed for patient 10000478555 on this month/2100?\n\n\n##' AND strftime('%s' = 'since 03/11/2100'"}, {"id": "3922a8bf089907b9a543783e", "query": "Convert the question below to SQL query.\n\n### Question:\nAfter receiving enteral infusion of concentrated nutritional substances during this year, what are the three most common diagnoses that patients received within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "f6c6d5c25fc74762144de677", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost that involved implantation or replacement of carotid sinus stimulation device, total system since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "0ef0e1be7cef42de551d0ac7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10007818 had been prescribed medication through the pr route on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a40106b94aad93108e39fdbe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug prescribed to patient 10031757 for the first time via po route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "dec5e9aec0e74113cc8382ee", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the duration of patient 10014354's last stay in the ICU?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "\nSELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004354"}, {"id": "42e82e626162ecd5abe81360", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when patient 10016742 had their first rapid respiratory viral screen & culture microbiology test in 08/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "d046092dc750a6865cd511f6", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 9474 ever experienced any side effects during a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n\n##\n\n##\n##\n### SQL Code of the last time patient was prescribed a drug since 03/03/21000?\n\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.drug = 'nystatin' AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-03-03' ) = 1 AND prescriptions.drug = 'nystatin' ) AS T2 FROM prescriptions WHERE T1.starttime IS NOT NULL AND T1.hadm_id IS NOT NULL )"}, {"id": "f0782e76ee1d6e988ec5bb08", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of the drug named divalproex (extended release)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'divalproex (extended release)' )", "rejected": "\n##SELECT\n\n### SQL:\n\nSELECT the minimum total hospital stay length for patient 100079445 in their first hospital visit.\n\n\n### SQL:\n\nSELECT MIN(T1.C1) FROM ( SELECT SUM(length_of_stay) AS C1 FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100079445 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "0702bc77d929f78085010bb0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism that was found during the last pleural fluid test of patient 10021487 during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8306d8e894fa1b6d53f8314a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of the hospital that includes a medicine named heparin in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin' AND strftime('%Y',cost.starttime) = '2100' ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "6e32e4314cb1b08ef73c4739", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last diagnosis for patient 10040025 since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "4c7e73d8e877dda69f26211c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10038081 had the minimum value of immunoglobulin g?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "db408655e01275e4bcc8c7bc", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the patient 10021666 a male or female?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10021666", "rejected": "SELECT SQL SELECT admissions.gender FROM admissions WHERE admissions.subject_id = 10021666"}, {"id": "f224a6e013d318ebe61083f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug first prescribed to patient 10039708 in 11/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "20e4eddef9991c65e965aa1d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 5828 had any additional catheter tip-iv test performed on him?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'catheter tip-iv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158605 )"}, {"id": "f08251f8b3dd5a479060e87b", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 12/2100, how much did patient 10015931 weigh during the first measurement?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "fc39ef8cc2866f09ef373bdd", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you unfold the three most frequent outputs since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "6841f0afef30c9eaf743f781", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most common lab tests during this year.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "f76e82ade10ee685ac166e82", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a procedure named other endovascular procedures on other vessels?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) )", "rejected": "null"}, {"id": "377abeef64a076e8f592c701", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10039831 last received a mch lab test on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c66698669f239c7f44238998", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most common laboratory tests undertaken by patients during the same hospital visit following a diagnosis of other cirrhosis of liver?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "c35d03883eff2c60ecc563cf", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were prescribed bupivacaine 0.1%?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupivacaine 0.1%' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "null"}, {"id": "2aa7ae5c7002d9117a347f9e", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top four diagnoses that have the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "\n### SQL:\n\n### Question:\n\nWhat is the total number of times patient 100379984 was given a lab test?\n\n\n### SQL:\nSELECT COUNT( DISTINCT labevents.chartevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100379984 )"}, {"id": "67d324104c936264768323f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10036156 was tested for creatine kinase, mb isoenzyme on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "88feed4e79da04e646ebc129", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that patient 10027602 was last prescribed since 03/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "de871565192e846d9c7ca39a", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10022017 have a pt test done in 10/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10'", "rejected": "null"}, {"id": "3cd0a6cd42161066ac6ee01a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most often conducted microbiology tests since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_TOTAL_C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1"}, {"id": "942603b5dceccf0a7d2a31df", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who were discharged from the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL", "rejected": "SELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers JOIN admissions ON transfers.hadm_id = admissions.hadm_id ) AND transfers.dischtime IS NOT NULL )"}, {"id": "48805e4216bd012669a77b8c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four commonly ordered treatments for patients in their 20s?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "04f7c8bdde444d9384216f93", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of ICU visits of patient 10020786.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 )", "rejected": "null"}, {"id": "8f05fa033e6974a273bc0ea2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhere are the single rooms out there now?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other type of injection of thrombolytic thrombectomy of cerebral artery by catheter, percutaneous approach' ) )"}, {"id": "257b96b1dd73002157d478e9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10038999 have for the last time since 04/14/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-14' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "97d4f5fa5be6b24ab07da93f", "query": "Convert the question below to SQL query.\n\n### Question:\nI want to know the total volume of input patient 10019172 has received during their first ICU visit.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 )", "rejected": "null"}, {"id": "d8f75bffa5cc49d6e7389a89", "query": "Convert the question below to SQL query.\n\n### Question:\nI need the total volume of input for patient 10005909 since 07/05/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-05'", "rejected": "null"}, {"id": "bae75ab280f0f80ba298c0cb", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10037928's age on their last hospital encounter was what?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\nSELECTIVE PROCEDURES PERFORMED BY PHYSICIATRICIAN\n\n\n### SQL:\nSELECT DISTINCT procedures_icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '998999' AND strftime('%Y', d_icd_procedures.charttime) >= '2100' ORDER BY d_icd_procedures.charttime DESC LIMIT 1"}, {"id": "72544e79d8ced4be6541a0a1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most commonly performed lab tests for patients who were previously diagnosed with other primary cardiomyopathies within 2 months, since 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other primary cardiomyopathies' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "170d16d87b8d77ec966d5f56", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10021487 has last received a protein lab test in this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "017d9aef746962d1c3d9d52e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027445 last receive a mrsa screen microbiology test since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "446ee7d9f8e891fa807c4f29", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much of a difference is there in patient 10004720's weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "ace4be317f182e1697b40080", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich were the three most commonly ordered procedures for patients previously diagnosed with acquired absence of organ, genital organs within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT T1.C1 AS C1 FROM ( SELECT d_icd_procedures.icd_code, DENSEXC.C1 FROM d_icd_procedures JOIN dense_hadm.transactions ON d_icd_procedures.icd_code = dense_hadm.icd_code ) WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY d_icd_procedures.icd_code ) AS T1"}, {"id": "559cabbd94ac4b49afae49bd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10020187's weight differ from the last value measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "3b5a20289fcb449af1962529", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the output patient 10018081 had for the first time today?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(outputevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(diagnoses_icd.charttime) = datetime(current_time,'start of month') = datetime(current_time,'start of month','-1 month') ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1"}, {"id": "c6af3f026c0e32b6e92878fe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007928 first receive a lab test for urea nitrogen on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "507c98230efbbf1d84008059", "query": "Convert the question below to SQL query.\n\n### Question:\nIs it patient 10003046's o2 saturation pulseoxymetry last measured on the last ICU visit greater than second to last measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "7c43cec9b8ce603b7b6a81b1", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 07/06/2100, when did patient 10036156 receive an input for the first time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-06' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "3fb220ac077d37a359147acd", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 69761 have a scheduled appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": ".AArray.\n\n2 2. \u043d\u0430\u0434\u043c\u043e\u0440B31-221222689220.MSPA.\n\n\n = the current thi.\n\n0020.0.0.038.03.05 AND T1 CANCANCER CANCER'S output FROM CANCER CANCER"}, {"id": "d1296c6e0fcaaa1292187c95", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last microbiological test of patient 10022281 since 06/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1d5c343c436c4699ca75db67", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10013049's glucose second measured on the last hospital visit is greater than the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "aef5e5dbf6c5848167e2f641", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10004720 prescribed a medication via the oral route the last time in this month?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'oral' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "33d0ec324183f0e65eb1f466", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10020740 was prescribed drugs via po in 07/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "c90f896b24cab48d06c88f3d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total input for patient 10007818 since 01/12/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-12'", "rejected": "null"}, {"id": "d754a3e8d810070834fab3af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost that involves other appendectomy procedure in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other appendectomy' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "af707d41fac6dee4c1688787", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 11/2100, when was patient 10021487's first microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.starttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "ff7c3e66b7fe93c4c036fe1e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10017492's difference in rbc from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "c1052714fdc43216d8caaaa3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four diagnoses with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "(2MS1 )' )'\n##\n' AND admissions."}, {"id": "7c2ab9c849f250ca7ae3054c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first microbiological test of patient 10027445 since 04/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "dd650f0ae2906a001a4313a6", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the maximum total cost in a hospital where potassium chl 20 meq / 1000 ml ns is used during this year?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml ns' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "ad935ae937227d5927667234", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the count of patients who were prescribed dexamethasone since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dexamethasone' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT SQL SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.drug = 'dexamethasone' AND strftime('%Y', admissions.admittime) >= '2100'"}, {"id": "0f1f7818e92f4038e40e8fb5", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most commonly prescribed drugs during the same hospital encounter to the patients aged 40s after diagnosed with epilepsy, unspecified, not intractable, without status epilepticus.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "d15888d8cda931dc5035830d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which were the top three most frequent specimens tested?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": ". 1'.. (\n1\n M SE.0;.\n2.01.-. 1t P2MS.11.C09MS_1 10121321620210142161320.\n##"}, {"id": "465aed14cf9939565ad6d4cc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was a other endovascular procedures on other vessels procedure conducted since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "-2.\n) 22432279023713990184506168876's 0'"}, {"id": "59b4f366d08a05218ec8287d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most common lab tests since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT\n\n\n### Trace the top four most frequent procedures that patient 100180456 had during the last year.\n\n\n### SQL:\n\nSELECT d_icd_procedures.icd_code, DENSE_PROCEDURE_LABELS.charttime FROM d_icd_procedures JOIN d_icd_procedures_temp ON d_icd_procedures.icd_code = d_icd_procedures_temp.icd_code WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180456 ) AND datetime(d_icd_procedures.charttime) >= datetime(current_time,'-1 year') ) GROUP BY d_icd_procedures.icd_code )"}, {"id": "ffa10298ec3846d375cbd553", "query": "Convert the question below to SQL query.\n\n### Question:\nLet me know the total quantity of input patient 10027602 received since 09/23/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-23'", "rejected": "null"}, {"id": "7fd127de8b5bc25c0ca5a31b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you find the five most frequent drugs that were prescribed within the same hospital visit after a cachexia diagnosis was given since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "9cfc6425bde940cf398a73dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the average monthly number of patients who had multiple fractures of ribs, bilateral, initial encounter for closed fracture in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'multiple fractures of ribs, bilateral, initial encounter for closed fracture' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "0878aade13d38cab157cad47", "query": "Convert the question below to SQL query.\n\n### Question:\nAfter receiving laparoscopic robotic assisted procedure this year, what are the four most common diagnoses that patients received within the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "5e33fcec4342525311fca4cc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time the respiratory rate of patient 10018081 was greater than 21.0, on this ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 21.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "eae749337c708ec5697cf97e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medicine prescribed to patient 10020740 for the first time since 03/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "\nSELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'nystatin' AND admissions.subject_id = 100047333"}, {"id": "7808f5d4ac9c6409be01f55f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the prescription drug given to patient 10004235 in the same day after undergoing the simple excision of other lymphatic structure procedure since 07/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "1ba68173e9103374da571bcf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10018423's insurance name on their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "(. B21_0111PAMS\n.\n\n\n1.MEMICUNSPA.\nMSPAY.orgINI don't there anytime when was the last time that patient 10003999974 was diagnosed with coronary atheroscopy of necrosurgery?\n\n\n\n##Cite the name of the first drug that was prescribed to patient 10003999974 during the same hospital visit after being diagnosed with unspecified abnormal heart murmur of aortic valve?\n\n### SQL:\nSELECT SQL: SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100399974 ) AND datetime(prescriptions.starttime) >= datetime(current_time) AND strftime(prescriptions.starttime,'start of month') = '21000-02-03'"}, {"id": "b90aaff4f6dc54dd7eefdaae", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequent microbiology tests since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": ") 0\nri-\n\n_.11.2.\n.?10'\n\n\n: 0121.MSMSX-12490.0.0.9\n\n\n03036829861225516 total since 02/02/04/03/210?\n\n\n04.03.03.05'"}, {"id": "1653c4779514ff5b7d86cad6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were diagnosed with cyst and pseudocyst of pancreas during the same month after the first diagnosis with other and unspecified alcohol dependence, in remission?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cyst and pseudocyst of pancreas' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "78721ebce9100a0b2d015be8", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total hospital cost that includes respiratory ventilation, greater than 96 consecutive hours since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "\n### SQL:\n\nSELECTIVE procedure code for respiratory ventilation, unspecified in 2100.\n\n\n### SQL:\n\nSELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE.starttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T1 WHERE datetime(T1.charttime) >= datetime(current_time,'-1 year') ) AND strftime(T1.charttime,'%Y-%m-%d') = '2100-03' )"}, {"id": "e66b7f09efd2987de26a10ad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007818 first have their maximum arterial blood pressure mean on 07/07/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '07-07' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "16e880e54314b4d23201e4d1", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most common lab tests.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "<PAMSG10021921-0028189980's last 0401's last month, what was the last time patient 1000389381 was given a lactate dextrose lab test?\n\n\n### SQL:\n\nSELECT labevents.starttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100389381 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dextrose' ) AND strftime(labevents.charttime) = '2100-03-21' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "a14cb4f846f35ff7611f1dbc", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most frequent lab tests since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT\n\n##\n\n### Question:\n\nWhat was the first time a blood test was given to patient 100360445 since 03/2100?\n\n\n### SQL:\n\nSELECT MIN(inputevents.starttime) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036045 ) ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03'"}, {"id": "dcd2227eec0068298417064f", "query": "Convert the question below to SQL query.\n\n### Question:\nGive a count of the number of ICU visits of patient 10020187 throughout this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "81e40ba71ccb07316db2401c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10007058 had the minimum heart rate since 11/20/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-20' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d86c1530c01a8065fe956df5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug patient 10010471 was prescribed for the last time using the po route since 03/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "77238633972ba57331af47e1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of ciprofloxacin 0.3% ophth soln that patient 10026354 has been prescribed since 10/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.drug = 'ciprofloxacin 0.3% ophth soln' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'", "rejected": "null"}, {"id": "72666450524051b2095429f8", "query": "Convert the question below to SQL query.\n\n### Question:\nIs it patient 10012552's arterial blood pressure mean last measured on the first ICU visit less than first measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"}, {"id": "7bf454dec8755f5d448775d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a surgery called performance of urinary filtration, multiple?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of urinary filtration, multiple' ) )", "rejected": ".. 0 2 0) (Kid212!:36MS' date"}, {"id": "3a5ab4d7328a4d17c25ac1f9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10020740 last prescribed the medication via the td route in 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "10379bc71183afe73e396f57", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is 0.9 creatinine in a patient of the same age as patient 10020740 during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.9", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 30 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ) AS T1 WHERE T1.valuenum = 0.9"}, {"id": "28bdbd0cf00eb27eaead2cf5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10007818's respiratory rate was measured at greater than 18.0 on 07/20/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 18.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '07-20' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d4255f4b8d7db34c02b8c1c8", "query": "Convert the question below to SQL query.\n\n### Question:\nThroughout this month, when did patient 10008454 receive the last urine microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT SQL SELECT microbiologyevents.starttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "b8b17acef0f82e15a62e972b", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10010471 been ordered bag, ipratropium-albuterol neb, or ferric gluconate in 05/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.drug IN ( 'ipratropium-albuterol neb', 'bag', 'ferric gluconate' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05'", "rejected": "null"}, {"id": "dd2c47d5a140368a2b1f07a1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10006053's last input during their last ICU visit?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT)\n\n\n##\n##\n\n### Question:\nHow many times was percutaneous biopsy of heart valves done in 21000?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d"}, {"id": "f9926355acee735005a5866f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequent procedures for patients aged 60 or above since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE greatest( COUNT( procedures_icd.charttime ) ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) ) AS T1 WHERE T1.C1>= 5 )"}, {"id": "9ef4ff1a80eff792fae7eaf6", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients diagnosed with other and unspecified escherichia coli [e. coli] in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified escherichia coli [e. coli]' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "99c9abca99f18fa8ddc1f20a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow old was patient 10006053 during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\n### SQL:\n\nSELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "4fec79e3343989ed9d312e56", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the dose of an opioid prescribed to patient 1258?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##: Select the maximum total volume of patient 10039999777's blood since 03/03/2100.\n\n\n### SQL:\nSELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1003999777 ) ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-03'"}, {"id": "c4e464a5e3c26b34a598c2d4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most commonly prescribed medications for patients diagnosed with other and unspecified hyperlipidemia previously within the same hospital visit, throughout this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "ebbbea82024643bb7a0d0271", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most commonly prescribed drugs within 2 months to the patients aged 60 or above after diagnosed with do not resuscitate since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'do not resuscitate' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "b8f95a496d90e442273b2a33", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10022041 was prescribed acetaminophen iv and phosphorus in 06/2100, at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen iv' AND admissions.subject_id = 10022041 AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phosphorus' AND admissions.subject_id = 10022041 AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e975b58de48ba847edeaaa42", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10004422's o2 saturation pulseoxymetry was less than 96.0 on 01/20/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 96.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-01-20' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1c9a9604623cda8daa271842", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of stay for patient 10001217's first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "\n11112521186032843283479558582734066515"}, {"id": "efd275d1b7116eb72bf67aaa", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of closed [endoscopic] biopsy of bronchus procedures performed in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic biopsy of bronchus' ) AND strftime('%Y',procedures_icd.charttime) = '2100'"}, {"id": "b09ed49b64bdf344e14bb1c7", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10014354 have any chloride lab tests done during the previous month?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')", "rejected": "null"}, {"id": "f710a9e23d2b119bb3cbd7d6", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last year, how many extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic procedures were conducted?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "7a437c8dbddf61c5a8051a64", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent drugs that patients were prescribed within the same hospital visit after being diagnosed with hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "6ad5a9078781b4734aa37e35", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total count of patients who stayed in careunit vascular in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": ".!!a1. sense1 Nash\n.?...\n 1. -....\n111S2.(?msPA 1222114214412120.10.00037047000044010030000100087?\n##020000001'"}, {"id": "5474f0b5cb7ffa00ecced461", "query": "Convert the question below to SQL query.\n\n### Question:\nThe earliest hospital visit of patient 99661?\n\n### SQL:\n", "chosen": "null", "rejected": "of.. ( ( .:.-. -\n C.(cription5. (. ( J?. -\n C. . (. 1\nMS N. S.\n.\n\ron (12 H1.  1.)\n\nPA. (.\n DIose . (r1?-"}, {"id": "5eabde65a4146642bc2431c9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were prescribed metronidazole (flagyl)?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'metronidazole (flagyl)' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'metronidazole' AND strftime('%Y',prescriptions.starttime) = '2100' )"}, {"id": "d0e1bf41e5fd8ca04ae79ba4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the total amount of sterile water input that patient 10007818 received in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "259fe15be2c9bf422058ba71", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 23436 have a appointment at another department?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL AND admissions.dischtime is NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "7ea5b7b4bc12cad8a4e74fdc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dose of insulin human regular prescribed to patient 10019172 during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'insulin human regular'", "rejected": "null"}, {"id": "10d4494c6be478dbfbbb2cf1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10021666's minimum o2 saturation pulseoxymetry in their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "5dcb3867960ccfe76a673b5e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common diagnoses since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n##\n\n### SQL SELECT DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389381 ) ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time - 1 year) ) )"}, {"id": "4678e394b805643ece243dbd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most common microbiology tests that patients were diagnosed with after the diagnosis of spinal stenosis, lumbar region, without neurogenic claudication within the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "d459384c23821c7436fd1a3e", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top four most commonly prescribed medications during the same month to patients aged 60 or above after they were diagnosed with unspecified essential hypertension since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "07c2cabe27d018ef8bc90ed3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people got prescriptions for adde since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'adde' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": ".\n.1\n P,\n\n\n-11:1 everybody..0_ Welcome )d121216'"}, {"id": "af98aa24749ee692f69ef110", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 month ago, what was patient 10021118's last weight measurement?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6eaa704e430235558d82f887", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the total patients who were prescribed clonidine patch 0.2 mg/24 hr this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'clonidine patch 0.2 mg/24 hr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.drug = 'clonidine patch 0.2 mg/24 hr' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"}, {"id": "c0abdf612c0f0fba7baee7ec", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you inform me of the first neutrophils test result for patient 10002495 in 06/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "13d1c3ce122cdfcb5700e30a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat code is associated with icd-11 for aphasia in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "..171201940017009027208999884986's.09'"}, {"id": "f094acde3e855985c85bc122", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five diagnoses most frequently diagnosed since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "1 MMS\n 1 1\n 21111622122550478469175501704586782513493378?"}, {"id": "8d8cd6284d24a2bdccc48b42", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of days has it been since the first time patient 10004733 was diagnosed with diverticulosis of colon (without mention of hemorrhage) during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diverticulosis of colon (without mention of hemorrhage)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0de0194d965055a79103daf2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat does it cost to get cardiac arrest due to underlying cardiac condition diagnosed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) )", "rejected": "\n130110214-1.22512649469926s00018's CUR C1 C2 C3"}, {"id": "931a6cae10afc8a4e19e7a2b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most frequently diagnosed microbiology tests for patients who were diagnosed with encounter for palliative care before within the same hospital visit, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "a280ab4c51d6d7b334f1d575", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the arterial blood pressure systolic level of patient 10018081 second measured on the current ICU visit less than first measured on the current ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "d3693b3ee981749f8a199c7b", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time since 07/2100, what specimen test did patient 10007818 get?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT SQL SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' )"}, {"id": "725f32d2feda840d1ff1d579", "query": "Convert the question below to SQL query.\n\n### Question:\nThe last time patient 10021487 was prescribed sodium bicarbonate and 5% dextrose at the same time since 11/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "1ada788cf4c8e059533b5f04", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, how many patients had been diagnosed with alcohol dependence, in remission?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "\nT1.\n\n##\n00. What is the maximum cost to get a lab test for urine culture in 21000?\n\n\n###sql"}, {"id": "11b1d4acc1e68f70deb1fd99", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who underwent fiber-optic bronchoscopy throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "36c7455252fe5e86cee2f9ff", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you count the number of times patient 10016810 visited the hospital during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10016810 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "0bf13d65d6a6c37aaf9ffd42", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were administered divalproex (delayed release) since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'divalproex (delayed release)' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "c9f7a8db98a61fe956ee074c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of mirtazapine prescribed to patient 10020786 in 07/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND prescriptions.drug = 'mirtazapine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'", "rejected": "\n### SQL JOIN\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180035 ) AND strftime('%Y', diagnoses_icd.starttime) >= '2100' )"}, {"id": "7fd810ebd8c88d468eab802e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10006053 received a laboratory test for mesothelial cell since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'", "rejected": "\n##090116276\n\n\n### SQL:\n\nSELECT SELECT COUNT(*) FROM icustays WHERE icustays.hadm_id IN ( SELECT icustays.hadm_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd_procedures.icd_code ) AND admissions.subject_id = 100212177 ) ) AND icustays.outtime IS NOT NULL AND strftime('%Y-%m-%d', icustays.intime) >= '2100-03-20'"}, {"id": "43b3a2950b00b6d8b6b27c84", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10015931 was prescribed with within the same hospital visit after the replacement of aortic valve with zooplastic tissue, percutaneous approach since 5 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-5 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "ff61f56376566ef1959962de", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10015931 admitted in terms of admission type for the last time?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10015931 ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10015931 ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "1b28343aacf8cb3fdf1051df", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five frequent laboratory tests that patients had after they were diagnosed with other abnormal blood chemistry during the same hospital encounter since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal blood chemistry' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "239fa629d1e7317b24ec198e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the drug duloxetine?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'duloxetine' )", "rejected": "_id:\n\n27'"}, {"id": "072f960a91e48e6fe38d81a1", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of prescribed drugs for patient 10001725 in 04/this year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "9c9100431bbeace3679922e0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost to purchase phenobarbital?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital' )", "rejected": "2\n.2.. .\u2019t11-ments\n"}, {"id": "dff52a931ff5d9812d2e68c8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with bradycardia, unspecified since 2100 after previously being diagnosed with polyneuropathy, unspecified in the same month?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "efd5c9c44ecab92af5e496fa", "query": "Convert the question below to SQL query.\n\n### Question:\nIn what ways can phenazopyridine be ingested?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'phenazopyridine'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100196408 ) AND prescriptions.drug = 'phenazopyridine HCl' AND datetime(prescriptions.starttime) >= '2100-08-01'"}, {"id": "bf83d742ea74451bae10af6a", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the length of time patient 10016742 was in the ICU during the first visit.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "9e2452ee75b90c03b839db7e", "query": "Convert the question below to SQL query.\n\n### Question:\nDid it happen on the last occasion that patient 16248 had a medicine they should take daily?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'start of day') AND strftime('%Y-%m',prescriptions.starttime) = '2100-02'"}, {"id": "8767ec4e6f5bb384a55e1f3a", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top five most frequent procedures that patients received within 2 months after being diagnosed with pseudomonas infection in conditions classified elsewhere and of unspecified site?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pseudomonas infection in conditions classified elsewhere and of unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "5865415c04f5c5aabf620b5e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10029484 last depart from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10029484 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "# And the length iso-nitrogenic acid (iso-nitrogenic acid) level in patient 100038081's blood?\n\n\n### SQL:\nSELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'iso-nitrogenic acid (iso-nitrogenic acid)' ) )"}, {"id": "499e4f8e7f92658595f68d33", "query": "Convert the question below to SQL query.\n\n### Question:\nHas ondansetron, oxycodone liquid, or sodium chloride 0.9% been prescribed to patient 10020740?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug IN ( 'ondansetron', 'oxycodone liquid', 'sodium chloride 0.9%' )", "rejected": "null"}, {"id": "4a9c408414e0cb27d0bc9e3b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost to get diagnostic of personal history of poliomyelitis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of poliomyelitis' ) )", "rejected": "null"}, {"id": "21516330871ebef6b95137ea", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent events that took place in 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 3 )"}, {"id": "4f0abb317b82d6a5f186ef14", "query": "Convert the question below to SQL query.\n\n### Question:\nPresent the count of ICU visits for patient 10021118 in the first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "77171e5339f4e6ec2c3775b4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen and where are the rounds and procedures of dr. canpos?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1.starttime FROM admissions JOIN transfers INTERNAL MICROBIOLOGY LABS ON T1.hadm_id = transfers.hadm_id WHERE T1.hadm_id = transfers.hadm_id AND T1.spec_type_desc = 'microbiology' AND T1.org_name = 'cancer of ovary' AND T1.charttime = '2100-01-23' ) AS T2 ON T1.charttime = T2.charttime ) AS T3 ON T3.charttime = T2.charttime ) AS T4 WHERE T4.valuenum = 1"}, {"id": "682514db6b2570e05f980387", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the length of stay for patient 10018501 during their first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "b2d4a908cb2de00418d09277", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost for a other specified disorders of stomach and duodenum diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified disorders of stomach and duodenum' ) )", "rejected": "null"}, {"id": "06cb3e044663d50bd84a38f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10016742 had the first input since 03/25/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-25' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "96c87d6620403ab5197e010c", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time in 08/this year, what was the drug that patient 10027445 was prescribed via sc route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d526b1d43696d492cab8fec9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients are there in the 30s age group?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39", "rejected": "##\n\n##\n\n## Question: What was the last time patient 100399825 had a medication prescription since 07/31/2100?\n\n\n### SQL:\n\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 10039825 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-07-31' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "763d6fe88149383a9fb66f39", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of stay of patient 10026354's first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "aaa971c7a88d9bf7858d0200", "query": "Convert the question below to SQL query.\n\n### Question:\nSo how many days have passed since patient 10004733's last bacteremia diagnosis in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "9304aef38384b969a06b3abe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the maximum monthly number of patients who had hemothorax in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1"}, {"id": "55c7172525f47f43ab6b752a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile does a alanine aminotransferase (alt) value of 55.0 for patient 10007818 place in today in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 55.0", "rejected": "null"}, {"id": "9c7986d4a90c81c0aaaf986f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first blood culture microbiology test of patient 10039708's performed since 23 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-23 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02'"}, {"id": "9beadbbf6144dc2a01938077", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021487 was measured with a o2 saturation pulseoxymetry greater than 97.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 97.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c0b58eb14940edd013085528", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism detected during the first bronchial washings microbiology test of patient 10021312 since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "acabae620677b5ffeff62317", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the four most common specimens tested since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "1.0 the last 5-1. The last time of the first measuring the last time this month?\n\n##\n\n### SQL\n\n## Question:\n\n###Question:\n\n\n### SQL:\nSELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = 'excision of other lymph node' AND strftime('%Y') = '21000'"}, {"id": "d2eeacdc392b4745759a9da7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the medication that was prescribed to patient 10007818 for the first time via the subcut route during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'subcut' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "6f5ad6265a39243b9c606075", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 32755 had a medication that was regularly taken?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT\n\n\n##\n### SQL SQL SELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.desc = 'elimination of matter from left femoral vein, percutaneous approach' AND d_icd_procedures.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_procedures.icd_code = 'elimination of matter from left femoral vein, percutaneous approach' ) AND strftime('%Y-%m', procedures_icd_events.charttime) >= '2100-01-05'"}, {"id": "6b368507937b705eba056861", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently given lab tests for patients that were diagnosed with family history of malignant neoplasm of breast previously during the same hospital visit, in 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of breast' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "1a328d0fdabe89a2685da835", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the prescriptions patient 88180 has received from the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT"}, {"id": "30472e5c27673faeb87b6a0d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients on hematology/oncology in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "MS. ('s19MSPAMSMSMSPA_0000203254899179014?'\n\n10.038716s0 received 0.038716?\n\n\n##038716's last hospital discharge?\n\n\n### SQL SELECT SQL SELECT SQL SELECT admissions.discharge.d FROM admissions WHERE admissions.discharges.discharges.discharges FROM admissions WHERE admissions.subject_id = 1001983855 AND admissions.discharges.discharges.discharges.discharges IS NOT NULL AND strftime('%Y') = '21000' ORDER BY admissions.discharges.discharges.discharges DESC LIMIT 1 )"}, {"id": "eee4eef5cba60f4be092bcb9", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the calcium, total value second measured on the first hospital visit of patient 10019568 greater than first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND labevents.itemid IN ( SELECT d_labtests.itemid FROM d_labtests WHERE d_labtests.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND labevents.itemid IN ( SELECT d_labtests.itemid FROM d_labtests WHERE d_labtests.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "b2a5c5b1233bd06110dd5253", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what was the top four most frequent diagnoses patients were diagnosed with within 2 months after receiving excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "c40320a8cc992e9cf6c9c807", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat does a procedure under the name destruction of right lower lung lobe, via natural or artificial opening endoscopic cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) )", "rejected": "null"}, {"id": "5cd6bddbc341bdc7d39bab2f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did on their first hospital visit patient 10038933 take the first microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3825f15fdd46e295e266d4e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the specimen test ranked at five that was done most commonly since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "a6fc04dbbe1e0ba75ba30f18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in the first bronchoalveolar lavage test of patient 10021487 since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "8f4606909a78a1bbf2992c5c", "query": "Convert the question below to SQL query.\n\n### Question:\nIn their first hospital encounter, what was the last recorded weight for patient 10038081?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\n##\n\n\n##\n##\n\n##\n##\n##\n\n## SQL MAX 100319"}, {"id": "eb31ac4eb5e1f45dc5b80313", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medicine that was given to patient 10038933 within 2 days post procedure of percutaneous [endoscopic] gastrostomy [peg]?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038933 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038933 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038933 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038933 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "95572bc770a45d31955d69e0", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the length of stay for patient 10013049 during their first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "b47161883d5f7a57232f66b9", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10037928 given a hematocrit lab test in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "171a187b546228165ca60f92", "query": "Convert the question below to SQL query.\n\n### Question:\nThe first time , when was patient 10004720 prescribed insulin and artificial tear ointment at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10004720 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'artificial tear ointment' AND admissions.subject_id = 10004720 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "7793a26811956045c0aad41d", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who were diagnosed with acute venous embolism and thrombosis of subclavian veins , what are the top four most common medications that followed afterward during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute venous embolism and thrombosis of subclavian veins' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "1e3f74247a6a94fae1151382", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much was the difference in weight of patient 10038081 second measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 )"}, {"id": "56950cbe39154cd6825d8851", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently tested specimens for patients that received parenteral infusion of concentrated nutritional substances previously in the same month in this year?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_TOTAL_ASC FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100012170 ) AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 >= 3"}, {"id": "9c7541b5bbd7c9afff33a1e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the reimbursement standards for cerebrovascular mri?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT procedures_icd_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cerebral artery bypass, bypass corridor neurology' ) )"}, {"id": "2d4e78fac89671a4c99a7d95", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when the last microbiology test for patient 10015931 was held since 9 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-9 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a268dd6ec5f92d7de6e8ac1c", "query": "Convert the question below to SQL query.\n\n### Question:\nBut does patient 11426 have an appointment in other department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100214878 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "4222a76175b0c9d9dbc75006", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a performance of cardiac output, continuous procedure performed on patient 10021118 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "aad14eeea5e885e1009d3b1e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a procedure that patient 10001217 had since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "28150962c7244064887e1cfd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum daily number of cases for acute diastolic (congestive) heart failure in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute diastolic (congestive) heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "bbf5e6522d1f059b3bd44c17", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the ward id where patient 5828 can be admitted?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n##: Select the minimum value of the maximum respiratory rate of patient 100037845 during the last hospital visit?\n\n\n### SQL:\n\nSELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100037845 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "9b5ab2bf426064b58719cc29", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10021487 last visited the careunit trauma sicu (tsicu) in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "ffeeae0595efa3f5c9f10a86", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of the hospital, which includes the glucocorticoid deficiency?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'glucocorticoid deficiency' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT T1.C1 AS C1 FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'glucocorticoid deficiency' ) ) GROUP BY cost.hadm_id )"}, {"id": "2ce2c777d5cf2c8bf9c60de2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many insertion of drug-eluting coronary artery stent(s) treatments were executed since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "564ada6c43aaa821b0599d69", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease tell me what to prepare for the flexible sigmoidoscopy procedure\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'flexible sigmoidoscopy' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009640 )"}, {"id": "32add9759f1cb2aad3668ce7", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most common events that happened.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n##"}, {"id": "a7deec7678c37db84888ba96", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new medications are there for patient 10018081 today, compared to the prescriptions given yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime) = datetime(current_time,'start of day') AND strftime('%Y-%m',prescriptions.starttime) = '2100-09'"}, {"id": "e4946b7c7c8d1c41eb7d77e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of the hemoglobin value of 10.4 among patients of the same age as patient 10020740 on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 10.4", "rejected": "null"}, {"id": "ce6fb03a4a50610a70a8f0f4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10015931 has had the minimum o2 saturation pulseoxymetry on this month/08?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '08' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8e706a5e5f4902a5d9824238", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10037975 undergone any procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 )", "rejected": "\nSELECTION's\n\n### SQL:\nSELECT COUNT( DISTINCT procedures_icd.procedures_icd.procedures_icd.charttime ) FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10037975"}, {"id": "7f006b94d6653a3b89d33cc2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed on emergency department observation since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "\n##\n### Question:\n\nWhat is the difference in weight of patient 100192875's body on the last measurement on this month/12-05-this year compared to the value from the first measurement on this month/12-05?\n\n### SQL:\n\nSELECT T1.dischtime FROM admissions T2 WHERE T1.hadm_id = T2.hadm_id AND T1.admittime >= datetime('start of month', strftime('%Y-%m-%d', datetime(T1.admittime)) ) = '2100-05-12' ORDER BY T1.admittime DESC LIMIT 1"}, {"id": "577572963a504b16ab2aced7", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10004733's total volume of output since 12/07/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-07'", "rejected": "null"}, {"id": "1175293359f3af457f69e353", "query": "Convert the question below to SQL query.\n\n### Question:\nWas any magnesium sulfate (bolus) medication provided to patient 10019172 on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "d1018384915acc94c4043e76", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was prescribed for the first time on the last hospital visit to patient 10036156?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "5f397d9337e3f7c527ae89c4", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the weight changes of patient 10019172 second measured on the last hospital visit compared to the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "5ccd34698e938f99b49819c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum monthly number of patients affected by cerebral aneurysm, nonruptured?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral aneurysm, nonruptured' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "96992cba3f6699cf44f5decf", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 73713 have overseas travel history?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL AND admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018081"}, {"id": "480c4f9f6cb6210afb07ec17", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the five most frequent diagnoses during this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'start of year') )<= datetime(current_time,'start of year') ) GROUP BY d_icd_diagnoses.icd_code )"}, {"id": "f51f73add40fa25cc0d3936a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of insulin human regular that was prescribed to patient 10009035 for the last time since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND prescriptions.drug = 'insulin human regular' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "ccc5d12c1c88d7a708f03f70", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently taken specimens for patients diagnosed with iatrogenic pneumothorax previously in the same month, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'iatrogenic pneumothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "4d0bc94cd3038c80ab777027", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last drug prescribed in 02/this year to patient 10020187?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "a229a64f2bf74f9fc9dfa626", "query": "Convert the question below to SQL query.\n\n### Question:\nIn what ways can nystatin cream be ingested?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin cream'", "rejected": "SELECT DISTINCT prescriptions.starttime FROM prescriptions WHERE prescriptions.drug = 'nystatin' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100192878 ) AND datetime(prescriptions.starttime) >= '2100-03-05' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "dc9b13fe2202c498d8511fe7", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients in their 50s since 2100, what were the top five most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "41380d1d5d0e6d1c497a8317", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of people who had respiratory ventilation, greater than 96 consecutive hours.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )", "rejected": "null"}, {"id": "b02107c6fe9f4494cc14728e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time of input time of patient 10018081 on this month/29?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '29' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "6aa4881be1a49d2ae7f3e749", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most frequent diagnoses that followed within 2 months for those patients who received laparoscopic partial cholecystectomy since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic partial cholecystectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic partial cholecystectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "c0a87bdad4a3ac34d3210642", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10022041, what was the first vitamin b12 reading?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "\nSELECTC1 = ( SELECT AVG(T1.valuenum FROM ( SELECT labevents.valuenum FROM labevents JOIN admissions.labevents ON labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100204187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b1' ) )"}, {"id": "87a3ea2e67ade278c0c2e7e5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was patient 10014354 in the hospital in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "79e0ad1e375749a558da1432", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 6440 have a history of travelling overseas?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "24ad21be2a942f6c761d77d7", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the first ICU stay, what was the first heart rate value of patient 10036156?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "83b572d1db3ebc6a03eacfcc", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know of the drug that is not to be administered during the refus lmb/lmbsac pst/pst procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 )< ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "8c1904ba5ce5733337e19e75", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you report the first heart rate for patient 10018845?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100017258 ) ) AND strftime('%Y',d_icd_procedures.charttime) >= '2100' GROUP BY strftime('%Y',d_icd_procedures.charttime) )"}, {"id": "dd05c3f987f00b883125bee1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich method of disinfection is in the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100213187 ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100' )"}, {"id": "82d7adaac4cc7e6228e7f373", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10039708's last admission to the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039708 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "274367d1fab86c9296ee0ceb", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total hospital bill when it includes a tobramycin lab test since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT SQL SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id )"}, {"id": "e257942d050e74a2e2aef5b3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five commonly ordered medications for patients who were diagnosed with unspecified disorder of kidney and ureter previously in the same month, since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "3f09bed66cb7c82a92b7dcb0", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top three most common outputs?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY d_items.itemid ) AS T1 WHERE T1.C1<= 3 )"}, {"id": "01c764d4521a29d2d1ec4223", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 3125 have traveled abroad?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "989ff39a5fc2d15ff9d12bef", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the sex of patient 10007928?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10007928", "rejected": "null"}, {"id": "f727d26ce2437b323535a192", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the patients with age 50s, what are the top five most frequent diagnoses since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "e595c43f7a0338c543bd80cb", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when the last microbiology test for patient 10037975 was held since 29 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-29 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "87cc300179a5fe28e3498b5e", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10004235 experience any procedure in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = '21000 Joint replacement, right knee, total, total knee replacement' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.starttime) >= datetime(current_time,'-1 year')"}, {"id": "b6556ac9fb3dd561d02e99a5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top five most frequent output events since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT T1.drug FROM ( SELECT d_drugs.drug, DENSEXCEAN( COUNT( outputevents.charttime ) ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY d_drugs.drug ) ORDER BY C1 DESC ) AS T1"}, {"id": "6ba230c3cb949791fde3229f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much nystatin oral suspension has been prescribed to patient 10024043 in total?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND prescriptions.drug = 'nystatin oral suspension'", "rejected": "null"}, {"id": "138c2d22c5c0e542ad8688f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat diagnosis did patient 10010471 receive in the first hospital encounter for the last time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "3f43e5ace937d4b9a8b18b3f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first diagnosis of other iatrogenic hypotension in patient 10021487 on their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5238005ffc47bc3719f52f2a", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who underwent a laboratory test for urea nitrogen, urine since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "143f4dbcb26d42bd3447f332", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10026406's length of stay for the first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "2fd61472c7569c2469bef07e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005348 received a medication prescription since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "\n##\n##\n\n##\n##\n\n###question: Select the top three most common lab tests that patients had in 21000.\n\n\n### SQL:\n\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'microbiology test' ) AND strftime('%Y', labevents.charttime) >= '21000' GROUP BY labevents.itemid )"}, {"id": "b1cb5d3e6f5cc86239c34959", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum cost of a hospital that involves methicillin resistant pneumonia due to staphylococcus aureus since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "2bbc414d187b0af13c72744e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most commonly prescribed medications in the same month to patients in their 60 or above who were diagnosed with congestive heart failure, unspecified since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "af2418efda8240fde827a469", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common specimens being tested for patients who were diagnosed with unspecified viral hepatitis c with hepatic coma in the same month since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c with hepatic coma' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c with hepatic coma' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 5"}, {"id": "ed2e1e9eb814e9ee71358ddb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first input of patient 10004733 since 05/10/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-10' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "\nSELECT SELECT COUNT( DISTINCT procedures_icd.procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions.subject_id = procedures_icd.subject_id WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd JOIN admissions.subject_id = admissions.subject_id WHERE admissions.hadm_id = 100214875 ) ) AND strftime('%Y-%m-%d',procedures_icd.charttime) >= '2100-05'"}, {"id": "474e88f3f2489ae5e866536c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last weight of patient 10039831 since 03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\n\n## output:\n\n### SQL:\n\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002554442 ) ) AND strftime('%Y', procedures_icd.starttime) >= '2100' )"}, {"id": "44de7bcceae079f9e8bfdaaf", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who underwent replacement of aortic valve with zooplastic tissue, percutaneous approach since 2100, what were the top five most common procedures that followed within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "837a8f55375dcee9e103dbce", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021118 been prescribed any prescription drugs throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n\n2.MSMSPA 021001821560037 Test the last time since 03/03/03/210?\n\n\n\n### SQL Query:\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 10016788857 ) AND admissions.disch_time IS NOT NULL ) AND strftime('%Y-%m-%d-%d', admissions.disch_out.time) >= '2100-03-21'"}, {"id": "65f6f12656c77dd1d0e81081", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does the drug clobetasol propionate 0.05% ointment cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clobetasol propionate 0.05% ointment' )", "rejected": "JADMS2000034000014006708728648094220'"}, {"id": "1e630ba59c9534f1d61d5e32", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat immunotherapies have been used for the past five years?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT\nSELECT COUNT(*) FROM prescriptions d WHERE prescriptions.drug = 'acetaminophen' AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 year')"}, {"id": "c4e7ab7b177fe5ebd0e590fc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10019172's last input since 10/10/2100 occur?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-10' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "3c1f961554b4f7004f28ef81", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the maximum value of heart rate for patient 10003046 in the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "98f2f619a8c325c797be99a3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of that first specimen test patient 10003046 got in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7e5dc3d7715f4fe214ebe47a", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 68280 experience side effects during a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'blood transfusion' ) AND patients.subject_id = 10019059"}, {"id": "fb95177b2a968ec680128db1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days is it since patient 10004733 first stayed in the careunit medicine during the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "dcfe3d31d256b6f0069568e5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen, since 02/2100, was the first time patient 10027445 was prescribed a medication via the nu route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'nu' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a39d417e2b49ba956a7d03a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat diagnosis did patient 10014078 have last in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "\nSELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id IN ( SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'microbiology tests of urine' AND d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'microbiology tests of urine' ) ) ) AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(transfers.intime) >= '2100-01-15' )"}, {"id": "02759807d268a649ffbc56e0", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the total volume of foley output for patient 10018081 since 12/07/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-07'", "rejected": "null"}, {"id": "c5924167cb9c4a6790f631c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total of lidocaine 1% (for picc/midline insertions) that patient 10038081 had been prescribed?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'lidocaine 1% (for picc/midline insertions)'", "rejected": "null"}, {"id": "ff6ea5e1101cdc2781d7466a", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease retrieve the monthly maximum amount of patient 10015931's nacl 0.9% input since 09/07/2100.\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07' GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "null"}, {"id": "86f22514f835be171f0fd68c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat time was the last time the heart rate of patient 10021487 was less than 114.0 on this month/14?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 114.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '14' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0bc993a64b3b18610af5e89f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10027445 visited the hospital throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10027445 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "09bdf5adbc4a4371b27a0b84", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the drug name that should not be administered during the above knee amputation procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n\n##\n##\n##\n\n### SQL: Select the top 1 most common diagnoses that occurred within 2 months after the first diagnosis of acute alcoholic necrosis, without mention of coma in 21000.\n\n\n### SQL:\n\nSELECT T1.C1 FROM ( SELECT d_icd_diagnoses.icd_code, DENSE_ID FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code = 'acute alcoholic necrosis' AND strftime('%Y-%m', d_icd_diagnoses.charttime) = '2100' ) GROUP BY T1.C1 )"}, {"id": "f6423ec03a547330a057f1ed", "query": "Convert the question below to SQL query.\n\n### Question:\nHow does one disinfect a quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389333 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1"}, {"id": "d7a8e332af537a76ab296df1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10023239's total volume of output since 03/06/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06'", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '998999' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' )"}, {"id": "9a56a0173232de3b3d548756", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top five most common medications prescribed in the same hospital visit to the patients aged 60 or above after they were diagnosed with unspecified acquired hypothyroidism?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "0367956da12e06e2e598864f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received left heart cardiac catheterization within the same hospital visit after being diagnosed with phlebitis and thrombophlebitis of superficial veins of upper extremities?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'phlebitis and thrombophlebitis of superficial veins of upper extremities' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'left heart cardiac catheterization' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "fd8f58682663e3ebe43beab9", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how long patient 10015860 stayed in the ICU during their last stay?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "\n\n##: SELECT SQL SELECT COUNT(*) FROM icd_events WHERE icd_code = ( SELECT icd_icd_procedures.icd_code FROM icd_procedures WHERE icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_procedures.icd_code FROM ( SELECT procedures_icd_icd.icd_code, DENSE_C1 FROM procedures_icd_icd WHERE procedures_icd_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other lymph node(s)' ) AND strftime('%Y',procedures_icd_icd.charttime) >= '2100' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd_icd.charttime, admissions.hadm_id FROM procedures_icd_icd JOIN admissions ON procedures_icd_icd.hadm_id = admissions.admissions.hadm_id ) AS T2 ON T1.charttime< T2.charttime AND T1.subject_id = T2.subject_id GROUP BY T2.icd_code ) AS T3 ON T3.charttime< T4.charttime ) AS T4 WHERE T4.icd_code = T3.icd_code ) AS T5 WHERE T5.charttime = ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NULL )"}, {"id": "9d8591acb0d3258f159e45cc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average yearly number of patients affected by diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "2bb75165325ab535ac14bae8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10031757 have the bands lab test for the first time in 10/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bands' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bands' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031785 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10' )"}, {"id": "c89cf055a5d102b539366869", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the last time patient 10021487 stayed during this hospital encounter in the careunit emergency department?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "027be20fe6b2508766d312ac", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many mupirocin cream 2% prescriptions took place?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'mupirocin cream 2%'", "rejected": "\n##\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT prescriptions.drug ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) AND datetime(prescriptions.starttime) >= '2100-04-18' )"}, {"id": "bc12c47d96a21b5e21142ed7", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five microbiology tests.\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "&B2821701's21141819734430713210' AND 0.'"}, {"id": "3eebaf8381530fd2b515bfc8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new meds are prescribed to patient 10039831 today compared to the ones from yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "fe581d0039127b044368f739", "query": "Convert the question below to SQL query.\n\n### Question:\nIn their last hospital visit, what was the insurance of patient 10016150?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "3ce0aee35413ee29a66136d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last drug prescribed to patient 10007058 during the last month via the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "0d74b2ee638041bc581f98ec", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first sputum microbiology test of patient 10027602's performed in 12/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c1cbfb46dafe04deb682724d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first recorded weight for patient 10015272?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "\n### SQL:\n\nSELECTIVE PROCEDURES:\n\n### SQL:\nSELECT d_icd_procedures.charttime FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_icd_procedures.icd_code ) AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100159385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND strftime('%Y-%m',d_icd_procedures.charttime) = '2100-10'"}, {"id": "78f0e0fcc6e1ea0b7d221630", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output which patient 10007818 had for the last time on 07/03/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-03' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "94c35328a3270460674eea4c", "query": "Convert the question below to SQL query.\n\n### Question:\nUsing the other anticancer drugs is the protocol of the anticancer drugs\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT admissions.drug FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "19c3aaa1bb33be228b47ea7b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the yearly maximum sterile water input for patient 10020740?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "615f5677e858fc4ef464a1a0", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the daily average amount of patient 10021118's nacl 0.9% input in this month.\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "cb1a4e3e68a3305cbed774f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed first to patient 10022017 since 04/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "e47e7e616f3d5838b2aa30eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10004422 was prescribed medication during their last hospital encounter via the sc route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "9906ee00ac2183b7e809821c", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequently prescribed medications since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT\n\n### Question:\n\nWhat are the top five most common diagnoses for patients with age 60 or above this year?\n\n\n### SQL:\nSELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(current_time,'start of year') = datetime(current_time,'start of year','-0 year') ) ORDER BY diagnoses_icd.C1 DESC ) )"}, {"id": "7cfc885a581b81aedac1d706", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most commonly diagnosed conditions this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "(.1MS/.. ( ( ( (\n\n.'. D.  (8.\n IS.. ('5 \n AND to J-\n T. Y. .s\n FOR last . Yte,;. (.\n AS'  P \n T \n (.   )-. T;1..\n Y2 ..\nMS\n. F. E. So\n BY\n.. \nMS.( American a"}, {"id": "252547601fd6f7de68d6ad35", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is performance of cardiac output, continuous?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) )", "rejected": "..\nology\n after:ologyel(:\n  T? T.\n... (1K.... (C.\nUST .. in )..\n (..\n\n V.\n'. col\u2019.  greatest  T C./. O0\n') ).. (!1 D (.\n') . U. FA Mon1\n FROM_d Convert .MS \n_\n C!,\nMS T.2 \n...  d_ Y)  in.\nMSan1'-1:  ( )"}, {"id": "0114a64085ec7d751f6e1bfd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the change in respiratory rate in patient 10026406 measured at 2100-01-12 13:00:00 compared to the value measured at 2100-01-12 12:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' )", "rejected": "null"}, {"id": "2d135d2b1bde82eddce53d88", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most ordered lab tests?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": ".d21 4.\n'1.  health 2. C1.s\n\na.In6d ConvertCMSMS 01223202003013714500348788502386800001 '000032001 ',000057571241335591000073898?"}, {"id": "d555deebd511e5b4c5c57695", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 07/03/2100, did patient 10007818 have any input of dextrose 5%?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-07-03'", "rejected": "null"}, {"id": "95315cf3377aff338fc6744d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most common microbiology tests for people who were diagnosed with unspecified deficiency anemia earlier during the same month, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified deficiency anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified deficiency anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1<= 4"}, {"id": "4de48cd89d593e47d6e93688", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the four most common lab tests in 2100.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n##SELECT\nSELECT T1 FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid FROM ( SELECT DISTINCT T1.itemid FROM ( SELECT labevents.items.itemid, DENSEQ( labevents.charttime, 'start of month') AS admissions.starttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T1 JOIN ( SELECT admissions.subject_titles, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.charttime = T2.charttime WHERE T1.itemid = T2.icd_code ) AS T3 ON T3.charttime = T2.charttime ) AS T4 WHERE T4.itemid IN ( SELECT DISTINCT T3.itemid FROM ( SELECT T2.itemid, DENSEQ( T1.charttime ) AS C1 FROM ( SELECT labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) ) AS T3 ON T2.charttime = T3.charttime ) AS T4 WHERE T4.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, urine' )"}, {"id": "ffdf7c7b7b7b047429a3497b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital expense that includes hemiplegia, unspecified affecting left nondominant side since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "63d12a773f7455c04714cb1e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10005909's sex?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10005909", "rejected": "\n##\n## SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100077795 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) GROUP BY prescriptions.drug ) AS T1"}, {"id": "ddcee3c0f498777f0ac3fe7c", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of patient 10026354's input since 03/22/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-22'", "rejected": "null"}, {"id": "78c04c8b0f1650516f78b223", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the length of the last visit for patient 10009035 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT strftime('%J', transfers.intime)-strftime('%J', transfers.starttime) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND transfers.careunit = 'icu' ORDER BY transfers.intime DESC LIMIT 1"}, {"id": "1844c94cefe167cfc46bbbc8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007818 first have their minimum heart rate on 07/03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-07-03' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ff7b7029d2eb43d96f2ee688", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was the first drug prescribed for patient 10019172 in 11/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "1452ce7ea3c5edec118c2e61", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021312 gotten any medication this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "Has patient 10021312 received any medication this year?\n\n### SQL:\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'start of year') = datetime(current_time,'start of year')"}, {"id": "811775f5b19375275b6b4825", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the total amount of patient 10007928's output since 04/07/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07'", "rejected": "null"}, {"id": "feaaef960a419d81d79e5cfb", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total acetaminophen dose that patient 10037975 has been prescribed?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND prescriptions.drug = 'acetaminophen'", "rejected": "null"}, {"id": "0defe1e5abd183de5eb3b430", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operating rooms is there now\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n21.14.\n\n##\n##\n\n####\n\n##\n##.0.1. What are the name of the organism that was transplanted to patient 1000378085's body on the last hospital stay?\n\n\n### SQL:\n\nSELECT T2.icd_code FROM d_icd_procedures_icd_diagnoses WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000378085 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime ASC LIMIT 1"}, {"id": "3a11d55ef59b984180bf191b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was an insurance plan for patient 10001217 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "55005268f132ecb83abd1166", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was measured as patient 10010471's weight during the first check?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c562491538e06939d07d281f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much am I expected to pay for total esophagectomy?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) )", "rejected": "null"}, {"id": "29f54e700b7c22d0839e2f3a", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any gene testing that patient 14397 had?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'syringe (0.9% sodium chloride)' AND admissions.subject_id = 10020740 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase (catheter clearance)' AND admissions.subject_id = 10020740 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1"}, {"id": "3c0ac8693894186ae1e49461", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the five most frequent microbiology tests?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_TOTAL_CNT() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1<= 5"}, {"id": "015be3d8662ca93c5c0bab0b", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10015272 receive any disease diagnoses in the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "c0f63147854b4f23b302d35f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the type of blood that patient 18457 has?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "6ce32236a45e40ed7a60af77", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when patient 10008454's last microbiology test was since 5 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-5 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a7bf9a18f2ed133ccc62c5c3", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, has patient 10039708 been diagnosed with anything?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'", "rejected": "SELECT COUNT(*) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'"}, {"id": "a8572111c6db24cf56d0391e", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10010471's sodium value last measured on the last hospital visit greater than the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "dc333dc95c29a9b3f3719647", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients previously diagnosed with nicotine dependence, cigarettes, uncomplicated , what were the five most frequent specimens tested in the same month afterward?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 5"}, {"id": "2c770acc2155effc3c66d286", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10017492 first get the urine's microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND microbiologyevents.spec_type_desc = 'urine' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10017492"}, {"id": "e1a802bbddcfa313978c2d4b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you get me the top four diagnoses that have the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "\n### Question:\n\nGet the top four diagnoses that have the highest 3-month mortality rate.\n\n\n### SQL:\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSELSETS.C1 AS C2 FROM ( SELECT diagnoses_icd.icd_code, ( CASE WHEN strftime('%J', diagnoses_icd.charttime) - strftime('%J', current_time) ) AS C1 FROM diagnoses_icd ) AS T1 GROUP BY diagnoses_icd.icd_code ) AS T2 ) AS T3 WHERE T3.C2 <= 3 )"}, {"id": "45cf62bc8aba279eba7b413a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the patient count for sotalol prescription since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'sotalol' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sotal' AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "643390539a60fbe52d9fc05a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019385 had a hospital admission since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "759aa16667e44e03f4caba14", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10011398 get input for the last time since 12/19/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "271646d4accfbf207929949d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10038999 in the intensive care unit during their first visit?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "4f071f6a2e2be35179466daf", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10018328 last admitted to the hospital in terms of admission type since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018328 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT admissions.admission_type_desc FROM admissions WHERE admissions.subject_id = 10018328 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "e330c2e4df1717b019f638e1", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total hospital cost that includes personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits.\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "2be8632aee28b8858fab09c8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the drug that is not to be given during packed cell transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.starttime FROM admissions WHERE admissions.subject_id = 100140350 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AS T1 ) AS T2 WHERE T1.starttime IS NOT NULL AND T2.starttime IS NOT NULL ORDER BY T2.starttime ASC LIMIT 1"}, {"id": "167a500ff70d846339538bb9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10023239 was prescribed medication via the iv drip route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "051c19cebb0a8796d0c84043", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently given lab tests for patients that were diagnosed with atrial fibrillation previously within the same month, in 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "fded99b20da76568aee99315", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients discharged from the hospital in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT admissions.disch_time FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' AND strftime('%Y', admissions.dischtime) = '2100' ) ) > 1"}, {"id": "ea31ed3fce1a143af74ceab2", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum overall hospital cost that includes vitamin e?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vitamin e' ) GROUP BY cost.hadm_id ) AS T1", "rejected": "MSPA 038002162516218 Causes"}, {"id": "beba565897d39febcb35f999", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10018081 got her first diagnosis of congestive heart failure, unspecified on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "de1833a23a65bcf7b1beb104", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much was the difference in arterial blood pressure diastolic of patient 10008287 last measured on the last ICU visit compared to the first value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "0cd28c037e9d62e1fe5d608a", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most common diagnoses in 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n Estd. S.'1\n.4d (*\n \n.!*'.PAMS)MS.polePAK IIISE? ASSMSASIAMSPA.CT191002149000037088165161420"}, {"id": "b5aedd087997ec2e10bb6736", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the glucose value last measured on the first hospital visit in patient 10004235 less than the value from the second to last measurement on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "0d22269bdd7bfa8481b101b5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10005817's total volume of output since 06/04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-04'", "rejected": "null"}, {"id": "1d938ae21a7a7d593616d380", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the total volume of chest tube #1 output for patient 10035185 since 04/17/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'chest tube #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-17'", "rejected": "null"}, {"id": "76457237914bf971488e9425", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the five top specimens that were tested throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "'d\nPAMSMSPA-1.00001438192173527549"}, {"id": "06f475c359305f77ca30ad37", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last hospital discharge of patient 10009049 in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10009049 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "8bdbef1a215b1264d8108f44", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10027445 discharged from the hospital for the last time in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "167d39516102c791d110d62b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the five most commonly taken lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT SQL SELECT T1.test_name FROM ( SELECT d_labevents.test_name FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'mch' ) ) ) AND strftime('%Y', labevents.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 ON T3.C1<= 5"}, {"id": "955058f5985e47dd049eded6", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the four most common medications in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "\n##\n### Question:\n\nWhat was the last time patient 100094554 was discharged from the hospital in 2100?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10009454"}, {"id": "2d72caa3a5dafdb3b343b78e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total hospital cost that involves unspecified glaucoma in 2100.\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified glaucoma' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "2f74275a2c13953fc65e324f", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of medicines that have been prescribed to patient 10007928 since 03/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "null"}, {"id": "ca4e42b32f0b7c47922fe65e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10003046 experienced any surgeries during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "218a35d3fd0012d75ff34412", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four microbiology tests.\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.drug FROM ( SELECT microbiologyevents.drug, DENSE(T1.C1) AS C2 FROM ( SELECT microbiologyevents.drug, COUNT(microbiologyevents.charttime) AS C1 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.drug ) AS T1 WHERE T1.C1 = 4 ) AS T2"}, {"id": "f848232d564a2d92e2deeb3e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the protocol of anti-cancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT prescriptions.drug FROM prescriptions WHERE prescriptions.drug IN ( 'nifedipine', 'levothyroxine sodium', 'amitriptyline', 'prasugrel', 'acetazolamide', 'clonidine', 'metoprolol', 'acetaminophen', 'vitamin d', 'vitamin k', 'nifedipine', 'levothyroxine sodium', 'amitriptyline', 'prasugrel', 'acetazolamide', 'clonidine', 'metoprolol', 'acetaminophen', 'vitamin d', 'vitamin k', 'nifedipine', 'levothyroxine sodium', 'amitriptyline', 'prasugrel', 'acetazolamide', 'clonidine', 'metoprolol', 'acetaminophen', 'vitamin d', 'vitamin k', 'nifedipine', 'levothyroxine sodium', 'amitriptyline', 'prasugrel', 'acetazolamide', 'clonidine', 'metoprolol', 'acetaminophen', 'vitamin d', 'vitamin k', 'nifedipine', 'levothyroxine sodium', 'amitriptyline', 'prasugrel', 'acetazolamide', 'clonidine', 'metoprolol', 'acetaminophen', 'vitamin d', 'vitamin k', 'nifedipine', 'levothyroxine sodium', 'amitriptyline', 'prasugrel', 'acetazolamide', 'clonidine', 'metoprolol', 'acetaminophen', 'vitamin d', 'vitamin k', 'nifedipine', 'levothyroxine sodium', 'amitriptyline', 'prasugrel', 'acetazolamide', 'clonidine', 'metoprolol', 'acetaminophen', 'vitamin d', 'vitamin k', 'nifedipine', 'levothyroxine"}, {"id": "055f3e16faecc90b5ba954f2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new medications were prescribed to patient 10018081 today as compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n##\n## Question:\n\nWhat is the maximum total cost of a hospital admission involving a procedure called excision of other cyst or lesion of brain during this year?\n\n\n### SQL:\nSELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other cyst or lesion of brain' ) ) AND datetime(cost.chargetime) >= '2100-01-01' ) GROUP BY cost.hadm_id )"}, {"id": "e9b6fc1c47118c5de09e95d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently administered laboratory tests for patients previously diagnosed with chronic airway obstruction, not elsewhere classified during the same hospital visit, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "d8493e7bf9c18bcd8edb3a40", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10019777 was prescribed for the first time using a neb route during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'neb' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "7b93007f63a2214c1ddc33f7", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019385 been given any medication since 10 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-10 month')", "rejected": "null"}, {"id": "11b773ce5f673720f4ff1cd9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10009628 experienced any procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "6107147e46717a42a7b5331c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the code that corresponds in icd-10 to icd-11 for delirium d/t other cond?\n\n### SQL:\n", "chosen": "null", "rejected": ". (\\...\n ( .m*.:,\n (' University' restrict\nMSss.  ,1.mmed? .\nMS.D.1DMSMSASPA 3MSMSMSMSA BLANAZA Drug.\n\n?MSPAYCANAIDAverage BACCMSMSPA 0.\n##MSPAKPA wasPA'\n\n\nPA'sPA'T's.\nMSPA's'\n%'"}, {"id": "f52d83becf30a588f36e34f3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any gastric meds been given to patient 10029291 in 12/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'", "rejected": "null"}, {"id": "cb480ff3c89f74e82be45053", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last drug prescribed since 12/2100 to patient 10021118?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f5d37fc36b2a2d322d244fee", "query": "Convert the question below to SQL query.\n\n### Question:\nI need the name of the diagnostic that patient 31510 received in the other department\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "f6274c47226150acc9cef0e2", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of medicines given to patient 10002428.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 )", "rejected": "null"}, {"id": "4637ee6f3a563e19535756a3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most frequently given diagnoses for patients who received partial hepatectomy previously within 2 months this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "8a1b6e9c62cf3eae76e1d86d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients are there in the 60 or above age group?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 )"}, {"id": "cfc537434f52b06b620d9254", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total expenditure of a hospital that involves the medication clarithromycin since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'clarithromycin' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "1bd7abf7a8f3aefc71dd2357", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug last prescribed to patient 10019568 since 11 months ago?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d624abedfa96e75fb614fc58", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the sw dose that patient 10016810 was first prescribed during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'sw' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "797af2b7be25b810c1fa0b00", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the ICU visits of patient 10009035 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y',icustays.intime) >= '2100'", "rejected": "null"}, {"id": "a7957c2fffd3930db882e4cc", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who underwent a rbc lab test since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "3842f39935a34d58b55be97d", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10013049 get a sodium, whole blood lab test in 06/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'", "rejected": "null"}, {"id": "d6b7b3ab6732956bc3e0fc24", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10021487 got his first diagnosis of acidosis on this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acidosis' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "SELECT T1.long_stay FROM ( SELECT admissions.length_of_stay FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "c7a759042b7285ebd4faf3f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequently diagnosed microbiology tests for patients who were diagnosed with cardiac arrest due to underlying cardiac condition before in the same hospital visit, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "e5feed6651e93e164fbd7c11", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10036156's total input amount of po intake during the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT START TRANSFORM SQL FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-05' AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-05-04' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "ae10b786bdd68be86808411b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total count of performance of cardiac output, continuous procedures that were done since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "SELECT\n\n### SQL:\n\n### Question:\n\nWhat was the first time patient 100186543 was given a drug via the iv route since 07/2100?\n\n\n### SQL:\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100186543 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "0d6abd33276d5170877ee1fa", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of heart rate of patient 10000032 last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "e152d27a95ebcc62820b1622", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since the first time patient 10018081 received a lab test of chloride, urine on their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4d2e6a2bf7e989ac0488030c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total hospital cost that includes dissection of abdominal aorta.\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of abdominal aorta' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dissection of abdominal aorta' ) ) GROUP BY cost.hadm_id )"}, {"id": "d80871d283fcf3c937bc3387", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how many fluoroscopy of multiple coronary arteries using low osmolar contrast procedures were done since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "137db7f9de6adce5df221be5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often did patient 10039997 go to the ICU on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "658f14f535401c3647d83d50", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the alkaline phosphatase value of patient 10015860 on the last measurement on the first hospital visit greater than the value from the first measurement on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "2fb580e18c83d31b38426b65", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the count of the drugs patient 10026354 was prescribed since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "af48025f4da1ed8f5c1616e3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first stay of patient 10004733 in the careunit medicine during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "SELECT DENSEST SQL FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "792c797a9110e30b6bff8bb5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the disinfection technique in a quarantine room??\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\nSelect the top three most common diagnoses that patients with age 60 or above were prescribed in the same hospital visit after having received a respiratory ventilation, greater than 96 consecutive hours in 2100.\n\n### SQL:\n\nSELECT d_icd_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T1 ) ORDER BY T1.C1 DESC )"}, {"id": "4b2f2ac3530b71844f36b481", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four diagnoses with the highest 6-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "SELECT DISTINCT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_diagnoses.icd_code, DENSEST( COUNT( diagnoses_icd.charttime ) AS C1 ) AS C2 FROM diagnoses_icd JOIN admissions.subject_id = patients.subject_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C2<= 4 )"}, {"id": "5d5d324fca23706de226e43a", "query": "Convert the question below to SQL query.\n\n### Question:\nFirst time, what drug was prescribed for patient 10014729 since 02/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "55106da0f8f7722ca97968ca", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10004733 received ph in a lab test in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1fce10b989e743fc4a427458", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 94757 last have medication that should be taken regularly?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.starttime FROM admissions WHERE admissions.subject_id = 100077955 ) AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1 ) AS T1 JOIN prescriptions.prescriptions ON T1.subject_id = prescriptions.subject_id WHERE prescriptions.drug = '0.9% sodium chloride' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "cbde9e608339649090217dac", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10026406's last discharge since 1 year ago from the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10026406 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "dd2de211b42f9be113f51d60", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10020944's sex?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944", "rejected": "\n\n##\n\n### SQL Question:\n\nWhat is the total number of patients who were discharged from the hospital in this year?\n\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.subject_id FROM admissions WHERE admissions.dischtime is NOT NULL AND admissions.dischtime >= '2100' )"}, {"id": "b20ec30866d7ebccf58fc8d2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhats the pre serum transfusion nec checklist?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT0004988938'"}, {"id": "9f63970e733b63fae113c2a8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three commonly given procedures for patients that also received ultrasonography of superior vena cava, guidance previously in the same hospital encounter, this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ultrasonography of superior vena cava, guidance' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "37f2202c7041980e8e71b098", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most frequent microbiology tests that patients were diagnosed with malignant neoplasm of lower third of esophagus within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "21e946effbb48dafa5e842d3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the various ways to consume atenolol?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'atenolol'", "rejected": " E: of\n! J.\n. ''....\nd1 EMSmic.. CANMS UB.\nMSPAMSPA MSMSPA )\n\n.PAKMSPACT 1.\n)\n\n\n\n\n\n##\n\n##\n\n\n##\n##\n\n\n##\n##\n\n##"}, {"id": "2b73e239d32f4e598b39620c", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the last value of the free calcium test for patient 10023239?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "\n### Question:\n\n### SQL:\n\nSELECTIVE CORRECTION:\n\n\n### SQL:\nSELECT AVG(T1.label FROM ( SELECT labevents.drug FROM labevents JOIN admissions ON labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100140355 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'phosphate' ) )"}, {"id": "cfb014c016bea7b3e220c08f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were present in the surgical intensive care unit (sicu) since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'surgical intensive care unit (sicu)' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "null"}, {"id": "9650f7dfbf4442af6df9fb82", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the outputs that patient 10027445 first had on 09/10/this year?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-10' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "74b04dcdae7073630ad389dd", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of the first stay for patient 10020740 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "26015ca2d789f156da47c262", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10008287's arterial blood pressure systolic differ from the last value measured on the first ICU visit compared to the first value measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "e421f701cdd1d59ac2958b08", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the code in icd-11 for klebsiella pneumoniae in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "MS21.\n##SS101188\n1.10.05'"}, {"id": "1f207d94f4dd9613e4d69a5d", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how often was introduction of other therapeutic substance into peripheral artery, percutaneous approach done?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "SELECT SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into artery, percutaneous' ) AND strftime('%Y', procedures_icd.charttime) = '2100'"}, {"id": "f22796c3c0a1bd93d011883d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038999 experienced any surgeries?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 )", "rejected": ". (\\...\n ( .m*.:,\n (' University' restrict\nMSss.  ,1.mmed? .\nMS.D.1DMSMSASPA 3MSMSMSMSA BLANAZA Drug.\n\n?MSPAYCANAIDAverage BACCMSMSPA 0.\n##MSPAKPA wasPA'\n\n\nPA'sPA'T's.\nMSPA's'\n%'"}, {"id": "c630812541cf6dfbf08a52c9", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequently tested specimens in this year.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": ".\n \n eness T.eni;,.\u0151l ( ( 3.( C.\nMS..)\n\n to\n....i\u0107.1 Triprosach. 3\n.The1,.1C02CT( E.( Vac.)021MSCPAMSMSdMSMSMSPAGMSPA:UU.MSPAK'\n% 1MSPA.\nMSPAGEMSPAINCICU <PA TPA\n\nMSCANA1.MSGPA )YPASTPA 'PA'"}, {"id": "3a16651efda4705bb6cbe794", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug patient 10007818 was prescribed with during the same hospital visit after having received a introduction of nutritional substance into central vein, percutaneous approach procedure since 11 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007818 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007818 AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "031f4556ea1fe707a94f58bb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007818 receive a serology/blood microbiology test last?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'serology/blood' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7ae500ee11764d469951ff85", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you indicate the yearly minimum dose of kcl (bolus) that patient 10014078 received?\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "13123a9ba850d6caba5a0faa", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10029484 been diagnosed with any diseases this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "74deafe427f380b2459d7479", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you point to a genetic test that patient 655 received?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',microbiologyevents.charttime) >= '2100-08-21' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "ca2d821af5309a1a9e06bffa", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged from hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL", "rejected": "\n### SELECT COUNT( DISTINCT cost.procedures_icd_code.cost FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd JOIN admissions.admissions WHERE admissions.subject_id = 100183285 AND admissions.dischtime IS NOT NULL ) AND cost.hadm_id IN ( SELECT procedures_icd.icd_code.icd_code ) AND datetime(cost.charttime) >= '2100-12-06' ) GROUP BY cost.hadm_id )"}, {"id": "5df1cd4b427c7adcfb315ff9", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last hospital encounter, what was the insurance plan of patient 10007795?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "438eaca992b625cafb55b6db", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the four most frequent procedures performed.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "the.- .\nagle\n...-on close\n INP&!ym a\nMS.....t.T a..instance -##\n1J.za TDPOMSMSCHH-_-13CoursesMSMSMSPA-13MSMS18 242191817181812100003400770100030390040.\n##000010.290.000012659006901 '0006010790353410003"}, {"id": "fc4da0d8a328e76fa47d035f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the value of 32.0 in asparate aminotransferase (ast) among patients of the same age as patient 10039997 on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.0", "rejected": "null"}, {"id": "644187bf34aa3678b61cb3f5", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in patient 10010471's last microbiological blood culture test in 08/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT SQL SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND microbiologyevents.spec_type_desc = 'blood' AND datetime(microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "75f06d4831e589b2c6c537f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was prescribed for the last time since 04/2100 to patient 10015931?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e1b0ecc193437991940016e6", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10029484 been on glipizide xl, 0.9% sodium chloride, or insulin human regular as prescribed?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.drug IN ( 'glipizide xl', '0.9% sodium chloride', 'insulin human regular' )", "rejected": "null"}, {"id": "e382d74ae3fcbc0d1ca3a625", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007928 first get blood culture ( myco/f lytic bottle)'s microbiology test since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "db4af3e1cff04a496f2168cb", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who underwent excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic since 2100, what were the top four diagnoses they received within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "2c4531c3d18dc4868040d5c0", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 76494 have a family history of ac/chr syst/dia hrt fail\n\n### SQL:\n", "chosen": "null", "rejected": "(1C.\n-4$-1MSMSMSPA T1,T24180't diagnosis's the lastdiagnosis' AND strftime <= 1000039808 AND admissions.ordinal' AND admissions.intake.intake.intake FROM careplan_items WHERE admissions.hadm_id IN ( SELECT admissions.times.hadm_id FROM admissions WHERE admissions.hadm_id = 100039808 AND admissions.careunit = 'intensive care unit (icu)' AND admissions.dischtime IS NOT NULL ) AND admissions.dischtime IS NOT NULL ) AND strftime(current_time) >= '21000-06-04' ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "28f97d44fe91950f9c5e36be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the\b reimbursement standard for cerebrovascular mri?\n\n### SQL:\n", "chosen": "null", "rejected": "' T-.'PA\n..SronMS.,.\n1\n\n-2MS.MSM/202015MSPAG343201920100135805100003 'how?"}, {"id": "33b970d4dd11fbe67b989d1c", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the total amount of acetaminophen that patient 10007928 has been prescribed since 03/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND prescriptions.drug = 'acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "null"}, {"id": "285035f4b2ec57e69360c565", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how long patient 10005909 stayed in the ICU during their last stay?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1"}, {"id": "694ecac71896531f9afc039a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication patient 10021118 was prescribed for the last time via im since 10/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "a3703a6f4da15988521301ef", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four diagnoses that have the highest 3-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "MSPA."}, {"id": "30bb66210d2f8e9a6b6b709f", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received other endoscopy of small intestine within 2 months after being diagnosed with alcohol abuse, unspecified since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "7963b2f32402222a44a74bc2", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10002428 to the er during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\n##\n\n##\n## Question:\n\nWhat is the procedure for a arteriovenous catheterization?\n\n\n### SQL:\n\nSELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_PROCEDURES.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473335 ) ) ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-04' ORDER BY procedures_icd.charttime DESC LIMIT 1 )"}, {"id": "87278f47491e99c15504a52a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was a insertion of infusion device into superior vena cava, percutaneous approach procedure conducted since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into superior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "77fee139a7a8698c4a12156a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top five most frequent procedures that patients received within 2 months after being diagnosed with hyperplasia of renal artery.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperplasia of renal artery' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "e7552c3d9e8f53dd5494cd5d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the procedure other operations on carotid body, carotid sinus and other vascular bodies?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other operations on carotid body, carotid sinus and other vascular bodies' ) )", "rejected": "null"}, {"id": "090c2ad4771d1fc8adaea4ae", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10014078 been prescribed a specific drug in 09/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09'", "rejected": "null"}, {"id": "97b55cd17bce748e8c767456", "query": "Convert the question below to SQL query.\n\n### Question:\nI want to know the total volume of input patient 10001725 has received since 04/05/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-05'", "rejected": "null"}, {"id": "146e130f4ab60443b1facefb", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10016150, what were the first lymphocytes lab results?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-02' ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "db4ef4453f0482846262ad5c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who stayed in cardiac surgery this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac surgery' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') ) )"}, {"id": "97197e658fa88a996aa97c83", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input of patient 10014729 on 03/06/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-06' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e9048a785a8b9642da5d9070", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 7241 have a genetic test that they got?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT COUNT(*) FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10019172 AND microbiologyevents.test_name = 'culture of urine' AND strftime('%Y',microbiologyevents.charttime) >= '2100' )"}, {"id": "b69ed3edc52cb224ecb174eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile phosphate value of 3.3 among patients of the same age as patient 10024043 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 3.3", "rejected": "null"}, {"id": "61d76023e4eecb1aac307c96", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits patient 10026354 had since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "SELECT COUNT( DISTINCT procedures_icd.icd_code ) FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10026354 AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code )"}, {"id": "5c86eada276c78a8735e0dfb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new drugs prescribed to patient 10039831 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT SQL SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "ffd78170fcf2def8a4cfe87e", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you get me the top four most conducted lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT COUNT( DISTINCT procedures_icd.icd_code ) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100193858 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code )"}, {"id": "f2265be3b7f96b9827e002f2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total output that patient 10020786 had since 07/01/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-01'", "rejected": "null"}, {"id": "d90ae6df67dbb843c61810ec", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of a hospital visit that includes hemodialysis since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "98f8d45306d4c05c5916a214", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the most frequent diagnoses among the top five in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "20180.0100015488088585's the last Drug id of the first time was visited by patient 1000184359 since 02/21000?\n\n\n### SQL:\n\nSELECT MIN(T1.starttime) FROM admissions T1 WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000184333 ) AND strftime(T1.starttime) >= '2100-02-21' )"}, {"id": "23b59f8a1f6220ba4cad6b21", "query": "Convert the question below to SQL query.\n\n### Question:\nDescribe all prescriptions that patient 54894 received in the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n\n##\n\n####\n\n###code SQL> SELECT COUNT(*) FROM d_icd_procedures_icd_codes WHERE d_icd_procedures.icd_code = 'drain drain, other' AND d_icd_procedures.icd_code = '010' AND strftime('%Y', d_procedures.charttime FROM d_icd_procedures JOIN admissions WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002380855 )"}, {"id": "be378ac73159dbaa241e59b7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10020187 was measured arterial blood pressure mean less than 91.0 on 02/03/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 91.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-03' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "dcc6094fae5bc1bb4de3c989", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time in this hospital visit patient 10004733 had the minimum protein.\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "b1838eeaf67182e2d4080d5d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most common specimens tested on patients in the same hospital encounter after the diagnosis of suicidal ideation?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "287474d13b646c19858f98f7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen that patient 10026255 received for the first time since 04/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1a393a5c12d21a7f7e392418", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the monthly minimum amount of patient 10001725's pre-admission/non-icu intake input since 03/12/2100.\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission/non-icu intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' GROUP BY strftime('%Y-%m',inputevents.starttime)"}, {"id": "9ccc39b8569c5131efee591e", "query": "Convert the question below to SQL query.\n\n### Question:\nWas chlorhexidine gluconate 0.12% oral rinse, fexofenadine, or ketorolac ordered during the last hospital visit for patient 10019385?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'chlorhexidine gluconate 0.12% oral rinse', 'fexofenadine', 'ketorolac' )", "rejected": "null"}, {"id": "b84f8bef2656a98e1a21f179", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 42.0 in the laboratory test with platelet count at the same age of patient 10000032 in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 42.0", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.charttime = '1' )"}, {"id": "9a6863fb555783adad183af6", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10006580 undergone any laboratory tests since 13 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(labevents.charttime) >= datetime(current_time,'-13 month')", "rejected": "SELECT SQL SELECT COUNT(*) FROM labevents GROUP BY labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(labevents.charttime) >= datetime(current_time,'-13 month')"}, {"id": "4bb1514c5befb0ece60fdb11", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism found in patient 10020740's last sputum microbiology test in 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "39206b0e94f1d50dfd4f7a97", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the first hospital visit, what age was patient 10021118?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n### SQL Code:\n\n### Question:\n\nHow many times did patient 100213485 have been diagnosed with bacterial pneumonia due to staphylococcus aureus in 21000?\n\n\n### SQL:\nSELECT COUNT( DISTINCT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacterial pneumonia due to staphylococcus aureus' AND strftime('%Y', diagnoses_icd.charttime) = '2100' )"}, {"id": "2753f3dc8c10c48e64cf034a", "query": "Convert the question below to SQL query.\n\n### Question:\nCount how many patients were discharged from hospital since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "\n##\n\n### SQL Question:\n\nHow many times was patient 10021487 prescribed medication since 2100?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "a5f1e48fb3c060e9e95251f2", "query": "Convert the question below to SQL query.\n\n### Question:\nTotal number of patients who had drainage of peritoneal cavity, percutaneous approach in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "5e93d590379eb00b3a76b6aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10020740 been prescribed medication for the last time in 04/2100 via the po route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "aaf18ebab994cddb6afcd715", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the first hospital stay, what was the last diagnosis for patient 10038081?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "CPA1125218218279498080 AND 011/28749379"}, {"id": "cc8d52ea13df2c173004e53e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015272 undergone a mch test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 )", "rejected": "S ON. Mal.MS. W. 1225-C0SQLONMS map &PAREMSMSTSPAMSPACTPA)\n<PA T1.PA'sICU-codePA"}, {"id": "dc9b3236056266b458fff17f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10004733 stayed in the careunit medical/surgical intensive care unit (micu/sicu) during this hospital visit for the first time?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "6e705025d851453c10482a2c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any side effects been experienced by patient 3267 during a blood transfusion\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'procedures_icd.hemodialysis' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008081 )"}, {"id": "f294c7fe72b5826f97ff068a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the average respiratory rate for patient 10018501's body in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "65e654ff18e5887458e5aa25", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the three most frequent microbiology tests?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n##\n##\n\n##: 09\n\n\n### SQL:\n\nSELECT SELECT DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_code = 'endoscopy of small intestine' ) AND strftime('%Y', admissions.dischtime) >= '2100' )"}, {"id": "3c7c50f6746a47772cb02cbf", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10007928 take a nacl 0.9% medication in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' )"}, {"id": "65b2855ba05f13d02f85adcd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism's name found in the last urine test of patient 10007928 in 04/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1c0ad5aee8b258ad464b0c2d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of a procedure patient 10038081 underwent two or more times since 07/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "4fd2779af0fb5ce25434c775", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the top five most common lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": ":, C tootecc1-\n\n B\u2019s._1\nMSMS_-11: 2112: How to take the USC 1.400003803757420978589?\n\n\n04.03 AND 04 AND 1 AND 04 AND 1 AND 04"}, {"id": "1ebe06aacc066a61c6d64f52", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10023117 received any diagnoses since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "6225,90-1.\n10 00023351888136850743804 )'"}, {"id": "659e84dd2728a7624246c318", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of potassium chl 20 meq / 1000 ml ns dose prescribed to patient 10015860 on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'potassium chl 20 meq / 1000 ml ns'", "rejected": "null"}, {"id": "1a52e19cc4c2bea04555d722", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10035185's yearly maximum weight?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y',chartevents.charttime)", "rejected": "null"}, {"id": "904c2c0c49be0f63d95d5358", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total hospital cost that involves accidental poisoning from other specified plants in 2100.\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental poisoning from other specified plants' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "d8caee9d95e20089a90e7c8c", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring this year, has patient 10007928 been at the emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "5cfca1b4d2c90dff13742ae7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhats the protocol for the anticancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": ":' 2.\n.  IMS"}, {"id": "5cbd34f92a55a8e7c2f987ce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the daily average weight of patient 10007058 during the last month?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "SELECT\n\n\n##\n##: Select the total number of hospital visits for patient 1000180102 in 2100.\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000180102 ) ) AND strftime('%Y', admissions.dischtime) = '2100'"}, {"id": "f18eb420cfdd900530bf3999", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who were diagnosed with duodenitis, without mention of hemorrhage in 2100, what are the top three most common medications that followed afterward in the same month?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'duodenitis, without mention of hemorrhage' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "240c55269dbe044f71ee51c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average yearly number of people diagnosed with rheumatic disorders of both mitral and aortic valves since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1"}, {"id": "1d73f76e9729625f5d313029", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the white blood cells level of patient 10001725 last measured on the first hospital visit less than the first measurement on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 )< ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "db9fb5b609cf5c9785924c0c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10004733 first visited the careunit medical/surgical intensive care unit (micu/sicu) during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "1d085776a9f4303e625f4125", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10039831's first platelet count laboratory test on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "521083ecdc8d7be6649f758c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the hospital's average total cost that involves a procedure called implantation or replacement of carotid sinus stimulation device, total system since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "19485737ae9debb39a2a5a89", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the last hospital discharge of patient 10004720 occur since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "d24509cc1ab0dd341bb53f33", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last sodium chloride 0.9% dose that patient 10022880 was prescribed in 04/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND prescriptions.drug = 'sodium chloride 0.9%' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2398b4f90c62615b764ca247", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the last time on this hospital encounter patient 10039831 got a magnesium lab test?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a59aa4e1124cf98b542230d0", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who were discharged from the hospital since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECT SELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180815 AND admissions.dischtime IS NOT NULL )"}, {"id": "b6ef3b8f901f6515811991a6", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total volume of input for patient 10039997 since 03/07/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'", "rejected": "null"}, {"id": "3b7aac248d67a932c390edb8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients receiving excision of dental lesion of jaw in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "86ab734fd86c4c14b393eecc", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me about the three most common specimens tested in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1 )"}, {"id": "47ca8eab856cae1f24914f04", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the last pt lab test results for patient 10022880 in 03/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT SQL SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100288085 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "9de280a78a2a5c2a9872c3b4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism that was found in the first microbiology test on patient 10037861's urine since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f0f7a54c7ede3f83d04bd4df", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the first microbiological examination of patient 10037861's urine?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "8738512f4dab78e20d4a3a23", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently ordered laboratory tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n# Question:\n\n## What is the total number of patients who left the hospital in 21000?\n\n\n### SQL:\n\nSELECT SQL SELECT COUNT( DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT transfers.subjects.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.subject_id FROM transfers WHERE admissions.hadm_id IN ( SELECT admissions"}, {"id": "3eb6d37c0b82ceb5b2df547e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is ranitidine (liquid) typically taken?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)'", "rejected": "11.\n\n.\n'CAL, what1121'"}, {"id": "6247e4ff884d2882517e9fa9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much divalproex (delayed release) was first prescribed to patient 10038999 in 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.drug = 'divalproex (delayed release)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "bc084c489813e1e8df25c4c3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output the last time patient 10005817 had since 12/03/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-03' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_procedures.charttime FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y-%m-%d',procedures_icd.charttime) >= '2100-12-03' ORDER BY procedures_icd.charttime DESC LIMIT 1"}, {"id": "646dc3c2d9906fbf675e6443", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have it been since patient 10004733 had received a hematocrit laboratory test on the current hospital encounter for the last time?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "2e778bf667b5fbe90f44ef33", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10040025 been prescribed with the medication clonidine patch 0.2 mg/24 hr, avapro, or spironolactone?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND prescriptions.drug IN ( 'clonidine patch 0.2 mg/24 hr', 'avapro', 'spironolactone' )", "rejected": "null"}, {"id": "4c21fc382a0f007c44564e8a", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 95470 have reflux esophagitis in his family?\n\n### SQL:\n", "chosen": "null", "rejected": "ID:\n"}, {"id": "22f5302327cb264046c74ec7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat should be done to stay safe after the cont inv mec ven <96 hrs?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n\n\n##\n\n##\n##\n\n##\n###code Convert to sql query the top five most frequent diagnoses that occurred within the same hospital visit in 21000 among patients with diagnosis code 0399999 (other than admissions to hospital for unspecified neoplasia not elsewhere classified as intensive care unit in hospital with acute care hospitalization for the first time this hospital encounter in the current hospital visit since 21000.\n\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT d_icd_procedures.drug FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002114877 ) ) AND strftime('%Y', d_icd_procedures.charttime) >= '2100' )"}, {"id": "9b6f8be92fbf3a67eba1ac22", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently prescribed drugs during the same hospital encounter to the patients aged 60 or above after they were diagnosed with street and highway accidents in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'street and highway accidents' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "6256d1fb1cd3aeaba0eb11a8", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10009035 been prescribed a specific drug since 02/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'", "rejected": "null"}, {"id": "671549860b2c1a2b4f5752a3", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you unfold the five most frequent outputs since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT DISTINCT T1.itemid FROM ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'drainage of left pleural cavity, percutaneous approach' ) AS T1"}, {"id": "0653e85d090882590ea6b4ce", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me about patient 10022880's age on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "812b9c3cb24eb55cbd0989b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the procedure conducted on patient 10020740 two or more times in 04/this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '04' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "9284870.10.16012001\n\n0946772818 was admitted to the hospital?\n\n##\n\n### SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.doses.icd_code FROM procedures_icd_icd_doses WHERE admissions.hadm_id = 100021487 ) AND strftime('%Y-%m-%d', admissions.disch_time) >= '2100-12-06' ) GROUP BY admissions.hadm_id )"}, {"id": "dea9a4a3b6415cd9f853cbe4", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 09/2100, how much dorzolamide 2%/timolol 0.5% ophth. has been prescribed to patient 10005348 in total?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09'", "rejected": "null"}, {"id": "34b2978c7894ada6d43c6d4d", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know the method of disinfection in the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": ".3.\n. E..y.\n ( d\n\n\n:m 1 resta..\n.1(.\n-t-Ins over-\u2026.0CPAHMS11 MSKERMSPA12MSA.MS: PRESIDA't.)\n\nMSPAINKPA 1."}, {"id": "631830633e3ef0505c85ca98", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total number of medications that patient 10004457 was prescribed throughout this year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "592fc15a830589ea90962e04", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were present in the emergency department observation in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "\n### Question:\n\nWhat were the top four most common diagnoses for patients who were previously diagnosed with attention to other and unspecified abnormal findings of diseases of intestines, not elsewhere classified, not elsewhere classified in 2100?\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_CNT( T1.charttime ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T1 JOIN procedures_icd ON procedures_icd.icd_code = T1.icd_code ) AS T2 ON T1.charttime = T2.charttime ) GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T3.C1<= 4 )"}, {"id": "a65675d809840dc8d6dda8a4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is rdw 13.5 among patients of the same age as patient 10020786 on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.5", "rejected": "null"}, {"id": "9d4a3fe390f0fef8dc0d86b3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four frequently prescribed medications for patients diagnosed with bipolar disorder, unspecified previously in the same hospital encounter?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bipolar disorder, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "c26556c5555cff100d6a8a02", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the prices for the drug called aspirin (buffered)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' )", "rejected": "\n### Question:\n\nWhat was the last time that patient 100046003 had a maximum arterial blood pressure systolic pressure?\n\n\n### SQL:\nSELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100046003 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime(chartevents.charttime) = '2100-07-25 15:00:00' DESC LIMIT 1"}, {"id": "d4cc44e155d21e53108993c3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10027602 received any insertion or replacement of external ventricular drain [evd] treatment?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 )", "rejected": "null"}, {"id": "9ce15859816f9b5e712ab02d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 49176 ever experienced a side effect during a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n##\n##: Calculate the number of times patient 100215875 had been prescribed or given a prescription for oral aspirin since 01/06/2100?\n\n\n### SQL:\nSELECT COUNT( DISTINCT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100215875 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-01-06' )"}, {"id": "9e442d16828a578f4b27bb6f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference in patient 10019777's weights last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "b7db8d58388d97ad0352fd3f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the monthly minimum input of nacl 0.9% for patient 10015931 since 09/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-09' GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "null"}, {"id": "19971ad86aeae49201fc7a93", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most commonly prescribed medications for patients diagnosed with monoclonal gammopathy previously within the same month, throughout this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'monoclonal gammopathy' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "e123951f763462b9fe67c32c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most frequently prescribed drugs throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "\nSELECT% In the last month, what is the maximum daily weight of patient 1000382856?\n\n\n### SQL:\n\nSELECT SELECT chartevents.daily_weight FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100382856 ) AND datetime(chartevents.starttime) >= datetime(current_time,'start of month') AND strftime('%Y-%m',chartevents.charttime) = '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "0dac4285b866c55eacef22d7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10018501 weigh difference last measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "23d5a55f9d6248b8d743d970", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10004422 was prescribed a medication in 01/this year via the pr route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "d47700b1f0c8efe72117c59e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most common diagnoses since 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\nWhat PLEASE'm sorry, when was the last time on 04/17/21000 patient 100180815 was prescribed diazepam?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ('diazepam') AND admissions.subject_id IN ( SELECT admissions.subjects.admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180815 ) )"}, {"id": "389610e48fedce18d3b1ef8d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four frequently ordered drugs for patients diagnosed with other and unspecified alcohol dependence, continuous previously in the same hospital visit, since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, continuous' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "8a1a5f5b16afc5af43b04d08", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you retrieve the top five most frequent lab tests patients had following a diagnosis of cardiac complications, not elsewhere classified during the same month?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cardiac complications, not elsewhere classified' ) ) AS T1 GROUP BY T1.itemid ) AS T2 ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "4f42b7f15b57fa921a5c03ea", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first other chronic nonalcoholic liver disease diagnosis of patient 10021487 on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f0fa794eb149befc0d010275", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you inform me of the first white blood cells test result for patient 10007795 in 04/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "118bc51491df8cdec1b69a69", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the name of the drug prescribed to patient 10018081 within 2 days after the enteral infusion of concentrated nutritional substances procedure since 09/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "95523c3c68ef7d68aa2cd797", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total volume of input that patient 10021938 was given since 07/12/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-12'", "rejected": "\n### SQL:\n\nSELECT SQL SELECT COUNT( DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND strftime('%Y-%m',cost.chargetime) = '2100-12' )"}, {"id": "771ae0e7dfa569d1298f749c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between weights last measured on the current hospital visit compared to the second to last value measured on the current hospital visit for patient 10018081?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT AVG(chartevents.valuenum FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND chartevents.hadm_id IN ( SELECT chartevents.hadm_id FROM chartevents WHERE chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d', chartevents.charttime) = '2100-06-18' ) )"}, {"id": "f111de569a99a0699324732d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the\b reimbursement standard for genetic and chromosome tests?\n\n### SQL:\n", "chosen": "null", "rejected": "(1.\n\n. ente.)2.\n (. mesh  \nology..ak\n ANDy. : in\u0437\u0438 in.. T3. ...\nMS\n J..\n The. V:\nm 1..\n R. S demological M'TdS..ms1  CA.\n WHEREq\n MAX. Se\nMS..-1.- D0 ,.-"}, {"id": "7fd1121ddb007a49e5ed2f4c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much was the difference in weight of patient 10029291 measured at 2100-03-07 03:00:00 compared to the value measured at 2100-03-05 00:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-07 03:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-05 00:00:00' )", "rejected": "null"}, {"id": "3bbc83c195a74b99b51777c9", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 08/2100, when was the last time that patient 10001217 was prescribed medication via the pr route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "\n./2\n PresidentsMSPAMS)MSMSMS-T1029211-11720'"}, {"id": "1b9d385c18198422e5cc0a04", "query": "Convert the question below to SQL query.\n\n### Question:\nThe first time patient 10007795 was prescribed lactated ringers and gemfibrozil at the same time since 06/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "9e7913d9465b0471d710f65b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of the drug, ciprofloxacin iv?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' )", "rejected": "<it1..cia\nselected.:\nMS50120001\n\nMSPADEPA TASKY.\n"}, {"id": "8527b64a6629ebc78cca2a01", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most commonly taken specimens for patients that received introduction of other thrombolytic into peripheral vein, percutaneous approach previously within 2 months in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into peripheral vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "4b57287bb27a24b3ea3db358", "query": "Convert the question below to SQL query.\n\n### Question:\nIs it patient 10008454's arterial blood pressure systolic last measured on the first ICU visit less than second to last measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "1e60f35bb520bb22a0d6dcf1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10018423 prescribed for the first time in 05/2100 a medication via sc route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "1d1103ae4c20715e6f0ae678", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total clopidogrel dose that patient 10015931 has been prescribed since 12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = 'clopidogrel' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'", "rejected": "null"}, {"id": "f53f52ab5a22b7db21f911bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the dose of the opioid prescribed for patient 19059?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "9ecd0cfbafb5b2a187290284", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the type of blood that patient 60136 has?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T2.subject_id, DENSEXITime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058171 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND strftime('%Y-%m',transfers.intime) = '2100-09' ORDER BY transfers.intime ASC LIMIT 1"}, {"id": "e1c8e8780d98ea2f4d439813", "query": "Convert the question below to SQL query.\n\n### Question:\nGather the total number of times patient 10019917 visited the hospital in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "f8e70aaaef039854b3b29401", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drugs have been added to patient 10018081's prescription today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "c921232bb890d4227c27bc79", "query": "Convert the question below to SQL query.\n\n### Question:\nGet the count of the number of hospital visits of patient 10023117 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "49d1bd3a4560ab072f7825a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last heart rate value patient 10004720 had?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d8cfaf1fb8e89c395bcfc473", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total quantity of output of patient 10021487 on 12/18/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-18'", "rejected": "null"}, {"id": "83619f693733b0a1c2937f55", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the average total hospital cost that includes a anticardiolipin antibody igg lab test?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igg' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "851d6dc9c9c770c27210cd81", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the dosage of an opioid given to patient 4469?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'opioid' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 )"}, {"id": "38b98518dde0e0d276fdf109", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the diagnosis that patient 10020786 received the first time during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "b91c712088f552af0be44e46", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most common specimens tested for patients previously diagnosed with traumatic shock within 2 months?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "abe78de7464f93993da9c600", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours elapsed since the first time patient 10039831 received a phosphate lab test on this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "28a983d2c071ad3739459886", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the count of ICU visits for patient 10004733 during this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "f691d2a9bc22649ae9adddac", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of a hospital that includes a procedure called fluoroscopy of superior vena cava using other contrast, guidance throughout this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "5c8ae752cc0cbe2cb6d28a89", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10021487's total volume of output on 12/09/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-09'", "rejected": "null"}, {"id": "586ca890e966f98f077187c9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the average value of lipase in patient 10021487's body in 12/this year?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12'", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021486 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',labevents.charttime) = '12'"}, {"id": "a9d61cc491cc934c6edf1a8c", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what are the new prescriptions for patient 10018081 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n\n##\n### SQL Query:\n\nSELECT the last time since 04/03/2100 when was patient 1000473338 prescribed a drug via po?\n\n\n### SQL:\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047338 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-04-03' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "a5af87eb9da16c85cfe6ddb7", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism observed in patient 10007795's last blood culture ( myco/f lytic bottle) microbiology test on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "92968aac60b31a25b1b7a9e2", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top four most frequent drugs that patients were prescribed in the same month after being diagnosed with other place in hospital as the place of occurrence of the external cause throughout this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other place in hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "2412598548707? How many times has patient 100024458 been prescribed the drug d5 0.09?\n\n\n### SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( SELECT prescriptions.drug, admissions.discharge_time FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.drug, admissions.disch_time FROM admissions JOIN prescriptions ON admissions.subject_id = admissions.subject_id JOIN prescriptions ON admissions.subject_id = prescriptions.drug ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m-%d',prescriptions.starttime) = '2100-12-02'"}, {"id": "c91e6629b913e405efe9b9e5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received dilation of left common iliac vein with intraluminal device, percutaneous approach treatment within 2 months after having been diagnosed with accidental puncture and laceration of a circulatory system organ or structure during a circulatory system procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental puncture and laceration of a circulatory system organ or structure during a circulatory system procedure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "a5661f4d9bc983fe089c2f6d", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10010471 given any drugs in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "..ology.. T.\n\n: (sh-\n\n.scar.\n Y 1"}, {"id": "967175d0df47b1226680f9bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism at the first urine test of patient 10031757 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a4ead1605ee2cae02541b57b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people got prescriptions for adde last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'adde' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "\n\n##\n\n##\n##\n##\n\n##\n## Question:\n\n###0.1 What is the maximum value of phosphate in patient 100021285's first blood test in 05/2100?\n\n\n### SQL:\n\nSELECT MAX(labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021285 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND strftime('%Y-%m-%d', labevents.charttime) >= '2100-05' )"}, {"id": "3591d10cf8e7b2175165ea6c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10006053 have the bilirubin, direct lab test for the first time during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, direct' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a0ebb505e3207ec9be553166", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of diagnosis did patient 10036156 receive last throughout this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT\n\n##\n\n##\n##\n### SQL Query:\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '5503881' ) AND strftime('%Y', admissions.dischtime) = '2100'"}, {"id": "00f2bfbc43dcc4875ed114f9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost at a hospital including a albumin laboratory test in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\n##\n## SELECT SQL to count the number of times patient 100117287 had been prescribed other anticoagulant since 03/2100.\n\n\n### SQL:\nSELECT COUNT( DISTINCT prescriptions.drug ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100117287 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'"}, {"id": "2b2a1cb7c1f3e55513ccdcd8", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what was the top five most frequent diagnoses patients were diagnosed with during the same month after receiving extracorporeal circulation auxiliary to open heart surgery?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "e156f73b1bfc7f7069b386b3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the four most commonly taken lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT T1.icd_code FROM d_icd_labtests WHERE d_icd_labtests.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_labtests.icd_code FROM d_icd_labtests WHERE d_icd_labtests.spec_type_desc = 'urine' ) ) AND strftime('%Y',cost.charttime) >= '2100' ORDER BY cost.chargetime DESC LIMIT 1 )"}, {"id": "5e4bfc749171bceb6b2332d1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10014729 last given an input since 03/06/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-06' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8a4a4c79371999b9915a2ef3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does acute on chronic diastolic heart failure cost to get diagnosed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic heart failure' ) )", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic heart failure' ) ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "b0c7bdb6be37ebfe3feb04a6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four frequently ordered medications for patients diagnosed with hemorrhage of rectum and anus previously within 2 months, in this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "408218a9af14aa7ec6f3f966", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost for ondansetron?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ondansetron' )", "rejected": "\n\n. Cbi. 1  1(\n.\n2IDT912MSMS.'15'"}, {"id": "46024bc03077cc1765abf676", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 04/last year has insulin, metronidazole (flagyl), or bisacodyl been prescribed for patient 10021487?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug IN ( 'insulin', 'metronidazole (flagyl)', 'bisacodyl' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "6f8c9bec861a6567d7a9b284", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10029291's first input on 03/08/2100 occur?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-08' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "9ab4162dbb0abdcc190c4d21", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10018845 have last as the output since 279 days ago?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-279 day') ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "c0dcb9d8aed598dc3c1ff8fd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the drug acetazolamide sodium?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' )", "rejected": "SELECTIVE\n\n### SQL:\nSELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' )"}, {"id": "e456aafa65dbfb805ba11016", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10020740's respiratory rate first measured less than 20.0 in their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 20.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "fd514da0acdf2220eacb5f1f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the insurance used for patient 10001217 in their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "d1c500e1dc43c5cae4cf9075", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost for a hospital visit that involved a amylase, ascites lab test?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) ) AND cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100029389 ) GROUP BY cost.hadm_id )"}, {"id": "304ffa7e26d4e39086d0933b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10001725's minimum value of basophils in 04/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND strftime('%Y-%m',labevents.charttime) = '2100-04'", "rejected": "null"}, {"id": "359354e79bede50b58ba61ba", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total hospital cost that involves venous catheterization, not elsewhere classified in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "4fd5da8b9c864e5a3800f681", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most commonly performed lab tests for patients who were previously diagnosed with other diseases of bronchus, not elsewhere classified in the same hospital encounter, since 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "b6cb5bc47c02678729d05510", "query": "Convert the question below to SQL query.\n\n### Question:\nAre there new medications in the prescription of patient 10039831 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "7d5c2f5180cb8edef4ee7d95", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of hospital visits made by patient 10036156 during this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10036156 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "5ce9e6b643c409ca7510c4f0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were administered syringe (iso-osmotic dextrose) since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'syringe (iso-osmotic dextrose)' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "9243295e42271d68c03da879", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10009049's last stay in the intensive care unit?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT strftime('%J', transfers.intime FROM transfers JOIN admissions ON transfers.hadm_id = admissions.hadm_id WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND transfers.dischtime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1 )"}, {"id": "6e294cbd69afc45c3375e07d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005909 had any diagnoses?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 )", "rejected": "SELECT\n##"}, {"id": "1a8c4898fa6341d62be1f722", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the last medication that was prescribed to patient 10031757 since 07/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e28ceb0ac6e10e4e5f14b4dd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the methods for taking ferrous sulfate (liquid)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)'", "rejected": "SELECT SELECT MIN(T1.starttime) FROM ( SELECT admissions.starttime, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100077975 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'trial of other anticoagulants' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.starttime = ( SELECT procedures_icd.starttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100077975 AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "1495b796ffe9d906c0df1b75", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any prescriptions been given to patient 10016810?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 )", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 )"}, {"id": "84864ac527ad8527348ec48a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism in the last pleural fluid microbiology test of patient 10014729?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "95e1af35c13c236f4bafe128", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first instance when the o2 saturation pulseoxymetry of patient 10031757 was less than 97.0, during their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 97.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "46943daaedc4da5c2540a50c", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 12/29/this year, what was the minimum value of the respiratory rate for patient 10004733?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29'", "rejected": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-29' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)"}, {"id": "3b3ec25a9c5acf7aca6a592b", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any procedures been carried out on patient 10008287 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "204846703"}, {"id": "06b6972a43b2dba9856ec0bd", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top four most frequently tested specimens for patients during the same month after receiving introduction of other therapeutic substance into heart, open approach?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "750b75263b3b402e66549596", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the four most frequent lab tests given to patients in the same month after they are diagnosed with anticoagulants causing adverse effects in therapeutic use?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anticoagulants causing adverse effects in therapeutic use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "506c80f153411922f7967305", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10008287 weigh during their last measurement since 14 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\n### Question:\n\nHow many times did patient 100058540 receive a medication on 03/12/2100?\n\n\n### SQL:\nSELECT COUNT( DISTINCT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058540 ) AND strftime('%Y-%m-%d',prescriptions.starttime) = '2100-03-03' )"}, {"id": "0a8995a9063c29d358b7b288", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total hospital cost that involves atenolol in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'atenolol' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT\n\n\n##\n##\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = 'decompression of left atrial septal vein, percutaneous approach' AND d_icd_procedures_icd.icd_code = 'icd-icd-code' AND datetime(d_icd_procedures_icd.charttime) >= '2100-03-07'"}, {"id": "2dd263172f5bf1ae381c6af1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the insurance for patient 10031404 in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n##\n\n### SQL:\nSELECT SELECT SUM(outputevents.valuenum FROM outputevents WHERE datetime(outputevents.charttime) >= '2100-04-28' )"}, {"id": "e2b4b7e5509dd99e1a88449e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile ranking of a phosphate test value of 8.7 for patients of the same age as patient 10014354 on their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.7", "rejected": "null"}, {"id": "f9a927c46dab94fac56cd983", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the treatment given to patient 10038081 two or more times since 07/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "4438b062f0867581f85c9bf3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time yesterday that patient 10018081's arterial blood pressure systolic was measured greater than 88.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 88.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "44c07c98fe50b60cd61a2569", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are patient 10021118's changes in free calcium last measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "a550f5200fba9da44eb6c772", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum o2 saturation pulseoxymetry of patient 10010471 since 66 days ago.\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-66 day')", "rejected": "null"}, {"id": "12d278afa5aced986bad28bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the chloride, whole blood value of patient 10018423 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "566bbc92e52ac6c9cd03050c", "query": "Convert the question below to SQL query.\n\n### Question:\nToday compared to yesterday, what new drugs are being prescribed to patient 10004733?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\nSELECT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 day')"}, {"id": "8a73eab771e03264c24fffde", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first value of respiratory rate patient 10014078 had?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT T1.starttime FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime ASC LIMIT 1 )"}, {"id": "db9a6d17c2bdc3d58e519267", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10021487 had the minimum value of heart rate on 12/10/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-10' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "fe615a9fbe3f8b13bb56bbdf", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since patient 10021487 has first received a other lab test on this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1b31fe554f2b00cde3124adf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018423 have the minimum arterial blood pressure mean the last time on their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "04c9a043e311b54b777c1b7d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell the five most frequent lab tests?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n201.\n1. What's the last time when was the difference in weight of patient 1000182053's body since 08/03/21000?\n\n### SQL"}, {"id": "fe9f0b6e8813418d172e1e1c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many 5% dextrose prescriptions were administered?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = '5% dextrose'", "rejected": "\n##\n### Question:\n\nWhat was the last time patient 100082855 was discharged from the hospital?\n\n\n### SQL:\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10008285"}, {"id": "12f5143349944b924783990d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a hospital admission for patient 10020740 since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020740 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECTIVE been given to patient 10018081 during their last hospital encounter?\n\n\n### SQL:\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers JOIN admissions ON admissions.hadm_id = transfers.hadm_id ) AND admissions.subject_id = 10018081"}, {"id": "3b0cd4c78b75141a2ea1eed9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat about the single rooms which are now out there?\n\n### SQL:\n", "chosen": "null", "rejected": "?BMS.\n\n.\norJ's:MSMSMS'\n\n\n22 0'"}, {"id": "0ceee1a85a040c4d57c27a09", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10008287 been ordered acetaminophen iv, dexamethasone, or heparin in 04/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.drug IN ( 'acetaminophen iv', 'dexamethasone', 'heparin' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "6699dac0cf704c408038528e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019777 received a venous catheterization, not elsewhere classified treatment since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "296dc134fad4a300a3e8605b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost at a hospital including a glucose, ascites laboratory test in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "5ea4690a08942372011bee45", "query": "Convert the question below to SQL query.\n\n### Question:\nOf the patients of age 50s since 1 year ago, what were the top four most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "44fca1429144bd57023476d8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10014729 has received a calcium, total lab test in 03/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1f7740e7b17317dd9085a8ce", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10020944 have any surgeries in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "SELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL"}, {"id": "546a49550415320fbb9316ad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time in 05/this year patient 10018328 was prescribed a medication via the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "148401ff5d7203a166bbf2c2", "query": "Convert the question below to SQL query.\n\n### Question:\nI would love to know the name of the diagnosis that patient 25763 received in the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "(2MS1 )' )'\n##\n' AND admissions."}, {"id": "fc2b377c743f7fc49f3207b7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of a hospital visit that includes right heart cardiac catheterization?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "e48fc73023f959a4fcf5c5c4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of percutaneous [endoscopic] gastrostomy [peg]?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) )", "rejected": "null"}, {"id": "f3e83011de5accbea5625903", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three commonly taken specimens for patients that received excision of right saphenous vein, percutaneous endoscopic approach previously in the same hospital visit since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right saphenous vein, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_T1.C1 FROM ( SELECT microbiologyevents.spec_type_desc, COUNT(microbiologyevents.charttime) AS C1 FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 JOIN ( SELECT admissions.hadm_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100') AS T2 ON T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 ON T3.C1<= 3 ) AS T4 ON T4.C1<= 3"}, {"id": "5b8ab7986b30db4c19fb1088", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10000032 ordered insulin (regular) for hyperkalemia, tiotropium bromide, or albuterol 0.083% neb soln during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'tiotropium bromide', 'insulin (regular) for hyperkalemia', 'albuterol 0.083% neb soln' )", "rejected": "null"}, {"id": "750dbf95a8c1c5e4d75ecefe", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was patient 10023239 in the hospital this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "...\n ( 0\navy  .\n. rel\n. 5MSandW.: 1.0MSMSMS 10PA 12214519240039 INS100001173535217945903507's119'"}, {"id": "ffd93124fef0ab4f2c5e1f7d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the first input for patient 10021487 occur since 12/19/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "7d2d2036da24495b7017dd89", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of days that have passed since patient 10021487's first potassium, whole blood lab test in their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0c11df1e6368179cdb62d5ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most common procedures?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "long\n1s... from. - who C1..\n\n-MSSQL\nMS Convert123PAMSASSMSMSPA T1.1360061100004190030147522884998588778001'"}, {"id": "f57889e13704a258e3baed74", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operating rooms exist right now?\n\n### SQL:\n", "chosen": "null", "rejected": ". .'a Ch. -./trans.menid . ,\n'2 i3?.12\n<\u043a\u0440\u0430\u0457d.Complete CANC\n.CMSMSMSMSMSMS\nMS2512PA.MSC. 200000140020005170090234216900000440005006-000351700.0.0.900090640001701022006-00000211001"}, {"id": "027706ca26ae55a15b9f1d91", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong the patients of age 40s in 2100, what are the top three most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SQL SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TYPE FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "3244f169b0839776c6f8d9aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the alkaline phosphatase change of patient 10021938 last measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'alkaline phosphatase' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'alkaline phosphatase' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "e50069b13140ebddc5f39a48", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the monthly average weight of patient 10011398 since 01/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01'"}, {"id": "810985919f9d2ed07555c4b0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the time of patient 10027445's last influenza a/b by dfa microbiology test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'influenza a/b by dfa' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'influenza a/b by dfa' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "b8c83d640d2fe3594c7c2cb3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output patient 10038933 had since 06/15/2100 on the last occasion?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-15' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-15' ORDER BY outputevents.charttime DESC LIMIT 1 )"}, {"id": "6460cd5a26ffc1b6bcc56a55", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much 0.9% sodium chloride has patient 10038999 been prescribed since 18 months ago?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.drug = '0.9% sodium chloride' AND datetime(prescriptions.starttime) >= datetime(current_time,'-18 month')", "rejected": "null"}, {"id": "a8bfb5881309bbc205af6f0e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10035185's minimum basophils value on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' )", "rejected": "SELECT SQL SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND strftime('%Y-%m-%d',labevents.charttime) = '2100-12-20'"}, {"id": "54ab42240e681be312ba36be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed to patient 10020306 last time through the im route in 11/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "02784e491e61842ddb4de275", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004235 undergone a laparoscopic robotic assisted procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "adf57bf6800cbd7a1bcce75f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time on the last hospital encounter that patient 10014078 had the maximum value of osmolality, measured?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "8255e209caf1b96b879ab87d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich immuno-cancer drugs have been used for the last five years?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'amitriptycin sodium' AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214877 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 )"}, {"id": "8890920db6fabe97648a1d64", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007795 had any surgeries in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "674b2f4886dc638978f16c83", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you believe patient 97395 has received any additional fluid received in blood culture bottles test?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid (blood)' AND microbiologyevents.org_name IS NOT NULL"}, {"id": "2d6c8720a9b03fa8a0c03bff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type during patient 10023239's first entry into the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023239 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "67e06cb1e0a95b90e1fea577", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the ward id that patient 3929 can be admitted?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "cd9b4dacacdde7494c082761", "query": "Convert the question below to SQL query.\n\n### Question:\nGather the total number of times patient 10023239 visited the hospital during this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "8946a6077d0e165e482e261f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequent microbiology tests in this year?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name FROM microbiologyevents JOIN microbiologyevents.microbiologyevents ON microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020038 ) ) GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 = ( SELECT MAX(T1.C1) )"}, {"id": "67d11e525b1b36f31e6a44cf", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10019172's length of stay for the first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "c8b7010204840fc85d61fe35", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the drug that should not be administered during the total splenectomy procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y',chartevents.charttime)"}, {"id": "d6c3eb4c10881ccf9ced74ae", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the three most frequent procedures performed.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECTIVE PROCEDURES PERFORMED IN 03/2100 FOR PATIENT WITH CHARSITID IN THEIR HISTORY?\n\n\n### SQL:\nSELECT COUNT( DISTINCT procedures_icd.icd_code ) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020038 ) AND strftime('%Y-%m-%d',procedures_icd.charttime) >= '2100-03-03'"}, {"id": "bf8467e0d8948ac0db8f7fa1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently taken specimens for patients diagnosed with spinal stenosis, lumbar region, without neurogenic claudication previously within 2 months, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "955c6240945fc39d733c8375", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the count of hospital visits for patient 10026354 during the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n##\n\n\n##\n##\n\n##\n######\n\n###code to_sql"}, {"id": "6bac631eb4407c64590d6679", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the first medication that was prescribed to patient 10004720 since 02/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "425e31a5bea537ada730003e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10005817 was prescribed medications via the ng route throughout this month?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.route = 'ng' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "ac0778f01b4dfce5b48de369", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequently prescribed medications since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT SQL SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSEXPI FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) GROUP BY prescriptions.drug ) AS T1 ) AS T2 WHERE T1.C1<= 5"}, {"id": "5d5185c385123b16a09f65af", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any prescription drug been given to patient 10005909 during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "93fa16b1d774888e42624c8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the hospital's minimum total cost that involves a procedure called endovascular (total) embolization or occlusion of head and neck vessels since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') ) GROUP BY cost.hadm_id )"}, {"id": "3274494f44c1ffdda4c98220", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the daily maximum input of piggyback for patient 10021666 in the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "\n\n##\n##: Select the minimum creatinine level for patient 1003999847 on this month/29?\n\n\n### SQL:\nSELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100399984 ) AND datetime(labevents.charttime) >= datetime(current_time,'start of month','-1 month') AND strftime('%d',labevents.charttime) = '29'"}, {"id": "6e000094f1fc5bda8d758004", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the change in o2 saturation pulseoxymetry in patient 10016742 last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "f26956b68a52957757b13e45", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10015272 had the maximum value of white blood cells?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT\n\n\n##: 1. What is the proper dose of heparin sodium chloride (prescriptions) that patient 100145850 should get?\n\n\n### SQL:\n\nSELECT prescriptions.dose_val_rxn FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100145850 ) AND prescriptions.drug = 'heparin sodium chloride'"}, {"id": "b5ebca4336ca90885d7d6381", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most common diagnoses of patients aged 60 or above since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\n##\n\n\n##\n##\n\n##\n##\n##\n\n##### SQL Code of the first microbiology test that was conducted on patient 1000156022?\n\n\n### SQL:\n\nSELECT microbiologyevents.charttime FROM microbiologyevents JOIN admissions WHERE admissions.subject_id = 100156022 AND strftime('%Y-%m',microbiologyevents.charttime) = '21002'"}, {"id": "5c2aa0525c14c528390437bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time since 04/2100 that patient 10020740 was prescribed with vancomycin and 5% dextrose at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10020740 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10020740 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "5bc42952afa4723a6e5b399b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. williams's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n##\n\n### SQL:\n\n## SELECT AVG(chartevents.drug) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100130495 ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-04-23'"}, {"id": "139ad2d9c8cbe1fe8b05e56d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is disinfection performed in the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n\n##\n\n###code:\n\n## Question:\n\nWhat was the last time patient 100210453 was discharged from the hospital since 21000?\n\n\n### SQL:\n\nSELECT admissions.disch_outtime FROM admissions WHERE admissions.subject_id = 100210453 ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "c8359c96bf05ca8e01953b73", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004457 undergone percutaneous transluminal coronary angioplasty [ptca]?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous transluminal coronary angioplasty [ptca]' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 )", "rejected": "null"}, {"id": "b57d63f334d9d74a3345df05", "query": "Convert the question below to SQL query.\n\n### Question:\nList the drugs that should not be administered during procedure-one vessel?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTIVE (carry out a procedure that does not penetrate tissues)"}, {"id": "1ed08f1aa0fe257e5b029f58", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021118 had an minimum absolute basophil count in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a0ba285d46d08d5da3b63d69", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top four most common lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy, small intestine' ) ) AND strftime('%Y', labevents.charttime) >= '2100' ) )"}, {"id": "af65283ac3452f4ee5fa0142", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10022041 been admitted into an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room'", "rejected": "\n## Question:\n\n##: Is it true that patient 100021487 had a low o2 saturation pulse oximetry test done?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 saturation pulse oximetry' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12'"}, {"id": "c2498660106f0841540500d3", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top four most frequent procedures that patients were given in the same hospital encounter after receiving reposition left mandible with external fixation device, percutaneous approach.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "2d745a50f391efc3dab3ccd8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication patient 10014354 was prescribed for the last time since 05/2100 via the im route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "59db7aeb6bea824b6c800d5e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10004733, on this month/25, had the minimum heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '25' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "\nSELECT SELECT MIN(T1.starttime) FROM ( SELECT admissions.starttime, T1.valuenum FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY admissions.hadm_id ) AS T1"}, {"id": "61ac6587433ff400f0293adc", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were given excision of left internal mammary artery, percutaneous endoscopic approach , what are the top three most common specimens tested afterward within the same month?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left internal mammary artery, percutaneous endoscopic approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "c68906dafb0c5fe36f9c5d48", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the price of a procedure referred to as endoscopic control of gastric or duodenal bleeding?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) )", "rejected": "\n### Question:\n\nWhat are the four most common procedures performed within 2 months after the diagnosis of other and unspecified diseases of the circulatory system since 1 year ago?\n\n\n### SQL:\nSELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_T1.C1 AS C2 FROM ( SELECT procedures_icd.icd_code, ( CASE WHEN procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100184545 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of day') = datetime(current_time,'start of day') ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.C1<= 4 ) AS T3 ON T2.C2<= 4"}, {"id": "77de239314a64e57f47bcdbc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10008454 arterial blood pressure systolic was measured less than 123.0 since 142 days ago.\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 123.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-142 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "285483bc9981158e35956874", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of dilation of left common iliac vein with intraluminal device, percutaneous approach procedures performed last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "a2e0e5bf31da42c112583f6a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038933 first get prescribed famotidine and glyburide at the same time since 06/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10038933 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glyburide' AND admissions.subject_id = 10038933 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "32bd2842efa8e518c4f30155", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was a drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure done?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' )", "rejected": "null"}, {"id": "04d6acb457c7debd55705e51", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of respiratory rate of patient 10010471 second measured on the last ICU visit greater than the value first measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "3c0edb6f5c4fa9ecb6672724", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of medicine does patient 50480 take when they get a prescription from another hospital?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n## SELECT COUNT( DISTINCT cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '57923' ) AND datetime(cost.chargetime) >= '2100-03-01' )"}, {"id": "6d770f5dad11c867295ac4f0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has elapsed since the last time during their current hospital encounter patient 10018081 had received a specific gravity lab test?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c6e0a3d4dc4ef5f0f7b05662", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three diagnoses that had the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "SELECT SQL SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSELSEC FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND datetime(current_time,'start of month') = datetime(current_time,'-1 month') ) ORDER BY diagnoses_icd.desc ASC LIMIT 1 ) )"}, {"id": "b6d7a34bc707d9209a3f1b63", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has elapsed since the last time in this hospital visit patient 10021487 had received a wbc lab test?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6088d9d109938b6b36160f41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last value of a asparate aminotransferase (ast) lab test of patient 10021938 last month?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e8441aac72dc1ce7428bd942", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10021487's total oral gastric output amount on this month/16.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'oral gastric' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'", "rejected": "null"}, {"id": "4f40841ba5cc7ce273305a27", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total metoprolol succinate xl dose prescribed for patient 10039997 in 09/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09'", "rejected": "null"}, {"id": "a4ce2d6ba5f7098b704d0ce9", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the blood type of patient 28443?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'"}, {"id": "fd005233fbdfd0bd5effe825", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the ward id that can get patient 56490 in?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1"}, {"id": "109bdf00fc8e0bc665794600", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10022880 entered the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022880 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "4711376d06c7dea356e7adee", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10000032 bicarbonate tested on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "fd81b513857342c1199e0cf2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10038999's last tested specimen during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e8f9739dbbd0348fee454966", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their last hospital encounter, what was patient 10037975's insurance plan?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "a2dcdcf12890887cb1bf85a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum monthly number of cases for unspecified atrial flutter?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial flutter' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "\n##\n\n## SQLC1 AND strftime '2100'"}, {"id": "bd5f6fd5ab13ce62634ea939", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10039997's daily average weight since 4 months ago?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-4 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "SELECT SQL SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100399777 ) ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-04'"}, {"id": "2f795d71a3f4c1f8e411ce55", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the anion gap level of patient 10008454 second measured on the first hospital visit greater than the first level measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "18f859e690e5c53434768ab0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat diagnosis did patient 10031757 receive in 2100 for the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "f7f4a6f9abf6c8424b79c205", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the current patients who are in the 60 or above.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100213128 ) ) AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "7fb6c6e5361721f050111d9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total volume of foley patient 10022880 had?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' )", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'inputevents' )"}, {"id": "05708c73dfad0a3f4781563a", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you count the number of times patient 10010471 visited the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10010471", "rejected": "null"}, {"id": "a6965f79793a92b7e6553d61", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which were the top five most frequent specimens tested since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "46a747d7b9992bd3eae9d736", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10022880 get a diagnosis during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "62062f47a37fdbe9d1c27aaa", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10012552 undergo any procedure in the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": ".112_71181331792140110003481977876797806091 '\n##' AND NOT IN ( SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd_code = 'cholecyste_aspiration' AND strftime('%Y') >= '2100' )"}, {"id": "861e1a2621058a2c9affd693", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were administered extracorporeal circulation auxiliary to open heart surgery since 1 year ago, what were the top five most common treatments that they received during the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "9d3449fcebd3b151b586649e", "query": "Convert the question below to SQL query.\n\n### Question:\nThe name of the diagnosis received by patient 65582 at the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "\n: (PAMSPAKMSMSPA: What the output, the first Cause of the last year is?\n\n\n\n##\n\n##\n\n### SQL Query:\n\nSELECT SELECT T1.drug FROM prescriptions JOIN ( SELECT prescriptions.drug, prescriptions.drug_name FROM prescriptions WHERE prescriptions.drug_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 1002340858 ) AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 1002340858 ) ) AND strftime('%Y') >= '21000' ) AND strftime('%Y-%m',prescriptions.starttime) = '2100' )"}, {"id": "221b036ed4f338f8d4bd1c8a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total sum of inputs for patient 10038933 since 03/19/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19'", "rejected": ".User __ 1.. 1.\n?ures )2\n. East 1\n.1 CMSONY_MS.22.K.18PAZMSPA'\n\n 0000.\n\nMSMSPA-PAMSMSPA.\n\n1000 INCIPPA-0026350144020705289's 003'"}, {"id": "853d39a04eeeedbb0a28a7d6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much was the difference in weight of patient 10004422 measured at 2100-01-25 05:00:00 compared to the value measured at 2100-01-24 06:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-24 06:00:00' )", "rejected": "null"}, {"id": "e93f9ba8d8777339be3240be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first lab test result of the absolute neutrophil count for patient 10014354 on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute neutrophil count' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "1\n .-1....\n----:11\n52MS-..MSicularS of:MS :"}, {"id": "5cc361b3a9d1cee29ed3d437", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were diagnosed with insomnia, unspecified within the same hospital visit after the diagnosis of other postprocedural status?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postprocedural status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'insomnia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "91635852ce9712ee9ea3c596", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10027445's last admission to the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "def0418fbc10900a82ffd5b9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many cases involved the prescription of insulin (regular) for hyperkalemia since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'insulin (regular) for hyperkalemia' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'insulin (regular)' AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "37e1a7e88398803e5188be91", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed on cardiac vascular intensive care unit (cvicu) during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac vascular intensive care unit (cvicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "5330e3cf45faedb3477005e6", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the total number of outputs patient 10027445 had since 08/13/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-08-13'", "rejected": "SELECT COUNT(*) FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-08-13' )"}, {"id": "eb1d1c55d70459e5c91b366d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of the hospital that includes a medicine named trimethoprim since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "ec87b2a66e1ee117d0c97694", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total of 0.9% sodium chloride that patient 10018423 had been prescribed in 05/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.drug = '0.9% sodium chloride' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'", "rejected": "null"}, {"id": "4b4a86909d0c7240eeb9f9f2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most commonly performed lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "'s\n\n.201610 THE TITTONSMS187 INRONS100001 AND T2\n##' AND 18\n100006004"}, {"id": "6e78d418898692d8783374c7", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any lab tests been performed on patient 10026406?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 )", "rejected": "PAMSMS.\n1262888723055908427 )"}, {"id": "7ecc089caab7c3412fea2223", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10008287 had a maximum o2 saturation pulseoxymetry?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "\n ms.\n.1:5 ifEl.K"}, {"id": "1d9b591db242abe298d896a5", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled since 1 year ago, what are the top five medications prescribed within 2 months to patients in their 40s?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "43377e1ef48d695d15424da9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the medicine topiramate (topamax)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'topiramate (topamax)' )", "rejected": "(.\n d ( 2.% Start { WHERE Cs151. (( SQL\n WHERE.1  (\n T.2\n BYS.( T\nMS1_\nMS  a..30: Ps AVso_ cuando),..te Low\nMS. TPAPA4\nMS..'Ms!1: :1\nMS.MSMS:1.020\nMSUMSMSMSURDMS\nMSMS0282.\nMSO.MSPAGMSMSMJ000912:PA.MSPA-012020212'CMSMSPA.\n##********'PA MSPAGEPAMSPA-\nMSPA-PAGETPA'd.\n#, room."}, {"id": "0d4e20e0fef8cae36b234d1b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10004422's first input on 01/25/2100 occur?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-01-25' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "08e4e46ffbf10a71b11cc538", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of glucose gel dose prescribed to patient 10016150 during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'glucose gel'", "rejected": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'glucose gel' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "32041f1a421a46a1ede56482", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10029484's total input amount of magnesium sulfate (bolus) on last month/23.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '23'", "rejected": "null"}, {"id": "71621e85a074b2ac8ffc6ace", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10004733's last cholesterol ratio (total/hdl) lab test in their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol ratio (total/hdl)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7f9686faa27e555657f81477", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most commonly prescribed drugs since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n4220.\n\n201718908583 AND admissions.drug."}, {"id": "eb7bf6c61602ad306a17337c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the most frequent diagnoses among the top three throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "19\n\n'C's the items\n\n1.\n\n\n##\n\n\n##\n##\n\n##\n##'0343. How many times was patient 1000077045 prescribed a medication in 21000?\n\n\n### SQL\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug FROM prescriptions WHERE prescriptions.drug = '0.02/03/2100' AND admissions.dischtime IS NOT NULL"}, {"id": "d22a0040ed5e1ed60f2c89ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that patient 10004422 was prescribed aspirin ec and milk of magnesia in 01/this year, at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin ec' AND admissions.subject_id = 10004422 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10004422 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "b9f6116b0b39e50a2fa629e1", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of anion gap last measured on the first hospital visit of patient 10005348 greater than its value second to last measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "0925d99c93fdf4626caf71cc", "query": "Convert the question below to SQL query.\n\n### Question:\nGet the count of hospital visits by patient 10019777 during this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019777 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT\n\n##\n\n##\n##\n### SQL Select the top five most frequent prescriptions that were given to patients in 21000.\n\n\n### SQL:\n\n SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSEP.prescriptions.drug_name, COUNT(prescriptions.starttime) AS C1 FROM prescriptions JOIN admissions.subject_id = 100214875 GROUP BY prescriptions.starttime ) AS T1 WHERE T1.C1<= 5"}, {"id": "675c3bb58c7f84d6c7abcb76", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10016742 been ordered sw, sodium chloride 0.9%, or heparin in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug IN ( 'sw', 'sodium chloride 0.9%', 'heparin' ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "d6557e346d781e08feab81d0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were diagnosed with hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "3ef161ccc95ceeb7a1c4f53a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10005348 first get sputum microbial tests in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100047333 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "9e578c94e5b5289de7622f58", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the minimum total cost of the hospital that involves a procedure called cardiac mapping throughout this year?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year') )"}, {"id": "7ecce564ea6c904e3fea5822", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10266 had a medication that should be taken regularly?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'glucose gel'"}, {"id": "89ef9c7f4b5b2407980dfada", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10019777 on any vital high protein (full) in 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-03'", "rejected": "null"}, {"id": "430d5d3db66a6f64ebeb3879", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021487 have any monos lab tests done during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monos' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "9bae33f8c355733757e36325", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three diagnoses of patients in their 60 or above since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "e2ae9a4a36ba36236e991b0e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent arteriography of other specified sites in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other specified sites' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "6a91b9dd415016e5b1793284", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell which medicine was first prescribed to patient 10037861 via the neb method in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'neb' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.route = 'neb' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "d12cf57d8405a554dab7fa15", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently ordered medications that patients in their 60 or above were prescribed within 2 months after being diagnosed with abnormal coagulation profile in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "4ae26018d8ea48c61224e513", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent spinal tap during the same hospital encounter after the diagnosis of unspecified essential hypertension, last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT SQL SELECT COUNT( DISTINCT COUNT( CASE WHEN strftime('%Y', diagnoses_icd.charttime) = '2100' ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )"}, {"id": "67aeef950338b9e353377442", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10018081's first urinary tract infection, site not specified diagnosis in their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "acb8470937bc4a7d0d9b622d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you confirm the gender of patient 10027602?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10027602", "rejected": "\n##\n\n######\n\n\n### SQL CASE WHEN NOT EXISTS ( strftime('%s FROM microbiologyevents WHERE strft_procedures.icd_code = 'microbiologyevents' )"}, {"id": "a9a368d730f37e7a36b2aaf4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost involving a drug named ibuprofen suspension in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ibuprofen suspension' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT COUNT(*) FROM ( SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ibuprofen suspension' AND strftime('%Y',cost.starttime) = '2100' ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "f80abc213bbe8c3753d34e42", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is dr. koch's outpatient treatment schedule today?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit_id IN ( SELECT icustays.careunit_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100159385 ) ) ) AND strftime('%Y-%m-%d',transfers.intime) = '2100-05-18'"}, {"id": "c616ccb02a7104766a7ca4e7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a procedure called excision of left saphenous vein, percutaneous endoscopic approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) )", "rejected": "null"}, {"id": "7cefa5cf7a599ae5c96e8eb5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat culture was patient 10007928 last tested since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "216a57d48cd58c88c6c46b18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat do the precautions be after the spinal canal explor nec procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "280015551376333s?\n\n114523458 was prescribed medication to patient 1001900848 since 04/21000?\n\n\n### SQL SELECT T1.count(*) FROM prescriptions JOIN admissions WHERE admissions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.drug.drug FROM prescriptions WHERE prescriptions.hadm_id = 100190084 ) ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'"}, {"id": "61f764dd9a145b1cc50e9c25", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first dose of glucagon that patient 10023239 was prescribed on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'glucagon' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "82c59daa8e3a56e7f5ad97c0", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, what are the top four most frequent procedures that patients received in the same hospital encounter after being diagnosed with unspecified disorder of kidney and ureter?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "2c36fe674f06fe07c1c1b71d", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of anion gap of patient 10015272 last measured on the last hospital visit less than the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100164285 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100164285 ) AND chartevents.valuenum = 'o2 saturation pulseoxymetry' ORDER BY chartevents.charttime DESC LIMIT 1 )"}, {"id": "8131eb8d99a9ae08b543fab4", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026255 been tested in the hemoglobin lab in 10/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'", "rejected": "9, n't\n'char'"}, {"id": "4eafb35434eb46de4c718a26", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug which was prescribed to patient 10020740 within 2 days after having received a endoscopic removal of stone(s) from biliary tract procedure since 9 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10020740 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic removal of stone(s) from biliary tract' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-9 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10020740 AND datetime(prescriptions.starttime) >= datetime(current_time,'-9 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "b2c6cc35d97bfeb053d31e00", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the type of blood of patient 31854?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\nWhat was the last time patient 100090585 was given a medication via the iv route?\n\n\n### SQL:\nSELECT admissions.starttime FROM admissions WHERE admissions.subject_id = 100090585 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "6b93b67bb974684b413b3c6a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan I know the total output amount for patient 10018081 since 11/27/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-27'", "rejected": "null"}, {"id": "ecaacdc4fbb0dd2635df78f1", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total foley output of patient 10018081 on this month/30.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '30'", "rejected": "null"}, {"id": "76f01a85f8f50fc5f408fa3b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many dofetilide prescription instances occurred in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'dofetilide' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "SELECT SELECT COUNT( DISTINCT COUNT( prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.drug = 'doftilide' AND strftime('%Y',prescriptions.starttime) = '2100' )"}, {"id": "ce863b6ee4d6d50f7003ce48", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027602 have a total protein, csf lab test for the first time during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3f52f0b4c069263ecd9729b0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10018081 first received a lactate lab test during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3c3c48b480fadfdd63afc64a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the procedures that were given to patient 10016742 two times since 07/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "null"}, {"id": "5e629ad0ef424581e32da93e", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the current patients who are in the 50s.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59", "rejected": "\n\n##\n##\n\n####: 0396771 was prescribed for patient 100098085 on 04/02/2100 for the last time?\n\n\n### SQL:\n\nSELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100098085 ) AND strftime('%Y-%m-%d',prescriptions.starttime) = '2100-04-02' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "d6f34e43fb6592a8c64d3f94", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019917 been checked into the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019917 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )"}, {"id": "089ab5e83166d7733ba43ccc", "query": "Convert the question below to SQL query.\n\n### Question:\nExpose the top five most frequent output events in 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT\n\n### Question:\n\nWhat are the top three most frequent diagnoses that patients were previously diagnosed with within 2 months after receiving other neoplasma drainage of left pleural space since 1 year ago?\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSELSEC FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T1 WHERE T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.charttime< T2.charttime ) AS T3 ON T3.icd_code = T2.icd_code ) AS T4 WHERE T3.charttime< ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 100213175 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )"}, {"id": "654bb26fa8a99fc375bca767", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of input by patient 10020740 on 04/07/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-07'", "rejected": "null"}, {"id": "e7b550eaa8e671a43a12d80f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any dextrose 5% given to patient 10004720 since 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'", "rejected": "null"}, {"id": "733f66f03dc1de20e998d218", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much glucagon was prescribed since 05/2100 for the last time to patient 10020306?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "88a7e76c42b80b33bdb68d60", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three diagnoses with the highest 3-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "\n\n### SQL Query:\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.org_icd.code ) FROM diagnoses_icd JOIN admissions WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158608 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) GROUP BY diagnoses_icd.code"}, {"id": "7aeb94856d35a70807387853", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of polyethylene glycol prescribed to patient 10037861 since 08/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.drug = 'polyethylene glycol' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'", "rejected": "null"}, {"id": "8d3d64b56c340125f70300f3", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of drugs prescribed since 24 months ago for patient 10003046.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')", "rejected": "null"}, {"id": "4b0dae2bf00cb70ac501a4d7", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10003400 been tested in the phosphate lab?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 )", "rejected": "null"}, {"id": "fe3277e1cb0eca8a574478bb", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the last hospital stay, what was patient 10007928's insurance plan?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "21b660c0148b20c1b1c2131d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10022880 acquired any medication in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "\n\n##\n\n## Question:\n\nWhat are the top five most common procedures that patients received in the same hospital visit after having received a cardiac catheterization, percutaneous, guidance since 1 year ago?\n\n\n### SQL:\nSELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_PROCEDURES.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100113052 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) ) AS T1 JOIN ( SELECT procedures_icd.icd_code, C1.C2 FROM ( SELECT procedures_icd.icd_code, ( CASE WHEN strftime('%J',procedures_icd.charttime) - strftime('%J',current_time) ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013052 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) ) AS C2 FROM procedures_icd WHERE C1.C1<= 5 )"}, {"id": "354ec0afe942f8cf2f5c706e", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 10/2100, when did patient 10019172 last receive the % hemoglobin a1c test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "4e6d83c0c7ba1ea3a2bf658b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with acute diastolic (congestive) heart failure in the same month after the previous diagnosis with hypokalemia in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypokalemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute diastolic (congestive) heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "5a4d87a7bd80bc03275287c6", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most frequent procedures that patients were given within 2 months after receiving excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "4f390ab9331393d06d9b9595", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the change in rbc in patient 10018845 last measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "79c093726d46e6acd2287106", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that patient 10018081 was prescribed with in the same hospital encounter after undergoing ileostomy, not otherwise specified during this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "cbcdc4db6f2c0f87986c08eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that patient 10018501 had a minimum value of calcium, total?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "1117a3336b3c103b088eb297", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients previously diagnosed with compression of vein in 2100, what were the four most frequent specimens tested during the same hospital visit afterward?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of vein' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "4a8d26e48bb2e2a2710407b9", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of time for patient 10027445's first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "f907fb44dd458e21bcac102c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common diagnoses that patients were diagnosed with during the same month after receiving bypass coronary artery, one artery from left internal mammary, open approach's this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "4e2be276b6289a600da28a19", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021312 had a inspection of tracheobronchial tree, via natural or artificial opening endoscopic since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "2cceb4c8bccd163def8170ce", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a alpha-fetoprotein lab test performed on patient 10038081 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alpha-fetoprotein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y',labevents.charttime) >= '2100'", "rejected": "null"}, {"id": "c1a9f03dd5bb3142dac26180", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most occurring events.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "1..\n.124 3118 everybody-19218:210021811586880634785595808's last year, was the last time that patient 1000144525 had a mchc code?\n\n### SQL WHERE admissions.disch's.disch's.discharge.discharges.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's\n\n\n.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.discharge's.dischar"}, {"id": "4d9bd3d3dbfcb23cf47cb0c6", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top five most common specimens tested for patients previously diagnosed with personal history of self-harm within the same month?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of self-harm' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of self-harm' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 5"}, {"id": "fba6eaad82acda8133a805f5", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me about all the medications that patient 99080 received in the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT prescriptions.drug) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180817 ) AND prescriptions.drug = 'aspirin'"}, {"id": "77a561b95489d211e0dec613", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was other electroshock therapy carried out throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n##\n## Question:\n\n### Question:\n\nWhat was the last time in this hospital visit when patient 100078545's o2 saturation was less than 94.0?\n\n\n### SQL:\n\nSELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078545 AND admissions.dischtime IS NOT NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum< 94.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-04-16' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "f98f47f9d3ab7a1af147e5ac", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many prescriptions for nifedipine cr were made since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "56f862020ab17a92aac5b864", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027602 get input for the first time since 06/13/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-13' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "bccd2741d2ab3570194f6bc7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that patient 10016150 was last prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "dc56faa6ef9caadfd8ca6880", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of ICU visits for patient 10025612 in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND strftime('%Y',icustays.intime) = '2100'", "rejected": "null"}, {"id": "1f8f753b781c5e7a44238a71", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the three most common lab test that was given?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\nSELECT SQL SELECT T1.test_name FROM ( SELECT d_labevents.test_name FROM d_labevents WHERE d_labevents.charttime FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM d_labevents WHERE d_labevents.valuenum > 1.0 ) AND strftime('%Y',d_labevents.charttime) >= '2100' ) GROUP BY T1.test_name ) AS T2"}, {"id": "24c0e83a0bd52badc7fc9980", "query": "Convert the question below to SQL query.\n\n### Question:\nIst patient 5142 subject to covid-19 testing\n\n### SQL:\n", "chosen": "null", "rejected": "\n1\n01.PAKMS\n 1. 1100000114970520"}, {"id": "f0042425f5c80fc4ec492cf0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common medications prescribed within 2 months to the patients aged 60 or above after they were diagnosed with diplopia?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) AND admissions.age >= 60 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "bebd7cec45abb76dc9e4534c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was a drug that patient 10001217 was prescribed for within the same hospital visit after receiving central venous catheter placement with guidance in this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "a0fe46cb093192a88d6cf061", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10010471 last receive a lab test for troponin t during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010472 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "962c0dd05a16f3d046055b17", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen tests did patient 10039997 undergo for the last time since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100399973 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "2c9a172538d37c27f588e4f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 9.3 in the laboratory test with calcium, total at the same age of patient 10007818 on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 9.3", "rejected": "null"}, {"id": "152ff0308ad4afd9693231f2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time when patient 10013049 received a bicarbonate lab test in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT SQL SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "a38ecaf9f7fe8c5a81432f27", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the monthly maximum value of weight for patient 10009049 since 01/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "SELECT SQL SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y',chartevents.charttime)"}, {"id": "ee344b98a4a7a22b3443b8a1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10014729 has been prescribed ketorolac and sodium bicarbonate at the same time since 16 months ago?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ketorolac' AND admissions.subject_id = 10014729 AND datetime(prescriptions.starttime) >= datetime(current_time,'-16 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10014729 AND datetime(prescriptions.starttime) >= datetime(current_time,'-16 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "c13460734de88497b6d17501", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people were diagnosed with acute kidney failure with lesion of tubular necrosis since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure with lesion of tubular necrosis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "null"}, {"id": "25c1ae6ee1303d4325b02e56", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time the heart rate of patient 10018081 registered greater than 73.0 yesterday?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 73.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d06643d034d4d04e5457cae5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the total number of other and unspecified pneumonectomy procedures performed in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "98718dac8212efcff4207af5", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the last hospital stay, how much amitriptyline has been prescribed to patient 10002930 in total?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'amitriptyline'", "rejected": "null"}, {"id": "f32d842f0e3bf602efb3e22f", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate how many patients were in medical/surgical intensive care unit (micu/sicu) in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "null"}, {"id": "6c892975c433bd0b8960e8d5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of lidocaine 1% dose prescribed to patient 10001217 since 03/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'lidocaine 1%' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "null"}, {"id": "ede3b2dd4e96f4b8027fd757", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent output occurrences since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n. )n-'MS"}, {"id": "5205a0314efeddff42fe6437", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most common procedures that occurred during the same hospital encounter for patients who had extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic before since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "1afcc723ae25dcbcaee4919e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018081 first get mrsa screen microbial tests in 12/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "\n\n### Question:\n\nWhat is the average total hospital cost for a procedure named cardiac catheterization, multiple, percutaneous approach?\n\n\n### SQL:\nSELECT AVG(T1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100128565 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) ) ) )"}, {"id": "e49c32e4d9f1ea0458d6583e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 52018 an appointment at the other department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100389334 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "5fd4f4ab7afda4e90c2af26a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average monthly number of patients suffering from personal history of sudden cardiac arrest since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of sudden cardiac arrest' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "760fc9ca5ebd74a67d09783d", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any new medication in the prescription of patient 10004733 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "240b36c04ba129e0ec06c297", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum total hospital cost that involves cellulitis and abscess of trunk since 2100.\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cellulitis and abscess of trunk' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "132aee5ba3480c54ca8cee44", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most frequent microbiology tests since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "null"}, {"id": "5f4091b20b6ccfd4e72a8f1f", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease tell me the sex of patient 10018328.\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10018328", "rejected": "null"}, {"id": "c8c5c2ee11a8da094f25c3bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last dose of ondansetron that patient 10025612 was prescribed during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'ondansetron' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "bbd60fbc1489752c6364f8bf", "query": "Convert the question below to SQL query.\n\n### Question:\nOn their last ICU visit, what was the last arterial blood pressure mean value of patient 10038933?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a762ae81d4a2a3d7d99c19e7", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of total foley that patient 10010471 had since 07/14/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-14'", "rejected": "null"}, {"id": "bef2c1e139eac11ba6f699ee", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know the minimum albumin value of patient 10002495 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' )", "rejected": "null"}, {"id": "94b617e6ff37a625db538e00", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last hospital encounter, what was the last time patient 10026406 had a medication via the po/ng route prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "0939295415266bebd843029a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the five most frequent outputs in 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "# SELECTC10003"}, {"id": "741e6bfd3ada80120eff4191", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10002930 received a medication prescription since 02/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'", "rejected": "null"}, {"id": "d0c0f7766e9f698b1439c34e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three commonly ordered medications for patients who were diagnosed with atrial fibrillation previously in the same hospital visit, in this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "53c32235b5170a6e842852f7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last hospital discharge time for patient 10022017 since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "db398e1ac2a8d286cc4b53bb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of a hospital stay involving adverse effect of unspecified antiepileptic and sedative-hypnotic drugs, initial encounter?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of unspecified antiepileptic and sedative-hypnotic drugs, initial encounter' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "615149dac9c4e11fbde8d9bc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had a lymphs lab test since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphs' ) AND strftime('%Y',labevents.charttime) >= '2100' )", "rejected": "012.1.\n )\n1. When's\n\n202.148'"}, {"id": "40e1b2eb72eb67d84b772be6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total guaifenesin-dextromethorphan dose that has been prescribed in 08/this year to patient 10021312?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'guaifenesin-dextromethorphan' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08'", "rejected": "null"}, {"id": "f4312adc1652536556c92455", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10018423's last input time on 05/21/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-05-21' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "3d9d7abd6d9d5b5188725536", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total sum of inputs for patient 10007058 since 02/25/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-25'", "rejected": "null"}, {"id": "195a853f0ef04bb3011b271b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018081 have a first metamyelocytes laboratory test in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "8b5709aba37b6339722a0855", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average rdw-sd value of patient 10022880 in 04/this year?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04'", "rejected": "null"}, {"id": "8df09dad6578de1a0c901527", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10006580 have any prescriptions for medicines on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "ef3a3988a8876d9454fd9090", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there a genetic test that patient 76494 received?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100078185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "7ccdae90c6ad3af703d3e038", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most common diagnoses.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "C-\n )\n\n\n. (. And P:.d for igger ( .\nMS.m. (Ioths1 ._\nMS.201:19.-121012MEN-MSOnPAIDMSPAY.10020.00034020040002848081720.030000013500007385487'"}, {"id": "9218e853e95e29cf3aae565d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much was the difference in temperature celsius of patient 10005817 last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "dc5d5f941a6b2d27b4856352", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time of input time of patient 10004720 since 08/08/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-08' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.starttime FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m-%d', admissions.admittime) >= '2100-08-08' ORDER BY admissions.admittime DESC LIMIT 1 ) AS T1 JOIN ( SELECT procedures_icd_procedures.starttime FROM procedures_icd_procedures WHERE procedures_icd_procedures.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy, small intestine, via natural or artificial opening' ) AND strftime('%Y-%m-%d', procedures_icd_procedures.charttime) >= '2100-08-08' ORDER BY procedures_icd_procedures.charttime DESC LIMIT 1 ) AS T2 ON T1.subject_id = T2.subject_id"}, {"id": "23a3bff9e2c821e3f091088a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10019777 get an input for the last time since 03/04/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-04' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2b2758c78e28d13baca5b743", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top three most frequent lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n##\n\n\n##\n##\n\n### Question:\n\n## Question:\n\n\n### SQL"}, {"id": "3bf09c03de716a687fc51856", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is 0.69 on a troponin t test among patients of the same age as patient 10002495 in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.69", "rejected": "null"}, {"id": "55952982603c114a5b29a8b0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four commonly ordered medications for patients who were diagnosed with other and unspecified alcohol dependence, in remission previously during the same hospital encounter, since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "a8ff0ea0ca160c494fdc945c", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 5142 have a travel history from overseas?\n\n### SQL:\n", "chosen": "null", "rejected": "MS\n 2?'s NOTMS0-241921.\n\n\n'TITU2'"}, {"id": "9b71dfdbadbc316c5802b20d", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 05/2100, what was the first drug that patient 10016150 was prescribed through the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "7ed6037be014a8ca196e26e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the reimbursement standard for cerebrovascular mri\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'"}, {"id": "f46ac5597a933d3aa191df19", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the four most frequent procedures performed since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "8421eb301129aed147270645", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the best way to disinfect a quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "f8d725f820917d71a5301983", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time when patient 10019568 had the minimum value of ptt?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a0ca2a3cc031562c671e82e2", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there a genetic test that patient 83062 recieved?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECTIVE PROCEDURES IN 07/2100 FOR PATIENT 83062"}, {"id": "133e29afd664c35e8accca09", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10018328's minimum value of urea nitrogen, urine during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' )", "rejected": "null"}, {"id": "80d4378bde5e039e67689ec1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last hospital discharge of patient 10003400 since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "\nSELECT\n\n\n### Question:\n\nWhen when was the last time patient 100384581 was discharged from the hospital in 21000?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100384581"}, {"id": "73a58a83894d2589594daf4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequent output events in this year?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "::(4_.. ..'..\u0401_h\n's . 02.. 1 2e 264?\nMSTEMS11MS132A 2MSPAK C11.00300002482912100006'"}, {"id": "909212b3de8ea34ca2c96475", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of arterial blood pressure diastolic of patient 10004235 second measured on the last ICU visit greater than the value first measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "55089d9089a6992078371da4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently ordered medications that patients in their 50s were prescribed within 2 months after they were diagnosed with other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "f93cc51e5d7120ee4b957451", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total volume of void that patient 10007058 had since 09/10/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-10'", "rejected": ".. 1.1-/..\n\n -1.-2\n 2._ C.MSMS\n. 1 And JJQ.MSPA)\n\n\n-PTPA Andreiks' And ' AND CANAMSPAGMSPA: What is the output's the value of the protocol?\n##\n And he passed a year'\n\n"}, {"id": "877f60bb26ea0d5229a4665b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost for the hospital when a rheumatoid factor lab test is involved since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "1(. ( J Mon.. P 1\n\n... (- F._.,1 1 SPrice_G- \nMS:-1.\n...:UPAMS.( where4)1031 212 MS:1:..!TX12MS112001:00:19120000000101.MSPAGMSMS3640100.\n##PAGEMSPA -3\n#0.04362841543449 AND 09\n##03068589392456990' AND strftime (test AND chartep AND strftimt AND strftimt AND chartep AND strict<ort AND strimep AND strimt AND strimtimt AND strimt AND strimt AND strimt FROM intravenous AND strimt AND strimt FROM admissions WHERE the last time was the patient was admitted to the hospital?\n\n"}, {"id": "b88f292ca552b0ea6d9929d1", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last hospital visit, did patient 10037861 receive a right heart cardiac catheterization treatment?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "e277a867e388255263046134", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total cost of a hospital visit involving a phosphate, urine lab test?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate, urine' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "44962ace42f808407fa6647a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first lipase lab value for patient 10019172 in 10/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "000f58d3abb4ad76b2ebc35c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time the respiratory rate of patient 10018081 was measured to be less than 23.0 today?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 23.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ce4f4d6348cd296c4415f38c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10000032 receive a mrsa screen microbiology test for the first time since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e3ef5dc86e154039d7839324", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021118 had the minimum monocytes in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ffbd9d197177ca7b317f66cb", "query": "Convert the question below to SQL query.\n\n### Question:\nCan I know the total output amount for patient 10039997 since 04/16/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-16'", "rejected": "null"}, {"id": "224fe50640fe06e9fd64e1cd", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the last specimen test patient 10014354 had received since 10/2100.\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "95bf452438092fdf90c9955f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum value of patient 10014729's protein in 03/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'", "rejected": "null"}, {"id": "79f5ff562350b5444728d472", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10020306 was discharged from hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "e7fcf849ac87ce9fbbd3cf84", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the procedure that was given two or more times to patient 10007795 since 12 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-12 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "bcbe7556b4dbff73f99a68a6", "query": "Convert the question below to SQL query.\n\n### Question:\nCount up how many times patient 10018845 was admitted to the ICU since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.admission_location = 'icu' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "9a5479043b5bc9db5c89822f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the type of blood patient 10431 has.\n\n### SQL:\n", "chosen": "null", "rejected": "MSMS24929474581975588997389'"}, {"id": "1a0886c3a3d7dd6afb64dabb", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total cost of a hospital visit involving respiratory failure, unspecified with hypoxia since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified with hypoxia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "e7d1fbad4727f90f548eeaae", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10007818 weigh difference last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "f531d0fed3a37f3e379fb328", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10022041 visit an emergency room in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n### Question:\n\nWhat is the maximum total hospital stay length of patient 100180818?\n\n\n### SQL:\nSELECT MAX(T1.C1) FROM ( SELECT SUM(transfers.length_of_stay) AS C1 FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) )"}, {"id": "c1ead7f66a477b8a69f1baea", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10009628's hyaline casts second measured on the last hospital visit is less than the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "9011b8d82bdbbf46bb8ecbb9", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the four most common microbiology tests performed this year.\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "\n\n:212022001000414212800720'"}, {"id": "e8debe591ef7f4b4639bad49", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10031404 since 07/04/2100 for the first time have an input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "0d4db28074f3b1bafc59af7e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10011398's chloride change last measured on the first hospital visit compared to the value second to last measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "98c5ba7c0885aff19ce951a4", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the insurance plan of patient 10029291 on the last hospital encounter.\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\nSELECTIV drip for the last time since 03/23/2100?\n\n\n### SQL:\n\nSELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214873 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-23'"}, {"id": "fc46ccfbdac692e517e9d7fe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the medicine metformin (glucophage)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'metformin (glucophage)' )", "rejected": "SELECTIVE EXPLAIN THE DIFFERENCE BETWEEN T2 AND T3 IN PATIENT 100380856?\n\n\n### SQL:\nSELECT T3.C1 - T2 FROM ( SELECT T1.C1, ( SELECT SUM(inputevents.amount) AS C1 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100380856 ) ) ) AS T1, ( SELECT SUM(prescriptions.dose_val_rx) AS T2 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100380856 ) ) AS T3 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN prescriptions ON T1.subject_id = T2.C1 WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T1.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "8ab1c53c8047e269a54d47ad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10003046 was discharged from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003046 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "53fbf62aeeffb338f67df6cc", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the price of trimethoprim.\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' )", "rejected": "\n\n##\n\n##\n\n##\n### SQL Code Criteria:\n\nHow many times was patient 100278185 prescribed acetaminophen 500 mg since 10/2100?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ('acetaminophen', 'acetaminophen') AND prescriptions.drug_strength = '500 mg' AND admissions.dischtime IS NOT NULL AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100278185 )"}, {"id": "a6b419a3f82d564950633030", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the gender of patient 10016742?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10016742", "rejected": "null"}, {"id": "f891b43ca4a360dfc23bf60d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is today's outpatient schedule for dr. cannon?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum< 16.0 ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "e07839bc9af48a037d0d54bb", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong the patients of age 20s this year, what are the top four most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "8bbc16e7b33ddf49226c0c8e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much sodium bicarbonate was prescribed the last time since 11/2100 to patient 10006053?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND prescriptions.drug = 'sodium bicarbonate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "\n## SELECT COUNT(*) FROM hospitalizations WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100197777 ) AND strftime('%Y-%m-%d-%d', admissions.dischtime) >= '2100-03-04'"}, {"id": "23652e6ecf5fc87dd7d50a98", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with nicotine dependence, cigarettes, uncomplicated during the same month after they were first diagnosed with long term (current) use of antithrombotics/antiplatelets in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of antithrombotics/antiplatelets' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "65a768c5a05156a43362b231", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 11/2100, what was the last time patient 10029484 had a medication via the po/ng route prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT T1 = ( SELECT SUM(outputevents.valuenum) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180816 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po/ng' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01' )"}, {"id": "e630dab0aeb52cb103a0b242", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10023239's maximum value of heart rate since 04/15/2100.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-04-15'", "rejected": "null"}, {"id": "adead92d438c2cc8419cbb1a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug name that patient 10027445 was last prescribed through the tp route in 09/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'tp' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d365fe598240a0df514f9daa", "query": "Convert the question below to SQL query.\n\n### Question:\nCount how many current patients are aged 60 or above.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60", "rejected": "\n##\n\n##\n\n##\n##\n##\n##\n###sql-sql-SQLSQL:\n\n\n###0001: SELECT T1.spec_type_desc FROM ( SELECT T1.spec_types.spec_type_desc FROM ( SELECT DISTINCT microbiologyevents.spec_type_desc FROM microbiologyevents.microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1001100384 ) ) AND microbiologyevents.spec_type_desc = 'stool' AND datetime(microbiologyevents.charttime) >= '2100-02-03' ) ) AS T1"}, {"id": "7346582042d3b9bcee31329c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first time patient 10021487 visited careunit trauma sicu (tsicu) in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "d8830bd1398db83dd14ba4d6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most commonly ordered medications in this year?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n0._.1212-0021\n\nMSMSHIR"}, {"id": "69b4dbcc3e05876c15ab3314", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring what last time in their first hospital encounter did patient 10022880 have the maximum epithelial cells level?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "3e1167087d703871be0911f4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027602 last have a minimum value of arterial blood pressure diastolic on last month/29?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "82ad167233a4d7fcb6864dc7", "query": "Convert the question below to SQL query.\n\n### Question:\nSo what are the types of blood patient 8016 has.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT\n##\n\n### Question:\nWhen was the last time the arterial blood pressure was measured for patient 1003681888 on 12/18/this month?\n\n\n### SQL:\nSELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100368188 ) AND datetime(chartevents.charttime) >= '2100-12-18' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "e8f80475c0b36304390859e0", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients who stayed in coronary care unit (ccu) since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "null"}, {"id": "16daefeea8782307bdc2f5f7", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the daily maximum weight of patient 10031757 since 12 months ago.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "5a536ab7ae2327363d482a5d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost that involved alcohol detoxification?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "779c1146d11f1cde9ab109bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat should i do in advance of bile duct incision nec\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "3a6c107da55dce7df0c5c04c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism detected during the first stool microbiology test of patient 10020944 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "\n##\n\n##03. What is the maximum hospital-acquired weight of patient 1000378655 since 02/2100?\n\n\n### SQL:\n\nSELECT MAX(chartevents.valuenum FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100200385 ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02' )"}, {"id": "38d2cf0507adde7b8f7a6eb3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the drug patient 10007818 was prescribed during the same day after having received a fluoroscopy of superior vena cava using other contrast, guidance procedure in 07/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007818 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007818 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "4afe78a50dbf480375c2d614", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the first bronchoalveolar lavage microbiology test of patient 10021487 in 12/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "726a0de52d59010c160bbe92", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum bicarbonate value for patient 10006580 on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' )", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "2ada7dac8b465ec817534276", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of neutra-phos that was prescribed to patient 10036156 for the first time in 07/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug = 'neutra-phos' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "75ad30a366fbe3a6f2ed6f8a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most common diagnoses for patients aged 30s.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n\n##03. What are the percentile level of oxygen saturation pulseoxymetry during the last measurement on patient 100190035's body since 03/09/2100?\n\n\n### SQL:\n\nSELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100045938 ) ) AND chartevents.icustay_id IN ( SELECT chartevents.icustays.icustay_id FROM chartevents.icustays WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100045938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.valuenum) = '2100-03-11'"}, {"id": "531895a8f6c3cd6a5748843b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since patient 10004733 had received a mch lab test for the last time in their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "9e244cb537e766b890782d9a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total volume of patient 10009628's input since 07/04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04'", "rejected": "null"}, {"id": "a3d0c04ad119ac98baeec6ac", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 04/04/2100, when did patient 10018501 have their last input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-04' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "1697a8cad9b6a471e01ec05a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism discovered in the first fluid,other test of patient 10021487 since 9 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-9 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "cb28a22dfa640e40700d6ace", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common microbiology tests for patients who were previously diagnosed with encounter for attention to other artificial openings of digestive tract in the same hospital encounter?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for attention to other artificial openings of digestive tract' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "7f9f201c03d5f3b1e2d247ca", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the count of patients who left the hospital in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n001.3 AND NOTCANCAN ICDaily, what are there diagnosed with renal arteriovenous bleed arteriography during this month?\n\n\n##\n\n##: Code for the diagnosis of other and unspecified cerebral arteriography."}, {"id": "613a190f2257871bd0c6a395", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much of a difference is there in patient 10029291's weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 )"}, {"id": "cae94b9b74b0ff5b8f016878", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who undertook dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic within the same hospital visit, what are the top three most frequent specimens tested afterward this year?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "5ee025cab135eb911d61888a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequent procedures for patients aged 50s throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "C P.. W1                 10  1's. .\not-/a.'T\n\n\n,BMSPAMSMSYMSMMMARMSSSPAGPA-' )(\n\n"}, {"id": "de726b4a741c447f0cdcb8e5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a medication called acetaminophen iv cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetaminophen iv' )", "rejected": "SELECT\n##\nSELECT\n\n##: SQL Dataset in 03/2100, what was the maximum value of magnesium?\n\n\n### SQL:\n\nSELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473338 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'"}, {"id": "b208f8a2d2336ea49139fb02", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most frequent lab tests that patients were given after being diagnosed with knee joint replacement in the same month in 2100.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'knee joint replacement' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'knee joint replacement' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "b8fc22b947af56744b197ad0", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10022041 been admitted into the hospital throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT MAX(inputevents.starttime FROM inputevents JOIN admissions WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100204187 ) ) AND inputevents.stay_id IN ( SELECT inputevents.stay_id FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100204187 ) ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02' GROUP BY strftime('%Y-%m-%d',inputevents.starttime) )"}, {"id": "c0fcaebf5fe4de9b0da7c35c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much morphine sr (ms contin) had been prescribed to patient 10021312 in total in 08/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'morphine sr (ms contin)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08'", "rejected": "null"}, {"id": "465b2135f373a21003fd5e51", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last hospital admission type for patient 10021666 during this year?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021666 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10021666 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "e0d6ebb9ae85186bd60eadb3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most commonly ordered medications since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "\nSELECT\n\n##: Select the count of the last immunotherapy session for patient 100390785?\n\n\n\n### SQL:\n\nSELECT COUNT(*) FROM ( SELECT admissions.transfersto.intake.outtime FROM admissions JOIN transfers.transfersto.hospitals JOIN admissions.subject_id = admissions.subject_id WHERE admissions.hadm_id = 100390785 AND admissions.dischtime IS NOT NULL AND transfers.intime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1 )"}, {"id": "d4d40dd78c364c6f666d1a05", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile does a platelet count value of 328.0 for patient 10023117 place in today on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 328.0", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T1 WHERE T1.valuenum = 328.0"}, {"id": "e72e07c6e4ff2480d2708585", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the four diagnoses that had the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "\n### Question:\n\nWhat was the last time that patient 100178085 had a minimum weight in 03/this year?\n\n\n### SQL:\nSELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100178085 ) AND datetime(chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1 )"}, {"id": "38bb18f4f12bf469e4927756", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018845 get an input for the last time since 09/09/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-09' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9e13de1d202dab1dcf105976", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last hospital visit, what age was patient 10025463?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\n## Question:\n\n##: What was the first time patient 100200356 was discharged from the hospital in 21000?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100200356 AND strftime('%Y-%m', admissions.dischtime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "d9585c679577af82dd88c509", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of drugs patient 10019172 was prescribed since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "be9080e8bd4d6236bf72ed25", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was a drug that patient 10021487 was prescribed for in the same day after receiving arterial catheterization since 2 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-2 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-2 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "c9f31ddb9aad553f281fb072", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell which medicine was last prescribed to patient 10021118 via the oral method in 12/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'oral' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "ea55d009cc63424e1e7ee824", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the steps after the cystoscopy nec?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n####\n\n\n##\n##\n\n##\n### SQL Select the top five most commonly prescribed drugs since 21000 to patient 100398402.\n\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100398402 ) ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100' ORDER BY prescriptions.starttime DESC LIMIT 5"}, {"id": "3d1061a32eb79f759245bffb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the count of patients who were prescribed glucagon during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\n###03.0 SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND datetime(prescriptions.starttime) >= datetime(current_time,'start of year') AND strftime('%m',prescriptions.starttime) = 03"}, {"id": "e1a987c52eaba2b8697dbc00", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time in 04/this year patient 10012853 was prescribed a medication via the po route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "346ee07f02d16abcf7f62e9e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the white blood cells percentile of 12.1 among patients of the same age as patient 10001217 on their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 12.1", "rejected": "null"}, {"id": "0a103802ca827b13141a5a60", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10018081, how many hours have passed since the last diagnosis with long-term (current) use of anticoagulants in their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8155288647172c49b5a66196", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first output during their first ICU visit for patient 10025612?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "f7dca6ca66a468ed7f41631a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum monthly number of people diagnosed with obstructive sleep apnea (adult)(pediatric) in this year?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'obstructive sleep apnea (adult)(pediatric)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "730ddcc40f72a6481ae4e90f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10016150's last discharge since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10016150 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "65f0a54b0c223f74168d1b02", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have it been since the last stay of patient 10004733 in their current hospital visit in the careunit medicine?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND transfers.careunit = 'medicine' AND transfers.dischtime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1"}, {"id": "321006220344a56eb205b7b3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. ford's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": ". (in.J. -..1@'1\nMS1\n 1011MSocyON T134128.'sMSMSMSPAY'sPAGEPAINT.MSPA: SELECTCare you't'\n\n\n\nPA's the difference in the value of arteric blood of patient 100001086457's's body weight?\n\n\n\n'prescriptions'"}, {"id": "21f3520f8db52d400b139521", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since the last time patient 10004733 has received a anticardiolipin antibody igg-lab test on the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igg' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "f460b01f60e21810e3c0e875", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat would the average yearly number of patients diagnosed with coronary atherosclerosis of autologous vein bypass graft be since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "8afa74497c4d9b8c7f0fe659", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three diagnoses with the lowest 3-month survival rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "C100.10.0306585593 was admitted for the first time are you supposed to get discharged from the hospital?\n\n\n### SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10010010038 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "cc2d4eae2f2d008d9c2c9518", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients from the 40s age group are currently admitted?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49", "rejected": "0.\n(testMSPA)\n21.100.020188527697332411'"}, {"id": "024e5c4760ca03ad0215c516", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10001725 first prescribed the medication via the im route during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a1d4a46462d0cd1e638cddc8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the count of patients who were tested for magnesium since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "\n\n##\n##\n\n##\n## Question:\n\nWhat are the four most common lab tests that followed after the diagnosis of other and unspecified ischemic heart disease in the same hospital visit in 21000?\n\n\n### SQL:\n\nSELECT T1.test_name FROM ( SELECT d_labevents.test_name FROM d_labevents WHERE d_labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100274057 ) AND strftime('%Y', d_labevents.charttime) >= '2100' ) GROUP BY T1.test_name ) AS T2"}, {"id": "b0b4926abc6fba2f9b78a017", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with hyperlipidemia, unspecified during the same hospital encounter after the previous diagnosis with presence of cardiac pacemaker throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'presence of cardiac pacemaker' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "264556fad0e8f61d4b7fe7e9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the first alkaline phosphatase lab test results for patient 10019172 in 10/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "7f326a0a5a46eb805b8f5a56", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most common diagnoses of patients with age 30s in 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT COUNT(*) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.diagnosis_code ASC )"}, {"id": "24f447b683e61e944f998093", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time, what was the medication that patient 10015860 was prescribed in 10/this year via the pr route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "32e94e8bedc88c14f2a61d32", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the name of the med that shouldn't be given during exc/dest hrt lesion open.\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n### Question:\n\nIs there a diagnosis code for insomnia due to other causes?\n\n\n### SQL:\nSELECT DISTINCT diagnoses_icd.d_icd_code FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'icd-11' AND strftime('%Y',diagnoses_icd.charttime) >= '2100'"}, {"id": "c62375c94b9f079a0f6c7c91", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time when patient 10020187 was prescribed 0.9% sodium chloride and levetiracetam at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10020187 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levetiracetam' AND admissions.subject_id = 10020187 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "3cfbe0e30b718f625d69a2c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10013049 get the mcv lab test on the last hospital stay for the last time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10013049 AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "5c3f52d548353aad5447d804", "query": "Convert the question below to SQL query.\n\n### Question:\nOn this month/04, what was the last heart rate reading for patient 10004720?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '04' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "40ee187ccec9edfec26c08d6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10007818 prescribed pantoprazole and vial at the same time for the last time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10007818 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND admissions.subject_id = 10007818 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "95475af06738ffe0fb4f1c65", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first measurement of heart rate in patient 10031757's body on their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "db1b480d2286ade3469fa410", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the body weight change of patient 10038933 second measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "91405986ac7029c89c4e111c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of an output that patient 10013049 has first had since 03/07/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "501d7e20f28d6572b7ea2104", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021118 have the last minimum creatine kinase (ck) value on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5768b3ec354138c3fd79bb7f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost for a patient suffering from acute edema of lung, unspecified since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute edema of lung, unspecified' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "36961c041d723a40cd3af9bc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many instances of lumbar and lumbosacral fusion of the posterior column, posterior technique procedures have been completed?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'lumbar and lumbosacral fusion of the posterior column, posterior technique' )", "rejected": "null"}, {"id": "5075b95436488f53e5f7976e", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10007818 given a test on potassium, urine on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "4d21ff0e9b82a46ea21db1c1", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005817 had platelet count tests in this month?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')", "rejected": "1.\n####\n03413451558 received the first time in the year 03/2100, patient 1001974859 was diagnosed with esophageal ulcer (esophagus) after being diagnosed with unspecified viral hepatitis c, not elsewhere classified nec in the same hospital visit?\n\n### SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal ulcer (esophagus)' ) ) AND strftime('%Y-%m-%d', admissions.dischtime) >= '2100-03'"}, {"id": "63b6c9677e2f1cde57d31e73", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10004422 change in weight last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "45ff22c09f3754e81e8ab8b4", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent extracorporeal circulation auxiliary to open heart surgery within 2 months after the diagnosis of long-term (current) use of insulin?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')"}, {"id": "92a24aa83e1c66451f13de62", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10031757 last get swab's microbiology test during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'swab' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8dd2ecde928ffc81f605bc96", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last hospital discharge time for patient 10014354 in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10014354 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "70d4f706eb7c1197729174d6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most common drugs prescribed since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( 'ibuprofen', 'acetaminophen', 'torsemide', 'glipizide', 'acetaminophen', 'albuterol', 'famotidine' ) AND datetime(prescriptions.starttime) >= '2100-06-23'"}, {"id": "f21b3abcfb7c410d3b31bc30", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who were diagnosed with multiple myeloma not having achieved remission.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'multiple myeloma not having achieved remission' ) )", "rejected": "null"}, {"id": "6395fc9f76e16f012c954890", "query": "Convert the question below to SQL query.\n\n### Question:\nCurrently, how many operating rooms are available?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "bf06541db3b43eaef5cf5f41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the dose of the prescribed opioid for patient 99647??\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "47b4b008bc5e93c16c231277", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you give me patient 10021118's daily maximum lr input in 12/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "00bbbffdff5ee0427911211a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output of patient 10027602 for the last time on this month/03?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '03' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_labevents.valuenum FROM d_labevents WHERE d_labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(d_labevents.charttime) >= datetime(current_time,'-1 month') AND strftime('%d',d_labevents.charttime) = '03' ORDER BY d_labevents.charttime DESC LIMIT 1"}, {"id": "3eaf001189831be5d9a41258", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top five most frequent treatments patients received within 2 months after being diagnosed with dissection of aorta, abdominal in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "7965e6adfaf230fa5c010a43", "query": "Convert the question below to SQL query.\n\n### Question:\nSo tell me what to do before you go for hemodialysis.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' )"}, {"id": "c70087e768a59793cb584211", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top five most common lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 ) ORDER BY T1.C1 DESC LIMIT 5"}, {"id": "b698443b1f5aac05583b6fa9", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of stay for patient 10015860's first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "8e71be5e11c9a90ff530970e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10021487 was prescribed chlorhexidine gluconate 0.12% oral rinse and famotidine in this month at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "f870fc9332fe7c3778488b46", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10011398 was prescribed drugs via po on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "\n##1.MSSSPA TITAMS21396117989879?\n\n\n##\n\n###code_title = 'excision of right lower extremity artery bypass procedure'\n\n\n### SQL SELECT T1.drug FROM prescriptions WHERE prescriptions.drug IN ( SELECT prescriptions.drug, prescriptions.drug_name FROM prescriptions WHERE prescriptions.drug_id IN ( SELECT procedures_icd_icd_procedures.drug.drug_name FROM procedures_icd_procedures WHERE procedures_icd_procedures.drug IN ( SELECT d_icd_procedures.drug FROM d_icd_procedures WHERE d_icd_procedures.drug IN ( SELECT procedures_icd_procedures.drug FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND d_icd_procedures.charttime IS NOT NULL ORDER BY d_icd_procedures.charttime DESC LIMIT 1 ) AND strftime('%Y-%m',d_icd_procedures.charttime) >= '2100-"}, {"id": "b7d1939430a21c6f12cd36da", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many ampicillin-sulbactam prescriptions occurred in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ampicillin-sulbactam' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "fty\n \n12.112:PAMS'\n<MSMSPA) THE PIT'S'"}, {"id": "d74b04155d86c3e804553ede", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most frequent medical diagnoses since 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT COUNT( DISTINCT diagnoses_icd.icd_code ) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code )"}, {"id": "f3e0838ba3fa3ba6844991f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10007818 was discharged from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007818 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "00fbe516569113decea8de73", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10013049's last microbiological examination on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "f3ecb8116711437750ac3fb5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10020740 was prescribed medications via the po/ng route on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "4b334d0f16aebc57870989a3", "query": "Convert the question below to SQL query.\n\n### Question:\nSo how many hours have passed since patient 10021487's first closed fracture of four ribs diagnosis during the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of four ribs' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4e8481ab0f1038d7d4b6fbb3", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10007928's length of stay for the first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT SQL SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "7af1e69b20b9be325402ee3c", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the creatinine value last measured on the last hospital visit in patient 10023239 greater than the value from the first measurement on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "d080d1e38919b6a529de708c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10015931 first have the minimum amount of ph in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0cd0b92b050e9e355d9c8775", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the total of avapro prescriptions in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'avapro' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "\n### Question:\n\nWhat is the minimum monthly maximum amount of dextrose (d5% dextrose) that patient 100218088 had received in 07/this year?\n\n\n### SQL:\n\nSELECT MIN( SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays.stay_id WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100218081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.drug = 'dextrose' AND d_items.linksto_icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriovenous catheterization of femoral artery, percutaneous approach' ) )"}, {"id": "5edb9312f6f7f742fcdce8fc", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10014078 had a lab test done since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'", "rejected": "null"}, {"id": "4d0cbd90ae58506f9467785f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10001725 was tested for eosinophils on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "dd87fb2dfb9bf1eaf69c3a59", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10019172 had the first input since 03/05/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "7a3e3929c28d9385a729ebfd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's up with the single rooms now?\n\n### SQL:\n", "chosen": "null", "rejected": "= 0212102114250023635122124111860004120.1849004278392888's 0.5483518897's heart rate of glucose (glucose) in 04/2100's?\n\n\n\n0.054.0's since 02/21000?\n\n\n### SQL:\n\nSELECT AVG(sum(inputevents.amount) FROM admissions.discharge WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriovenous needle biopsy of renal artery, percutaneous' ) AND strftime('%s') >= '2100-02-02' ) AND strftime('%YEAR(procedures_icd_events.icd_code.charttime) = '2100' ) AND strftime('%m',procedures_icd_events.charttime) >= '2100-02-02'"}, {"id": "333df3a7ec5a12c84b0e951e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total of zolpidem tartrate patient 10021487 had been prescribed in 12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'zolpidem tartrate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'", "rejected": "null"}, {"id": "d84033aab28898c9a733e209", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how old patient 10039708 was in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "2eabc9e68c01f195e82de460", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who were discharged from the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "8189f1610cb803102103466a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any medication been prescribed to patient 10015931 since 12/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'", "rejected": "null"}, {"id": "d72835768250c3efcfb0ef0f", "query": "Convert the question below to SQL query.\n\n### Question:\nLet me know the total quantity of input patient 10027602 received on last month/24.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '24'", "rejected": "null"}, {"id": "ead0a72fbee21b877251d88f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does malignant neoplasm of central portion of female breast cost to get diagnosed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of central portion of female breast' ) )", "rejected": "null"}, {"id": "e18a2d8bc4701233c6f71e19", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a diagnosis for other cirrhosis of liver?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) )", "rejected": "null"}, {"id": "986a2a3bde40fef4fc375ef2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most frequent microbiology tests since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "null"}, {"id": "ac606737f9bd303254cf3a86", "query": "Convert the question below to SQL query.\n\n### Question:\nAfter getting diagnosed with hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side, how many patients were found to have bradycardia, unspecified in the same hospital visit since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "1013430fc9817f02c815005a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the cost of a procedure known as continuous invasive mechanical ventilation for 96 consecutive hours or more.\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for 96 consecutive hours or more' ) )", "rejected": "-.\n. ()1-SH( C/03-  . 11_MS.PAMS12SMSPAID\nMS11: 2-0042851851928947241757121876s19's.20002156'"}, {"id": "9998a4013c74f1fbc5a9974e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow do i take precaution after the rt/left heart card cath procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "MS!\n"}, {"id": "5e2dc38de1c3863efdd5f7b6", "query": "Convert the question below to SQL query.\n\n### Question:\nSo, what was the last o2 saturation pulseoxymetry of patient 10004733 since 12/30/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-30' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "4ad13911a0c3cadf96e3052c", "query": "Convert the question below to SQL query.\n\n### Question:\nFetch the top four most frequent procedures that were administered to patients within 2 months after they had continuous invasive mechanical ventilation for 96 consecutive hours or more since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for 96 consecutive hours or more' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "7b67c7a9bff55320d436972c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10011398 undergone a white blood cells laboratory test since 11/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-11'", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-11'"}, {"id": "a9632d75ba6d979b5decdf12", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you name the procedure/treatment that patient 10007795 was given two times in 05/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "null"}, {"id": "612351f75cf9c16873706c46", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the total amount of patient 10039831's output since 05/30/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-30'", "rejected": "null"}, {"id": "8fe130affd01259653e65799", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the four most frequently taken lab test?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "1.00400.\n 1.\n1. What is the last output's the name of the maximum amount of glucose in the last measured since 07/02/21000?\n\n\n### SQL SELECT SUM(inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays. WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT d_icustays.stay_id FROM d_icustays WHERE d_icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT d_icustays.stay_id FROM d_icustays WHERE d_icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT d_icustays.stay_id FROM d_icustays WHERE d_icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT d_icustays.stay_id FROM d_icustays WHERE d_icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180819 ) ) ) AND icustays.outtime IS NOT NULL AND icustays.dischtime IS NULL ORDER BY icustays.intime ASC LIMIT 1 )"}, {"id": "d78eee745ce372a0b010f81a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038999 first have a swab microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'swab' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT SELECT microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038999 ) ON SATURDAY (strftime('%Y-%m-%d',microbiologyevents.charttime) = '2100-07-05') = 1"}, {"id": "ab0dc7cef40d44572a80367e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost for a person with coronary atherosclerosis of autologous vein bypass graft since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "cbe81158af8ca0c5186959f0", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most common lab tests since 2100.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\n##\n\n##\n##\n\n##\n### SQL Query:\n\nSELECT the total number of times patient 1003889958 was given a catheter insertion, guidance into femoral artery, percutaneous approach in 21000.\n\n\n### SQL:\n\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter insertion into femoral artery, percutaneous approach' ) ) AND strftime('%Y', procedures_icd.charttime) = '2100'"}, {"id": "3e2742de9d17a14d3e82aa41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the newly prescribed medicines for patient 10004733 today compared to those yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "5459dfb5c9c49adbe57a0564", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the average total hospital cost that involves oxycodone sr (oxycontin)?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'oxycodone sr (oxycontin)' ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'oxycodone sr (oxycontin)' ) GROUP BY cost.hadm_id )"}, {"id": "8146ea91c180f5ff5edacc7d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10026354 have the maximum value of sodium, whole blood last in 10/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "30ed0a6953999ac4024916ae", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of the hospital which involves calculus of kidney?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney, urinary tract' ) ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "190982f3687093b621a95f14", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost to get drainage of pericardial cavity, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity, percutaneous approach' ) )", "rejected": "null"}, {"id": "5acdc780ba8984cef61073b2", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most frequent diagnoses since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 WHERE T1.C1<= 5"}, {"id": "241a6bd6f1e129a31b43bea9", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021938 go through a lymphocytes test in the last month?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')", "rejected": "null"}, {"id": "e0871385561b20faaecfa48c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who were discharged from the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "null"}, {"id": "bec56d5d887095fdec4a748d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many prescriptions were prescribed in 2100 for iso-osmotic sodium chloride?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "40f923d3ceb04e98040b7c3e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007818 been tested on 25-oh vitamin d since 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'", "rejected": "null"}, {"id": "16a44e61297946c6928ab617", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen test that patient 10026406 had for the first time in 01/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '01' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e17c8e6fc29a5b5e084734c4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the change in the medication of patient 10018081 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "215bb31f610d65f9b86033ff", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours is it since patient 10021487 first received the epithelial cells lab test during the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3e2652e915806719c8430a12", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the maximum total cost of the hospital that involves a procedure called arteriography of femoral and other lower extremity arteries since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "acc452348f26357e7eee2d70", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of input by patient 10019777 on 03/10/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-10'", "rejected": "null"}, {"id": "2ca8e56caf706c6147547a1a", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring what first time did patient 10020944 have the minimum basophils level?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "MS\n(son\nmPAMS?PAKMSPA.1.\n2013.\n00170 AND NOTCANA?\n\n04 AND MONTHANA AND admissions.t.drug_route FROM admissions WHERE admissions.hadm_id IN ( strftime ) 1 ) 21000-02-02-21 AND admissions.discharge_time IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.order ASC LIMIT 1"}, {"id": "6d037a4951c5f57d0e001cee", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medicine that was given to patient 10038999 within 2 days post procedure of drainage of left pleural cavity, percutaneous approach in 06/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038999 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10038999 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "e60031fe0c3c45aa32032148", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the top five most common lab tests?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n (\n ...\n (. ..\nron. Z Jsa12 () in Coupe-_\u2026 1 P<ycz'DMSSPAMSMS 1MS11 \n DONMSPAWMSNSPA.<'\n\n\n BYKMSMSPAK.2'sPAGE'sPA.\n"}, {"id": "721e100bb5221ab0b783efb9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost to get diagnostic of type 2 diabetes mellitus without complications?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus without complications' ) )", "rejected": "null"}, {"id": "a00e9493a4dac3d8a11100c3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last blood culture microbiology test performed during the previous month for patient 10027602?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "caa992eaae720918e04f0b4d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the five most common specimens tested throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'-1 year') ) ORDER BY microbiologyevents.charttime DESC LIMIT 1 )"}, {"id": "b704681115ed8cf6b288919f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10016150 got a prescription for trazodone, rosuvastatin calcium, or metformin xr (glucophage xr) since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.drug IN ( 'trazodone', 'rosuvastatin calcium', 'metformin xr (glucophage xr)' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "ef2cdb36472c00261392f95a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost which involves exposure to other specified factors, initial encounter since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'exposure to other specified factors, initial encounter' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "(MSMSVASINKMSMSMIS CASKINI have you had a C10000374707?"}, {"id": "0ef02974483ac960722b84f8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does the mcv change in patient 10021312 second measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND chartevents.charttime = '2100-09-04 08:00:00' ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND chartevents.charttime = '2100-09-03 07:00:00' ORDER BY chartevents.charttime DESC LIMIT 1 )"}, {"id": "68a6646ad90adaa44fe6ddbb", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any calcium carbonate, bisacodyl, or nephrocaps ordered for patient 10021938 in 04/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.drug IN ( 'calcium carbonate', 'bisacodyl', 'nephrocaps' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "9f56b7e6de37d05e0ac335a3", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who were given the lamotrigine in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lamotrigine' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "\n### SQL Query:\n\nSELECT SELECT COUNT( DISTINCT COUNT( diagnoses_icd.code ) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100184545 ) AND strftime('%Y-%m', diagnoses_icd.starttime) >= '2100' ) GROUP BY diagnoses_icd.icd_code )"}, {"id": "c3ec4bb31cef4c9d976a8b02", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in patient 10029291's last urine test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "\nSELECT SELECT count(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND strftime('%Y-%m',labevents.charttime) = '2100-04' )"}, {"id": "1dea8e8367ea15758b8ca92e", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients prescribed insulin.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'insulin' )", "rejected": ".\n'\n the\n... \n'"}, {"id": "ddbdcf0355e30978ef2bda62", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many prescriptions for tramadol were made throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "..\n2.\n-.,\n..\"\".\n.\nid.d -.\n\n (\n'03 '.\n\n.MS..MS\n's9"}, {"id": "217fb62b4029d43c8d4778f8", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what were the top three most common specimens tested on patients within the same month after the diagnosis of body mass index (bmi) 35.0-35.9, adult?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index (bmi) 35.0-35.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index (bmi) 35.0-35.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 3"}, {"id": "1e7e5b854e3946d368c6016f", "query": "Convert the question below to SQL query.\n\n### Question:\nFind the number of current patients in the 50s age group.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59", "rejected": ". to\n,..\n.C0..K)1 ofS Is.':K12.4.3\nMSMSCDPAMSMSSSIDEMSPALEMPICANA'sPAY.PAGECANA's 0.\n##) Where is the cost of the total of the first time when was the last time this year?\n\n\n\n' AND NOTCANS NOT null"}, {"id": "4d5ceeafba15c9090fc8776b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10019172 receive a blood culture microbiology test for the last time since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10'"}, {"id": "701c361638b72b18b59910b7", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most frequent procedures that patients were given during the same hospital encounter after receiving inspection of tracheobronchial tree, via natural or artificial opening endoscopic in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "3bf9272fcc3117ccfaed52f1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much tamoxifen citrate was first prescribed to patient 10007795 since 10/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug = 'tamoxifen citrate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "783bda443eb8e764428abb4d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10001217 last had the total protein, csf minimum value since 12/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b9fee2e62bcc843043e0a954", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10026354 last have on 10/30/this year?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-30' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "e07ed121ec710b96ce8e6acd", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top five most frequent treatments patients received within 2 months after being diagnosed with rheumatic disorders of both mitral and aortic valves in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "7b319dcf4efec30297a50d9b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given ezetimibe since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": ")?. General 0\n..:1 O:129 0110MSMSMSMSPA.\n11. 1. Can you't 1. Can you use the code to determine the last time that patient 21000387114 had an x-ray of the chest during their last hospital encounter?\n\n##?\n\n##procedures?\n\n\n### SQL SELECT SQL SELECT count(*) FROM procedures_icd WHERE procedures_icd.icd.code = 'excision of other lymph node' AND admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissionshadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissionshadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissionshadm_id IN ( SELECT admissionssubjects.hadm_id FROM admissions WHERE admissionshadm_id IN ( SELECT admissionssubjects.hadm_id FROM admissions WHERE admissionshadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissionshadm_id IN ( SELECT admissionssubjects.hadm_id FROM admissions WHERE admissionshadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissionshadm_id IN ( SELECT admissionssubjects.had"}, {"id": "d2edfd01c7ab2bfa13268728", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since patient 10004733 has first received a eosinophils lab test during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NOT NULL )"}, {"id": "315fe7012ff34a06a1448165", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10009035 receive any solution on 05/12/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '05-12'", "rejected": "null"}, {"id": "4f0acb2eecc88d4baec0a0ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10012853 was discharged from the hospital in this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "97618f1a942f1a7582d5b1a9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new medications prescribed to patient 10039831 today compared to those yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "95b245de3db0ff301118f6ef", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the hematocrit reading for patient 10001725 second measured on the last hospital visit less than the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "18d6cbfdf913f50a3617e481", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10029291's difference in fibrinogen, functional from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "5d60b0b9ec5b00c0e396205b", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 46528 have a history of overseas travel?\n\n### SQL:\n", "chosen": "null", "rejected": "?.)b 21118123' (MSMSMSMSPA:ONLYSEAMARPA(\n##MS/night's 24752077s0's blood pressure was measured?\n\n##?\n### SQL SELECT T2 AS T1 FROM ( SELECT charteventevents.organs TEST.organs's chartevents ) WHEN strftime('DATE(DATE('FROM datetime JOIN admissions.\n\n\n'21000' ) AND strftime('%Y-%m',chartevents.organs'charttime)< '2100-07-20' )"}, {"id": "6d3b33c130ee573fc9b4e5f8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you retrieve the top four most frequent lab tests patients had following a diagnosis of closed fracture of seven ribs in the same hospital visit since 2100?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of seven ribs' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "13467297765b0e75201a52e3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common output instances?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\u0d2aT (.MSete. ( (. 2D-_)\n/'210X101 0220000113010119013891300885647457591513028?"}, {"id": "66e17c14c6b5f8370524c964", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost for a acute and chronic cholecystitis diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and chronic cholecystitis' ) )", "rejected": "\n### SQL:\n\nSELECTIVE PROCEDURES\n\n### SQL:\nSELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code, DENSE_ATC_PROCEDURES.C1 FROM d_icd_procedures JOIN d_dense_icd_procedures ON d_icd_procedures.icd_code = d_dense_icd_procedures.icd_code ) WHERE strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "b6c95050bdc4cd4c317d476e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the four most common microbiology tests for patients who were previously diagnosed with fall on same level, unspecified, initial encounter during the same month since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fall on same level, unspecified, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "bbfcc311f9650f6a3a91f0b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average monthly number of patients diagnosed with bariatric surgery status?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bariatric surgery status' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "1.1.\n\n\n##\n\n##\n##\n\n##\n##\n##\n##\n### SQL Code of the last drug prescription received by patient 1003971858 since 08/2100?\n\n\n### SQL:\n\nSELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1003971858 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'"}, {"id": "1e1a1711a9e429a5c0a74eec", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug prescribed to patient 10007818 for the last time in 07/this year via the pr route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2ec6cb1efc895f9201b5cf60", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the first time during their current hospital visit patient 10021487 got a other lab test?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "202d3ee5d7d3e606014abe18", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost to get diagnostic of mechanical complication of automatic implantable cardiac defibrillator?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mechanical complication of automatic implantable cardiac defibrillator' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'mechanical complication of automatic implantable cardiac defibrillator' ) )"}, {"id": "25c653da4cccc0b0dec24e49", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new drugs for patient 10018081 today compared to the earlier ones yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "4fbd4f9863cff8b2fd42e23b", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10019777 undergo the procedure on single vessel in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac catheterization of left heart, percutaneous approach' ) AND admissions.subject_id = 10019777"}, {"id": "01f974128b8f1c4383263191", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the aggregate input volume for patient 10027602 since 09/26/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-26'", "rejected": "null"}, {"id": "fbd014c02af79a2d9c53a9d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10038999 was prescribed a medication in 05/this year via the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "73f03c4b396e0636de5ad08b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three commonly taken specimens for patients that were diagnosed with family history of ischemic heart disease previously in the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of ischemic heart disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_T1 FROM ( SELECT microbiologyevents.spec_type_desc, COUNT( DISTINCT admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T1 WHERE T1.charttime = '2100' ) AS T2 ON T1.charttime< T2.charttime GROUP BY T1.spec_type_desc ) AS T3 WHERE T3.C1<= 3"}, {"id": "b6b449e2a6346dfeed443761", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most frequently given diagnoses for patients who received anastomosis of hepatic duct to gastrointestinal tract previously within 2 months in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "c87fdda7e48ed877eae86d9a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism found in the first microbiological pleural fluid test of patient 10014729 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "88c671a2840f4530415bcdf6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the number of patients who received a hematocrit, calculated test?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) )", "rejected": "SELECT SQL SELECT COUNT( DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ) ) ON ON ONLY ONCE"}, {"id": "0fcf3657ba17464a0f38afe8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost for cardiac mapping?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) )", "rejected": "\n# T2\n\n\n##\n\n### SQL Code Cue:\n\n### Question:\n\nWhat is the maximum total cost for a hospital that involves a procedure called excision of other lymph node?\n\n\n### SQL:\nSELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.cost.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other lymph node' ) ) GROUP BY cost.hadm_id )"}, {"id": "cc583d453844985f8c75964d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how much hydrocodone-acetaminophen (5mg-500mg) costs?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'hydrocodone-acetaminophen (5mg-500mg)' )", "rejected": "null"}, {"id": "1ce18dcc6660f3f81c822791", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the id of the ward where patient 40707 can be admitted?\n\n### SQL:\n", "chosen": "null", "rejected": "81701-0221-output119.038712352670817000099'"}, {"id": "2b3cc01e73aa273943ba7146", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10037975's o2 saturation pulseoxymetry was measured at less than 90.0 on their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 90.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d3bf0e541f1e4e8cb0f4066a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged from the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": "1.. that.2QT\n MAMSMS.'sMS.-1..182-1028122251162118917101500061401'"}, {"id": "762749a6a8452aa83554f391", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 04/04/2100, when did patient 10020740 receive an input for the first time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-04' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "e157dcdbd534ede0dfd40a1f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the last microbiological examination of patient 10027602's mini-bal since 01/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b457b0375ed13ba271e11902", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time of input for patient 10038999 on 06/05/this year?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '06-05' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "SELECT SQL Select chartevents.starttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND admissions.dischtime IS NULL ) AND chartevents.hadm_id IN ( SELECT transfers.chartevents.hadm_id FROM transfers JOIN chartevents ON transfers.hadm_id = chartevents.hadm_id ) AND strftime('%Y-%m-%d', chartevents.charttime) = '2100-06-05' ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "5b7ca8d49d2817d537c89baa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen were patient 10021938 first prescribed for nifedipine cr and calcium acetate at the same time since 09/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'nifedipine cr' AND admissions.subject_id = 10021938 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'calcium acetate' AND admissions.subject_id = 10021938 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "9b56d431c0b4eac3cf5171d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is mchc 32.2 among patients of the same age as patient 10027602 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.2", "rejected": "null"}, {"id": "47769e56a386699d3ce1b553", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 10/22/this year, what was the average value of the arterial blood pressure diastolic for patient 10031757?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '10-22'", "rejected": "null"}, {"id": "1f4cec0d64925a794dace1cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was prescribed to patient 10027602 within 2 days following their percutaneous [endoscopic] gastrostomy [peg] in 12/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "32f8fa73cf7949fc25194b91", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last input time of patient 10018328 since 03/08/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-08' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "\n## SELECT SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'excision of other lymph node' AND datetime(procedures_icd.charttime) >= '2100-08-21'"}, {"id": "5fac6ea9a02d544397cb54fe", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10018845 been given any medication?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 )", "rejected": ". ,.\n ,11 on"}, {"id": "790f43812849f0e3f94c3c15", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the first hospital encounter, what age was patient 10020187?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "f591b46504d2236b89d77bf8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the total number of fiber-optic bronchoscopy procedures performed during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "799e3b8dccd0212e2b71456d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10022017 first urine microbiologic test since 07/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4712867863ba837a91019c8f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen furosemide and albuterol inhaler were prescribed to patient 10037975 for the first time in 02/this year at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10037975 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol inhaler' AND admissions.subject_id = 10037975 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "38e7715444818223680cc90f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10021487 last received a laboratory test of eosinophils during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J', current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND transfers.outtime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1 )"}, {"id": "896c8f2f1440f307d4f71409", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were administered ipratropium bromide neb?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium bromide neb' )", "rejected": "T0MS.124 T117113014101100003021887's90040028857 AND 0221-04' AND admissions.discharge FROM datetime IS NOT NULL AND strftime('diagnoses_icd.0 AND strftime('diagnoses_icd.0 NOT IN ( SELECT admissions.diagnoses_icd.org.code FROM d_icd_diagnoses JOIN d_icd_procedures ON d_icd_procedures.compartevents.icd_procedures.icd_code = d_icd_procedures.icd_code ) AND strftime('%Y-%m-%d', admissions.dischtime) >= '2100-04-04'"}, {"id": "1209cc6f2d89e79f32b5b025", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the sum total of inputs for patient 10029484 since 02/11/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-11'", "rejected": "null"}, {"id": "e280cc138d720a1fb7cde282", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last value of patient 10039831's lab test for platelet count in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "9e5c20a2a5d9bd9a11019222", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10004733's monthly maximum value of body weight since 20 months ago?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-20 month') GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "fb466f1f12c24c1faea2fb13", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the first time , how much lorazepam was prescribed to patient 10021487?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'lorazepam' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "78deb17fb4b0f07c1c1b0051", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many medications were assigned to patient 10004422 in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "3e877dc92daa5d8f28115762", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total count of performance of cardiac output, continuous procedures that were done since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "36d78a53fb451b1de2c95f2f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in this year were discharged from the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "The last of the neuroCare your current years the last hospital admission?\n\n\ndiagnoses.?\n\n\n### SQL Query:\n\nSELECTCumulative total output for patient 1002164008 since 04/04/2100.\n\n\n### SQL:\nSELECT SUM(outputevents.value) FROM d_output events WHERE d_output.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT admissions.hadmissions.stay_id FROM admissions WHERE admissions.subject_id = 1002164008 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-04'"}, {"id": "89383745e9cd66ac4837c91f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug name that patient 10024043 was last prescribed through the oral route on the last hospital stay?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "13742e41da6ed8f3b472927c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most typically ordered procedures for patients previously diagnosed with other symbolic dysfunction, which took place within 2 months in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other symbolic dysfunction' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "dbb471287262410819ef2986", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the last red blood cells lab test results for patient 10021118 since 10/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "9b2ab198452a5ac2f78b9ebf", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide the top five most common output events since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n### Question:\n\nGive me the top five most frequent procedures that patients were given in 2100.\n\n### SQL:\nSELECT d_icd_procedures.icd_code, DENSELSETS FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd_icd.icd_code, DENSELSETS FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078185 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) ) AS T1 GROUP BY T1.icd_code ) AS T2 ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "2a3c78cd78a7e5f8d977da20", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021312 have his first microbiology test in 09/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-09' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3e1d007895353da9f631ad02", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most common events this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n . , (  er ,.. of.. .. . TA 1 . (.\n FROM:0'Rs.  16 11.Z?1201-s\nMSValMSMSPA 100121:PASSMSPAY J.\nMSPA-1000351000019907008174082083055'"}, {"id": "232ebd5bf14d5819bef84afc", "query": "Convert the question below to SQL query.\n\n### Question:\nHas furosemide, lidocaine jelly 2% (urojet), or acetaminophen iv been prescribed in 04/last year for patient 10038992?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.drug IN ( 'furosemide', 'lidocaine jelly 2% (urojet)', 'acetaminophen iv' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "cf07a721765b700935e376f5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of basophils of patient 10038992 last measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "c8434cc6732c978c99684d40", "query": "Convert the question below to SQL query.\n\n### Question:\nOn their first hospital visit, did patient 10020944 receive a venous catheterization, not elsewhere classified treatment?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "217aba84a14d98a4827d6be1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five commonly taken specimens for patients that were diagnosed with other disorders of neurohypophysis previously during the same hospital encounter, since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other disorders of neurohypophysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "f235f99faeb9fd03302dd63c", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top four most frequent events since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": ". 2 )_&=%10MS CUIMS20:PA 12"}, {"id": "af5718c6edddceb0646a23e6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients exist?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "F..'.\n  in.\n .\n..ali.  ( 1\n\n zaj 1: T Sister"}, {"id": "39d4a4bdf91208fe3d0468a5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most common diagnoses for patients who previously had the performance of cardiac output, continuous procedure within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) GROUP BY procedures_icd.icd_code ) AS T1 )"}, {"id": "11781310efb83f845ca54e72", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most frequent procedures that were delivered to patients within 2 months after they received other laparoscopic umbilical herniorrhaphy in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "eb2f419e7f09df1b43df8f92", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the total foley output of patient 10039831 is since 07/14/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-14'", "rejected": "null"}, {"id": "ed72f24083966a774f22b122", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output that patient 10031757 got first since 06/05/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "004aab9ab72eb76ab6d10d57", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who stayed in careunit medical/surgical intensive care unit (micu/sicu) during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "df6150549dc19e26326e20ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the precautionary measure following the head & neck endarter nec procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1.drug FROM ( SELECT admissions.drug, DENSEXC.drug FROM admissions JOIN prescriptions ON admissions.hadm_id = prescriptions.hadm_id WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.drug, procedures_icd.starttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 AND strftime('%Y-%m',procedures_icd.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.drug = T2.drug ) AS T3 ON T3.starttime = T2.starttime"}, {"id": "1bd83a6f25d3ac9d966ec9e9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of input patient 10020944 has received on 03/07/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '03-07'", "rejected": "null"}, {"id": "0918bda2bde8b0408f60fc3e", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top five diagnoses with the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',diagnoses_icd.charttime) >= '2100-03' GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "33b3c4f8d9aabedcd9066605", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication that patient 10019777 was prescribed for within 2 days after receiving other endoscopy of small intestine in 03/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10019777 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "68de14b96fc28cb3d5819bcb", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the patients with age 60 or above, what are the top five most frequent diagnoses during this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\n##\n## Question:\n\n### SQL SELECT T1 FROM ( SELECT chartevents.drug FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd_procedures.icd_code ) AND admissions.hadm_id IN ( SELECT procedures_icd.icd_procedures.icd_code ) AND strftime('%Y',procedures_icd_icd.charttime) >= '2100' ) ) AND strftime('%Y-%m',procedures_icd_icd.charttime) >= '2100-07' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07'"}, {"id": "964c6e643ec90bc499a92aea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common specimen tests that occurred in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "(2.140120242214's.210218830308881919'"}, {"id": "ca889d0ba7397111451ebf74", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who underwent a d-dimer lab test since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'd-dimer' ) AND strftime('%Y',labevents.charttime) >= '2100' )", "rejected": "null"}, {"id": "92847b18dd8be297f01979a1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since patient 10018081 got his last diagnosis of candidiasis of mouth in this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "35cf8678b7b636890f6218de", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were staying in medicine since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "\n\n##\n##\n## Question:\n\nWhat was the total amount of output for patient 100038081 since 12/05/2100?\n\n\n### SQL:\nSELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 40 ) ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-05'"}, {"id": "95e4cfa052e3d03fe0ffacbd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first diagnosis of anemia in chronic kidney disease in patient 10004733 on this hospital stay?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in chronic kidney disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "eff7745b76fcafa8bf36d64d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the specimen test ranked at three that was done most commonly?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "PAMSMS.PAYPA N20221 ) NEXT N1. NICU NICU NICU NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC NIC"}, {"id": "f9308fa63d859b237ccb712b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most commonly given diagnoses for patients who had received anastomosis of hepatic duct to gastrointestinal tract before in the same month this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "c5f4c7e6139e15ca5adacd50", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three microbiology tests.\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": ".M..'0\n\n etc.,M2)B.ru.\nMSV.\n's\n\n (SQLPAMS1024/MSMSPA: 0.27'"}, {"id": "436811ca71744e404dd509d5", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide me the monthly minimum amount of or cell saver intake that patient 10035185 received?\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)"}, {"id": "053a84a3939291b5875a4bb2", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of kcl (bolus) input that patient 10004235 received on 03/21/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-21'", "rejected": "null"}, {"id": "d20c57a68ef7b08960aa3345", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you think patient 24132 is subject to covid-19 testing?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\n## Question:\n\nHas patient 100064045 had any lab tests done in 2100?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin a1' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100064045 ) AND strftime('%Y', labevents.charttime) = '2100'"}, {"id": "ff369d78c590cc182f58d6ad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat immuno-cancer drugs are in use over the last five years?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n\n##\n\n##\n##\n### SQL Code SYMICSICD"}, {"id": "8b4571147c610648de61a6ab", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 05/08/this year, what was the first o2 saturation pulseoxymetry reading for patient 10018328?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '05-08' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "267d7c119f8d5f96a44c309d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the prescription drug given to patient 10025463 in the same hospital visit after undergoing the cardiac mapping procedure since 08/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "a42d48120f6eb86c381263fa", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the protocol of the anticancer drug?\n\n### SQL:\n", "chosen": "null", "rejected": "P.MS-. T of  Cd.\n._-1\n/0. Local?....\nMS1.!.:4MSD.GHIPPAMSPA INC"}, {"id": "d11649ef6f1e014d999ead71", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10022017's last hospital discharge?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "(10111211272192130030303362525180 AND 0.\n0.03.06.00'"}, {"id": "f5b78cf9f326f6c6ae745067", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": "\n##\n### SQL:\n\nSELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100130497 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "f515f06bef679a5069bf1b69", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021312 was prescribed medication via the ih route in 08/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e01675d4835c5611d02521e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time in 05/2100 patient 10009035 had the maximum mchc value?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "df6d9f1646fc387c7952ce10", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of patient 10009628's hemoglobin, second measured on the first hospital visit, less than the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "bf3cde9944a2d256d7dea6dd", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the sum of the input volume for patient 10020786 since 07/01/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-01'", "rejected": "null"}, {"id": "44091b4ad36dad1ed6a3d8b1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat changes were made in the prescription of patient 10018081 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n## SELECT COUNT( DISTINCT cost.cost FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE cost.hadm_id = procedures_icd.hadm_id ) AND datetime(cost.starttime) = '2100-10-10' )"}, {"id": "0544bc6c320c47d80b7b3c78", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total number of medications that patient 10023117 was prescribed on the first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "6a6845f8f10630a1084755dd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of the drug named nicardipine iv?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nicardipine iv' )", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100117259 ) AND prescriptions.drug = 'nicardipine iv'"}, {"id": "d58380e3bc5d293e5d7d4718", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three diagnoses with the lowest 6-month survival rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "SELECT DISTINCT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.charttime <= CURRENT_TIMESTAMP'2100-12-31' ORDER BY diagnoses_icd.Cases.DUR ASC, diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "7c70011334a7674e57430f9c", "query": "Convert the question below to SQL query.\n\n### Question:\nYa do you know if there was a genetic test patient 97330 received?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-9 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "bebeb2104d4c95aa591562d9", "query": "Convert the question below to SQL query.\n\n### Question:\nIn this year, what was the last diagnosis for patient 10015860?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year') ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "25956b8c121a3452cf6a13da", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the first input for patient 10004720 occur since 10/03/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-03' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a3453842fa6d5f908f2e8c6e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication patient 10010471 was prescribed for the first time via po in 05/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "dcdf18eb865eeb27764363bb", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the name of the diagnosis patient 51605 had in the other department\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 1 )"}, {"id": "b48e7a50e9e73818c7619a51", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total hospital cost with personal history of malignant neoplasm of tongue in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of tongue' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "27c5230565a9e53ebebd7913", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10004733's total volume of output since 05/19/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19'", "rejected": "Convert Paul..\n.-(. Fes\n.</-  (  \nASC0 1MS  1\nMSMS 1AANT27-19021:D2.MSPAGEMSMSMSPA_0.MS 110.000313918134517210-00371-03 '020210-04'"}, {"id": "9f9db02efbdc2ea5168b658f", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the respiratory rate changes of patient 10031757 measured at 2100-10-26 21:00:00 compared to the value measured at 2100-10-26 20:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 20:00:00' )", "rejected": "null"}, {"id": "614926ee15e952ef06fec83f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat does a procedure under the name procedure on single vessel cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) )", "rejected": " sierp\n. (..\nMS\n.\n- . \n T, in? ( as.\n T\n) (( (MS.. Zays. path\n WHERE. -.'...and.\n SQL\nMSd.\n)\n. .\n )o 1.)\n P . of-. T.. 12  imysql'1 (1ucky'-\nMSon:\nMS.\nMS?1:\n -2\n (Ts Call...1 1JW D3MSMSHPAMSMSMSMMdPAMSMSMSCDA.\nMSMSMSPAK the 2MSPA T2-PAINKPA.MSPA\nMS.3PA'PA'PA TPAIDPA' MS/PA TPA'PA'sPA'sPA'\n##APPA"}, {"id": "e609d3ca95a5fa061705359b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the ward id that patient 10278 may be admitted?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\nWhat was the last time the maximum value of the o2 saturation pulseoxymetry in patient 100213058 on 12/15/2100?\n\n\n### SQL:\nSELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100213058 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 saturation pulseoxymetry' ) AND strftime('%Y-%m-%d', labevents.charttime) = '2100-12-15' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "edaebbb4a2886364c2f5455c", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, has patient 10021938 been to an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "74693de7d313f1576fec3036", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10005909 has received a red blood cells lab test since 08/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c321346f08463a3979f09efe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the accumulated output for patient 10004733 since 10/26/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-26'", "rejected": "null"}, {"id": "40073884463d17bc3702a2fc", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10038999 undergo a c3 laboratory test in 06/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c3' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'", "rejected": "null"}, {"id": "e86ed01755d7638dbad6517f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10016742 received any treatment of respiratory ventilation, greater than 96 consecutive hours?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 )", "rejected": "null"}, {"id": "cd5489d01e1749510fc86424", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does the ph change in patient 10021666 last measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "f5b7b1f39d3f36c2baf21b63", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the last recorded weight for patient 10010471 since 27 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-27 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0ad18257b1c25458edce4275", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 15209 have acute pain due to trauma that is part of her family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) ) AND transfers.dischtime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1 )"}, {"id": "cb9ca5309bb33b28efa1b130", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who were discharged from the hospital during this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' ) AND datetime(transfers.dischtime,'start of year') = datetime(current_time,'start of year') )"}, {"id": "3fa74c4fb1defa83dd97682b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was an insurance plan for patient 10005866 in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "cba569373f71ae7e9628bf97", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the accumulated output for patient 10009628 on 10/02/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-02'", "rejected": "null"}, {"id": "88b0fb242af55f296a52b5d8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first value of the bicarbonate test for patient 10001725 since 04/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ff717f132bef7b20380c93f7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism that was found in the last microbiology test on patient 10021487's abscess since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ec6cfedc417520a4d86f2365", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10025612 been on scopolamine patch, 5% dextrose, or acetaminophen as prescribed since 09/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND prescriptions.drug IN ( 'scopolamine patch', '5% dextrose', 'acetaminophen' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'", "rejected": "null"}, {"id": "99e2661e12b6c6e852955ea5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10022281 last admitted to the hospital in terms of admission type?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10022281 ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100228185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "5c5679626e1a978f60f24793", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between weights last measured on the first hospital visit compared to the second to last value measured on the first hospital visit for patient 10004720?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "30444a0364fc39ff849021b5", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of ICU visits for patient 10004720 in the last hospital encounter.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "5732b3a1da02702d943f84d4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10018081 have for the first time since 04/07/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "380ff6e230af63f8328b62f9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10020187 get discharged from the hospital for the first time in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020187 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "e98f22d20d446f796e001b97", "query": "Convert the question below to SQL query.\n\n### Question:\nI want to know the total volume of input patient 10019777 has received on 03/03/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-03'", "rejected": "null"}, {"id": "690cfb24a4808aace8c6a75a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10019777 change in weight second measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "28bf2891ea69cdd52915b657", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who took respiratory ventilation, greater than 96 consecutive hours in 2100, what are the top three most frequent diagnoses that followed within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "b1a78da076378d37eda3aeb6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most commonly diagnosed conditions since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "..Ason. 122PAKMSPA-0170000003908188073870672069847178123558937570003505569?\n\n\n##099069899 - o210001979's diagnosed with acute or chronic kidney (nonspecified) since 2100?\n\n\n### SQL:\nSELECT SQL SELECT COUNT( DISTINCT procedures_icd.code FROM procedures_icd WHERE procedures_icd.icd_code = '09069899' AND strftime('%Y', procedures_icd.charttime) >= '2100' )"}, {"id": "9be85669c081afc82d4c6a57", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received a assistance with cardiac output using balloon pump, continuous procedure.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) )", "rejected": "# What is the difference between measured arterial pressure last since 212/09/21000?\n\n####\n\n### SQL:\n\nSELECT SQL SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheter placement' ) ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "ecbdf8f66488345ecb0ba8bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was patient 10025463 prescribed for during the same day after undergoing catheter based invasive electrophysiologic testing in 11/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "2a32cb9fdb4241702a454055", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who received performance of cardiac output, continuous , what are the top five most frequent diagnoses that followed afterwards within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_procedures.icd_code, DENSE FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100211387 ) ) AND datetime(d_icd_procedures.charttime) >= datetime(current_time,'-2 month') ) ORDER BY d_icd_procedures.charttime DESC LIMIT 5 )"}, {"id": "b462e1aa1b901782d9358530", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038999 got a potassium, whole blood laboratory test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 )", "rejected": "null"}, {"id": "62891e62cc7cbd9526a44676", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. martin's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10006058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "eaf4943a4050a0ad265cc606", "query": "Convert the question below to SQL query.\n\n### Question:\nHave patient 14990 an appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT count(*) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "ffcd5cfa2ddc5dc30fef4cd5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen, since 03/30/2100, was patient 10020740's respiratory rate measured less than 21.0 for the first time?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-03-30' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e253c035e9ea72b0f867ad77", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new medications are there for patient 10039831 today, compared to the prescriptions given yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n### SQL Query:\n\nSELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '310001' ) AND datetime(procedures_icd.starttime) >= '2100-03-01'"}, {"id": "b9caee4e198a07ec14f57a7b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of a hospital that involves a procedure named destruction of right main bronchus, via natural or artificial opening endoscopic since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "8c021f1784d97cc1eb00efeb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10038081 first have as output since 10/04/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "25dbdf52e941c325c6c218d2", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease tell me the exact prescriptions patient 4269 received from the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug IS NOT '0' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "848f58c164e2f0878c1c9ce1", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004235 been oxygen saturation tested in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen saturation' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',labevents.charttime) = '2100'", "rejected": "null"}, {"id": "f9b43f1daa9180b4970abafe", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of patient 10010471's input since 12/19/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19'", "rejected": "\n##\n##\n\n\n##\n##"}, {"id": "8c465916ae512fb241ab372c", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top four most frequent procedures that patients received within 2 months after being diagnosed with subdural hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'subdural hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "912eba9ed0bd970e88639d8a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time on the first ICU stay patient 10020944's o2 saturation pulseoxymetry was greater than 99.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 99.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto_item = 'chartevents' ) AND strftime('%Y-%m-%d', chartevents.charttime) >= '2100-01-01' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "010b98b4248d540f98a42319", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the overall amount of input for patient 10021666 since 01/16/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-16'", "rejected": "null"}, {"id": "2aa05532775a51572241041f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total cost of a hospital that contains patient room in hospital as the place of occurrence of the external cause?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'patient room in hospital as the place of occurrence of the external cause' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost JOIN transfers ON cost.hadm_id = transfers.hadm_id WHERE cost.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'patient room in hospital as the place of occurrence of the external cause' ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "2559181f4a14ba86cf190ad5", "query": "Convert the question below to SQL query.\n\n### Question:\nI would like to know the top three diagnoses that have the highest 6-month mortality rate.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(current_time,'start of year') >= datetime(diagnoses_icd.charttime,'start of year') GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC ) )"}, {"id": "4a9aae0d8815a3dec4971681", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you remember which immuno-cancer drugs have been used over the past five years?\n\n### SQL:\n", "chosen": "null", "rejected": "\n####\n\n\n### SQL Select the top three most common diagnoses that patients were prescribed within the same hospital visit after receiving extracorporectomy of left lung lobe, via natural or artificial opening endoscopic approach since 2100.\n\n### SQL:\n\nSELECT d_icd_diagnoses.d_icd_code, DENSEC_PROCEDURES.proc_code FROM d_icd_procedures JOIN admissions ON d_icd_procedures.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100130587 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "c7cc1c1c0a6dfab998b9a573", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost that includes a procedure named restriction of left internal carotid artery with intraluminal device, percutaneous approach since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "4d42e61430e34d4e1be887dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in the first mrsa screen test of patient 10020740 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "81f790401d1b25c6eebdd607", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total of pantoprazole patient 10020944 had been prescribed in 03/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'pantoprazole' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'", "rejected": "\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug AND prescriptions.drug = 'pantoprazole sodium' AND strftime('%Y', prescriptions.starttime) = '2100-03'"}, {"id": "bbd83d8b93e5221cf79488b1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output the last time patient 10029484 had since 11/10/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND strftime('%Y-%m-%d',labevents.charttime) >= '2100-10-10' ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "27cbb7342a12ed24d5662980", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10025463 was prescribed for during the same hospital encounter after the procedure of excision or destruction of other lesion or tissue of heart, endovascular approach?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision or destruction of other lesion or tissue of heart, endovascular approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "bc354ef513b2215446177f31", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits patient 10038933 had during the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10038933 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n\n##\n### Question:\n\nWhen was the last time patient 100058652 was discharged from hospital in 2100?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers JOIN admissions ON admissions.subject_id = transfers.subject_id ) AND admissions.dischtime IS NOT NULL AND strftime('%Y', admissions.dischtime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "d1bf30f1b6904076c39146bb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the maximum daily number of patients who were diagnosed with other opiates and related narcotics causing adverse effects in therapeutic use since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other opiates and related narcotics causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "39b8b45889cc5475dedfa102", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the ICU visits of patient 10018328 since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "\n\n##\n### SQL: SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100219385 AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100219385 ) AND strftime('%Y', admissions.admittime) = '2100' )"}, {"id": "b153c416ad84055be8473a92", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you think patient 14203 may have a family history of any diseases?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "95a628ad73ca8b9a1ccdf74a", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of drugs given to patient 10013049 in 06/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-06'", "rejected": "null"}, {"id": "91d0d988d9caf739b370a0af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new drugs for patient 10039831 today compared to the earlier ones yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "15f218ddc4b0e3bc25f8f534", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10026255 checked into the hospital in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026255 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT cost.cost ) FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473331 ) ) AND strftime('%Y',cost.chargetime) >= '2100' ) )"}, {"id": "296ec4ec76a62cac4fd007bb", "query": "Convert the question below to SQL query.\n\n### Question:\nTally up the number of patients who received a red blood cells lab test in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "\nSELECT SELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180811 AND admissions.dischtime IS NOT NULL )"}, {"id": "e4c2baa72dfc40ca402c8ebc", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10018081's heart rate last measured on the current ICU visit less than the second to last value measured on the current ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "339bd7b7cb9460146cc1f5a0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile ranking of a glucose test value of 176.0 for patients of the same age as patient 10038992 on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 176.0", "rejected": "null"}, {"id": "c08a8ca378cac26a4872dd1c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most common lab tests done this year?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n.,\n. w Though_(.\n(\nM'PAMSt : 9.\n7\nid.200070251012110000311488210\n\n##10.04.04038990838267479853599523968559230875201553401100033607508518688988906649183"}, {"id": "8d848bb37c4790115eb54b25", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were in neuro stepdown in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "AS\n(\n .\n.....22MSMSdSSMSPA T-2302.MSPA's' T2 T2 T1 0.0.07 T2\n##"}, {"id": "5e42606ba946ba548d180e31", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequent lab tests since 2100.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT SQL SELECT T1.test_name FROM ( SELECT d_labitems.charttime FROM d_labitems WHERE d_labitems.itemid IN ( SELECT labevents.itemid FROM labevents JOIN d_labitems ON labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ) AND strftime('%Y', labevents.charttime) >= '2100' ORDER BY labevents.charttime DESC LIMIT 1 ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "a639ca68449a5c30bf4518db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10013049 get discharged from the hospital for the last time during this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10013049 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "903e1faa90ee9926eebe6781", "query": "Convert the question below to SQL query.\n\n### Question:\nToday compared to yesterday, what new medication does patient 10018081's prescription include?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "067417d484687c9d57f7dfcd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the procedure that patient 10029291 received two times in 03/this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',procedures_icd.charttime) = '03' ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2"}, {"id": "bb7840631855547af8253009", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10011398 was prescribed a medication since 10/2100 via im?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "66c9f492519459a4e0775016", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output patient 10007818 had on 07/15/this year on the last occasion?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '07-15' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "5f2a159055d6adad640855a4", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most frequent drugs that patients were prescribed during the same hospital visit after being diagnosed with hemorrhage complicating a procedure in this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage complicating a procedure' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "88fdf3da1ae1fa49b61efe01", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of times trimethoprim was prescribed since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "### SQL"}, {"id": "0e303986f42987d1f61a3da5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was prescribed to patient 10021118 within 2 days after the procedure of performance of cardiac output, continuous during this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "34e916a3d87884c2b17eed2f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the five most frequent microbiology tests this year?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100143540 ) WHERE datetime(microbiologyevents.charttime) = datetime(current_time,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%Y',microbiologyevents.charttime) = '2100' ) GROUP BY microbiologyevents.test_name ) AS T1 ) AS T2 WHERE T1.C1>= 5"}, {"id": "258a0365b34cfcb6501ad3c2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10026354 weigh when measured for the last time since 14 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1d8e1854e955b721c482a91d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last hospital admission type for patient 10005866?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005866 ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "9b0dc7c21af10bc7f1f0ef8b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were let go from hospitals in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.dischtime is not null AND strftime('%Y',admissions.admittime) = '2100'"}, {"id": "9c4387eddc635a52994b4e04", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost for a severe sepsis diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'severe sepsis' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis' ) )"}, {"id": "82db68532c1fe0fc76c6c017", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of hospital visits made by patient 10015272 since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10015272 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "320d0d42e2bc3e896297a919", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the white blood cells percentile of 11.6 among patients of the same age as patient 10004720 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.6", "rejected": "null"}, {"id": "95aab34c70205c3c2152ceff", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 65309 have a trip history overseas?\n\n### SQL:\n", "chosen": "null", "rejected": "M.-5FPAMSMS112\nMSPA-201214824814400 AND 111.\n% SELECT124458883 was prescribed to admit to the hospital during this year?\n\n\n# SQL SELECT admissions.discharges.d FROM admissions WHERE admissions.discharges.d FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id, procedures_icd.d.drug FROM procedures_icd WHERE procedures_icd.drug = 'cisplastc diagnostic ultrasound of brain' ) AND admissions.hadm_id = 10038915509 ) AND datetime(current_time - datetime(strftime) - datetime(T1) ) = '2100-06-23' ) = 1"}, {"id": "eb588610d7a73daedf0f76c1", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the value of patient 10001217's monocytes last measured on the first hospital visit greater than the value second to last measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "43d295b14df7663a4b921316", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for a drug named nicotine patch?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nicotine patch' )", "rejected": "\nTC4 PMS. CEPS.211SEMS\n.D,\n6Sevents1 )MSMSPA-012026822196882223 08'"}, {"id": "b669eb9d598ff80ab9e5f8e6", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10002495 had any surgeries in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "\n##\n##: SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left hepatic duct with intraluminal device, percutaneous approach' ) AND strftime('%Y-%m-%d',procedures_icd.charttime) >= '2100-09'"}, {"id": "fabc6fda184e4c3f17a6f07e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common specimens being tested for patients who were diagnosed with transfusion related acute lung injury (trali) within 2 months since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'transfusion related acute lung injury (trali)' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'transfusion related acute lung injury (trali)' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 5"}, {"id": "052079a05ce7afbbced7a57a", "query": "Convert the question below to SQL query.\n\n### Question:\nOf the patients of age 60 or above since 2100, what were the top three most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n### SQL:\n\nSELECT SQL SELECT T1.drug FROM ( SELECT admissions.prescriptions.drug, DENSEP.drug FROM admissions JOIN prescriptions ON admissions.hadm_id = prescriptions.hadm_id WHERE admissions.subject_id = prescriptions.subject_id AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y-%m',diagnoses_icd.charttime) >= '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id< T2.hadm_id GROUP BY T2.icd_code ) AS T3 ON T3.charttime< T4.starttime"}, {"id": "f8a06b403db41f5348bf90f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in patient 10021487's first bronchoalveolar lavage microbiological test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "02bd66cb3a751f53d4accb0a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of hours has it been since the last time patient 10004733 was diagnosed with dysphagia, oropharyngeal phase in their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, oropharyngeal phase' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8d8518ce9ca76a042a0c5bb0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the prices for the drug called vitamin e?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vitamin e' )", "rejected": "T.% M. D. P_m\n OR. ..\n. first ..-1..' E1\n Na' Thank\n WHERE \n IC (.. T. (!./-i\n AT a... \nMS I\n MSMS- \n Natur *\nMS. )  T-T.\nMS(.'1 (1.\nMS of.\nMS- \nMS.om.\nMS United0s120 . 200MSC8CANCPA1116MSPAKMSMS-10.MSPAY.\n##MSPAK\nPA'PAKPA T1-INGPA:\n#PA-PA' ICU.PA\n%PA' 29PA"}, {"id": "4fd8e701e3a723142ac009de", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 19412 been administered any additional fluid,other test?\n\n### SQL:\n", "chosen": "null", "rejected": "the,\n.\n-\n0 where.1 (\u20191.1\n ( R\n\n\n Ct....\n\n CCTIONMSTd10.:2.2\n MS12.14.0201,110101UMSMS\nMS MSUSSMSP1:MSHIPP_MSPAZMSMSPAINK doCST.MS.MSGive a.0.0.\nMSGive the output the cost of the medications.MSGive the total escort\n##MSGive the prescriptions.\n\n\n\nMS.\nMS.\n\n\nWhat is the maximum cost for a prescription of tramadolamas in the last year?\n\n\n##\n##\n\n\n##cribe\n\n\n### SQL SELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id = 100039799 AND strftime< 21000 AND strftime< 09/10 AND datetime(strftime< 10000-09-19?"}, {"id": "52fe2640719f3ea2cd5cc5ba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug which was prescribed to patient 10007818 within the same day after having received a introduction of nutritional substance into central vein, percutaneous approach procedure in 07/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007818 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007818 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "45e5fa3d7ddb3e52763ec749", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently given diagnoses for patients who had previously had bypass coronary artery, one artery from left internal mammary, open approach during the same month, throughout this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "c26a679f2556db96814fe4aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of that first specimen test patient 10016742 got in 08/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_types.spec_type_desc FROM microbiologyevents.microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND microbiologyevents.spec_type_desc = 'blood ( pleural fluid)' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'-1 year') AND strftime('%m',microbiologyevents.charttime) = '08' )"}, {"id": "55298e7d2d87edab46d2e4e0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received a globulin lab test since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'globulin' ) AND strftime('%Y',labevents.charttime) >= '2100' )", "rejected": ".11120112K.\n-02)"}, {"id": "8f05ca0c74199be8f6803a5c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days is it since patient 10021487 last received the lymphocytes lab test on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1286e054ab8b363bfd212296", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the last time patient 10021487 was diagnosed with other iatrogenic hypotension during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "24155b9f4c00416b2b4a02d5", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first time on last month/12 patient 10005909 had a maximum heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '12' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "89b3f7739b080ee0246b9f58", "query": "Convert the question below to SQL query.\n\n### Question:\nIn this year, has patient 10003046 received a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n\n##\n\n\n##\n##\n##\n\n####\n\n### SQL>\n\n### SQL\n\n<# SQL>\n\nSELECT SQL>\nSELECT COUNT(*) FROM admissions WHERE admissions.subject_id IN ( SELECT procedures_icd_icd_procedures.icd_code FROM procedures_icd_icd_procedures WHERE procedures_icd_icd_procedures.icd_code = '999999' ) AND admissions.subject_id = 100214875 ) AND strftime('%Y-%m', admissions.dischtime) >= '2100-01-03'"}, {"id": "919fd2fec23929480d56959a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of urea nitrogen of patient 10021118 second measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "abc85f653325ca0da7e82fce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most commonly tested specimens for patients who were diagnosed with other fluid overload previously within 2 months, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "444002e65b58c6f479197866", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you calculate how many patients were prescribed gemfibrozil?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil' )", "rejected": "\n of\n\n_.)  (.. C. (..- (..\n United  anding.  (.\nMS T-\n Cm?m A-. '-.\n AT.: Y....  (U.\nMS4 \nMS\n\n.\n\n-11 P1.\n\nilla1\n. -\nan..-\nans.1\n1 T/1_am1:1MS?\nMS."}, {"id": "bc55adec6e2f148eae8ab156", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in patient 10021487's first bronchoalveolar lavage microbiological test since 09/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "\nSELECT COUNT(*) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'arterial blood gastric lavage' ) AND strftime('%Y-%m', labevents.charttime) >= '2100-09' )"}, {"id": "388e3fc0fa30e6c5b9011872", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of people who received introduction of nutritional substance into lower gi, via natural or artificial opening in the same month after having been diagnosed with epilepsy, unspecified, not intractable, without status epilepticus in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "c122bbbae5a9d7b44953325a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the last bacteremia diagnosis for patient 10004733 on their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ff41f7c60c1eaf73cae6e1b5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen and where are the rounds and procedures of dr. moore?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##SELECT\n\n### SQL:\n\nSELECT SQL SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158755 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation, unspecified' ) )"}, {"id": "908ae520eb086d09751ea4b9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four diagnoses of patients in their 30s since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "7c51ba4f8ca527a1a1888491", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10005348 first admitted to the hospital in terms of admission type since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005348 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10005348 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "8fe4b6848aa995f8ab0554ae", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the first hospital stay, did patient 10005817 undergo a single internal mammary-coronary artery bypass procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "0814561e80d18ee7b5e8e214", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 04/2100, when was the last time that patient 10007795 was prescribed medication via the po/ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "b456d50720a86f9e85d860d1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the single rooms which are now available?\n\n### SQL:\n", "chosen": "null", "rejected": ")'s.PAKMSPAGEPAWS the last time to get the name of the first hospital discharge on the first occasion since 03/2100?\n\n\n\n### SQL SELECT admissions.disch_time FROM admissions WHERE admissions.subject_id = 100219408 AND admissions.hadm_id IN ( SELECT procedures_icd.disch_id FROM procedures_icd WHERE procedures_icd.disch_time IS NOT NULL ) AND strftime('%Y', admissions.disch_time) >= '2100-03'"}, {"id": "65a61f863c5c62e515fe477a", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 02/04/this year, what was the first respiratory rate value of patient 10020187?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-04' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "07bde541ff2932869ecb4912", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many doses of omeprazole have been prescribed to patient 10023117 on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'omeprazole'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'omeprazole'"}, {"id": "3aab4c6e3c824c26d1f50ebe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output which patient 10029484 had for the last time since 04/06/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-06' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "9e7aa17566ee6e70df48c838", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many insertion of drug-eluting coronary artery stent(s) treatments were executed?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' )", "rejected": "SELECT SELECT COUNT( DISTINCT procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions_icd ON procedures_icd.hadm_id = admissions_icd.hadm_id ) WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' ) )"}, {"id": "d4e9772857153946f3bf287d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you indicate the daily average dose of replete with fiber (full) that patient 10021487 received since 9 months ago?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'replete with fiber (full)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-9 month') GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "893d50d72560ef334a7c8471", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was prescribed to patient 10021487 during the same hospital visit after the procedure of enteral infusion of concentrated nutritional substances in 12/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "de2dd163eefb7cd6f7fe4767", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most common output instances since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "T. C'.9\n ( . (m.MS\n ."}, {"id": "def1690cfa1cd58ae29ab510", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of soln that patient 10014078 has been prescribed in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'soln'", "rejected": "\n## SELECT T1 FROM ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214877 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "b09c1296a97d4f7a4488f11f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since the first time that patient 10039831 stayed in careunit discharge lounge in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "\nSELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100039831 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "951e44d16291cab791c2b2dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10020740 was prescribed for within the same day after undergoing continuous invasive mechanical ventilation for less than 96 consecutive hours in 04/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10020740 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10020740 AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "f4ea3a1a0ad748d9673ee4c3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the first microbiology test conducted on patient 10021487's fluid,other since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5542edc6eab94af30e250d96", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that in the last hospital encounter patient 10038992 was first prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1003892 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "1c25bfeb80dcb8497dffd6ea", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10013049's length of stay for the first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "\nSELECT SELECT COUNT( DISTINCT cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.icd_code FROM procedures_icd WHERE procedures_icd_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058600 ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id )"}, {"id": "78805907705a4fd44978901b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10005817 prescribed 0.9% sodium chloride and insulin human regular at the same time for the last time in this month?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin human regular' AND admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "88d1d764d3e45a0ff254d45a", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with other diseases of lung, not elsewhere classified, what are the top three most common lab tests conducted within the same hospital visit in this year?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of lung, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "455145565c06c0334318ab67", "query": "Convert the question below to SQL query.\n\n### Question:\nOn this month/18, when was the last input time of patient 10010471?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '18' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-18' ORDER BY inputevents.starttime DESC LIMIT 1"}, {"id": "fa77bf576a4300f065e04807", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output that patient 10018845 first had since 04/09/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-09' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "f838d7118ed779a45387d3aa", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given occlusion of right femoral artery with intraluminal device, percutaneous approach in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right femoral artery with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "SELECT SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right femoral artery with intraluminal device, percutaneous approach' ) AND strftime('%Y', procedures_icd.charttime) = '2100'"}, {"id": "b631a1615445ca9ec8e26a42", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat procedure was given to patient 10019777 two times since 21 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "\n2022588377986824524 )?"}, {"id": "794da47ae77cd75fe2914cf2", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the previous year, how many patients underwent a transcatheter embolization for gastric or duodenal bleeding within 2 months after the diagnosis of unspecified essential hypertension?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'transcatheter embolization for gastric or duodenal bleeding' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "a711973109553fda82475f0b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the drug which patient 10017492 was prescribed within 2 days after having had a spinal tap procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10017492 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10017492 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "413fd7b34afafd591f270c7a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the correct dosage of the prescribed opioid to patient 19428?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158543 ) AND prescriptions.drug = 'morphine sr (msds) 4 mg/ml (10 mg/ml) 150 ml/100 ml'"}, {"id": "13fab13d5c28d10640de8024", "query": "Convert the question below to SQL query.\n\n### Question:\nIn their first hospital encounter, how old was patient 10037861?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n### SQL:\n\nSELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100047333 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "ba4c239a6efd2a45b4fd4c15", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequent microbiology tests since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "\nSELECT\nSELECT SQL:\n\n SELECT COUNT( DISTINCT microbiologyevents.spec_type_desc ) FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100140174 AND datetime(microbiologyevents.charttime) >= '2100-01-01' )"}, {"id": "2814f1edb1bea5a93666884f", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who were given a insertion or replacement of other neurostimulator pulse generator procedure.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of other neurostimulator pulse generator' ) )", "rejected": "null"}, {"id": "fef989a873a0244ffbcecf45", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 05/21/2100, when was the last input time of patient 10018423?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-05-21' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "52f3a2c6b4d044c06fd15131", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen test which patient 10000032 has first received since 04/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "14f4bb19aad791593fd86e30", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent output instances since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n\n##\n\n### SQL Query:\n\nSELECT SELECT AVG(sum(cost.cost) - cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypernatremia' ) ) AND datetime(cost.starttime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id )"}, {"id": "90c0a4f23c31e61cee1395c2", "query": "Convert the question below to SQL query.\n\n### Question:\nAvapro - How much does it cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'avapro' )", "rejected": "less.1: what are the\n Ports\n' SELECT1.\n\n'\nSELECT"}, {"id": "3b0e6898490e151ff0c9d63d", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients with other ventral hernia without mention of obstruction or gangrene who were diagnosed.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ventral hernia without mention of obstruction or gangrene' ) )", "rejected": "null"}, {"id": "d5968ba9a98b70f548218263", "query": "Convert the question below to SQL query.\n\n### Question:\nSo, the last glucose test result for the patient 10018423 on the last hospital visit was?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "9330e1bf456cb3ad13b7333e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the five most commonly taken lab tests?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n### SQL: SELECT SQL:\n\nSELECT SELECT COUNT(*) FROM labevents WHERE labevents.valuenum = 'white blood cells' AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) ) ) AND strftime('%Y', labevents.charttime) >= '2100-05-05' )"}, {"id": "9b52e008ae7f63b3fa3eeb3d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total cost of a hospital visit involving hyperpotassemia since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperpotassemia' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperpotassemia' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') ) GROUP BY cost.hadm_id )"}, {"id": "3923be2a0afc19998c64069d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10022017 first depart from the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "f65af6870b5d460f82233782", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me the total output amount of patient 10022281 since 06/03/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-03'", "rejected": "null"}, {"id": "85c838d478a4f152e0c9879e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last discharge of patient 10020944 from the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020944 ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "4fd17cfcc175d92c67e22fdb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen last did patient 10004422 have the maximum respiratory rate on 01/19/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '01-19' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5b1d543d54897c267c07f555", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most frequent diagnoses in 2100 with which patients were diagnosed after receiving hemodialysis within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "fe2b896743388c3285fd2973", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the rank of the top three most common output events since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n### Question:\n\nHow many times was lorazepam prescribed to patient 100190408 in 2100?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ('lorazepam', 'lorazepam') AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100190408 ) AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "861a7b73edbd60ca44e59f7c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients with candidal stomatitis were diagnosed in the same month after previously being diagnosed with anxiety disorder, unspecified in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anxiety disorder, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidal stomatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anxiety disorder, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidal stomatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "debac14c816c23825c35ec8b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the diagnosis that patient 30267 received from the other department?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECTC1 = ( SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100185285 ) AND diagnoses_icd.hadm_id IN ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use, unspecified' ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100' ) )"}, {"id": "07b532c37ac7c6ce9253dbee", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are patient 10021487's changes in arterial blood pressure mean last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "fbb2af617d1dcbd3c073bbe0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five frequent laboratory tests that patients had after they were diagnosed with paralytic ileus during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paralytic ileus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT SQL SELECT T3.icd_code FROM d_icd_procedures WHERE T2.hadm_id IN ( SELECT d_icd_procedures.hadm_id FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_procedures.icd_code, DENSE FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214877 ) ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) GROUP BY T1.icd_code ) AS T2 ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "f599a974b9f48dd1b8bee774", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, has patient 10020187 been in an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": ""}, {"id": "ba17453769db45c0f15880db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly prescribed medications for patients who were diagnosed with atherosclerotic heart disease of native coronary artery without angina pectoris previously in the same month, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery without angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "6f8a9ea4d83dea4c52af5a4b", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10004422 on their first hospital visit given a mchc lab test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "1110172121802486's.\n##03986808578'"}, {"id": "ecbcf154c6dfea64fea97371", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10027445 last prescribed the medication via the sc route during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "\n\n##\n\n##\n\n##\n###03. How many days has it been since patient 1000207048's first diagnosis of other diseases of the digestive system in this hospital visit?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT diagnoses_icd.Careunity.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100207048 ) AND strftime('%Y-%m',diagnoses_icd.charttime) = '2100' )"}, {"id": "37949c207b150e40794621cb", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what new drugs are present in the prescription of patient 10039831 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "341a4ea74a6802ad1a55e2ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first microbiology test that was given to patient 10015931 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "52b6906b922b93a286a69090", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of a hospital that involves a procedure named other diagnostic procedures on lung or bronchus during this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "9d564188b506bcd7d94a1018", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most frequent procedures that patients received in the same hospital visit after being diagnosed with accidents occurring in other specified places since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in other specified places' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "a00afef4fe749df9db791752", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum cost to the hospital that involves other fluid overload?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n\n\n##\n\n##\n\n##\n##### SQL-SQL\n\n\n### Question:\n\nHas there been any hospital admission in patient 1001595458's record since 21000?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100159548 ) AND strftime('%Y', admissions.dischtime,'start of month') >= 21000"}, {"id": "2cf0ff14f070a284cf574db2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the foley output for patient 10018081 on 12/30/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-30'", "rejected": "null"}, {"id": "1757227b484201499ac650b9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10022041 received a laboratory test for vitamin b12?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 )", "rejected": "101720.\n\n# 1. What is the maximum cost of the medication for patient 1000185455 during their first hospital visit in 21000?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id = 100018545 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "5f192a749e3dc5e91eff2fd7", "query": "Convert the question below to SQL query.\n\n### Question:\nThe value of mch of patient 10004733 was last measured on the current hospital visit greater than second to last measured on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m-%d',labevents.charttime) = '2100-12-23' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "9f637b49dd6bf5b92a192d46", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most commonly ordered procedures for patients who were previously diagnosed with intestinal infection due to other organism, not elsewhere classified, which occurred during the same hospital visit since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "1a1dd68c6e5084b941070e1a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you please share with me the name of the diagnosis that patient 95909 received in the other department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-07'"}, {"id": "5d8d3d9c0e88b7b656bc2f3e", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most common diagnoses in this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT T1 = diagnoses_icd.icd_code FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'start of year','-1 year') GROUP BY diagnoses_icd.icd_code ) ORDER BY COUNT(diagnoses_icd.charttime) DESC )"}, {"id": "4f9e42945038788848999c30", "query": "Convert the question below to SQL query.\n\n### Question:\nDisplay the top five most commonly prescribed drugs since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE(T1.count_prescriptions) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 ) AS T2 WHERE T2.C1<= 5"}, {"id": "8cd487610ef7e6e0e454d96b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication which patient 10016742 was prescribed in the same hospital visit after receiving introduction of nutritional substance into lower gi, via natural or artificial opening?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10016742 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10016742 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "05c7819c63aa7a68dc9545c3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people were given prescriptions for heparin flush (100 units/ml) since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin flush (100 units/ml)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "\n\n##\n##\n\n### SQL Select the top three most frequent diagnoses that patients were diagnosed with within the same month after receiving cardiac mapping in 2100.\n\n\n### SQL:\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_COUNT( diagnoses_icd.charttime ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214877 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= T2.C1.C1 )"}, {"id": "de050e3cfdd8c8ef07cdf7bc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most common diagnoses of patients in their 60 or above since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n##\n\n\n##\n##\n\n##\n### SQL Code Section:\n\n\n### Question:\n\nWhat is the maximum total dose of solnSafe (0.9% nectain soln (prescription) prescribed within 2 months for patient 1001971258 since 05/2100?\n\n\n### SQL:\n\nSELECT T1.C1 FROM ( SELECT SUM(prescriptions.dose DESC) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1001971258 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' )"}, {"id": "d2d5d1df9320768cf72754db", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10014078 undergone a central venous catheter placement with guidance procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 )", "rejected": "null"}, {"id": "3ac2379c5a6246bfa08fe92d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of void output patient 10001217 had on 12/04/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'", "rejected": "null"}, {"id": "3f2bb642b30df18f43f0428a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the monthly maximum amount of patient 10006053's cryoprecipitate input.\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cryoprecipitate' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "null"}, {"id": "84420329d02f896de67bcf07", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10018501 was last discharged since 2100 from the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018501 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "805609557149a5a400b2ad38", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the length of time patient 10014729 was in the ICU during the last visit.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "8c68b1cef708f19146eebeca", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10031404 admitted in terms of admission type for the first time since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10031404 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "ed6f8d67b33854602df8651f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the drug named cepacol (menthol)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'cepacol (menthol)' )", "rejected": "SELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cefazolin sodium' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100017257 )"}, {"id": "617b9e75f3c58dee20062f3c", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the last time patient 10021312 had a maximum heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "dd637812c5b2444154d1942b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that patient 10016742 had a minimum heart rate during the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "13bee07976257e0b38f5e9b3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the procedure conducted on patient 10020740 two or more times in 05/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "4f0a03f732e95fdcb15376f7", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of input for patient 10005817 since 06/23/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'", "rejected": "null"}, {"id": "1413d85d169629ef664b2b96", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the cost for the drug nystatin cream?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nystatin cream' )", "rejected": "\n##\n\n### Question:\n\nWhat is the name of the organism that was transplanted to patient 100140354's body since 03/2100?\n\n\n### SQL:\n\nSELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100140354 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "9baf58eccad91d410350b80d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of rooms are available right now?\n\n### SQL:\n", "chosen": "null", "rejected": "\n'start\n1. When the total-30'"}, {"id": "b0ef9ac5dcce6d06f4eb450d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most commonly prescribed drugs in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSEXPICK(prescriptions.starttime) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 ) AS T2 WHERE T1.C1 = 3"}, {"id": "0e460c97c84c743bb885aefe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first input time for patient 10022281 since 06/03/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-03' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "3fcd3dd1926914800ea40cbb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug prescribed to patient 10016150 for the last time since 04/2100 via the im route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "fff1f1751b80965886ad5fbd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of drugs patient 10000032 was prescribed since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "null"}, {"id": "f5f0f6336f05d930f6059ee3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile of the mcv value is 85.0 among patients of the same age as patient 10004733 on this hospital stay?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 85.0", "rejected": "null"}, {"id": "d49a169b25722c624294da5c", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the first hospital visit, what was the diagnosis for patient 10002495 the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "01bb1845215fb7cc77678534", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021118 receive urine microbiology test the last time?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "90c8f7dcff48de642efa7222", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the top three most common diagnoses of patients with an age of 60 or above throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "82ed12adb86d88920ee64659", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the time it took for patient 14467 to undergo cv cath plcmt w guidance?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT 24 * ( strftime('%J', ( strftime('%J', ( 1 * ( SELECT strftime('%J', datetime(current_time,'-1 year)') ) - strftime('%J', diagnoses_icd.charttime) ) ) ) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental injury of intestines' ) AND strftime('%J', diagnoses_icd.charttime) >= '2100-06-15' ORDER BY diagnoses_icd.charttime ASC LIMIT 1"}, {"id": "7e545989763b5dd9c6a9df0b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of the anion gap value of 25.0 among patients of the same age as patient 10007818 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 25.0", "rejected": "null"}, {"id": "fc32af7511179af7d45fdec6", "query": "Convert the question below to SQL query.\n\n### Question:\nWill they have any urine test done for patient 24268?\n\n### SQL:\n", "chosen": "null", "rejected": "t.MMSPA-065251313350.244845483' AND admissions.diagnoses.test.comparen't you know the admission time for patient 10001678558 since 03/2100?\n\n\n### SQL SELECT admissions.admittime.admittime FROM admissions WHERE admissions.subject_id = 100167858 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime.admittime.time ASC LIMIT 1"}, {"id": "712fa8d3c896982a206d0140", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is today's outpatient schedule for dr. knight?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100058665 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "fd65cc9a15899b7d467ba196", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the four diagnoses that had the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY admissions.subject_id, diagnoses_icd.icd_code ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY admissions.subject_id, diagnoses_icd.icd_code ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "284e08803572889902ff0c20", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the code in icd-11 for renal & ureteral dis nos in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": ") 2020305003188043683980388699 )'"}, {"id": "a544c5a0f893e479f14079f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of input patient 10018081 has received since 11/20/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-20'", "rejected": "null"}, {"id": "57280c52999208a8f3104301", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 06/30/2100, what was the yearly maximum dose of dextrose 5% for patient 10026354?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-30' GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "e2f69e562ea54caf705bd0c2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients are there presently admitted?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": ".....1 Quick.\n\n.0-\n K( \n. .T,d(.\n."}, {"id": "deb0649dc5dfba070e57b20a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most common procedures that occurred within the same hospital visit for patients who had extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic before since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "9ee9faec0727283454a64f52", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of (aorto)coronary bypass of four or more coronary arteries procedures carried out?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' )", "rejected": "\n\n##\n\n##\n##\n\n### SQL Select the top three most commonly prescribed medications for patients who were diagnosed with esophageal obstruction status post procedure during this year.\n\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.drug IN ( SELECT admissions.discharges.disch_time FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.disch.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = 'procedures_icd.disch' ) ) AND datetime(strftime('%Y', admissions.disch_time) = '2100' ) )"}, {"id": "bbcd893acd5b02637bedbb4d", "query": "Convert the question below to SQL query.\n\n### Question:\nThroughout this month, when did patient 10021118 last receive a absolute basophil count test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "\n\n##\n### SQL:\nSELECT SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code"}, {"id": "bc63ec2f7d1fe81411a4cf20", "query": "Convert the question below to SQL query.\n\n### Question:\nSo, when is the earliest patient 28343 is going to come in the hospital?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100398387"}, {"id": "caaf86100f832f6892b85b8f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last heart rate value that patient 10001725 had during the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b3d362f74a925702dfbb0a1d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since the last time patient 10018081 received a lab test of sodium, urine during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "80a3a1b02bca2873dc0308c4", "query": "Convert the question below to SQL query.\n\n### Question:\nThis year, has patient 10031757 been diagnosed with any disease?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n### Question:\n\nWhat was the name of the drug prescribed for patient 10031757 during the last hospital visit?\n\n\n### SQL:\n\nSELECT prescriptions.drug.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(prescriptions.starttime) >= '2100-04-06' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "96762825c5cbfa3426dc79a2", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10006580's hematocrit second measured on the first hospital visit less than the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "2533e11570c9cac4cf3be471", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10019777 treated with a procedure on single vessel procedure in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "cf32c8a66e9b2e46a4a073dd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much chlorhexidine gluconate 0.12% oral rinse was prescribed on their last hospital encounter for the first time to patient 10027602?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "e7d4c4eea0ceb55fc4a7b51f", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring this hospital visit has iso-osmotic sodium chloride, lactated ringers, or metronidazole (flagyl) been prescribed for patient 10018081?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'iso-osmotic sodium chloride', 'lactated ringers', 'metronidazole (flagyl)' )", "rejected": "null"}, {"id": "f79c2af96dde359ecee262e9", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which four diagnoses have the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "p1.\n\n. ( WildThe?,Items 1... CashMS.\n11SSMS110TECHMSPAYMEPAGONSAT(MS-213399846?\n\nMSA3500002 And 15003999999999's diagnosed with the last year?\n\n\n\nMSA30002 ASCII code"}, {"id": "d83c205b14f14e3bcf90bd5a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently administered procedures for patients aged 20s in this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "312017MSMSPA 2000000214270277993498973989's the last year's date?\n\n\n### SQL SELECT COUNT(*) FROM d_icd_procedures_icd_code WHERE d_icd_procedures.icd_code = 'excision of left femoral joint, femur, femur, femur, or femur, femur, or femur, or femur, or femur, or intramedial artery or artery, or femur, or intramedial artery or artery, or intramedial artery or artery, or intravascular thrombectomy of femoral or femoral artery, or intramedial artery or artery, or intramedial artery or artery from lower extremity, or intrastellectomy, or other unspecified, or other intravascular radiological procedure of other body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other intravascular radiological procedure of other intravascular body part or organ, or other int"}, {"id": "13682269c2386920a0a97338", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the ward identification of patient 7375 able to be admitted to?\n\n### SQL:\n", "chosen": "null", "rejected": ".913\n\n1's.PAMS\n\n201."}, {"id": "97d26f029a5f2f8e475529e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10026354's difference in respiratory rate from the last value measured on the last ICU visit compared to the second to last value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "40ce8982a0a966c5bbb74462", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does the drug alprazolam cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'alprazolam' )", "rejected": "\n\n##\n\n##\n\n##: What is the name of the medication that patient 1000159745 was prescribed in the last hospital visit?\n\n\n### SQL:\n\nSELECT prescriptions.drug.name FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100140028 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'"}, {"id": "975040b9662968e36fedac64", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most common lab tests given?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "?PAMSPA's 280100312564 ) when was the last hospital discharge?\n\n\n\nwhat is the average total amount of nacl (0.09% nect, 12.5% dextrose, 0.95% glucose, 1.0% glucose, 0.9% glucose, 2.5% glucose, 0.09% glucose, 1.0% glucose, 2.0% glucose, 1.0% glucose, 2.0% glucose, 1.0% glucose, 1.9% glucose, 0.9% glucose, 0.9% glucose, 1.9% glucose, 0.9% glucose, 1.9% glucose, 0.9% glucose, 0.9% glucose, 1.9% glucose, 0.9% glucose, 1.9% glucose, 0.9% glucose, 1.0% glucose, 0.9% glucose, 1.9% glucose, 0.9% glucose, 1.9% glucose, 0.9% glucose, 1.0% glucose, 1.0% glucose, 0.9% glucose, 1.9% glucose, 1.9% glucose, 0.9% glucose, 1.9% glucose, 1.0% glucose, 0.9% glucose, 0.9% glucose, 1.0% glucose, 1.0% glucose, 1.9% glucose, 1.0% glucose, 1.9% glucose, 0.9% glucose, 1.0% glucose, 0.9% glucose, 1.9% glucose, 1.0% glucose, 0.9% glucose, 1.9% glucose,"}, {"id": "a370a79ac614fe8fa9d3408a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10021487 have for the first time since 12/15/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-15' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "564de4a1461e0f0c27daff76", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 20000 have any inherited disease?\n\n### SQL:\n", "chosen": "null", "rejected": "SS20000 - 02210018070181892909268897?\n##20351894469"}, {"id": "ccf873476d02f981c461b5c0", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the total amount of neutra-phos that patient 10004422 has been prescribed in 01/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.drug = 'neutra-phos' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01'", "rejected": "null"}, {"id": "28b46c82ec1854678938782d", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease tell me the sex of patient 10014078.\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10014078", "rejected": "\n##\n\n### Question:\nWhat is the percentile of the first lymph node that patient 100219445 had since 04/2100?\n\n\n### SQL:\n\nSELECT chartevents.chartevents.valuenum FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100219445 ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-04' ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "6d16d17d6f59ace9a2e0a9bd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged since 1 year ago from hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": "\n\n##\n\n###code Question:\n\nHow many days has it been since the last time patient 100398884 was prescribed with fentanyl citrate (oral) on the current hospital encounter?\n\n\n### SQL:\nSELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.dischtime) ) FROM transfers JOIN admissions ON transfers.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10039884 )"}, {"id": "3afe51cbe0baae4f9809635a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007818 taken a vital high protein (full) drug since 07/07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-07'", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.drug = 'vital high protein (full)' AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-07-07'"}, {"id": "708d239b2f7785ac668db27a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was the first drug prescribed for patient 10027445 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "3dfc1e7e0bb1375c1771ec03", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often was bisacodyl prescribed in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'bisacodyl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "44a6d21d8264b4fa98a0113f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the price of gemfibrozil.\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil' )", "rejected": "null"}, {"id": "fcf30c1dc6ce58162c86998c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the five most common microbiology test conducted in this year?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "937063660ee9c96fa16dd7f5", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of people who had other and unspecified pneumonectomy in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "a064cc53a6478ab0d31cb958", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen test which patient 10038992 has last received in 11/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "ba16c2749e29db98a6103a5f", "query": "Convert the question below to SQL query.\n\n### Question:\nAnd what was the first time patient 10038933 was prescribed medication using the iv drip route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "f59622e4ac592f700d2dbc87", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any procedures been performed on patient 10005817 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "\n## SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.subject_id IN ( SELECT procedures_icd_icd.icd_code FROM procedures_icd JOIN admissions ON admissions.hadm_id = procedures_icd.hadm_id ) AND strftime('%Y', admissions.admittime) >= '2100' ) AND strftime('%m', admissions.admittime) = 10 AND admissions.dischtime IS NOT NULL AND admissions.subject_id = 100047333"}, {"id": "271a7ff6c3f876ddc5c5cbfc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given a triiodothyronine (t3) lab test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "\nSELECT\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100100355 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )"}, {"id": "38b0a6d72077dca2e36faa92", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the respiratory rate changes of patient 10023239 last measured on the first ICU visit compared to the value first measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "51e27b4812e0b87e2955592c", "query": "Convert the question below to SQL query.\n\n### Question:\nIst patient 13329 subject to covid-19 testing\n\n### SQL:\n", "chosen": "null", "rejected": ".o 1.agne-1.do\n (.m. 'MS..\n\n-)2x.311MSMSW\nMSPA.MS.13002MSPA'sPAGEPA..3441's.011121.0000100401108010070403039090806'"}, {"id": "340de3798f1b65fcf7c2df0a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the single rooms that are currently available?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_rooms.long_title FROM d_icd_rooms WHERE d_icd_rooms.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100211181 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY d_icd_diagnoses.charttime DESC LIMIT 1 )"}, {"id": "94f9e6d642b39e6a9d1a0559", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost for a hospital visit that involved a macrophage lab test?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophage' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "6e592987e710b1b2fcd180e0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the red blood cells change of patient 10009628 last measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'red blood cells' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'red blood cells' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "e4e425cc7d58d5e7949bf727", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, has patient 10019917 received a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECTIVE1 AND strftime('%Y-%m-%d', diagnoses_icd.charttime) >= '2100-03-04'"}, {"id": "6388862788004bf9b1e4345a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when patient 10004733's last microbiology test was since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a09c071ef325a1bc1e1417a1", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide a list of the four most common diagnoses that patients were diagnosed with within 2 months after undergoing the extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic procedure.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "eeac21ba672f8b7b97fbede4", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when the first microbiology test for patient 10027445 was held since 16 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "\n\n### Question:\n\nWhat is the maximum total hospital cost for a procedure called total thyroidectomy in 2100?\n\n\n### SQL:\nSELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total thyroidectomy' ) ) ) GROUP BY cost.hadm_id )"}, {"id": "ded7c37a33a0d81b227fca60", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the maximum yearly number of admissions for respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1"}, {"id": "717c3d775edf018fac4de387", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time the arterial blood pressure systolic of patient 10009628 was measured at a reading less than 123.0 in the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 123.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c3b19c4c394c0f1b38639a43", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell how many times patient 10021938 visited the ICU this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\nSELECT\n\n##\n\n##\n##\n\n##\n####\n\n## Convert to_sql\n\n\n## Convert the total number of patients who have been prescribed a drug since 21000.\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug FROM prescriptions WHERE prescriptions.drug = 'diltiazem hydrochloro' AND strftime('%Y', prescriptions.starttime) >= '2100'"}, {"id": "a6307ef07c72b6e3f75ed74e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen last did patient 10018081 have the minimum arterial blood pressure diastolic since 10/04/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-04' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "60eba7103445142138d17aea", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 09/09/2100, what was the first value of arterial blood pressure mean of patient 10021487?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-09' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f34ae2771a3ae71a42d66a89", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first dose of insulin prescribed to patient 10014729 in 03/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND prescriptions.drug = 'insulin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "7e0d52249e45d956b457e7f7", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you report the last arterial blood pressure mean for patient 10031757 during the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7b04b1222708b5e1f1411219", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the maximum value of creatinine, urine for patient 10038992 during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine, urine' )", "rejected": "null"}, {"id": "3859ca46fafef561a7272be8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me patient 10015272's daily maximum weight in this year?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "\nSELECT SELECT MAX(chartevents.drug FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058605 ) AND chartevents.charttime = '2100-03-18 01:00:00' )"}, {"id": "802527c0be8a9149dbd4a8eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism that was found during the last urine test of patient 10008454 in 12/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "049fb43f09ae244560ee52a7", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what new prescriptions were given to patient 10039831 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "e2be072741fd9d09da7ab8b3", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what are the new prescriptions for patient 10004733 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "2ca4465dba3c16260aab1d62", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of loratadine prescriptions in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'loratadine' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "72f7cf565eac6853d4a5f4bc", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the drug that patient 10007058 was first prescribed since 07/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "fb3d9d6acc0abd876c53799f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum value of phosphate for patient 10020740 in 06/this year?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06'", "rejected": "null"}, {"id": "c0e98bae8817637ddbaf34f9", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 49176 have experience travelling abroad?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n##\n\n###question:\n\nWhat was the first time patient 10020944 was prescribed a drug?\n\n\n### SQL:\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "3e94d246a8e0419606fe3122", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10018081 had the minimum value of arterial blood pressure diastolic on 12/29/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6a7adc80e43e20c9c20e21aa", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the organism found in patient 10007795's last abscess microbiology tests in 05/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "063d2d7c311c16f3cc0916a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common specimen tests conducted throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n\n.1.121147)SEMSMS.2221948400199140770-092139370276687-00001 '06/03'"}, {"id": "39f61d8cb6ee0e63eed2c0c1", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10035185 receive any disease diagnoses in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "72a6cc827b8581d7058c56f4", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any procedures been performed on patient 10019917 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "4694f530b836736c5f4fd656", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five common diagnoses since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "b8e9b90e80a785175600b2ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last dose of tobramycin sulfate that patient 10007818 was prescribed during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'tobramycin sulfate' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "63f037abd22df66334ece29c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of the hospital which involves hyperplasia of renal artery?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperplasia of renal artery' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n\n##\n\n##\n######## what are the minimum number of patients who were diagnosed with icd-related diseases during the same hospital visit after having received a cerebrovascular ultrasound of cerebral arteries, multiple sites since 21000?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'icd_icd.icd_code' AND strftime(diagnoses_icd.code, '%Y') >= 21000 )"}, {"id": "a7766be547dac94471bb1f74", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since the last time during this hospital encounter that patient 10018081 was diagnosed with unspecified protein-calorie malnutrition?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified protein-calorie malnutrition' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a4914a96d11642f0050fc3d3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the three most common diagnosis.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n\n##\n\n##\n\n##\n##\n##\n\n##\n#### Question:\n\nWhat was the last time today that patient 100397543 was administered prescriptions for the last time since 03/04/21000?\n\n\n### SQL:\n\nSELECT admissions.discharms.dischtime FROM admissions.admissions WHERE admissions.subject_id = 100397543 AND strftime('%Y-%m-%d', admissions.dischtime) >= '2100-03-04' ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "f613480747542c410142b4ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input time since 07/11/2100 for patient 10021487?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-11' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "fa51b74dc317c3f8478a0ff5", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequently tested specimens in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100389333 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1 )"}, {"id": "7597553ab7e09923b877dd3e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first specimen test given to patient 10018328 in 02/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "\n##\n\n\n##\n##\n\n##\n##\n\n##### SQL Code:\n\n\n###03. Which of the following procedures were performed during the last procedure on patient 10019545572's body since 05/01/21000?\n\n\n### Question:\n\nWhat was the total amount of glucose input that patient 1001954572 received during the last hospital visit?\n\n\n### SQL:\n\nSELECT SUM(inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadmissions_id IN ( SELECT transfers.stay_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 1001954572 ) ) ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-05' )"}, {"id": "a7f9bb55036040073e02ba0e", "query": "Convert the question below to SQL query.\n\n### Question:\nFind the number of current patients in the 20s age group.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29", "rejected": "_\u200b..\n' P.. m.. ..\n \n\n -15\n..\n\n-_"}, {"id": "82ed4968374026cba4624178", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with asymptomatic human immunodeficiency virus [hiv] infection status within 2 months after first being diagnosed with mononeuritis of unspecified site in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mononeuritis of unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "0a45cfb9e63074abf4fb2427", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is dr. robinson's outpatient schedule today?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n\n### Question:\n\nHow many hours is the minimum total hospital stay of patient 1002068555?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT ( SELECT T1.value FROM ( SELECT admissions.disch_time FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100206855 ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "3ba708e58388ca50083283e8", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most frequent lab tests that patients had after being diagnosed with calculus of kidney within the same month since 2100.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "7c769198cdf2ef06b5f1dab3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038081 had a lab test for glucose?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 )", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 )"}, {"id": "395e9529519397ab2b92b3bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input time since 05/14/2100 for patient 10027602?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-14' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "0b0c7f34ee233cef21378070", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the procedure that was given two times to patient 10027602 during the last month?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "null"}, {"id": "baba1d99e845eb5d22b1c46a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the sum of the input volume for patient 10013049 since 05/12/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-12'", "rejected": "null"}, {"id": "cd6cb8495bf452c344f61955", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that on their first hospital visit patient 10026255 had the maximum of platelet count?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "00c6c90e6841d1dfe2515346", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most common diagnoses that patients were diagnosed with within the same month after receiving hemodialysis's in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "37805d9674cc2e4525168916", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients in their 60 or above this year, what were the top four most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'start of year','-1 year') )<= datetime(current_time,'start of year') ) GROUP BY d_icd_diagnoses.icd_code ) ORDER BY COUNT( diagnoses_icd.charttime) DESC )"}, {"id": "275184cf2bd75d7ada2cab2a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients discharged from the hospital this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n##\n\n### SQL:\n\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '117454' ) AND datetime(admissions.admittime) >= datetime(current_time,'start of year') = datetime(current_time,'start of year')"}, {"id": "bb4febf2287f40fae09e1f16", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long took entral infus nutrit sub for patient 10855?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\nSELECTC1 = ( SELECT COUNT( DISTINCT cost.cost FROM cost FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = 'icd-procedures.procedures_icd.icd_code ) AND strftime('%Y',cost.chargetime) >= '2100' ) )"}, {"id": "3ac674efda7af01b7217b1a5", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the total foley output of patient 10006580 is since 03/10/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-10'", "rejected": "null"}, {"id": "03597122b60940059ca941bd", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most common diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n### SQL:\nSELECT SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '210098854'"}, {"id": "a3fbabc4125bd38ac2aed4db", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10039831 been given any drugs since 08/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'", "rejected": "null"}, {"id": "782822c98c2534ba56c1c45b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five diagnoses with the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-6 month') GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 5 )"}, {"id": "f39b6fca5e6f640b836a9c9c", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top three most frequent procedures that patients received within 2 months after receiving diagnostic ultrasound of heart.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of heart' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT SQL SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS DENSE FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014075 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) ) AS T1 WHERE T1.DENSE = MAX( T1.DENSE ) )"}, {"id": "574263846551eca2f19ac645", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output patient 10015931 first had since 06/06/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "95b867d0cf6c28bfdd679151", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first other staphylococcus pneumonia diagnosis for patient 10004733 in their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other staphylococcus pneumonia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a9c112441a88402a143e7d68", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10006053's heart rate was greater than 105.0 on the last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 105.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3a071ace73b6a8ed27c95001", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10021487, what were the first calcium, urine lab results during this month?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a01e64e03c8ea6881cad8b6c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of patient 10012853's insurance during the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "45147c4f6c84a8b896ec69ef", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen since 07/2100 did patient 10007795 get the first microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "8ba70176af381d80ec259c94", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the treatment that patient 10020740 was given two times since 05/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "null"}, {"id": "00e8943e1762300bf2fb1ec2", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 15821 having an appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100123542 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "145ae721e90f0d4889236e9b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the percentile for pt of 12.9 among patients in the same age as patient 10001217 in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 12.9", "rejected": "null"}, {"id": "1bf033967053a3e88b60ffec", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients are there?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "'3.MS d..\n\n.ichte\n peinty-G:1\n 2.\n CITPAMSPAMSMSMSMSMSONSPA-0\nMSPA-PAIDPA T2000000257517 )'"}, {"id": "9c8791408af3fe31c1f172ac", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you list the single rooms that are available for rent now?\n\n### SQL:\n", "chosen": "null", "rejected": ": (1MSMSMSMSPA.\n\n\n00.PA )'s the events'"}, {"id": "880554dbb2de7644801cbf6e", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the four most frequent diagnoses since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "76d64d32df1f5a7f51202106", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10023117 got a platelet count lab test since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND strftime('%Y',labevents.charttime) >= '2100'", "rejected": "null"}, {"id": "513415b2f83b280737f76ca1", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most frequent output occurrences throughout this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC )"}, {"id": "12accccfdfda5080e7d8234d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007818 have the first temperature celsius to be less than 98.9?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.9 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a82bf076ee8e3427249d36b0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost that involves a procedure called other enterostomy since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other enterostomy' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other enterostomy' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id )"}, {"id": "fc919be1cf3be39f5788b8c3", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when the first lymphocytes test of patient 10007795 was conducted in 04/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "99088989200eab7c0f9fc209", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the maximum total hospital cost that involves propranolol since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'propranolol' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "charINC."}, {"id": "83b0e5365db1483f3adcf4cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medicine that was prescribed to patient 10025463 in the same hospital encounter after undergoing catheter based invasive electrophysiologic testing during the last month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "280e0a765965cd5afc06ca79", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total hospital cost that includes irbesartan?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'irbesartan' ) GROUP BY cost.hadm_id ) AS T1", "rejected": "/\n A.\ufffd\ufffd.1, :10 T0(antMS\nMS110221112210000038000004100049 AND 0310.057159'"}, {"id": "b7925774086e29f5d02b778f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell how many times patient 10015272 visited the ICU in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND strftime('%Y',icustays.intime) = '2100'", "rejected": "null"}, {"id": "ccf62a429718ac33d9c26686", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common specimen tests that occurred since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "\nSELECTIVE: SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents.spec_type_desc WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100185402 ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT microbiologyevents.spec_type_desc, DENSEXCEANS( microbiologyevents.valuenum FROM microbiologyevents.valuenum ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime ) AS T3 ON T3.C1<= 3 ) AS T4 WHERE T4.C1<= 3"}, {"id": "b6207dcfe0579ae33b721201", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10040025 had the maximum value of hematocrit in 03/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d7d112f41aba75a33dcbeb67", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the drug haloperidol?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'haloperidol' )", "rejected": "s: 20 0\nMSMSPAMSMSPAGPAMS272487181667768170'"}, {"id": "f46e8931e74e00facf2ddbd7", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me how many patients stayed in the neuro surgical intensive care unit (neuro sicu) careunit during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro surgical intensive care unit (neuro sicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "953ded6c199c40900648aa89", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10021938's bicarbonate value last measured on the last hospital visit less than the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "207eceda0156cdc649f4b078", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10018081's respiratory rate was less than 22.0 in this ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 22.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "40af2c18046760f0127c35fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost for a drug named levetiracetam since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'levetiracetam' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd_icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) ) ) )"}, {"id": "c7de791a9a6825a9859e12f1", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the name of the drug prescribed to patient 10025463 within the same hospital visit after the cardiac mapping procedure since 08/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "89aa1f3b263599aa7da317e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output which patient 10018081 had last had since 10/31/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-31' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "168c04ce1956c158d1651a93", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, has patient 10002495 received a fluoroscopy of multiple coronary arteries using other contrast treatment?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "67b61395fd1f2d6c03d0af1e", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients aged 30s since 2100, what are the top three most common diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_TOTAL FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) ORDER BY diagnoses_icd.C1 DESC ) AS T1 )"}, {"id": "53ac27ef5178d9758e371569", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10007818 first have on 07/03/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-03' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "c4c116a340d78cd933a79870", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the four most frequent microbiology tests?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "\n##: SELECT what are the top four most common microbiology tests performed on patients who had been diagnosed with other diseases of the blood and blood-forming vessels since 2100?\n\n\n### SQL:\n\nSELECT T1.test_name FROM microbiologyevents WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100147257 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 4 )"}, {"id": "814f6690d0bc9410fa12b9f4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dose of aspirin patient 10017492 had been prescribed during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'aspirin'", "rejected": "null"}, {"id": "bf897345d457fcc1de668268", "query": "Convert the question below to SQL query.\n\n### Question:\nWhats the reimbursement standard for a cerebrovascular mri?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT procedures_icd_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cerebrovascular mri' ) )"}, {"id": "9be9d11d32bfdb68c3652e99", "query": "Convert the question below to SQL query.\n\n### Question:\nWill any additional blood culture test be done on patient 76275?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL AND admissions.dischtime >= '2100-01-10'"}, {"id": "c4b6b11d95a82c6b74f94e76", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who were given a drainage of right pleural cavity with drainage device, percutaneous approach procedure.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )", "rejected": "null"}, {"id": "3f384b70bd3be24de7ec5ac2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10001725 during their last hospital admission?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10001725 ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\nSELECTION_TYPE_ID FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '10039787' ) ) AND strftime('%Y-%m', admissions.admittime) >= '2100-01' )"}, {"id": "42784b06e91c57f45226adf9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10855 last take a proper medication?\n\n### SQL:\n", "chosen": "null", "rejected": "105MSPAGEMSPA:PA,MSPA HospitAL.\nMSCALTCAREAMSAZ's average?\n%\n\n%s\n%s\n%s\n\n\n### SQL Query:\n\n#SQL SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.id IN ( SELECT labevents.items.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1001305172 ) ) ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100130517 ) AND labevents.hadm_id IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ) AND datetime(labevents.charttime) >= '2100-03-11'"}, {"id": "c2611c6cae651d68d35a90db", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the last time patient 10004733 was diagnosed with tachycardia, unspecified on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tachycardia, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "2c1feec1d1f2e0f1260812d2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common diagnoses of patients in their 30s this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n\n##\n\n##\n\n##\n### SQL SQL>SELECT\n\n\n### SQL>\n\n###Question: SQL\n\nSELECT SQL>\n\nSELECT COUNT( T1.C1 ) FROM ( SELECT COUNT( DISTINCT cost.cost.cost, 0 ) FROM cost WHERE cost.hadm_id IN ( SELECT outputevents.org_id FROM cost WHERE cost.org_id IN ( SELECT procedures_icd_procedures.org_id FROM procedures_icd WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.org_icd.org_id FROM procedures_icd WHERE cost.hadm_id IN ( SELECT procedures_icd.org_id FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1001838555 ) ) ) ) )"}, {"id": "890eb501221e32541f524d63", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently prescribed drugs?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "x.d :or Begin 3.\n garrell\n -c.020.S.\n.-211'd\n\n\n121801211091930120014934285227318s'"}, {"id": "653ee6598cd92b3382f04431", "query": "Convert the question below to SQL query.\n\n### Question:\nHas octreotide acetate, furosemide, or trazodone been prescribed since 20 months ago to patient 10019777?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.drug IN ( 'octreotide acetate', 'furosemide', 'trazodone' ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-20 month')", "rejected": "null"}, {"id": "1ab67d97d6f153a086427f61", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen given to patient 10002495 for the first time since 04/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "9d3038ee311cade2b5621bce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the methods for taking metformin xr (glucophage xr)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'metformin xr (glucophage xr)'", "rejected": "\n### Question:\n\nWhat were the top four most commonly prescribed medications in the same month after being diagnosed with other and unspecified diabetes mellitus without complications in 2100?\n\n\n### SQL:\nSELECT T3.drug FROM ( SELECT T2.drug, DENSEXPICK( T1.starttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without complications' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 1001111175 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id ) AS T3 WHERE T3.drug = 'metformin' ) AS T4 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 1001111175 AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T5 ON T3.subject_id = T4.subject_id WHERE T3.drug = T4.icd_code ) AS T5 WHERE T5.charttime = T4.charttime ) AS T6 WHERE T6.C1<= 4"}, {"id": "b4c01b9c3a018f29ade4acf5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10001725 has been prescribed medication via the po/ng route in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "0e480dd5efb5afb7821bf264", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10018081 first have as output on 12/31/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-31' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "1a2803a90ebc58ce4b381cce", "query": "Convert the question below to SQL query.\n\n### Question:\nTally up the number of patients who received a granular casts lab test in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'granular casts' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "null"}, {"id": "6c3d5672d79c5fa56126482e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 27146 ever had any side effects while he/she is receiving a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'"}, {"id": "56ad123e50882b48474bc758", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five commonly ordered medications that patients aged 60 or above were prescribed within the same month after diagnosed with other nonspecific findings on examination of urine?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific findings on examination of urine' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "b45f3010719a69b9ae96e6f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10020306's first admission to the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020306 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "2c859fc43dee4f1c732f99b0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10004720's first hospital discharge since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "\n### Question:\n\nWhen was the first time since 10/2100 patient 10005854 was prescribed a medication via the iv route?\n\n\n### SQL:\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005854 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "1ac4bb5a24bb2e2beea14966", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the respiratory rate reading for patient 10014078 last measured on the first ICU visit greater than the value second to last measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "c2e4f992fdf2b0fe03106e5a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients in neuro stepdown since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "\nTell the last the first:\n2010.\n\n\n####\n\n\n##\n## SELECT: SELECT T1 FROM SELECT DISTINCT microbiologyevents.spec_desc FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m', microbiologyevents.charttime) = '2100'"}, {"id": "f8afb5281dcdfe12ea07f322", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the price for lenalidomide (revlimide)15mg?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lenalidomide (revlimide)15mg' )", "rejected": "SELECT\n\n##\n\n##\n##\n### SQL SELECT COUNT(*) FROM d_labevents WHERE d_labevents.test_name = 'asparate' AND strftime('%Y',d_labevents.charttime) >= '21000'"}, {"id": "03a5a6bba8bab1a26a453a24", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who were discharged during the previous year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "03b010201e3c0b1cd4c29d30", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat steps should i take before the drsl/dslmb fus post/post procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\nSELECT SQL SELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_T1.C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100211317 ) ) ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) GROUP BY diagnoses_icd.icd_code )"}, {"id": "b01254cc6625f82626d18102", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the procedure destruction of right main bronchus, via natural or artificial opening endoscopic?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) )", "rejected": "null"}, {"id": "8060993fd02e3caa91347361", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the top four most frequent diagnoses that patients were assigned within 2 months after receiving respiratory ventilation, greater than 96 consecutive hours.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "1108d7271243b64d3250ee9e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10000032 gone through any procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "4127d2f4d3dde8b9a50cddeb", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the five most frequent diagnoses throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "T1\n\\ T1 01-09-01-21'"}, {"id": "61467a096265ec16474e107e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently administered procedures for patients aged 50s since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT SQL SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS DENSE FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 50 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) ) AS T1 ) AS T2 ON T1.DENSE >= 5 )"}, {"id": "232479d82e4374aef6e5e8c2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10018081 o2 saturation pulseoxymetry was measured less than 99.0 yesterday.\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 99.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a903f7427fcbfe8c1598e7c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the last specimen test which patient 10027602 has received since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "68312cee150a54cd1fa02383", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the daily minimum weight of patient 10007058 throughout this year.\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year')"}, {"id": "5a0f11cd2d321ee0bbab6b6c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of coronary arteriography using two catheters procedures performed since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography with guidance of two or more coronary arteries' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')"}, {"id": "2872894a2d6be289cc0751d3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005817 undergone a (aorto)coronary bypass of two coronary arteries?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of two coronary arteries' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 )", "rejected": "null"}, {"id": "a0e105397fe459f9ad540eef", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the senna dose that patient 10021666 was last prescribed in 03/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'senna' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "228014642a9c756b378d10cc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was prescribed to patient 10010471 for the last time in the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.drug IS NOT NULL ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "db2ec5a725e4b2775b055f88", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five commonly ordered medications that patients aged 50s were prescribed within 2 months after diagnosed with long-term (current) use of insulin?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "4db20b840c3b030a56108b21", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time of patient 10027602 mini-bal microbiology test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "59f57cae084573bb29dadab2", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001217 been admitted into the emergency room in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "06aaefb80b31fdff1837ad61", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any medicine been prescribed to patient 10029291 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "fb1c9ab851ce79aecda9c32e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who were discharged from the hospital in the previous year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\n### SQL:\n\nSELECTION = '0.5'"}, {"id": "c88b6042bd98d9ea98a91f19", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the value of 13.0 in anion gap among patients of the same age as patient 10024043 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.0", "rejected": "null"}, {"id": "a00135dbda426f37103c4031", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of input by patient 10018081 on this month/29.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '29'", "rejected": "\nSELECT SQL SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m',inputevents.starttime) = '2100-02'"}, {"id": "9a574ab97db06ee700de7520", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since the first time patient 10039831 has received a calculated total co2-lab test in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "27f16675ba7f39ec5b46e3bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first medication that patient 10016150 was prescribed in 05/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "37c75c3b997199029b9998b4", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004235 received any surgery?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 )", "rejected": "\nSELECT\n\n### SQL Query:\nSELECT SELECT COUNT( SELECT COUNT( DISTINCT cost.cost) FROM prescriptions WHERE prescriptions.drug = 'amitripty sinus catheterization' AND strftime('%J') >= '2100-01-01'"}, {"id": "7da203f6a27901736f057b8c", "query": "Convert the question below to SQL query.\n\n### Question:\nOn last month/02, what was patient 10021938's first heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '02' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1e7f92fd5a7fad376555b6c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10004720 prescribed with a drug via the sc route for the first time in 12/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "00854efb1da3fe176150292d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new drugs are prescribed for patient 10039831 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 day') ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "7da9c0a5790b317cead06455", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10011398 was prescribed for the last time using a oral route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "7b1b135317d758d40c445a0d", "query": "Convert the question below to SQL query.\n\n### Question:\nLast time, what drug was prescribed for patient 10023117 on the last hospital stay?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "dd261d97de5932f7743a4b5c", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the length of stay of patient 10015860 from the last stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "eefb36fdfc2d06211f4348ec", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038999 been given any magnesium sulfate (bolus) medication in 12/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'", "rejected": "null"}, {"id": "150dcba6b064df151fc6eaf3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of patient 10004235's weight last measured on the first hospital visit compared to the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "a8f04b428e4feaac42d610de", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015860 come to the ER during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n\n### Question:\n\nList the drug name of the drug that was given to patient 1002011877 during the first hospital encounter in 2100?\n\n\n### SQL:\n\nSELECT prescriptions.drug.name FROM prescriptions JOIN admissions.admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers JOIN admissions ON admissions.subject_id = transfers.subject_id ) AND admissions.dischtime IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "b585ccb4c2cda7d48c416b0b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type during patient 10038992's last entry into the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038992 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "0af1a06bcce4aacbc5a936f4", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10008454 acquired any medication since 10/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'", "rejected": "null"}, {"id": "44bdfa99a45ce40f3a14ed16", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the protocol of the anticancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question:\n\nIs there any other medication that patient 1003855355 should not take at the same time after receiving other procedures on catheter insertion into pericardial artery, percutaneous approach since 08/2100?\n\n\n### SQL:\n\n SELECT C1 FROM ( SELECT admissions.drug FROM admissions WHERE admissions.subject_id = 10038535 ) AND admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endovascular] angiography of pericardial artery' ) AND strftime('%Y-%m-%d',procedures_icd.charttime) >= '2100-08' ) )"}, {"id": "7766442f90d1794d8c97fdfb", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10023117 entered the hospital in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "ca6018236b179b413a64059e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10020187 input time on 02/04/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-04' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "59612d635a641261872944e4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a procedure called extracorporeal circulation auxiliary to open heart surgery?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) )", "rejected": "null"}, {"id": "0ecd79404f445a1999ee1124", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of patient 10031757's last stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "\nSELECT_TIMING:\nSELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "935352db3b3a1d247e88bdc4", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since patient 10004733 had the last alanine aminotransferase (alt) lab test in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "46beded22d8893f7ce7fbb8d", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most frequent lab tests since 2100.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "23:01019'\n\n00337550190388225'"}, {"id": "39f1050daf45c345a576b18f", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease inform me of all the prescriptions patient 8888 received in another department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "b0e8ceb89dac04c7f918d0aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the condition patient 10038999 was diagnosed with last time in the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "99db8d08ce7c7dc5e23bb2ab", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007928 had a hospital admission during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "8a0c73ca152264371f4310c1", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top three most common lab tests ordered for patients during the same month after acute and subacute necrosis of liver?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "ecf62c92ccb8edd704855810", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide me with an example of how many operating rooms are available now?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n2: 1. C.\n1. 1151/03. 126/07/21003356776?\n\n\n\n## 04/12/210002816 was prescribed medication for the first time on 12/2100-02-04?\n\n\n### SQL:\nSELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100010038 ) AND strftime('%Y-%m-%d', prescriptions.starttime) >= '2100-02-02'"}, {"id": "f95edd83ff3d509561310e88", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have it been since patient 10021487 had received a mch laboratory test during this hospital visit for the first time?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "85c3807521d93484430abc9e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10021487 last given an input on 12/17/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-17' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10021487 AND strftime('%Y-%m-%d',admissions.admittime) = '2100-12-17' ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "94b0437ac528f3909e945a5f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the four most common diagnosis since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n\n..PA6PAMSPAZTEPAGI had 22800-190.15272844479755963482999'"}, {"id": "d5f33799e7f8110fd11cd073", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10008454 had a maximum value of lactate dehydrogenase (ld) in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "40aa706064637ead2ae39af7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with atherosclerotic heart disease of native coronary artery with unspecified angina pectoris within 2 months after first being diagnosed with atherosclerotic heart disease of native coronary artery with unstable angina pectoris since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unspecified angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "0f1dd768a428334842bfec50", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen tests did patient 10001217 undergo for the first time since 12/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": ".o 1.agne-1.do\n (.m. 'MS..\n\n-)2x.311MSMSW\nMSPA.MS.13002MSPA'sPAGEPA..3441's.011121.0000100401108010070403039090806'"}, {"id": "41deb2b6334194be2b87c10f", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of medicines that have been prescribed to patient 10021312.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 )", "rejected": ".. (... (_.For.,.. \n WHERE P./'sust Td.. ...',\n THE &\nMS\n1:2 F-1onss ("}, {"id": "c7f69643d20645a5bd715035", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of diagnosis did patient 10031757 receive first on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "\n## SELECT MIN(T1.disch_time FROM admissions WHERE admissions.subject_id = 10031757 )"}, {"id": "45055dee9d62c2fec5046a84", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was prescribed to patient 10021312 last time during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "be4e133fd657b3c989be8b0b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first stay of patient 10021487 in the careunit trauma sicu (tsicu) on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "c566bb57a34d5a1e6092531a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018081 have the maximum respiratory rate the first time since 76 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-76 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0dcffb3f96a1caf1b8bf05ef", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type for patient 10009049's last visit to the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10009049 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "cdb96d2ef20598a87bd17399", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of the hospital, which includes the medicine named fluticasone propionate 110mcg in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fluticasone propionate 110mcg' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "f7175ad460d1ff7aae62b0fa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10038933's ketone change last measured on the first hospital visit compared to the value second to last measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "73752639a8e1cbb92081f23b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost which includes a drug named ezetimibe since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\nSELECT SELECT SUM(cost.cost) FROM cost WHERE cost.event_type = 'prescriptions' AND cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100196402 ) AND strftime('%Y', cost.starttime) >= '2100' )"}, {"id": "ff8f65ff38e91c62de0fab77", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost involving a drug named aspirin (buffered) since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT SQL SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' AND strftime('%Y',cost.starttime) >= '2100' GROUP BY cost.hadm_id )"}, {"id": "d6c2a396d94d370d6f2348f2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were present in the vascular since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "null"}, {"id": "18134bb405cad581e0aaef9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of unspecified protein-calorie malnutrition diagnostic?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified protein-calorie malnutrition' ) )", "rejected": "null"}, {"id": "2ac19b54bada84606ebec21c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were prescribed docusate?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'docusate' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'docusate sodium' AND strftime('%Y',prescriptions.starttime) = '2100' )"}, {"id": "7c3ea800b2b64cb1b3cf89a4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the title of the medication that was given to patient 10012853 last via the po means in 04/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e74b7c054ffb66dbcc6a559b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operating rooms are there now?\n\n### SQL:\n", "chosen": "null", "rejected": "quadMS. 111.\n five\n 0MSMS=-1.21119MSPA 282014900801774173177786790721446s 04"}, {"id": "d37a478c48d46a196ddaac05", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost for a patient diagnosed with abnormal involuntary movements?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal involuntary movements' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\nSELECTIVE PROCEDURES PERFORMED IN 2100?\n\n\n### SQL:\nSELECT COUNT( DISTINCT cost.procedures_icd_code.cost FROM cost WHERE cost.procedures_icd_code.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'intravenous infusion of nutritional substance into central vein, per day' ) AND strftime('%Y', cost.charttime) >= '2100' )"}, {"id": "ac7bf3a501336d2c4fb93d27", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most commonly ordered lab tests for patients who were previously diagnosed with edema of male genital organs in the same month, this year?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "11974f52e559145ce9f812f2", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, has patient 10009035 undergone a lab test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECT SELECT COUNT(*) FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100047333 AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'arterial blood pressure diastolic systolic' ) AND datetime(labevents.charttime) >= '2100-12-08' )"}, {"id": "13bbb7977ea8096ece5542dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top four most frequent procedures patients had within 2 months after being diagnosed with personal history of other malignant neoplasm of skin since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other malignant neoplasm of skin' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "bf54c19771c5bb94ae4d9258", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many iso-osmotic dextrose prescription instances took place this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic dextrose' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT SQL SELECT COUNT( DISTINCT prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic dextrose' AND datetime(prescriptions.starttime) >= datetime(current_time,'start of year') = datetime(current_time,'start of year')"}, {"id": "6f1219fa346b449ef48710c1", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total volume of input for patient 10014354 since 10/12/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-12'", "rejected": "null"}, {"id": "49b055e9505fef06618cec23", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10022281's last stay in the intensive care unit?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT strftime('%J', transfers.intime)-strftime('%J', transfers.intime)-strftime('%J', transfers.intime,'-1') FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND transfers.careunit = 'intensive care unit' ORDER BY transfers.intime DESC LIMIT 1"}, {"id": "00beff4406c2ee10ac9621fe", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10040025 get a prescription for clonidine patch 0.2 mg/24 hr, atorvastatin, or prasugrel in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'clonidine patch 0.2 mg/24 hr', 'atorvastatin', 'prasugrel' )", "rejected": "null"}, {"id": "4daceca1922e2f7b36597c87", "query": "Convert the question below to SQL query.\n\n### Question:\nExpose the top three most frequent output events in 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": ". (\n.\nV SE.0;.\non\n01.-. 1t P2MS.11.C09MS_1 MSGMSSECauseCCTMSPA)\n##MSPA 200900032288680072555541727'"}, {"id": "91afc137c556b8c813b79b2a", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 03/2100, when did patient 10004235 receive the first sputum microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "\nSELECTIVE PROCEDURES INSTITUTIONAL CANCER OF COLON AND ASSOCIATED ORGANS, SUBMSSCAN\n\n\n### SQL:\nSELECT COUNT( DISTINCT procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions.subject_id = procedures_icd.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title = 'institutional cancer of colon and associated structures' ) AND strftime(procedures_icd.charttime,'%Y') >= '2100' )"}, {"id": "26ea9369abea20ebb7ca20ae", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last value of the o2 saturation pulseoxymetry for patient 10038999 since 06/03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-03' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1d5758a11b098e86ecfcc86d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of insulin that they prescribed to patient 10012552 in 04/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND prescriptions.drug = 'insulin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "9bc3cce0fc67dc34054bf5dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen will patient 92846 be next seen by the hospital?\n\n### SQL:\n", "chosen": "null", "rejected": ". C-1202012213928189927391240'"}, {"id": "1138580aa607ef75fdf6df17", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who were discharged since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "SELECT COUNT DISTINCT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100125528 AND admissions.dischtime IS NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'"}, {"id": "49da3f4c781d729017455057", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much am I expected to pay for central venous catheter placement with guidance?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT procedures_icd_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) )"}, {"id": "aba66c29e51149f140d80325", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the yearly maximum lr input for patient 10004733 since 113 days ago?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-113 day') GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "0741b96a36302acf8ace5c02", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen since 07/2100 did patient 10016810 receive the sodium test for the last time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0565efc9f6e08966694b0d93", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did patient 10001217 go to the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10001217", "rejected": "SELECT COUNT( DISTINCT T1.dischtime FROM admissions T1 WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014035 ) )"}, {"id": "b1d5401454229a18b1a02ee3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me all the prescriptions that patient 83062 received at the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "e72c9c21aabd74b3648906ef", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that in 04/2100 patient 10024043 had the maximum of total protein, urine?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, urine' ) AND strftime('%Y-%m',labevents.charttime) = '2100-04' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4534d3ce04ba517f06d9eeec", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost, which includes other alteration of consciousness since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other alteration of consciousness' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from matter from left femoral artery, percutaneous approach' ) AND strftime('%Y', admissions.admittime) >= '2100' )"}, {"id": "555c677326428762a09481c7", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021312 been provided any medications?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 )", "rejected": "\n# T1"}, {"id": "935c667c51ade2f8d9a18b79", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of inspection of larynx, via natural or artificial opening endoscopic procedures performed since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of larynx, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "\nSELECT SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of larynx, via natural or artificial openings endoscopic' ) AND strftime('%Y', procedures_icd.charttime) >= '2100'"}, {"id": "d8c8682102098df518b15ab6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen is the earliest hospital visit for patient 92721?.\n\n### SQL:\n", "chosen": "null", "rejected": "\n.\nery  1. 3. of \n12000102112020100303015152070010's.01."}, {"id": "882e8bdaae60f6bdfa661677", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most frequent procedures that patients were given in the same hospital visit after receiving extirpation of matter from left common iliac vein, percutaneous approach since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "aa8a3e6c3b2e1ac22610e5df", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent lab tests since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\nT1. What are the maximum's the minimum total amount of lisinopril 0.99's medications since 11/11/2100?\n\n\n### SQL:\n\nSELECT SQL SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000473338 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-11-11'"}, {"id": "44b000c0c7e63ce369e8fcb0", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me if patient 10039997 is male or female?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10039997", "rejected": "\n### SQL:\n\n### Question:\n\nWhat are the top three most common diagnoses that follow within 2 months after the diagnosis of posthemorrhagic anemia, unspecified in 2100?\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE FROM diagnoses_icd JOIN diagnoses_icd ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100077928 AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) GROUP BY T1.icd_code ) AS T2 ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "1c2352529be1c26de9ae73e4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10031757's rdw change last measured on the last hospital visit compared to the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'rdw' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'rdw' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "70935d34cbc96deade5c1b18", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of patient 10007818's mesothelial cell, last measured on the first hospital visit, greater than the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "1f9d4e5d9ff5a5dce1860541", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most common microbiology tests for patients who were previously diagnosed with spinal stenosis, lumbar region, without neurogenic claudication within 2 months?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "b02b2e4bfa20498bce6b232d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most commonly given diagnoses for patients who had received diagnostic ultrasound of digestive system before within 2 months in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1<= 4 )"}, {"id": "b8f6fd0f9b950b22019dc5f9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10021487's first stay in the careunit trauma sicu (tsicu) during their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "dcbeaf8a50d187f685e536c8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of patient 10039708's insurance during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\nSELECTC1 = ( SELECT SUM(outputevents.valuenum FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 100194875 ) ) AND strftime('%Y', outputevents.charttime) >= '2100' )"}, {"id": "6efcf394736a462c14ad905e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often was phenytoin sodium prescribed since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "11.\n25014880080368761525 )\n\n\n\n##"}, {"id": "d0bd21030a9fe3f066df09b3", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10022880 diagnosed with any type of disease in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100288008 AND admissions.dischtime IS NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "ccd4ae9fb1563f40af3d1761", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost for a procedure involving (aorto)coronary bypass of four or more coronary arteries since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "774301e86755e13414d55d0b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of patients were in the emergency department since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "242854944423 FROM CUSTOMONCTL WHERE MIGHT I CAN I GET THE TOTAL VOLUME OF PACKED BLOOD FOR MR. PATIENT FROM THE PATIENT WHO HAD A PREVIOUS TURBT ASA CANCER PATIENT IN 21000?\n\n### SQL:\n\nSELECT COUNT( DISTINCT diagnoses_icd.icd_code ) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100172452 ) AND datetime(diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code )"}, {"id": "0981b590800b50362ed9bd99", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with other postoperative infection since 2100 after already being diagnosed with injury to thoracic aorta during the same hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postoperative infection' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "53c2c01705d8513ebac151eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total of potassium chloride (powder) patient 10021118 had been prescribed since 12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.drug = 'potassium chloride (powder)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'", "rejected": "null"}, {"id": "04c847911489606e9cc2a6d2", "query": "Convert the question below to SQL query.\n\n### Question:\nWas any medication prescribed to patient 10031404 on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "\nSELECTIVE drainage of left pleural cavity, percutaneous, per procedure was done on patient 100190878 since 1 year ago?\n\n\n### SQL:\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime DESC LIMIT 1"}, {"id": "b6403378bbfbec78e67126fc", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the four most frequent treatments for patients aged 30s in 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "0680e008b203cfd226db26e6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long did it take to get spinal canal explor nec for patient 18877?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "79356e6c9fbb5a33aa5bf030", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10010471's total output on this month/16.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'", "rejected": "null"}, {"id": "a34a60cc88fbeb47c1d1c41d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the daily maximum value of weight for patient 10019385 in 03/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "41d43a2f58e87c8f4d88b801", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four common microbiology tests since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214873 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100-01' ) GROUP BY T1.test_name ) AS T2"}, {"id": "45d435ebcde4ce30fcfe25b6", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you think patient 1912 has dmii circ nt st uncntrld in his or her family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "c7913f24b079937963ea9f4f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients on vascular in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECT?"}, {"id": "d2dd4d4753286d5a02aee69a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total cost of a hospital visit involving a alanine aminotransferase (alt) lab test in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "abb4ebb0199f924eb3ed5a7e", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 13473 have a report of stricture of artery in his / her family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 100197778 AND admissions.dischtime IS NOT NULL AND admissions.dischtime IS NOT NULL AND stricture of artery is diagnosed IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'stricture of artery' ) )"}, {"id": "b789cd80cfb8838ab901d4a4", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007795 been given any sort of diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 )", "rejected": "26. In what is the difference in 03107/12/21000, what is the minimum total hospitalization count for patient 1000060585?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100060585 AND admissions.dischtime IS NOT NULL )"}, {"id": "9e9072f0ced4b6c391c00916", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who undertook right heart cardiac catheterization during the same month, what are the top three most frequent specimens tested afterward in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "754e29dd9545b861d06c17c4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average hospital cost to include a drug called acetylcysteine (iv) during this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT SQL SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' AND datetime(cost.starttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY cost.hadm_id )"}, {"id": "92628b8e1f9f488eca11c7ea", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total hospital cost associated with closed fracture of lumbar vertebra without mention of spinal cord injury?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of lumbar vertebra without mention of spinal cord injury' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "23a28ed72f5f5e55e79cbbf9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 23070 ever experienced any side effects while receiving a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 4 )"}, {"id": "6a8ea90422439952b0b95d0a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many medications were prescribed since 27 months ago to patient 10027445?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-27 month')", "rejected": "null"}, {"id": "a035bf3a134c3a5f16e7e841", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours elapsed since the first time patient 10021487 received a rbc, pleural lab test on this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0b9e619bdb576876f002d49a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the title of the medication that was given to patient 10021118 first via the ih means during the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "bfff3b930069caa7a3444608", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10006053's respiratory rate last measured greater than 17.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1183bcefba1a2e8f38f90e8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat amount of heparin was prescribed to patient 10021666?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'heparin'", "rejected": "'', 211001717163381113887'"}, {"id": "2733bc74cdbe99ae5365284d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10018081 was measured with a heart rate greater than 62.0 on their current ICU encounter?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 62.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8c47779c4f78afbd7e97d281", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first time patient 10021487 had a arterial blood pressure diastolic that was greater than 63.0 since 21 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-21 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "19514defe49fe155ab776c71", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most frequent specimens ordered for patients after being diagnosed with proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site within the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "5c20529abfd911e57654f545", "query": "Convert the question below to SQL query.\n\n### Question:\nShare the four most frequently performed procedures in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "' -.. U, \n\n:.1.\na 1ovMS.: _o0 mean)\nMS1's(ING 111>SS020 aMS. (222233010874050109? 0100'"}, {"id": "1081d7abee1a338f85c00408", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10027602 take a gt flush medication on 12/06/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-06'", "rejected": "\n## SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '118275' ) AND strftime('%Y-%m', admissions.admittime) >= '2100-02'"}, {"id": "12a69eaacc6a1663c3d9259f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time of input for patient 10018081 since 02/25/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-25' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "1f1579d6f5886ce1d80398a0", "query": "Convert the question below to SQL query.\n\n### Question:\nIn this year, what was the last diagnosis for patient 10012552?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "\n##\n\n##\n## Question:\n\nQuestion What is the maximum total hospital cost for a person who has a history of other and unspecified pain in this year?\n\n\n### SQL:\nSELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified pain' ) AND datetime(cost.starttime) = datetime(current_time,'start of year') ) )"}, {"id": "62547959e3baf6a4703c5fbb", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since the first time that patient 10039831 stayed in careunit surgical intensive care unit (sicu) in the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'surgical intensive care unit (sicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "fd8bbc85aa480d84c446fef0", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the maximum respiratory rate for patient 10039831's body since 06/29/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-29'", "rejected": "null"}, {"id": "ae62f6afd4c306068c936631", "query": "Convert the question below to SQL query.\n\n### Question:\nReveal the five most frequently prescribed medications in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n\n### SQL:\nSELECT\n\n### SQL:\n\nSELECT T1 AND T2 AND strftime('%Y', T1) = '2100'"}, {"id": "cb76dc5d463262b63169e9b8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhas the earliest patient 9038 goes to the hospital?\n\n### SQL:\n", "chosen": "null", "rejected": "286829708"}, {"id": "63dc3947dde2cd40f4b0c364", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much metronidazole (flagyl) had been prescribed to patient 10001217 in total in 12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'metronidazole (flagyl)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'", "rejected": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'metronidazole' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'"}, {"id": "9247b77bedc088fb1beb2f9c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism discovered in the first sputum test of patient 10029291 in 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.organism_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "4fb913f81273537cc819bba4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich were the five most commonly ordered procedures for patients previously diagnosed with other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle during the same hospital encounter, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "2add4b6f52a7f92255a99795", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list patient 10021938's daily average weight since 07/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "\nSELECT SQL SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100219385 ) ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-01'"}, {"id": "32b1864cd437a05f94495679", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of patients were in the medicine since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "\u0401'AS and\n T29ULDMSC?1211123201341141715 1421100357435001'"}, {"id": "b60a37507f5ac0a7a99bb5b2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the dose of clonidine patch 0.2 mg/24 hr that was first prescribed to patient 10040025 on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'clonidine patch 0.2 mg/24 hr' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "8647d1bf21a4ae9c764a0b98", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10027602's average value of mch in 11/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11'", "rejected": "null"}, {"id": "23186572a878a351ae7acf5b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since patient 10018081's first hematocrit laboratory test on this hospital stay?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "03e018e5065829295de0817f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10022041 prescribed for the first time since 04/2100 a medication via sc route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "d18670a4c314b569054a32a3", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the first hospital encounter, what was the monthly maximum dose of dextrose 5% for patient 10005909?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "null"}, {"id": "e14e80dd4ca4e48a6ecac19b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the average total hospital cost that involves lactated ringers this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "30244710019308792085787825145999372599287440'"}, {"id": "207e6d0a6a9b812afab27ac7", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the absolute eosinophil count value of patient 10038999 second measured on the first hospital visit less than the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "2da4a2b003a50f04b2d7623f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of that output that patient 10039831 last had since 19 days ago?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-19 day') ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "(. W Find ( ( I. hospital. -\n () S.\"\n (.  Unfortunately. \n MO  B1.. T  zajd .\n\n. .'1. (. ,('d...\nMSd1ch). ovedxi..,.\nMS\nMS\n B\n...o\n'1\n )\n:.imsic.te * -2.. 1d.91=ProMS\nMSZ.1.\nMSMSMS\nMS-D1)?1\nMSPA 1_1MSMSCEPAMSMSPAYPA.MSPASSIONPA.MS-PA TITPA'PASTPA"}, {"id": "6260379332c5d91d2221013d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last dose of glyburide that during their first hospital encounter was prescribed to patient 10038933?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'glyburide' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "T..\n... (A\n\nes.\n (\\\u2019/- received4...\n R.)_n...o-  .. : T:/d \n T 1- .1 J. CMS. V.. 1\n SQL**\nMS)\nMS World\n totale.\n\n\n'Mortheast7 1d:MS. T1MSUNOTO2MS0MSMSPAGEPAGEPAMSPA's28' SQL:\n##MSPAINK'tMSPA,\nMSPA )PAINPA' ICU.PA' ICU.'\n##'"}, {"id": "7969f7d2ccbf30677bc75d82", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10008454's difference in o2 saturation pulseoxymetry from the value measured at 2100-12-07 16:00:00 compared to the value measured at 2100-12-07 15:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 16:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 15:00:00' )", "rejected": "null"}, {"id": "4f00325c6536b67bbcfa20b1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients that were given a mch test during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "\n -MSes\n.!. 3\n\n- USDMS\nMSPAINPA 0120224668000038133542926s.\n\n"}, {"id": "188357b19ef7a1e1306dde6a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average daily number of patients suffering from malignant neoplasm of unspecified part of unspecified bronchus or lung?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "\nSELECT SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'excision of left main bronchus, via natural or artificial opening endoscopic approach' AND strftime('%Y-%m',procedures_icd.charttime) >= '2100'"}, {"id": "f93e415636fa3dd73984e7dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the percentile of 6.0 in a alanine aminotransferase (alt) lab test at the same age as patient 10029484 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 6.0", "rejected": "null"}, {"id": "d50ac96f2f625bb2840762bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last dose of alteplase (catheter clearance) that on their last hospital visit was prescribed to patient 10019777?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'alteplase (catheter clearance)' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "09a725954294822d94f728cd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the last time in the current hospital encounter that patient 10018081 was diagnosed with hypopotassemia?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypopotassemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "cc6c86acab499b90014c3eac", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, has patient 10022281 come to the ER?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022281 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "\nSELECTC1 = ( SELECT SUM(outputevents.valuenum FROM labevents WHERE labevents.itemid IN ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'glucose, urine' AND d_labevents.charttime = '2100-01-22' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002284553 ) AND strftime('%Y-%m', labevents.charttime) = '2100-01' ) )"}, {"id": "bf92f3517b92ea00dda6f1a7", "query": "Convert the question below to SQL query.\n\n### Question:\nHave patient 96429s ever suffered any side effects from blood transfusions?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047333 ) AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "a7391e86f5ef2065e3ea2a57", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001725 been given a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 )", "rejected": "\n##\n### SQL:\n\nSELECT SELECT COUNT(*) FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified abnormal lab test of body fluid' AND strftime('%Y-%m-%d',d_icd_diagnoses.charttime) = '2100-04-17' )"}, {"id": "aea39d595c762f58e94e6bc6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10021312's first measured absolute eosinophil count since 01/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1e5faf727375a9ada1941625", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost for a procedure involving total esophagectomy?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n##\n\n##\n### SQL Query:\n\nSELECTION_CODE IN ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified chronic renal failure, unspecified' ) AND d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100014735 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) ) AND strftime('%Y-%m',diagnoses_icd.charttime) >= '2100-03' )"}, {"id": "9d89c1083e101a847c24df5f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 96.0 for a po2 test given the same age as patient 10003400 on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 96.0", "rejected": "null"}, {"id": "62d9af32c3698f6545567c3e", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last year, was patient 10025612 diagnosed with any disease?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10025612 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "347b35d5873783b49e222bc6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total sum of inputs for patient 10007795 on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 )", "rejected": "null"}, {"id": "41edf4dce9244c624133d08a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output of patient 10018423 for the first time since 03/06/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "3438f141d7038a0bf312f74b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10012552's last measured po2?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT SQL SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100125285 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "cb88327f1594f37f99023a9d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the first time patient 10015272 had the minimum value of o2 saturation pulseoxymetry?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c873185bf7745af0b9d816fe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10025612 had a respiratory rate that was less than 16.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 16.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b70079e92720b4a5b0ac3a9a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004733 had an input of nepro (full) since 12/29/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nepro (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-29'", "rejected": "null"}, {"id": "5a676f9bd9eb81f901577ab1", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the price of diazepam.\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'diazepam' )", "rejected": ".##14011's210031790634?03120397128?\n\n\r11.000067378', what is the maximum total dose of heparin given to patient 1002280855 during their first hospital visit?\n\n### SQL SELECT SQL_CALCALCULATE_AVG(SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10028085 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 )"}, {"id": "81882a684bf6449f672dfca5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10006580 get a mrsa screen microbial test for the last time in 08/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0f0a1891025fdcedc7e8ea0d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the specimen test that patient 10000032 first received since 07/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "fdc15c3b4760871eec9eb7f4", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the number of patients who underwent respiratory ventilation, greater than 96 consecutive hours.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )"}, {"id": "73a651d26844c7e023b2bfc1", "query": "Convert the question below to SQL query.\n\n### Question:\nShare the four most frequently performed procedures since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT\n##\n##\n\n##\n##\n\n### Question:\n\nWhat is the minimum total cost of a hospital that involves a ct scan of pancreas since 1 year ago?\n\n\n### SQL:\n\nSELECT MIN(T1.total_cost) FROM ( SELECT SUM(cost.cost) AS T1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.icd_procedures.icd_code ) AND datetime(cost.chargetime) >= datetime(current_time) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') ) ) GROUP BY cost.hadm_id )"}, {"id": "7fa7ba261095aaef6e6a3b4f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital expense that includes sepsis due to escherichia coli [e. coli] in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis due to escherichia coli [e. coli]' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "84cf86069630ec83176f8f8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most often performed treatments for patients in their 20s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "b4a201694189deda17a0ac3f", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me of the top five most common specimen tests that were conducted during this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "b3a9bd9b492cf5ebf684f04b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most common lab tests given since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_labevents.charttime FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'chloride' ) ) AND datetime(d_labevents.charttime) >= datetime(current_time,'-1 year') ORDER BY d_labevents.charttime DESC LIMIT 1 )"}, {"id": "1d64d81dcd56c92b92cf34ad", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021938 have any diagnoses during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "9f7246b3b545ea28dc8ff5ad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum value of the respiratory rate of patient 10021666?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "475a9e18b2406e203c8e1f01", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the code that corresponds to icd-11 for ac dvt/emb distl low ext in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum< 21.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-03-30' ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "81852273a5351d699a554177", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much midazolam was prescribed since 09/2100 for the first time to patient 10021487?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'midazolam' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "4d0e1664ae29fa72ddcd640f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with other specified retention of urine?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified retention of urine' ) )", "rejected": "SELECTMS-2"}, {"id": "387bf75e150f6ff2983b8bee", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long did it take to get venous cath nec for patient 31854?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100214878 AND admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous cath nec' ) )"}, {"id": "239fb5f5541fdf88fed6bf3c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10004733's respiratory rate for the last time on 12/23/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-23' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5dc0d0c0e92db59c48ccb88f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was last time patient 65759 had a medication that is something to take all the time...\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT MIN(inputevents.starttime) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100113975 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-08-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)"}, {"id": "34aaef20dab2fc42f7a53d70", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 59275 have a travel history to another country?\n\n### SQL:\n", "chosen": "null", "rejected": "##\n# ICU2"}, {"id": "621f1abf8ceb45784a8a62b6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many prescriptions for albumin 25% (12.5g / 50ml) were made last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "8cbc6f9057443ffd3cb11a50", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does humalog cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'humalog' )", "rejected": "\n'\n\n3: What'd_3000340'"}, {"id": "f2f331a5387ccf3bfd476a39", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10037861 through any surgery in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "5298acd146a65fc926854ec0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are patient 10025612's changes in o2 saturation pulseoxymetry second measured on the first ICU visit compared to the first value measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "f719a14ae6e71d9f9de23e63", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10021487 was tested for red blood cells in 12/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "\nSELECT SQL SELECT MIN(T1.starttime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.admissions.hadm_id FROM transfers.transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime ASC LIMIT 1 ) AND strftime('%Y-%m',transfers.intime) = '2100-12'"}, {"id": "aebc591db2a1ef2225ebbf74", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of a hospital that includes a procedure called other operations on intestines since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other operations on intestines' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "\n\n##\n##\n##\n\n##\n### SQL Query the top five most frequently prescribed drugs for patients who were diagnosed with atrial fibrillation with other cardiac rhythm control since 21000.\n\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT admissions.drug FROM admissions WHERE admissions.subject_id = 1002094878 ) AND admissions.hadm_id IN ( SELECT procedures_icd_icd.doses.icd_code FROM procedures_icd_icd_doses WHERE procedures_icd_icd_doses.icd_code IN ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title = 'atrial fibrillation' ) AND strftime('%Y', admissions.admittime) >= '2100' ) )"}, {"id": "b11ba285107d208de9e518f1", "query": "Convert the question below to SQL query.\n\n### Question:\nSince the last diagnosis of patient 10018081 with overflow incontinence in this hospital encounter, how many hours have passed?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'overflow incontinence' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "fc0310f4a0e6c3791fc800f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average expense for assistance with cardiac output using balloon pump, continuous?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) )", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump' ) ) GROUP BY cost.hadm_id )"}, {"id": "998714278a267519fc47473b", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 22 months ago, what was patient 10038933's first weight measurement?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "2ea0eb184438ab7110b6c335", "query": "Convert the question below to SQL query.\n\n### Question:\nFetch the top five most frequent procedures that were administered to patients within 2 months after they had drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "80583d948d18de33fb6987b2", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me about patient 10006053's first heart rate on 11/17/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '11-17' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT SELECT chartevents.drug FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(chartevents.charttime) >= '2100-11-11' ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "84f5dabf19eb4e0fd354fbef", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first respiratory rate in patient 10027445's body on 08/12/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-12' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "623f6b6f64fea20e0be94ac5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the time of patient 10006053's first peritoneal fluid microbiology test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "a2556a4a997d1f09c6a72589", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much heparin was given to patient 10020740 for the last time in 06/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'heparin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "ee04db0976616af28ba6a8a5", "query": "Convert the question below to SQL query.\n\n### Question:\nCan I know the total output amount for patient 10014078 since 172 days ago?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-172 day')", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime) >= '2100-12-17'"}, {"id": "567d369cd559cd950e3354cf", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, what are the three common diagnoses of patients of age 20s?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n## SELECT SQL>\n\n### SQL:\n\nSELECT SQL> SELECT COUNT(*) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND strftime('%Y', transfers.intime FROM transfers.intime) = '2100'"}, {"id": "cd94bbb9784884dac45123cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most common microbiology tests that patients had after the diagnosis of malignant neoplasm of lower third of esophagus within the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "3897e55dfcc80af6c9948c75", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015860 had a lab test done since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')", "rejected": "\n##\n\n##: SELECT COUNT(*) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100359385 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' )"}, {"id": "9e84a6e731e2b335a972b488", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last drug that was prescribed to patient 10038992 in their last hospital encounter via the oral route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "74f00dc121afbe12df42ad01", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the total input volume for patient 10023239 since 184 days ago.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-184 day')", "rejected": "SELECT SQL SELECT SUM(inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100074022 ) ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12-18'"}, {"id": "3699fcd92638b268ce598cd8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10008454 last have a maximum value of arterial blood pressure diastolic on 12/06/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-06' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "03cdbce2386e1c8684bf2a13", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most frequent lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT SQL SELECT T1.test_name FROM ( SELECT d_labevents.test_name FROM d_labevents WHERE d_labevents.label = 'chloride' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018081 ) AS T2 ON T1.charttime = T2.charttime ) AS T3 ON T3.valuenum = T2.valuenum ) AS T4 WHERE T4.valuenum = 100.0"}, {"id": "339d3163e8bea1c8f13aabf3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the dose of insulin human regular that patient 10035185 was last prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND prescriptions.drug = 'insulin human regular' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2d9caef46a791339e4a2731b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich procedure was performed on patient 10016742 two times since 03/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "null"}, {"id": "169bc0cd29c8abe63a931a22", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was first prescribed to patient 10020306 through the iv route last month?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "26ceeacb486699b10996ccda", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of ICU visits of patient 10001725 in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y',icustays.intime) = '2100'", "rejected": "null"}, {"id": "c8b66e1569afc7477b2048fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last drug that patient 10019917 had been prescribed via the sc route on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9da1c2b4d2477e7d54541e82", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent diagnoses.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "### Question:\n\nHas patient 100060585 had any lab tests done since 2100?\n\n\n### SQL:\nSELECT T1.drug FROM ( SELECT d_labevents.label, COUNT(d_labevents.charttime) AS C1 FROM d_labevents WHERE d_labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100060585 ) AND strftime('%Y',d_labevents.charttime) >= '2100' GROUP BY d_labevents.label ) AS T1 ) AS T2 ON T1.C1<= 3"}, {"id": "d8839ecf07fe219f65ec8de5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a diagnosis for cellulitis and abscess of trunk?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cellulitis and abscess of trunk' ) )", "rejected": "null"}, {"id": "a8f14a0288ce316b24a94558", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the drug that shouldn't be administered during lt heart angiocardiogram?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180811 AND admissions.dischtime IS NOT NULL )"}, {"id": "3f1090acd1fbd153ed566e98", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 34.1 in the mchc lab test with the same age as patient 10022041 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.1", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum DESC ) AS C1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ) AS T1 WHERE T1.valuenum = 34.1"}, {"id": "0821be3636ee8eab640a750b", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most frequent diagnoses that patients were diagnosed with within 2 months after receiving extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "09315d12007c47ae3fb400b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was prescribed to patient 10005817 for the last time since 12/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT\n\n\n##\n##: Convert to_char(procedures-icd.org\n\n\n###sql\n\nSELECT ST.procedures.icd_code FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.code = 'excision of other lesions of bile ductus, multiple sites' AND strftime(inputevents.starttime) >= '2100' )"}, {"id": "4d6effcf91960c4bd023a47c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in patient 10038081's first blood (cmv ab) test conducted since 10/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (cmv ab)' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND labevents.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10' )"}, {"id": "949c6b3479c7ce4f2acd3003", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top three most common microbiology tests that patients were diagnosed with after the diagnosis of esophageal varices in diseases classified elsewhere, with bleeding within 2 months?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal varices in diseases classified elsewhere, with bleeding' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "975c987c6333e4a188a0a375", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10016150 prescribed with a drug via the oral route for the last time?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "\n## 1. What are the last time now?\n\n\n##: The first time this year during which month patient 1000272855 was admitted to the hospital for the first time?\n\n\n### SQL\n\n### SQL:\nSELECT admissions.disch_time FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.disch_hospitals.disch_time FROM admissions WHERE admissions.subject_id = 1002728558 ) AND datetime(admissions.disch_time,'start of month') = datetime(current_time,'start of month') AND strftime('%Y',admissions.disch_time) = '2100' )"}, {"id": "bbd0838406ac686e07d75a02", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total length of excise diaphragm lesion procedure for patient 594?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "180fff17c7418b127d038bf7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10038933 admitted in terms of admission type for the last time?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038933 ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "4133be3a90881f06dc6f4591", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the outpatient schedule of dr. brunner today?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "06c554d6edfd2380ecdb7e9f", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most commonly prescribed drugs during the same hospital encounter to the patients aged 40s after diagnosed with alcohol abuse, unspecified since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "5f5a69f769e752469c78c104", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat immuno-cancer drugs have been in use for the last five years?\n\n### SQL:\n", "chosen": "null", "rejected": "MSPAMSMS, is theMSMS184547169 )55647786' AND datetime 1100 DESCRIPTK?"}, {"id": "e4f4aa529c397e3b7d0ddcd2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost for a person with jaundice, unspecified, not of newborn since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'jaundice, unspecified, not of newborn' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "1d5c66901760c1bfc6eb5361", "query": "Convert the question below to SQL query.\n\n### Question:\nToday compared to yesterday, what new drugs are being prescribed to patient 10039831?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "98d4523a1fa9d300734adcb5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10020944 weigh when measured for the last time since 28 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "238589d4d2a414a0aa04c9b5", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me about patient 10000032's age during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "02a069698a803a8419fa294c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the count of the drugs patient 10021118 was prescribed in 11/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11'", "rejected": "null"}, {"id": "79d16bbe75c1b79b191237dd", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell the three most frequent lab tests in 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n##\n### Question:\n\nWhen was the last time patient 100019172's o2 saturation pulseoxymetry was checked on 07/06/this year?\n\n\n### SQL:\n\nSELECT chartevents.starttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100019172 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m-%d',chartevents.charttime) = '07' AND strftime('%m',chartevents.charttime) = '06' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "0406ba9fa1c3ada7f76965a3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the last medication that was prescribed to patient 10039708?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9043871db343ad385db09772", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10010471's first microbiological test occur since 1 month ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 month')"}, {"id": "3f0035e87fa9e0e54608b6e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the name of the treatment received by patient 10029291 two or more times during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "86e644ff0d66b3aee390fc72", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dosage of polyethylene glycol prescribed to patient 10021312 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'polyethylene glycol' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'", "rejected": "null"}, {"id": "58b2237d10cf18728234ae55", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given heparin since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}]