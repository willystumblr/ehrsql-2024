[{"id": "15e5163ccc3e3c1f766d7f6a", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the red blood cells level of patient 10021312 last measured on the first hospital visit greater than the second to last level measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admitted_dischtime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "1f4cec0d64925a794dace1cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was prescribed to patient 10027602 within 2 days following their percutaneous [endoscopic] gastrostomy [peg] in 12/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "66e17c14c6b5f8370524c964", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost for a acute and chronic cholecystitis diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and chronic cholecystitis' ) )", "rejected": "null"}, {"id": "04c15bde72e4c64e49a380e7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the total minimum cost for a hospital that includes a amylase lab test?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "ccc5d12c1c88d7a708f03f70", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently taken specimens for patients diagnosed with iatrogenic pneumothorax previously in the same month, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'iatrogenic pneumothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'iatrogenic pneumothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 4"}, {"id": "0e38c574dc705f0c26a2aa69", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the first hospital encounter, what amount of bisacodyl was prescribed to patient 10025463?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'bisacodyl'", "rejected": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'bisacodyl' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "59f57cae084573bb29dadab2", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001217 been admitted into the emergency room in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'"}, {"id": "2dfbec4e54ac5d6edf34216d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10002495's first measured rdw-sd in 06/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "83b572d1db3ebc6a03eacfcc", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know of the drug that is not to be administered during the refus lmb/lmbsac pst/pst procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'"}, {"id": "db9a6d17c2bdc3d58e519267", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10021487 had the minimum value of heart rate on 12/10/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-10' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-10' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1"}, {"id": "d7e9bb0643911048598d2147", "query": "Convert the question below to SQL query.\n\n### Question:\nIs that patient 15945 has an appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%E',outputevents.charttime) >= '269 days ago' )"}, {"id": "513415b2f83b280737f76ca1", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most frequent output occurrences throughout this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1<= 4 )"}, {"id": "74357f5fe76f72bc4084d3b0", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 23070 have overseas travel history?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT T1.drug FROM ( SELECT prescriptions.drug, DENSE( T1.starttime ) AS T2 FROM prescriptions AS T1 WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 23070 ) AND T1.starttime > '2100-10-05' ) ) AS T3 WHERE T3.C1> 1"}, {"id": "58dc0f1db2dd25ed12cb221c", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients aged 60 or above since 1 year ago, what are the top five most common diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1<= 5 )"}, {"id": "34e14f0320cc416a7c84ff9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 9619 is scheduled for the earliest hospital visit?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1.SELECT COUNT(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT T2.cost.hadm_id FROM cost WHERE cost.row_id IN ( SELECT T1.cost.row_id FROM ( SELECT T1.cost.row_id FROM ( SELECT T1.cost.row_id, DENSEARKS( T1.cost ) AS T2 FROM ( SELECT T1.cost, DENSEARKS( T1.cost, 1 ) AS T2 FROM ( SELECT T1.cost, datetime(T1.chargetime) AS T1 FROM ( SELECT admissions.hadm_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 9619 ) AS T1 WHERE strftime('%J',T1.starttime) >= '2100-06-18' ) AS T2 ) ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T4 ) AS T3 ) AS T4 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 ) AS T3 ) AS T4 )"}, {"id": "fa39db2734c74d5812a74112", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10027602 had input since 11/26/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime ASC LIMIT 1"}, {"id": "84c70bbe9310c79050cef5e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was prescribed to patient 10018423 within 2 days following their measurement of cardiac sampling and pressure, left heart, percutaneous approach?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018423 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018423 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018423 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018423 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "e32a0cfb6a8e66331f21aaa1", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 21134 have any history of depressive disorder nec in his / her family?\n\n### SQL:\n", "chosen": "null", "rejected": "\nd-\"),\n.\n\n\n 'MSd '\n\ndMSMSC'\n' AND' AND'\n"}, {"id": "486691bb6da24ab4f1918724", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the first output of patient 10015860 since 06/05/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime ASC LIMIT 1 )"}, {"id": "896c8f2f1440f307d4f71409", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were administered ipratropium bromide neb?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium bromide neb' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium bromide neb' )"}, {"id": "4e6dcd007988152470193f41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients staying in med/surg in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y',transfers.intime) = '2100' )"}, {"id": "99db8d08ce7c7dc5e23bb2ab", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007928 had a hospital admission during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"}, {"id": "03cc245c1d997582959cd48a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average monthly number of cases for other specified coagulation defects since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1"}, {"id": "c3b19c4c394c0f1b38639a43", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell how many times patient 10021938 visited the ICU this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')"}, {"id": "60ea85db45d1ad1ad72cf62a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10010471 received any lab tests since 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07'", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07'"}, {"id": "79cd6dad6ad9f5ff2c2684e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of that first specimen test patient 10029484 got since 11/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "fa30ead3c41cae309bafcade", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost including a rbc, pleural lab test since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, pleural' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, pleural' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "a3fbabc4125bd38ac2aed4db", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10039831 been given any drugs since 08/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'"}, {"id": "1a393a5c12d21a7f7e392418", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the monthly minimum amount of patient 10001725's pre-admission/non-icu intake input since 03/12/2100.\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission/non-icu intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission/non-icu intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' GROUP BY strftime('%Y-%m',inputevents.starttime)"}, {"id": "84ba0d560e8d6b40089569b5", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10005909 prescribed with the medication enoxaparin sodium, docusate sodium, or 5% dextrose in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'enoxaparin sodium', 'docusate sodium', '5% dextrose' )", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'enoxaparin sodium', 'docusate sodium', '5% dextrose' )"}, {"id": "546a49550415320fbb9316ad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time in 05/this year patient 10018328 was prescribed a medication via the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "783bda443eb8e764428abb4d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10001217 last had the total protein, csf minimum value since 12/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1"}, {"id": "76752df29fef2ffe6127c97b", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10040025's chloride last measured on the last hospital visit greater than the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "ecbdf8f66488345ecb0ba8bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was patient 10025463 prescribed for during the same day after undergoing catheter based invasive electrophysiologic testing in 11/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "7d7aee677bb35ba8d39e2a8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the recorded sex of patient 10022880?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880", "rejected": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880"}, {"id": "d8caee9d95e20089a90e7c8c", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring this year, has patient 10007928 been at the emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"}, {"id": "ff8f65ff38e91c62de0fab77", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost involving a drug named aspirin (buffered) since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "e260781263bd5dafc3731d96", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operation rooms are now available?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT# SELECT COUNT(*) FROM chartevents WHERE chartevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100313352 ) ) ) AND chartevents.charttime IS NOT NULL AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.chartime) >= '2100-04' )"}, {"id": "4449c0b54dc6e4a7af5dc9d8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first value of a myelocytes lab test of patient 10004235 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'myelocytes' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'myelocytes' ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "f946291e703d6e542a4a7d37", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the three most frequently prescribed medicines within the same hospital visit after a diagnosis of family history of ischemic heart disease was made during this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of ischemic heart disease' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of ischemic heart disease' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "3bd09b282f97fbf5a9f40eaf", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the weight changes of patient 10027602 last measured on the last hospital visit compared to the value second to last measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"}, {"id": "0cf19476dc727db127ab20bf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the last specimen test which patient 10018328 has received since 17 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-17 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-17 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "6a8ea90422439952b0b95d0a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many medications were prescribed since 27 months ago to patient 10027445?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-27 month')", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-27 month')"}, {"id": "5732b3a1da02702d943f84d4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10018081 have for the first time since 04/07/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07' ORDER BY outputevents.charttime ASC LIMIT 1 )"}, {"id": "c35d03883eff2c60ecc563cf", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were prescribed bupivacaine 0.1%?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupivacaine 0.1%' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupivacaine 0.1%' AND strftime('%Y',prescriptions.starttime) = '2100' )"}, {"id": "b0ef9ac5dcce6d06f4eb450d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most commonly prescribed drugs in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1<= 3"}, {"id": "5d8d3d9c0e88b7b656bc2f3e", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most common diagnoses in this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n\n### Question:\n# What were the top five most common lab tests ordered in 21000 for patients aged 60 or above?\n### SQL:\n SELECT d_labtests.label FROM d_labtests WHERE d_labtests.lab_name IN ( SELECT T1.d_labtests.label FROM d_labtests WHERE d_labtests.charttime IN ( SELECT T1.charttime FROM ( SELECT T1.charttime FROM ( SELECT admissions.hadm_id, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 1 ) WHERE admissions.age >= 60 ) AS T1 ) ) )"}, {"id": "63df5bb2d6f0f20c72c9dfbf", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10039997 admitted in terms of admission type for the last time at the hospital this year?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "474e88f3f2489ae5e866536c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last weight of patient 10039831 since 03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "cc2bba4f303536420f4558fe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who had a hyaline casts test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )"}, {"id": "648035b87d03c40993442aeb", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the current hospital visit, how many hours have passed since patient 10018081's first diagnosis of abnormal coagulation profile?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J - strftime('%J - strftime('%J - 0 - strftime('%J - 0 - strftime('%J - 0 - strftime('%J - 0 - strftime('%J - 0 - strftime('%J - 0 -"}, {"id": "683c48b602131b125efece68", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time in 03/this year, when was patient 10019777 prescribed vancomycin and iso-osmotic dextrose at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic dextrose' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic dextrose' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1"}, {"id": "f26956b68a52957757b13e45", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10015272 had the maximum value of white blood cells?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1"}, {"id": "338a9d532066c9b092d97b39", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10018328's age on their first hospital encounter was what?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "e3ef5dc86e154039d7839324", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021118 had the minimum monocytes in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "acc3a9c211f42e9d6d154a20", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five diagnoses associated with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE( T1.C2 AS C3 ) AS T1 FROM ( SELECT COUNT( T1.C1 AS C2 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'vascular insufficiency, unspecified' ) ) AS T1 ) AS T2 WHERE T1.C1 <= 3 ) AS T3 ) AS T4 ) AS T5 ) AS T6 ) AS T7 ) AS T8 ) AS T9 ) AS T10 )"}, {"id": "09eada5be412b54a7d6e3604", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 65759 have a record of hypotension nec in his / her family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 65759 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypotension, unspecified' )"}, {"id": "5f2a159055d6adad640855a4", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most frequent drugs that patients were prescribed during the same hospital visit after being diagnosed with hemorrhage complicating a procedure in this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage complicating a procedure' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage complicating a procedure' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "caa992eaae720918e04f0b4d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the five most common specimens tested throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n0/: \n: (how: ( AND strftime(': '07-07-2100'"}, {"id": "4f42b7f15b57fa921a5c03ea", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first other chronic nonalcoholic liver disease diagnosis of patient 10021487 on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1"}, {"id": "99088989200eab7c0f9fc209", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the maximum total hospital cost that involves propranolol since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'propranolol' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'propranolol' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "5c8d918b88b696fa22b10f23", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most common prescriptions in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1<= 4"}, {"id": "7793a26811956045c0aad41d", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who were diagnosed with acute venous embolism and thrombosis of subclavian veins , what are the top four most common medications that followed afterward during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute venous embolism and thrombosis of subclavian veins' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute venous embolism and thrombosis of subclavian veins' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "a4ead1605ee2cae02541b57b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people got prescriptions for adde last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'adde' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "'\nm\n)'1ch-2ym).MS.\nier'UMS10C =MSMSPAY.MSPAYCARCMAR.CICU_.\nMS.\n##' AND 1 AND 1000020003087539210006 'PA'"}, {"id": "79e0ad1e375749a558da1432", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 6440 have a history of travelling overseas?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT icustays.room_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1"}, {"id": "8a73eab771e03264c24fffde", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first value of respiratory rate patient 10014078 had?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "914748abe25fc4a2ffa614f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medicine does patient 84476 take after being prescribed by our hospital's other department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1<= 4"}, {"id": "7da203f6a27901736f057b8c", "query": "Convert the question below to SQL query.\n\n### Question:\nOn last month/02, what was patient 10021938's first heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '02' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '02' ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "91405986ac7029c89c4e111c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of an output that patient 10013049 has first had since 03/07/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime ASC LIMIT 1 )"}, {"id": "228014642a9c756b378d10cc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was prescribed to patient 10010471 for the last time in the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "45b872b3b1c160f0ef5249c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who stayed in careunit emergency department observation since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "131ea45cf61be3a504988801", "query": "Convert the question below to SQL query.\n\n### Question:\nIn total, how many patients were prescribed vancomycin since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' AND strftime('%Y',prescriptions.starttime) >= '2100' )"}, {"id": "10a09034b24ebc5ea1fcd470", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the lymphocytes level of patient 10037928 last measured on the last hospital visit less than the first level measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 )< ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "b76a7905227123a769fc9e14", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many individuals are current patients in their 40s?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49", "rejected": "ious'tell't'\n' AND '' AND'\n' AND str' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND' AND'"}, {"id": "df5a3dc1bac62f8679a50e44", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10023239's % hemoglobin a1c last measured on the first hospital visit greater than the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "273f6bc57bc0f792177dfd04", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004733 received a enteral infusion of concentrated nutritional substances treatment since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "SELECT COUNT(*)>0"}, {"id": "5a471bc5d991ced2d535cfb7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times irbesartan was ordered since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'irbesartan' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'irbesartan' AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "0b6a628ddf97a2a792d52b70", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people were given prescriptions for plasmalyte?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'plasmalyte' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'plasmalyte' )"}, {"id": "347b35d5873783b49e222bc6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total sum of inputs for patient 10007795 on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 )", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 )"}, {"id": "83fcd6e49ddcd0e710cd01fb", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top five most conducted lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1<= 5 ) AS T2"}, {"id": "b9f6116b0b39e50a2fa629e1", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the value of anion gap last measured on the first hospital visit of patient 10005348 greater than its value second to last measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"}, {"id": "a8fc0b9f87df5a45d66da39e", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the cost for the procedure called drainage of left pleural cavity, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) )"}, {"id": "52ab9f0636d7c7efa44fbe81", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what were the top three most common specimens tested on patients during the same month after the diagnosis of polyneuropathy, unspecified?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 3"}, {"id": "6b2bc626482c4ebd317ba6ea", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what was patient 10012552 diagnosed with for the last time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE( diagnoses_icd.charttime ) AS T1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m',diagnoses_icd.charttime) >= '2100' ) ) AS T2 ON T1.icd_code = T2.icd_code WHERE T1.charttime = T2.charttime"}, {"id": "0a103802ca827b13141a5a60", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10018081, how many hours have passed since the last diagnosis with long-term (current) use of anticoagulants in their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "f0fa794eb149befc0d010275", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you inform me of the first white blood cells test result for patient 10007795 in 04/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000795 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "20a337b806f34bbcaf6383e9", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of medicines given to patient 10038933 in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',prescriptions.starttime) = '2100'"}, {"id": "148401ff5d7203a166bbf2c2", "query": "Convert the question below to SQL query.\n\n### Question:\nI would love to know the name of the diagnosis that patient 25763 received in the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)"}, {"id": "c2498660106f0841540500d3", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top four most frequent procedures that patients were given in the same hospital encounter after receiving reposition left mandible with external fixation device, percutaneous approach.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "6e2b15fdbc190829eee00df1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. shears's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "MS.'\nMS' AND str.drug. AND str.patient_id = 1000047295 )'"}, {"id": "3f2bb642b30df18f43f0428a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the monthly maximum amount of patient 10006053's cryoprecipitate input.\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cryoprecipitate' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cryoprecipitate' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)"}, {"id": "7eb920ea8c935405a34f2187", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time on their first ICU stay patient 10014078 had a minimum respiratory rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1"}, {"id": "07032b1d51ef6d34a32ed424", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most commonly prescribed medications since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": ":\n\n\n\n##:"}, {"id": "966d1ead03418408fd0eccc1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with paroxysmal atrial fibrillation in 2100 after previously being diagnosed with pain in left shoulder within 2 months?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in left shoulder' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paroxysmal atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in left shoulder' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paroxysmal atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "feaaef960a419d81d79e5cfb", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total acetaminophen dose that patient 10037975 has been prescribed?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND prescriptions.drug = 'acetaminophen'", "rejected": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND prescriptions.drug = 'acetaminophen'"}, {"id": "5b1d543d54897c267c07f555", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most frequent diagnoses in 2100 with which patients were diagnosed after receiving hemodialysis within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "9043871db343ad385db09772", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10010471's first microbiological test occur since 1 month ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": ""}, {"id": "661a2833119e979de4228585", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10029291 been prescribed with the medication perphenazine, furosemide, or neomycin-polymyxin-bacitracin since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.drug IN ( 'perphenazine', 'furosemide', 'neomycin-polymyxin-bacitracin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.drug IN ( 'perphenazine', 'furosemide', 'neomycin-polymyxin-bacitracin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "a12e0ce3ce5a8ad2bd8f3a5d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost for drainage of right pleural cavity with drainage device, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )"}, {"id": "c6a7a43a376d92df5f420f3d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10009628 got a lab test in 09/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '09'", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '09'"}, {"id": "2d825ccd2b65ad362114e5dc", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 19175 have a family history of colostomy status?\n\n### SQL:\n", "chosen": "null", "rejected": "*\n\nn't =MSCool'):\nMSU.C.long.?\n'21000'"}, {"id": "bc55adec6e2f148eae8ab156", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in patient 10021487's first bronchoalveolar lavage microbiological test since 09/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "2bbc414d187b0af13c72744e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most commonly prescribed medications in the same month to patients in their 60 or above who were diagnosed with congestive heart failure, unspecified since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "cd68238c19445383f9469b6b", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the temperature celsius level of patient 10005817 second measured on the last ICU visit greater than the first measurement on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "7615134b4fa7ff6ddf73b525", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who were discharged from the hospital in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'"}, {"id": "fc0310f4a0e6c3791fc800f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average expense for assistance with cardiac output using balloon pump, continuous?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) )"}, {"id": "11f0c0917f60ce2086cc646c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients with noncompliance with renal dialysis were diagnosed within 2 months after previously being diagnosed with personal history of tobacco use?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "333df3a7ec5a12c84b0e951e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total of zolpidem tartrate patient 10021487 had been prescribed in 12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'zolpidem tartrate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'", "rejected": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'zolpidem tartrate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'"}, {"id": "92968aac60b31a25b1b7a9e2", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top four most frequent drugs that patients were prescribed in the same month after being diagnosed with other place in hospital as the place of occurrence of the external cause throughout this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other place in hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other place in hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "1558f54b2c3bec57f2893d4f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequent procedures for patients aged 30s?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "-d'-name'"}, {"id": "30444a0364fc39ff849021b5", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of ICU visits for patient 10004720 in the last hospital encounter.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )"}, {"id": "f9e2b0a131460704a8a57a4f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most frequently performed procedures for patients who are 60 or above?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 3 )"}, {"id": "9e244cb537e766b890782d9a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total volume of patient 10009628's input since 07/04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04'", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04'"}, {"id": "240c55269dbe044f71ee51c5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average yearly number of people diagnosed with rheumatic disorders of both mitral and aortic valves since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1"}, {"id": "a19797fad6ac2c57326769e0", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, has patient 10005909 been diagnosed with any illness?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'", "rejected": "SELECT SELECT COUNT(chartevents.drug) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y',chartevents.charttime) >= '2100' )"}, {"id": "eb588610d7a73daedf0f76c1", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the value of patient 10001217's monocytes last measured on the first hospital visit greater than the value second to last measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "0d0dfd8344c44ef1ba5abcc4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of patient 10014078's insurance in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "2ea2811b8f3a6ed89aa46618", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did last patient 10014729 have the minimum value of albumin, pleural in 03/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, pleural' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, pleural' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1"}, {"id": "b589fb2df1dcb6da13ec9456", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently given diagnoses for patients who had previously had hemodialysis within 2 months, in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "d126628b6dfa7ff021c37cc5", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 06/2100, when did patient 10039831 receive the first mrsa screen microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "ae118d940c4e33b7050b1c8d", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 14054 subject to tests to determine if he has covid-19.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE( T1.drug ) AS T3 FROM ( SELECT T1.drug, DENSE( COUNT( T1.charttime ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 ) AS T2 WHERE T2.C1<= 3 ) AS T3 ) AS T4 WHERE T4.C3 = 1"}, {"id": "db4ef4453f0482846262ad5c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients who stayed in cardiac surgery this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac surgery' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac surgery' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )"}, {"id": "ab607c4930656aed65054027", "query": "Convert the question below to SQL query.\n\n### Question:\nHas magnesium sulfate (bolus) been administrated to patient 10005909 since 03/02/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02'", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02'"}, {"id": "8f05ca0c74199be8f6803a5c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days is it since patient 10021487 last received the lymphocytes lab test on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "7adf373e9c0d4a3cd7f5fec3", "query": "Convert the question below to SQL query.\n\n### Question:\nThis year, what are the three common diagnoses of patients of age 40s?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "4f7c481bcc13707e66944d07", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three frequently ordered drugs for patients diagnosed with tobacco use disorder previously in the same month, this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "224e861c8a991fe5103027e4", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10020944 to the emergency room on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "c0dcb9d8aed598dc3c1ff8fd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost for the drug acetazolamide sodium?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' )"}, {"id": "bb12c097d6c3840101205ef8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the five most common lab test that was given in 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1<= 5 )"}, {"id": "3fad6d968be4660d18e4a33a", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their last ICU visit, what was patient 10007928's last heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "6012b1badcebf4d12139de0e", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me patient 10026354's total output volume on 10/31/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-31'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-31'"}, {"id": "84cf86069630ec83176f8f8e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most often performed treatments for patients in their 20s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 5 )"}, {"id": "a6fc04dbbe1e0ba75ba30f18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in the first bronchoalveolar lavage test of patient 10021487 since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "74cb952e6290049d94447a5f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the last output of patient 10005909 since 269 days ago?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-269 day') ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%E',outputevents.charttime) >= '269 days ago' )"}, {"id": "c0cedb965b06326bbddb2eb4", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients discharged from the hospital since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "al-.'m\n1per\nd.'PAMS-to beKMSPAY Cancer't't's.'t.'s.'"}, {"id": "ebe871c89f963463b9c8c4be", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the time when patient 10014729's o2 saturation pulseoxymetry was less than 95.0 for the last time on 03/06/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 95.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-06' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum< 95.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-06' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "984b06bd38c5e69abd10d736", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most common specimens tested since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100379050 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100' ) ORDER BY microbiologyevents.charttime DESC LIMIT 3 ) AS T1"}, {"id": "2ec6cb1efc895f9201b5cf60", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the first time during their current hospital visit patient 10021487 got a other lab test?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "d754a3e8d810070834fab3af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost that involves other appendectomy procedure in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other appendectomy' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT: SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.long_title = 'other endoscopy of small intestine' AND strftime('%J', '0', '0', '0') = 1 AND strftime('%J', strftime('%Y', procedures_icd.charttime) >= '2100'"}, {"id": "45ff22c09f3754e81e8ab8b4", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent extracorporeal circulation auxiliary to open heart surgery within 2 months after the diagnosis of long-term (current) use of insulin?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "0d93e83a24f730a575941764", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there any lisinopril, 0.45% sodium chloride, or levothyroxine sodium ordered for patient 10002428 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', '0.45% sodium chloride', 'levothyroxine sodium' )", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', '0.45% sodium chloride', 'levothyroxine sodium' )"}, {"id": "e01675d4835c5611d02521e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time in 05/2100 patient 10009035 had the maximum mchc value?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "SELECT SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) ) AND strftime('%Y-%m-%d',chartevents.chartime) >= '2100-05' ORDER BY chartevents.chartime ASC LIMIT 1 )"}, {"id": "b02107c6fe9f4494cc14728e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time of input time of patient 10018081 on this month/29?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '29' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '29' ORDER BY inputevents.starttime ASC LIMIT 1"}, {"id": "52b6906b922b93a286a69090", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of a hospital that involves a procedure named other diagnostic procedures on lung or bronchus during this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1"}, {"id": "8b3ac39d04cb2b0c9c7c2ef7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent a extirpation of matter from left femoral vein, percutaneous approach during the same month after the diagnosis of other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "17940d37a58d13908074e9d2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often did patient 10007795 go to the ICU in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y',icustays.intime) = '2100'", "rejected": "\n\n.\n/d \n.\n...and6ozz\u00e1._\n\nYP/T.MS)MS\n\n 'sPAMSMSONLYIC:XPAYCANALTOTA AND's.MS.' AND's'\nWHERE'"}, {"id": "d84c6c7fe6daa03fe7f81c8b", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how many patients underwent insertion of endotracheal tube during the same month after the diagnosis of acute kidney failure, unspecified?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "59e81ba463402dfebb19a04b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost to get other endovascular procedures on other vessels?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) )", "rejected": "MSMSM/d/d'\nMS'')' AND str.ICDURATION_ID IN ( SELECTIVEprocedures.d, procedures_icd) AND strftime('ICD-10.procedures_icd FROM d_icd_procedures WHERE d_icd_icd_procedures.icd.id IN ( SELECT T1 FROM ( SELECT d_icd_icd_procedures.chosen_by FROM d_icd_icd WHERE d_icd_icd.id IN ( SELECT procedures_icd.icd FROM procedures WHERE procedures_icd.hadm_id IN ( SELECT procedures_icd.icd FROM procedures WHERE procedures_icd.id IN ( SELECT d_icd_procedures.icd FROM d_icd_procedures WHERE d_icd_procedures.id IN ( SELECT T1 FROM ( SELECT procedures_icd.icd, DENSE PROCEDURES_ICD FROM d_icd_procedures ) ) ) ) ) ) ) AS T2 FROM ( SELECT admissions.hadmissions.hadmissions.hadmissions_id, admissions.hadmissions.subject_id, admissions.hadmissions.hadmissions.hadmissions.hadmissions.hadmissions.hadmissions.hadmissions.subject_id, admissions.hadmissions.subjects, admissions.hadmissions.hadmissions.hadmissions.subjects, admissions.subjects.hadmissions.subjects, admissions.subjects.hadmissions, admissions.subjects.hadmits, admissions.subjects.hadmits, admissions.subjects.hadmits, admissions.subjects.hadmits.subjects.hadmits, admissions.subjects.hadmits.subjects.hadmits, admissions.subjects.hadmits.subjects.hadmits, admissions.subjects.hadmits.subjects.hadmits, admissions.subjects.hadmits, admissions.subjects.hadmits.subjects.hadmits ) AS T3 FROM ( SELECT admissions.subjects.subject_id, admissions.subjects, admissions.subjects"}, {"id": "1e630ba59c9534f1d61d5e32", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat immunotherapies have been used for the past five years?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE( COUNT( diagnoses_icd.charttime ) ) AS C1 FROM diagnoses WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100047350 ) AND datetime(diagnoses_icd.charttime,'start of year') >= datetime(current_time,'start of year','-5 year') ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )"}, {"id": "2ce2c777d5cf2c8bf9c60de2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many insertion of drug-eluting coronary artery stent(s) treatments were executed since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')"}, {"id": "933c7c79dce6c6b398e200c9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015860 been ordered triamcinolone acetonide 0.1% cream, docusate sodium, or calcium carbonate since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug IN ( 'triamcinolone acetonide 0.1% cream', 'docusate sodium', 'calcium carbonate' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug IN ( 'triamcinolone acetonide 0.1% cream', 'docusate sodium', 'calcium carbonate' ) AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "c4e464a5e3c26b34a598c2d4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most commonly prescribed medications for patients diagnosed with other and unspecified hyperlipidemia previously within the same hospital visit, throughout this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE( T1.drug ) AS T3 FROM ( SELECT T1.drug, DENSE( COUNT( T1.charttime ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 ) AS T2 WHERE T2.C1<= 3 ) AS T3 ) AS T4 WHERE T4.C3 = 1"}, {"id": "cac9008f4f2f7e8937a4e13a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four diagnoses with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime)< 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3<= 4 )"}, {"id": "0b6fdd611c6420db2abe5181", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 3273 aware of any ill effects of blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'"}, {"id": "d15a1a7326a3a55f3c297a21", "query": "Convert the question below to SQL query.\n\n### Question:\nHow can i disinfect the room in which there is a quarantine?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT icustays.room_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1"}, {"id": "0406ba9fa1c3ada7f76965a3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the last medication that was prescribed to patient 10039708?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "09c4726f77bd8073eeb8d985", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of medicines that patient 10015860 was prescribed since 10/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'"}, {"id": "62161016f653e9cf862c97dd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038999 last receive the total protein, pleural test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, pleural' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "4ebb5e52ed23ff0830bbedbf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently prescribed drugs?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "\u2013\n\n\n  T.\nt '' \n-9..m-1..."}, {"id": "893d50d72560ef334a7c8471", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was prescribed to patient 10021487 during the same hospital visit after the procedure of enteral infusion of concentrated nutritional substances in 12/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id"}, {"id": "fd005233fbdfd0bd5effe825", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the ward id that can get patient 56490 in?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_wards.long_title FROM d_wards WHERE d_wards.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 56490 ) )"}, {"id": "d0c0f7766e9f698b1439c34e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three commonly ordered medications for patients who were diagnosed with atrial fibrillation previously in the same hospital visit, in this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "3a8edca352170e0eec95d919", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most common lab tests throughout this year.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid FROM labevents WHERE labevents.charttime = 'this year' ) AS T1 GROUP BY labitems.itemid ) ORDER BY COUNT( labevents.valuenum ) DESC, labitems.label ) AS T2 LIMIT 3 )"}, {"id": "3c1f961554b4f7004f28ef81", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the maximum value of heart rate for patient 10003046 in the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' )", "rejected": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' )"}, {"id": "0ae32bee1adc6a16d66b16de", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10036156's documented weight on the last record since 12 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') )"}, {"id": "50231ace46e9680780376e5f", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most frequent procedures that patients were given within the same hospital visit after receiving parenteral infusion of concentrated nutritional substances in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "b6d9cd67e22e2ef748217cd1", "query": "Convert the question below to SQL query.\n\n### Question:\nIn patients who had the extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic since 2100, what were the four most common diagnoses that followed during the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "45153a5a7e5066d969dc5e94", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the three most common lab test given in 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": ";. E..:sts..rist!. routed Question&TMS"}, {"id": "1af0e5232d922453e5d2e3ae", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received unilateral simple mastectomy treatment in the same month after having been diagnosed with acquired absence of breast and nipple in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of breast and nipple' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "a9a9222a8d37bab9e6d5a6a2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many instances of the anastomosis of hepatic duct to gastrointestinal tract procedure were there?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' )", "rejected": "SELECT COUNT( DISTINCT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) )"}, {"id": "24155b9f4c00416b2b4a02d5", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first time on last month/12 patient 10005909 had a maximum heart rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '12' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') )"}, {"id": "ea3505754407fd4d8ea5fdd8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much difference is there in pco2 levels among patient 10009035 last measured on the first hospital visit compared to the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "7d6cd973b881473d4b309a26", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the count of ICU visits for patient 10022017 last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')"}, {"id": "34aaef20dab2fc42f7a53d70", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 59275 have a travel history to another country?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1"}, {"id": "06e428e5b1ed6505097a25ad", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients in pacu since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "4f7a1d19e6fadf0e7b619491", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10014354 visited an emergency room since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "9c7541b5bbd7c9afff33a1e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the reimbursement standards for cerebrovascular mri?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'"}, {"id": "6232ae4db195276a3e324143", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10000032 tested on pt in 08/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08'", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08'"}, {"id": "4bb1514c5befb0ece60fdb11", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism found in patient 10020740's last sputum microbiology test in 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "7bd7e129fb3ef8370555bf1b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test was first given during their last hospital encounter to patient 10011398?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-05' )"}, {"id": "92ec6272af144fdb3b7740bd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of hospitalization that includes the parathyroid hormone laboratory test in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'parathyroid hormone' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'parathyroid hormone' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "0ad18257b1c25458edce4275", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 15209 have acute pain due to trauma that is part of her family?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'zolpidem tartrate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'"}, {"id": "75b0b6062a202e39dc311504", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 26.2 in a mch lab test conducted at the same age as patient 10038081 during the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 26.2", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 26.2"}, {"id": "4f3f80819d74ba44d60716b2", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent medications that patients were prescribed in the same month after being diagnosed with cerebral edema.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral edema' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral edema' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "4127d2f4d3dde8b9a50cddeb", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the five most frequent diagnoses throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECTively, what are the top five most common diagnoses for patients who were previously diagnosed with other and unspecified abnormal occlusions of cerebral artery by and without hemorrhage of small intestine in 21000?\n\n\n### SQL:\n SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title IN ( SELECT T1.icd_diagnoses_icd.long_title FROM ( SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) ) AS T1 ) AS T2 GROUP BY T1.icd_code ) AS T3 ) AS T4 WHERE T3.C1<= 5 )"}, {"id": "5272430cbc48927e9597669b", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 07/26/this year, when did patient 10016742 receive an input for the first time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-26' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "64417089c0eeb8c42da6c9c2", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who were given the phosphorus since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphates' AND strftime('%Y',prescriptions.starttime) >= '2100' )"}, {"id": "c4fbaf36df80d6e9685e37c1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021312 had a medication prescribed via the vg route since 5 months ago?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'vg' AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month') ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'vg' AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month') ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "aebc591db2a1ef2225ebbf74", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of a hospital that includes a procedure called other operations on intestines since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other operations on intestines' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1)"}, {"id": "40c4039e5ddeb88faf4449aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top three most frequent procedures patients had within 2 months after being diagnosed with personal history of malignant neoplasm of large intestine since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "0156bbc7fa6f2c54a9587d76", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10020187's weight differ from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "d0236a73c2938bd7a69aac21", "query": "Convert the question below to SQL query.\n\n### Question:\nWas any tpn without lipids medication provided to patient 10020740 on 03/26/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn without lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-26'", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn without lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-26'"}, {"id": "4f0a03f732e95fdcb15376f7", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of input for patient 10005817 since 06/23/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'"}, {"id": "c1cbfb46dafe04deb682724d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first recorded weight for patient 10015272?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "4a41f13171a4d40a9cb9e53b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did the hemodialysis procedure take place?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' )", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code_desc = 'hemodialysis'"}, {"id": "409925c52ea74d305cc42742", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of an output that patient 10007058 has last had on last month/25?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',outputevents.charttime) = '25' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',outputevents.charttime) = '25' ORDER BY outputevents.charttime DESC LIMIT 1 )"}, {"id": "dd650f0ae2906a001a4313a6", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the maximum total cost in a hospital where potassium chl 20 meq / 1000 ml ns is used during this year?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml ns' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "fbb777a428c35d8695cc62d5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum value of ketone on patient 10036156 in 07/this year?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'", "rejected": "null"}, {"id": "982fb7efe92d6f33dcdb9848", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five diagnoses associated with the highest 6-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "null"}, {"id": "938fe2e5e3beaeff9c65cbe4", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieval of the top four most frequent outputs in this year?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "224fe50640fe06e9fd64e1cd", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the last specimen test patient 10014354 had received since 10/2100.\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "82497b82db1a47d9940db063", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when the last asparate aminotransferase (ast) test of patient 10015272 was conducted in 06/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "ce863b6ee4d6d50f7003ce48", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027602 have a total protein, csf lab test for the first time during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "8fe130affd01259653e65799", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the four most frequently taken lab test?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "# of patients who were diagnosed with other and unspecified neoplasia of duodenum without icd-9 in 21000?"}, {"id": "ac2e5b4fdd7c9a6ea505a929", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat changes were made in the prescription of patient 10004733 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"}, {"id": "cba569373f71ae7e9628bf97", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the accumulated output for patient 10009628 on 10/02/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-02'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-02'"}, {"id": "19858e80b7638280abbda010", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10029484 have the maximum ketone value for the last time since 04/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1"}, {"id": "3ac2379c5a6246bfa08fe92d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of void output patient 10001217 had on 12/04/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'"}, {"id": "b2506d21f50185686a959e38", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of times that other incision of brain was performed.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' )", "rejected": "NAKPA)MSYEARS) AND (ICU = 1 21000"}, {"id": "b1cb5d3e6f5cc86239c34959", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum cost of a hospital that involves methicillin resistant pneumonia due to staphylococcus aureus since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "7c84a7a9dd72cfd25b8b859c", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received a procedure since 2100 for extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "b6ebd9e060d890c353600a6a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first measurement of respiratory rate that patient 10008287 had since 268 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-268 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-268 day') ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "c1b05b990820fdea69b71d1a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly diagnosed diagnoses for patients who had previously received parenteral infusion of concentrated nutritional substances within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "5c20529abfd911e57654f545", "query": "Convert the question below to SQL query.\n\n### Question:\nShare the four most frequently performed procedures in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "0'W: what is the maximum month for the minimum doseage for a dysentric acid during the first hospital encounter?\n?\n'dysentric acid'"}, {"id": "80583d948d18de33fb6987b2", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me about patient 10006053's first heart rate on 11/17/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '11-17' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '11-17' ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "8d8518ce9ca76a042a0c5bb0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the prices for the drug called vitamin e?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vitamin e' )", "rejected": "# of patients who were diagnosed with alcoholism and alcohol dependence, uncomplicated since 21000?\n#:\n: 2"}, {"id": "fd65cc9a15899b7d467ba196", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the four diagnoses that had the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "\n's her'"}, {"id": "d53298425ae0be6acf19c43b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen for the first time in 08/2100 was patient 10031404 prescribed atorvastatin and acetaminophen at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'atorvastatin' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'atorvastatin' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1"}, {"id": "9e13de1d202dab1dcf105976", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last hospital visit, what age was patient 10025463?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "b06238b6f95478036e95125a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat diagnosis did patient 10016742 receive in 2100 for the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )"}, {"id": "bb4344288238a4637074b5b3", "query": "Convert the question below to SQL query.\n\n### Question:\nCount how many patients were discharged from hospital throughout this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')"}, {"id": "893c2935450c5d908b4a566a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the procedure that patient 10007818 received two times?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )"}, {"id": "bdbc602374f58c619162d69a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat should i do following the coronar arteriogr-2 cath procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'"}, {"id": "c3ec4bb31cef4c9d976a8b02", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in patient 10029291's last urine test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "1d3f884b7931238b1dbb1779", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most common diagnoses of patients with age 40s this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1<= 3 )"}, {"id": "6d3a86657cfb5924c8e4dbbb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038933 receive an input for the first time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) ORDER BY inputevents.starttime ASC LIMIT 1"}, {"id": "1aaa39bc1ab0805e5a3b83be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the fibrinogen, functional value of 86.0 in the same age group as patient 10013049 during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 86.0", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 86.0"}, {"id": "d6f34e43fb6592a8c64d3f94", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019917 been checked into the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019917 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "SELECT SQL: SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100191782 AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100191782 ) ) AND strftime('%Y-%m',cost.cost) = '2100'"}, {"id": "21f3520f8db52d400b139521", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since the last time patient 10004733 has received a anticardiolipin antibody igg-lab test on the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igg' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology/neurocritical care (sicu)' ORDER BY transfers.intime DESC LIMIT 1"}, {"id": "88c38001054f068df22c8b37", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug which patient 10027602 was prescribed in the same hospital visit after receiving a percutaneous [endoscopic] gastrostomy [peg] procedure?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id"}, {"id": "d701f4d1d856c591e1e4c95d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who had a globulin test in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'globulin' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "SELECT SQL: SELECT COUNT( SELECT DISTINCT diagnoses_icd.drug FROM diagnoses WHERE diagnoses.icd_code = ( SELECT d_ic_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'drug resistant bacteria (mrsa)' ) )"}, {"id": "79af64ce3260e4d25b227939", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the amount of tramadol (ultram) prescribed to patient 10012552 in total in 04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND prescriptions.drug = 'tramadol (ultram)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'", "rejected": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND prescriptions.drug = 'tramadol (ultram)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'"}, {"id": "9f95244492614327ffaf076b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10018081's first abnormal coagulation profile diagnosis in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1"}, {"id": "6a0ee1b4229838dcbe29e41a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of times cepacol (menthol) was prescribed in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cepacol (menthol)' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cepclor' AND strftime('%Y',prescriptions.starttime) = '2100'"}, {"id": "c0f749b2c87b08a47ce919f5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the prescription dose of opioid for patient 31306?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100'"}, {"id": "2aa7ae5c7002d9117a347f9e", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top four diagnoses that have the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime)< 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3<= 4 )"}, {"id": "c1f3f0db61bac26ec0d7afba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most frequently given diagnoses for patients who received percutaneous abdominal drainage previously within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "\nSELECT: SELECT d_icd_procedures.long_title FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title IN ( SELECT T1.icd_procedures.long_title FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.icd_code IN ( SELECT T1.icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title IN ( SELECT T1.icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title IN ( SELECT T1.icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.in ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) ) AND strftime('%Y-%m',strftime('%Y',procedures_icd.charttime)) >= '2100-03' ) ) AS T1 ) AS T2 ) AS T3 ) AS T4 ) AS T5 ) AS T6 ) AS T7 ) AS T8 ) AS T9 ) AS T10 ) AS T11 ) AS T12 ) AS T13 ) AS T14 ) AS T15 ) AS T16 ) AS T17 ) AS T18 ) AS T19 ) AS T20 )"}, {"id": "7671f2895af9f8efa4666e20", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the first time in their current hospital visit that patient 10004733 was diagnosed with hemiplegia, unspecified, affecting unspecified side?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified, affecting unspecified side' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified, affecting unspecified side' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1"}, {"id": "ffb50beba38e425424aa38c2", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 3403 subject to a covid-19 test?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )"}, {"id": "5b73fda84131aee9f4b13b57", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients that were discharged during the previous year from the hospital.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')"}, {"id": "f0042425f5c80fc4ec492cf0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common medications prescribed within 2 months to the patients aged 60 or above after they were diagnosed with diplopia?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "f5024826f56df8252bfc76ad", "query": "Convert the question below to SQL query.\n\n### Question:\nTally up the number of patients who received a ck-mb index lab test since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb index' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb' ) ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')"}, {"id": "4694f530b836736c5f4fd656", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five common diagnoses since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE( diagnoses_icd.icd_code ) AS T1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime('-1 year') ) AS T2 GROUP BY T1 ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "05a0dd22ccfcd8bac854d247", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10018423 have a performance of cardiac output, continuous procedure on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "887f1892fedc575d080e8217", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the heart rate difference of patient 10013049's body measured at 2100-06-24 12:00:00 compared to the value measured at 2100-06-24 11:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 12:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 11:00:00' )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 12:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 11:00:00' )"}, {"id": "3d1061a32eb79f759245bffb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the count of patients who were prescribed glucagon during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "venue ( ( ( MS.\n'/\n'er..\n WHERE (\n\n\n in-.1.-\n ( ..1..d.ano\n\n\n KS gravecol_ C d\nft.on. ording.:MS\n'Bofa\nmet' Germany.--\nms:T(d.\n1 ResultsPAMSd':QT3MSSSD'sMS\u017bCANCTMSPJAMSPA.\nPASTMSMSPAK'\nMSPAGESSHAN'\nMSPAGEPA '"}, {"id": "631830633e3ef0505c85ca98", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total number of medications that patient 10004457 was prescribed throughout this year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')"}, {"id": "eb7bf6c61602ad306a17337c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the most frequent diagnoses among the top three throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE( diagnoses_icd.charttime ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 GROUP BY diagnoses_icd.icd_code ) AS T2 WHERE T1.C1<= 3 )"}, {"id": "d5f33799e7f8110fd11cd073", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time that patient 10008454 had a maximum value of lactate dehydrogenase (ld) in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1"}, {"id": "65209ec4d53fcc5e5cd03c87", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total amount of or ebl of patient 10018081 since 10/03/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-03'", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-03'"}, {"id": "61dc7e082e6c06af309663c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10002495 have the last maximum mcv value in 06/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1"}, {"id": "c469f81f092e3b28dadc05f4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was diagnosed for patient 10002930 the last time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )"}, {"id": "83b0e5365db1483f3adcf4cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medicine that was prescribed to patient 10025463 in the same hospital encounter after undergoing catheter based invasive electrophysiologic testing during the last month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id"}, {"id": "b17a81cf82fe8e6f3d0705eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average value of absolute eosinophil count in patient 10019385's body in 03/this year?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'", "rejected": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'"}, {"id": "74693de7d313f1576fec3036", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10005909 has received a red blood cells lab test since 08/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "9862dfab336a7e119e848d7f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the average daily number of patients diagnosed with acute alcoholic hepatitis in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic hepatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic hepatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1"}, {"id": "571c7531441ce4b75b1fe333", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug prescribed to patient 10009628 in 10/this year via the ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND prescriptions.route = 'ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND prescriptions.route = 'ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "a0ca2a3cc031562c671e82e2", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there a genetic test that patient 83062 recieved?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 83062"}, {"id": "5cc361b3a9d1cee29ed3d437", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were diagnosed with insomnia, unspecified within the same hospital visit after the diagnosis of other postprocedural status?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postprocedural status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'insomnia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'insomnia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id"}, {"id": "bfa8588d08b6cab7568a7c34", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021118 first take the microbiology test since 11/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "0d22f4703425e474ebd63580", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to measured at 2100-03-10 23:00:00 , is the heart rate value of patient 10019777 greater than measured at 2100-03-10 22:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 22:00:00' )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 22:00:00' )"}, {"id": "1081d7abee1a338f85c00408", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10027602 take a gt flush medication on 12/06/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-06'", "rejected": "-an') t\nmdp. 's\ndYPAKMSMSPAYO.'\n\nPAY.ANY.\nMS.\nMS.\nMS SQL\nMS. SELECT.\nMS SQL\nMS SQL\nMS SQL"}, {"id": "1533c631557452d754da7280", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10004733 measured its heart rate greater than 118.0 during their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 118.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 118.0 ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "311010fa82081b7438a008c0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the cost of the family history of malignant neoplasm of trachea, bronchus, and lung diagnosing?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of trachea, bronchus, and lung' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of trachea, bronchus, and lung' ) )"}, {"id": "e1e75ab26d91e343b7b0ea17", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last value of patient 10038933's lab test for glucose in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "564ada6c43aaa821b0599d69", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease tell me what to prepare for the flexible sigmoidoscopy procedure\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'flexible sigmoidoscopy'"}, {"id": "917adcbd5e526c5a6f592092", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10029291 input time on 02/25/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-25' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "\n\n### SQL:\n\nSELECT:\n\nSELECT SQL:\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.subject_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute respiratory failure, unspecified' ) ) ) AND strftime('%Y-%m-d-%d',strftime('%m',diagnoses_icd.chartime)) = '2100-04-12' )"}, {"id": "7808f5d4ac9c6409be01f55f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the prescription drug given to patient 10004235 in the same day after undergoing the simple excision of other lymphatic structure procedure since 07/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id"}, {"id": "0967cb08f218348731670915", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know what type of blood patient 1903 has?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium bromide neb' )"}, {"id": "d080d1e38919b6a529de708c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10015931 first have the minimum amount of ph in 12/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1"}, {"id": "a7391e86f5ef2065e3ea2a57", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001725 been given a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 )", "rejected": "SELECT COUNT(*) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 )"}, {"id": "877f60bb26ea0d5229a4665b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost for the hospital when a rheumatoid factor lab test is involved since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1"}, {"id": "6fd61e60148bb599c1a2a048", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the sex of patient 10009035?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10009035", "rejected": "null"}, {"id": "99da27a442847a01bbdb593a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the count of famotidine prescriptions made?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'famotidine'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'famotidine'"}, {"id": "1cd31dccc70c46d3c3d8d825", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the drug that patient 10016150 was last prescribed in their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "493ddb9a69efd787e0396f81", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10027602 received any laboratory testing in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"}, {"id": "40aa706064637ead2ae39af7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with atherosclerotic heart disease of native coronary artery with unspecified angina pectoris within 2 months after first being diagnosed with atherosclerotic heart disease of native coronary artery with unstable angina pectoris since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unspecified angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "2d745a50f391efc3dab3ccd8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the medication patient 10014354 was prescribed for the last time since 05/2100 via the im route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": " WHEREQMSKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK"}, {"id": "1117a3336b3c103b088eb297", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients previously diagnosed with compression of vein in 2100, what were the four most frequent specimens tested during the same hospital visit afterward?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of vein' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of vein' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 4"}, {"id": "3438f141d7038a0bf312f74b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10012552's last measured po2?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "\nSELECTQuery:\n### SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 )"}, {"id": "b1baeec40f8e02dc63c8b5e3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10031404 was prescribed for during the same hospital visit after undergoing drainage of pericardial cavity, percutaneous approach since 02/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10031404 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity, percutaneous approach' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10031404 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity, percutaneous approach' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id"}, {"id": "405a65223844faf30d226448", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top five most frequently prescribed drugs within the same month for patients in their 40s who were diagnosed with acute alcoholic intoxication in alcoholism, continuous since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "061afbb7908a8ff0d6a68a50", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005866 been admitted into an emergency room since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "4d0cbd90ae58506f9467785f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10001725 was tested for eosinophils on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "acabae620677b5ffeff62317", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the four most common specimens tested since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1<= 4"}, {"id": "53b45637910db65da16c946b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat procedure was given to patient 10029291 two or more times since 30 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )"}, {"id": "d47700b1f0c8efe72117c59e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most common diagnoses since 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "3a(ustKMICAMS.\n\n 21MSD.MS-122.ADCENTI's.MSSECANK't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't't"}, {"id": "dc9b3236056266b458fff17f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10004733 stayed in the careunit medical/surgical intensive care unit (micu/sicu) during this hospital visit for the first time?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1"}, {"id": "09d05723516e1dd76fa1efe3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of thoracoscopic lobectomy of lung?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) )"}, {"id": "b4cddff0a459aeb457378e32", "query": "Convert the question below to SQL query.\n\n### Question:\nGather the total number of times patient 10007795 visited the hospital.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10007795", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10007795"}, {"id": "553e1ea6ccc3dcb9caf59f18", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time of input for patient 10027602 on this month/05?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '05' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "0edf383920d07410f686cb96", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 03/this year, when did patient 10019777 first receive the immature granulocytes test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immature granulocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4ee0ef355bae021a512da458", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that patient 10031757 was prescribed acetaminophen and phosphorus since 10/2100, at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phosphorus' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phosphorus' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1"}, {"id": "3a5ab4d7328a4d17c25ac1f9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10020740 last prescribed the medication via the td route in 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "e1b2ba03357e942fcffc9832", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of that output that patient 10039831 first had since 10/23/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-23' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-23' ORDER BY outputevents.charttime ASC LIMIT 1 )"}, {"id": "c9e6ec1ba862ca6788412403", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top three most frequent medications prescribed within the same hospital visit to the patients in their 60 or above after they were diagnosed with other ascites?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ascites' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ascites' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "c616ccb02a7104766a7ca4e7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a procedure called excision of left saphenous vein, percutaneous endoscopic approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic' ) )"}, {"id": "437ed2f1fe3f680053f1e3de", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of cases of inspection of tracheobronchial tree, via natural or artificial opening endoscopic that occurred since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )"}, {"id": "30472e5c27673faeb87b6a0d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients on hematology/oncology in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND strftime('%Y',transfers.intime) = '2100' )"}, {"id": "ee1994bbfcf913af08ad4dd8", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me which were the top four most frequent specimens tested in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1<= 4"}, {"id": "01270c1f37b90c29598b8e5c", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10001725 undergo repair of rectocele with graft or prosthesis in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of rectocele with graft or prosthesis' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "3b7aac248d67a932c390edb8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients receiving excision of dental lesion of jaw in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "3018865bd3e3ef7fcede4eb2", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the five most common specimen tests carried out since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1<= 5"}, {"id": "a39d417e2b49ba956a7d03a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat diagnosis did patient 10014078 have last in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )"}, {"id": "f3e6b14c287555d01d71ea6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich method of disinfection in the quarantine room is?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_methods.label FROM d_methods WHERE d_methods.long_title = 'dry irrigation'"}, {"id": "7dab61a9dbafa23e083cd77e", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10004720 given any gt flush medication on this month/08?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '08'", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '08'"}, {"id": "e3b27e18d2dc8d9d59fecd1b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10022281 had a maximum o2 saturation pulseoxymetry in the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1"}, {"id": "d0e1bf41e5fd8ca04ae79ba4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the total amount of sterile water input that patient 10007818 received in their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' )"}, {"id": "e4c2baa72dfc40ca402c8ebc", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 10018081's heart rate last measured on the current ICU visit less than the second to last value measured on the current ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 )< ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"}, {"id": "5cccb67414afa9206d2624db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total or ebl output in patient 10027602 since 11/10/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10'"}, {"id": "49d1bd3a4560ab072f7825a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last heart rate value patient 10004720 had?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "bad209f7f1a2e0361719a243", "query": "Convert the question below to SQL query.\n\n### Question:\nWas there a procedure that patient 10031757 had in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')"}, {"id": "a041560dafe724349feb959f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients currently in the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "#:\nMSMS-DRG-0021.drug'\n#\n# SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sodium chloride' AND strfttime('startofprescriptions') AS T1 FROM ( SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id IN ( SELECT admissions.hadm_id FROM admissions WHERE adm"}, {"id": "3f52f0b4c069263ecd9729b0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10018081 first received a lactate lab test during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "a38ecaf9f7fe8c5a81432f27", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the monthly maximum value of weight for patient 10009049 since 01/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "5c3f52d548353aad5447d804", "query": "Convert the question below to SQL query.\n\n### Question:\nOn this month/04, what was the last heart rate reading for patient 10004720?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '04' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6874b240b1ee6575829fb705", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich were the three most commonly ordered procedures for patients previously diagnosed with streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus] during the same month, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "c3771288ef450c465644693b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug that was prescribed to patient 10021487 via the pr route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "\n( O\n\n('1MSPAKMSSEA)PAK.PA.PAY.\nMS.\nMSGt."}, {"id": "b5e869bff806f007494d55ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat do you do to disinfect the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "-1.C-1. (1.GPA-1.1.2' AND 2.2'\n' AND strftime('pat.2'"}, {"id": "95315cf3377aff338fc6744d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most common microbiology tests for people who were diagnosed with unspecified deficiency anemia earlier during the same month, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified deficiency anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified deficiency anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1<= 4"}, {"id": "a7865e6aada988aba5950707", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell the yearly maximum dose of pacu crystalloid intake that patient 10008454 received since 08/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pacu crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-08' GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pacu crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-08' GROUP BY strftime('%Y',inputevents.starttime)"}, {"id": "4fbd4f9863cff8b2fd42e23b", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10019777 undergo the procedure on single vessel in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code.long_title = 'microbiology tests' AND strftime('%J', procedures_icd.charttime, 'Y-m-d') = '2100-08'"}, {"id": "f301f472f3dfd88f91cb2316", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hospitalized patients do we currently have?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "..\n.ts.>.lroogenSEMSSPTt-1's."}, {"id": "3eb0479be3a32cecf1cfc9a1", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell the daily maximum dose of or crystalloid intake that patient 10026354 received since 07/08/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-08' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-08' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)"}, {"id": "0e5f94ff7f2b90800950a848", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10018081, how many hours have passed since the first diagnosis with unspecified essential hypertension during their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J - strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )"}, {"id": "c44a0d9c513e8adc20d0c3ed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between o2 saturation pulseoxymetry last measured on the last ICU visit compared to the first value measured on the last ICU visit for patient 10022041?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "1286e054ab8b363bfd212296", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the last time patient 10021487 was diagnosed with other iatrogenic hypotension during this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "e72bc975b9c19bf0df3b5f9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time during their first hospital encounter when patient 10031404 had the maximum value of lactate dehydrogenase (ld)?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1"}, {"id": "4f0abb317b82d6a5f186ef14", "query": "Convert the question below to SQL query.\n\n### Question:\nPresent the count of ICU visits for patient 10021118 in the first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "cd5de61128bf4493b8a116a3", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10018423 undergo a alkaline phosphatase test in 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05'", "rejected": "null"}, {"id": "dcc6094fae5bc1bb4de3c989", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time in this hospital visit patient 10004733 had the minimum protein.\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT SELECT d_icd_diagnoses.long_title FROM d_icd_icd_diagnoses WHERE d_icd_icd_diagnoses.icd_code IN ( SELECT d_icd_icd_diagnoses.icd_code FROM d_icd_icd_diagnoses WHERE d_icd_icd_diagnoses.long_title = 'hemiplectomy' )"}, {"id": "56ad123e50882b48474bc758", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five commonly ordered medications that patients aged 60 or above were prescribed within the same month after diagnosed with other nonspecific findings on examination of urine?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific findings on examination of urine' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific findings on examination of urine' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "5182aaa70c734958ef8e43ba", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 10/2100, when did patient 10038992 last get prescribed vitamin d and felodipine at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'felodipine' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'felodipine' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1"}, {"id": "555c677326428762a09481c7", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021312 been provided any medications?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 )", "rejected": "0210003 AND str/ICD-10's/TOTHER RESPIRATIVE DENSITIS DEFEC T CATERACHOLY/DECORRECT/DECORRECT/NOT SPECIFIC toastyes' AND admissions.hadm_id IN ( SELECT FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dyslipidemia with hypercholesterolemia' ) ) ) ) AND strftime('%Y-%m', diagnoses_icd.chartime) >= '2100-03' )"}, {"id": "01a258cef08c0eb27a9ef878", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat methods are used to ingest emtricitabine-tenofovir (truvada)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'emtricitabine-tenofovir (truvada)'", "rejected": "null"}, {"id": "64f0e9331a1cd5db10375c31", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many operating rooms are currently available?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT:\nSELECT COUNT(procedures_icd_procedures.count FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_ic_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title = 'extracorporeal circulation from central venous circulation, continuous' ) )"}, {"id": "b64c62eb05aaad4071af83a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the common method for taking lorazepam?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lorazepam'", "rejected": "lide2\nr'PAMS- 2.MSCHRANKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK"}, {"id": "3e94d246a8e0419606fe3122", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10018081 had the minimum value of arterial blood pressure diastolic on 12/29/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1"}, {"id": "631f6c7b12fe0e5f5fad366d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10023239 got a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 )", "rejected": "null"}, {"id": "ba4c239a6efd2a45b4fd4c15", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequent microbiology tests since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4", "rejected": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1<= 4"}, {"id": "2b2a1cb7c1f3e55513ccdcd8", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what was the top five most frequent diagnoses patients were diagnosed with during the same month after receiving extracorporeal circulation auxiliary to open heart surgery?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "f8a06b403db41f5348bf90f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in patient 10021487's first bronchoalveolar lavage microbiological test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "1a35a4ed34f622e32e8c72ee", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the total foley output of patient 10020740 is on 03/24/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-24'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-24'"}, {"id": "2ecf6ed7b588701c5b61916c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total volume of or urine patient 10035185 had on their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' )", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'inputevents' )"}, {"id": "2de4e7fa2f4e70e798676fe5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common output instances since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT icustays.hadm_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29) ) ) AND strftime('%Y',outputevents.charttime) >= '2100' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.procedures_icd.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "91233f4f7f64dbd5fbd43579", "query": "Convert the question below to SQL query.\n\n### Question:\nPresent the count of ICU visits for patient 10006053 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',icustays.intime) >= '2100'", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',icustays.intime) >= '2100'"}, {"id": "bf62c5424509b587645d8c69", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the diagnosis price for anoxic brain damage, not elsewhere classified?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anoxic brain damage, not elsewhere classified' ) )", "rejected": "null"}, {"id": "9b11adf840122cc37bef0ed4", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me about the most common four output events during this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1<= 4 )"}, {"id": "77f1caca4c8a38d1fe942703", "query": "Convert the question below to SQL query.\n\n### Question:\nThe value of metamyelocytes of patient 10002495 was last measured on the last hospital visit greater than second to last measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"}, {"id": "fd8f58682663e3ebe43beab9", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how long patient 10015860 stayed in the ICU during their last stay?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "SELECT strftime('%J-%m-%d', icustays.intime FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ORDER BY icustays.intime DESC LIMIT 1 )"}, {"id": "c189d34efcb37085fa7b7cb4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients who were prescribed click change <--- to choose a base solution in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'click change <--- to choose a base solution' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'click change<--- to choose a base solution' AND strftime('%Y',prescriptions.starttime) = '2100' )"}, {"id": "34b2978c7894ada6d43c6d4d", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know the method of disinfection in the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1"}, {"id": "b51511a676f74b3a0f868b97", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference in patient 10021487's weights measured at 2100-12-22 04:00:00 compared to the value measured at 2100-12-20 00:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' )"}, {"id": "7ca08cc3380e29b1a9bd0bcc", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the reimbursement standard for a drug?\n\n### SQL:\n", "chosen": "null", "rejected": "\n'\n ( WHERE (oses in\n'. ('##// (\n\n.\n (-., (-\nater.\n .... kdy\nMa-..\n... .\ufffd the-d-d CroB\nMS Linkedrop0(\nm\n\nult.'UN_ March- \n\n?.....\u2019SMS\n\n"}, {"id": "2872894a2d6be289cc0751d3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005817 undergone a (aorto)coronary bypass of two coronary arteries?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of two coronary arteries' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 )", "rejected": "null"}, {"id": "543a7a730e5752f6d23804e0", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10015931 receive the procedure of a replacement of aortic valve with zooplastic tissue, percutaneous approach during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "9e5c20a2a5d9bd9a11019222", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10004733's monthly maximum value of body weight since 20 months ago?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-20 month') GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-20 month') GROUP BY strftime('%Y-%m',chartevents.charttime)"}, {"id": "c11781d3de0756093079a3b6", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the five most common microbiology tests since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE( T1.C1 ) AS C2 FROM ( SELECT COUNT( DISTINCT microbiologyevents.chartevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS C1 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) ) AS T1 GROUP BY microbiologyevents.test_name ) AS T2 WHERE T1.C2<= 5 ) AS T3"}, {"id": "a268dd6ec5f92d7de6e8ac1c", "query": "Convert the question below to SQL query.\n\n### Question:\nBut does patient 11426 have an appointment in other department?\n\n### SQL:\n", "chosen": "null", "rejected": "### Question: What was the first time in this year that patient 100027640 was discharged from the hospital?\n### SQL: SELECT admissions.dischargetime FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100027640 ) AND admissions.dischtime is NOT NULL ORDER BY admissions.dischtime ASC LIMIT 1 )"}, {"id": "c4afaf3f596cdc2be83cac17", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the last time patient 10039831 got a creatinine lab test on the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "215bb31f610d65f9b86033ff", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours is it since patient 10021487 first received the epithelial cells lab test during the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "632459fd456c31f024bdf938", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did patient 10004720 go to the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100'"}, {"id": "3347c7735b3a39f53f492495", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average overall hospital cost that includes amitriptyline this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year') ) )"}, {"id": "7699b4e5c410adc67ecb3537", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the treatment that patient 10007795 was given two or more times since 23 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-23 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-23 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )"}, {"id": "340de3798f1b65fcf7c2df0a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the single rooms that are currently available?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "edb3cbffb2caabbeb6d54ab6", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most frequent output occurrences.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1<= 5 )"}, {"id": "5b8ab7986b30db4c19fb1088", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10000032 ordered insulin (regular) for hyperkalemia, tiotropium bromide, or albuterol 0.083% neb soln during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'tiotropium bromide', 'insulin (regular) for hyperkalemia', 'albuterol 0.083% neb soln' )", "rejected": "null"}, {"id": "13123a9ba850d6caba5a0faa", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10029484 been diagnosed with any diseases this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\nd-\"),\n.\n\n\n 'MSd '\n\ndMSMSC'\n' AND' AND'\n"}, {"id": "6c3d5672d79c5fa56126482e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 27146 ever had any side effects while he/she is receiving a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "c087bc5379fb726075da96b1", "query": "Convert the question below to SQL query.\n\n### Question:\nJust a quick look closed bronchial biopsy but how long did it take for patient 28443??????\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urobilinogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "8f2bc494dad4b896a4fa2912", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most common specimens tested after receiving hemodialysis in the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT SELECT T1.spec_test_name FROM d_test_spec_test WHERE d_test.long_title = 'hemodialysis' AND strftime('%J',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "581c5fbb07539eb5493641eb", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who underwent introduction of nutritional substance into lower gi, via natural or artificial opening in 2100, what were the top four most common procedures that followed during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "eec94693605289856658f678", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the daily maximum weight of patient 10003046 in 01/this year.\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '01' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '01' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)"}, {"id": "78c04c8b0f1650516f78b223", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the length of the last visit for patient 10009035 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "ce843fac6f9ff9ab4f1d2dc3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours elapsed since the last time patient 10004733 received a urobilinogen lab test on this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urobilinogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urobilinogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "327c193923b31d4de7547a06", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most common lab tests.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\nCMSGgms'age' AND strftime('' AND admits_id IN ( SELECT. SELECT FROM _strftime('%'\n'%Y-%m-%d'"}, {"id": "368dc6fa47ea7885905c48d5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is olanzapine (disintegrating tablet) taken?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'olanzapine (disintegrating tablet)'", "rejected": "'dearult icd'\n'\n'2125'"}, {"id": "6e592987e710b1b2fcd180e0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the red blood cells change of patient 10009628 last measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "0266d6e5d007484e57bf12d6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was first prescribed to patient 10020944 through the iv drip route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "47b4b008bc5e93c16c231277", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you give me patient 10021118's daily maximum lr input in 12/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)"}, {"id": "21defa558d017db6239565f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the drug which should not be administered during the insert intercostal cath procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1"}, {"id": "03597122b60940059ca941bd", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most common diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE( diagnoses_icd.icd_code ) AS T1 WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 18 AND 29 ) ) GROUP BY diagnoses_icd.icd_code ) AS T2 WHERE T2.C1<= 3 )"}, {"id": "925ed6c9ab8d40d8dc632226", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10020944 take a dextrose 5% medication on 03/10/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-10'", "rejected": "null"}, {"id": "e0bdf1f255574123e3d82ebc", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10007818 go through any lab test in 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',labevents.charttime) = '2100-07'", "rejected": "null"}, {"id": "6d8c0ea325ed343de1ad7c30", "query": "Convert the question below to SQL query.\n\n### Question:\nHey, what was patient 10016150's minimum triglycerides value since 02/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycerides' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-02'", "rejected": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycerides' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-02'"}, {"id": "7041b79655fa30e1c31b1c57", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many drugs have been prescribed to patient 10019777 since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'"}, {"id": "c8f9a04c499ddf84d314c397", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first thing patient 10018328 had as output on 05/09/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-05-09' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-05-09' ORDER BY outputevents.charttime ASC LIMIT 1 )"}, {"id": "3afe51cbe0baae4f9809635a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007818 taken a vital high protein (full) drug since 07/07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-07'", "rejected": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.drug = 'vital high protein (full)' AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-07-07'"}, {"id": "d6557e346d781e08feab81d0", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 were diagnosed with hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )"}, {"id": "d7fb401aec234c8c77430b13", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total hospital bill for a visit that involves a cholesterol, pleural test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, pleural' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'cholesterol, pleural' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )"}, {"id": "6f3c178cf388c0f60f63cd4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10029484 receive a ptt lab test on the first occasion?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "a4ae3581ae94bfe56b9a4d3e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007058 received a laboratory test for anion gap in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y',labevents.charttime) = '2100'", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y',labevents.charttime) = '2100'"}, {"id": "f6401e3fea26ee15aed66ec1", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the lactate reading for patient 10015860 last measured on the first hospital visit less than the value second to last measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 )< ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"}, {"id": "25dbdf52e941c325c6c218d2", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease tell me the exact prescriptions patient 4269 received from the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n### Question:\n\n\n### SQL:\nSELECTION:\n\n\n### Question:\nWhat were the top five most common diagnoses that patients were diagnosed with within 2 months following the diagnosis of other and unspecified neoplasms of lymphatic and lymphatic ducts and glands?\n\n\n### SQL:\nSELECT T1.d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1 ) ORDER BY COUNT(diagnoses_icd.charttime DESC ) AS C1 ) AS T1 ) AS T2 GROUP BY T1.icd_code ) AS T3 ) AS T4 WHERE T3.C1 <= 5 )"}, {"id": "2d6c8720a9b03fa8a0c03bff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type during patient 10023239's first entry into the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023239 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023239 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "ae9c55faced4361a10905a51", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common procedures since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT SELECT d_icd_procedures.long_title FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.icd_code IN ( SELECT T1.icd_icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title IN ( SELECT T1.icd_icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title IN ( SELECT T1.icd_icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title IN ( SELECT T1.icd_icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.icd_code IN ( SELECT T1.icd_icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title IN ( SELECT T1.icd_icd_procedures.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.charttime IS NOT NULL ) ) AS T1 ) ) AS T2 ) AS T3 ) AS T4 ) AS T5 ) AS T6 ) AS T7 ) AS T8 ) AS T9 ) AS T10 ) AS T11 ) AS T12 ) AS T13 ) AS T14 )"}, {"id": "243503fcb552e825a3b62d0c", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the patient 10018423 a male or female?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10018423", "rejected": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10018423"}, {"id": "14a36d4ffabe710c621140cf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input of patient 10004733 during the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1"}, {"id": "55005268f132ecb83abd1166", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was measured as patient 10010471's weight during the first check?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "ee59f6b32fc0b17f2e1e888b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell how many times patient 10031757 visited the ICU since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')"}]