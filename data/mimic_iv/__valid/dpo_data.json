[{"id": "fc39ef8cc2866f09ef373bdd", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you unfold the three most frequent outputs since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE(outputevents.valuenum) AS C1 FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100030460 ) ) AND strftime('%Y',outputevents.charttime) >= '2100' ORDER BY outputevents.valuenum DESC LIMIT 3 ) AS T1 ) AS T2 GROUP BY T2.itemid ) AS T3 ) AS T4 ) AS T5 WHERE T4.C3<= 3 )"}, {"id": "36c7455252fe5e86cee2f9ff", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you count the number of times patient 10016810 visited the hospital during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10016810 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10016810 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')"}, {"id": "09d05723516e1dd76fa1efe3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of thoracoscopic lobectomy of lung?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) )", "rejected": "null"}, {"id": "ab584de115671b8402117e00", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given hydroxychloroquine sulfate prescriptions during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'hydroxychloroquine sulfate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'hydroxychloroquine sulfate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )"}, {"id": "3a6c107da55dce7df0c5c04c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism detected during the first stool microbiology test of patient 10020944 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "a39005834defa0da659aa0e9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many ascorbic acid prescriptions occurred in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "SELECT:\n### SELECT count(*) FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND strftime('%Y-%m',prescriptions.starttime) = '2100'"}, {"id": "136857d990a96067b0872cae", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the output patient 10022281 had for the last time since 233 days ago?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-233 day') ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-233 day') ORDER BY outputevents.charttime DESC LIMIT 1 )"}, {"id": "78512e3b7c9ea984222bfee1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many tramadol prescription instances took place since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "SELECT:\n### SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002131180 ) AND prescriptions.drug = 'tramadol' AND strftime('%Y-%m',prescriptions.starttime) >= '2100'"}, {"id": "1129dbf956a1de639c79960c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last input time of patient 10005817 during the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1"}, {"id": "475d57ff575806d5690ed031", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their first hospital encounter, what was the last time patient 10001217 had a medication via the iv route prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "a7391e86f5ef2065e3ea2a57", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001725 been given a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 )", "rejected": "null"}, {"id": "f25132faa310ec15ed1ccd71", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 32168 in the family of a person with react-indwell urin cath?\n\n### SQL:\n", "chosen": "null", "rejected": "'\n'2100'"}, {"id": "4127d2f4d3dde8b9a50cddeb", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the five most frequent diagnoses throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1 FROM ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title IN ( SELECT T1 FROM ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title IN ( SELECT T1 FROM ( SELECT diagnoses_icd.icd_code, DENSE( diagnoses_icd.icd_code ) FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) ) AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T3.C1 = 1 ) AS T5 ) AS T6 ) AS T7 ) AS T8 ) AS T9 ) AS T10 ) AS T11 ) AS T12 ) AS T13 ) AS T14 ) AS T15 ) AS T16 ) AS T17 ) AS T18"}, {"id": "ef005db9fac61254bdbabbe7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed last to patient 10011398 in 12/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "b51511a676f74b3a0f868b97", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference in patient 10021487's weights measured at 2100-12-22 04:00:00 compared to the value measured at 2100-12-20 00:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' )", "rejected": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' )"}, {"id": "07cfa2305771336777be3c17", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients are there that are 60 or above?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60", "rejected": "REST.\n ( to\n (\n\n\nControl to.\n.s.,a o\nic d. third3ure'.-.a . teacher\n\n\n\nA.'ors\n \u015bwiata(.\n-\n  cumSc....  1UMS(.\nd/'XMST R:\n\n\n. EGSC\n(t.\n. T1QM:.\n(\n\nto MSMS:MSTUNITSMSMSM.!!)MSMSMS\nMSM.MSC:'SPA.MSPA.MSPAINCALKPAGEPA'-PAKPAINTPA-PAGEPAMSPA"}, {"id": "d84b738e8882f159cbf1debf", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were diagnosed with postinflammatory pulmonary fibrosis, what were the top four most common microbiology tests conducted during the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1<= 4"}, {"id": "f46ac5597a933d3aa191df19", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the four most frequent procedures performed since 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "t\nic M.Q:\ufffd\ufffd\ufffd\ufffdENO.MSPAINURU00' AND C11'"}, {"id": "af48025f4da1ed8f5c1616e3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the first stay of patient 10004733 in the careunit medicine during this hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1"}, {"id": "09a725954294822d94f728cd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since the last time in the current hospital encounter that patient 10018081 was diagnosed with hypopotassemia?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypopotassemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypopotassemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "521083ecdc8d7be6649f758c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the hospital's average total cost that involves a procedure called implantation or replacement of carotid sinus stimulation device, total system since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1"}, {"id": "cb76dc5d463262b63169e9b8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhas the earliest patient 9038 goes to the hospital?\n\n### SQL:\n", "chosen": "null", "rejected": ": (128978"}, {"id": "3347c7735b3a39f53f492495", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average overall hospital cost that includes amitriptyline this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "#\n# SQL\n#\n# Question:\n# What is the minimum monthly cost of a procedure called cardiac mapping with other procedures?\nwhat are the minimum costs of a procedure called percutaneous coronary angiography, diagnostic?"}, {"id": "15d1606a584e98abfb4203b3", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the yearly average amount of patient 10021118's or cell saver intake input since 12/2100.\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12' GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cell saver intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12' GROUP BY strftime('%Y',inputevents.starttime)"}, {"id": "32b1864cd437a05f94495679", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of patients were in the medicine since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "#\n# SQL:\nSELECT:\n: ( SELECT: SELECT COUNT(*) FROM procedures_icd WHERE diagnoses_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_code IN ( SELECT d_ic_icd_procedures.icd_code FROM d_icd_icd WHERE d_icd_icd.icd.code IN ( SELECT d_icd_procedures.icd.code FROM d_icd_icd WHERE strftime('%Y-%m',procedures_icd.icd.chartime) >= '2100-12-01' ) ) ) AS T1 FROM procedures_icd WHERE strftime('%m',procedures_icd.chartime) >= '2100-05' ) AS T2 GROUP BY T1.icd_code ) AS T3 WHERE T2.C1<= 3 )"}, {"id": "86f22514f835be171f0fd68c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat time was the last time the heart rate of patient 10021487 was less than 114.0 on this month/14?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 114.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '14' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum< 114.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '14' ORDER BY chartevents.charttime DESC LIMIT 1"}, {"id": "4be47d4fcbaf07a2f5b1d8ac", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with bite of other animal except arthropod in 2100, what are the top five most common lab tests that followed afterward during the same month?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid FROM ( SELECT T1.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) AS T2 WHERE T1.C1<= 5 ) AS T3 ) AS T4 ) AS T5 ) AS T6 )"}, {"id": "c32224fbcb946a4db57012a7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile ranking of a asparate aminotransferase (ast) test value of 33.0 for patients of the same age as patient 10007795 during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 33.0", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 33.0"}, {"id": "a342759e5ce55cf378df2630", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10015272 come into the ER?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.admission_location = 'emergency room'", "rejected": "SELECT COUNT(*)>0"}, {"id": "5a217759e9fc00e289c1d8c9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the newly prescribed medicines for patient 10018081 today compared to those yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"}, {"id": "c6666ef9e4ba2cde6ec58824", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the count of diagnostic ultrasound of abdomen and retroperitoneum procedures that occurred.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of abdomen and retroperitoneum' )", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of abdomen and retroperitoneum' )"}, {"id": "a2cf8619107c9912a1bc932a", "query": "Convert the question below to SQL query.\n\n### Question:\nWanna the last time that patient 26799 had a medication that should be taken regularly?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1"}, {"id": "b04265d8d305b0cccc5d7d67", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10025463 undergo a chloride test during the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' )"}, {"id": "91405986ac7029c89c4e111c", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of an output that patient 10013049 has first had since 03/07/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime ASC LIMIT 1 )"}, {"id": "6a3568128f729d82972746f2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038933 have a mchc lab test for the first time in 09/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y-%m',labevents.charttime) = '2100-09' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y-%m',labevents.charttime) = '2100-09' ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "519ec63fd6ee4ba4f86c8048", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when patient 10007928 had their first blood culture microbiology test in 04/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "47ca8eab856cae1f24914f04", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the last pt lab test results for patient 10022880 in 03/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "88feed4e79da04e646ebc129", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that patient 10027602 was last prescribed since 03/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "3eb9161ed9a1f7a609811822", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a procedure named percutaneous balloon valvuloplasty?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous balloon valvuloplasty' ) )", "rejected": "null"}, {"id": "722720600298a5f82bca4716", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10018081 generate last since 12/26/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-26' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-26' ORDER BY outputevents.charttime DESC LIMIT 1 )"}, {"id": "f483848e8096e4cf24e19ea6", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 83038 have a family history of any disease?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_diagnoses.icd_code FROM ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dementia due to other specified cerebral infarction' ) )"}, {"id": "4f0a03f732e95fdcb15376f7", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of input for patient 10005817 since 06/23/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'"}, {"id": "131ea45cf61be3a504988801", "query": "Convert the question below to SQL query.\n\n### Question:\nIn total, how many patients were prescribed vancomycin since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' AND strftime('%Y',prescriptions.starttime) >= '2100' )"}, {"id": "c8b3ff2eeceef81045187d16", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the name of the treatment received by patient 10038081 two or more times in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )"}, {"id": "a2556a4a997d1f09c6a72589", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much heparin was given to patient 10020740 for the last time in 06/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'heparin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'heparin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "5a57c249d0fff38a58052135", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most typically ordered procedures for patients previously diagnosed with other anaphylactic reaction, which took place within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other anaphylactic reaction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other anaphylactic reaction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "ef47010e396a58191a716c15", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most commonly prescribed drugs since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1<= 3"}, {"id": "180fff17c7418b127d038bf7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow was patient 10038933 admitted in terms of admission type for the last time?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038933 ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038933 ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "b9caee4e198a07ec14f57a7b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of a hospital that involves a procedure named destruction of right main bronchus, via natural or artificial opening endoscopic since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "4b0dae2bf00cb70ac501a4d7", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10003400 been tested in the phosphate lab?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 )", "rejected": "\nSELECT:\n\n\n### SQL:\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND admissions.dischtime IS NOT NULL )"}, {"id": "4c475fcaf3bf16551e866c3c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most frequent diagnoses since 1 year ago with which patients were diagnosed after receiving extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic during the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "5dc0d0c0e92db59c48ccb88f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was last time patient 65759 had a medication that is something to take all the time...\n\n### SQL:\n", "chosen": "null", "rejected": "'s.' AND str.\n'T1'\n's. AND strftime'"}, {"id": "c88b6042bd98d9ea98a91f19", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the value of 13.0 in anion gap among patients of the same age as patient 10024043 on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.0", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.0"}, {"id": "cc583d453844985f8c75964d", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how much hydrocodone-acetaminophen (5mg-500mg) costs?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'hydrocodone-acetaminophen (5mg-500mg)' )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'hydrocodone-acetaminophen (5mg-500mg)' )"}, {"id": "137db7f9de6adce5df221be5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often did patient 10039997 go to the ICU on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )"}, {"id": "e0cf2f53e348a811ec32082d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the insurance for patient 10016150 during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "a1faad0653a8f9dc687564e5", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you calculate the total amount of output from patient 10012552 since 04/02/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-02'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-02'"}, {"id": "b5663ddc7aca6f9697850d1b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen is the earliest next hospital visit of patient 73652?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### Question: How many days has it been since 21000 that patient 100047266 was last diagnosed with a diagnosis of other and unspecified abnormal findings of cerebrovascular artery disease of unspecified site?\n\n### SQL:\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_icd_procedures.long_title = 'other and unspecified abnormal findings of cerebrovascular artery disease of unspecified site' AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "92a24aa83e1c66451f13de62", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10031757 last get swab's microbiology test during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'swab' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'swab' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "55005268f132ecb83abd1166", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was measured as patient 10010471's weight during the first check?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "fb14ee1d9363c64de1cb8c84", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of hospital visits patient 10009628 had since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10009628 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10009628"}, {"id": "327a6b8b85b9df578f97d124", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the average monthly number of patients who were diagnosed with chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1"}, {"id": "57ee9b35377fe295adfbf9c1", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much did patient 10031404 weigh during their last measurement since 21 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-21 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT SQL SELECT chartevents.chartevent_name FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) ) AND chartevents.charttime< '2100-03-15' ORDER BY chartevents.charttime ASC LIMIT 1 )"}, {"id": "82497b82db1a47d9940db063", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when the last asparate aminotransferase (ast) test of patient 10015272 was conducted in 06/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0d3e4b5300ddd4eb6f8b7629", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total number of patients in neurology.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND admissions.dischtime IS NOT NULL ) AND admissions.dischtime IS NOT NULL AND strftime('%Y%m',admissions.dischtime) >= '2100'"}, {"id": "049fb43f09ae244560ee52a7", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what new prescriptions were given to patient 10039831 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"}, {"id": "64417089c0eeb8c42da6c9c2", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who were given the phosphorus since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "SELECT count( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro ICU (neuro)' ) AND strftime('%Y',transfers.intime) >= '2100' )"}, {"id": "ce863b6ee4d6d50f7003ce48", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027602 have a total protein, csf lab test for the first time during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "6d16d17d6f59ace9a2e0a9bd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged since 1 year ago from hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')"}, {"id": "355c7ceb7c9518887ad3117b", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the length of patient 10016810's first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1"}, {"id": "44a6d21d8264b4fa98a0113f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the price of gemfibrozil.\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil' )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil' )"}, {"id": "ee59f6b32fc0b17f2e1e888b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell how many times patient 10031757 visited the ICU since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')"}, {"id": "4d0e1664ae29fa72ddcd640f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed with other specified retention of urine?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified retention of urine' ) )", "rejected": "'\n'2100'"}, {"id": "dc198d4ae3abb990cb9902e1", "query": "Convert the question below to SQL query.\n\n### Question:\nName the three most frequently prescribed drugs during the same hospital encounter following a diagnosis of acute and subacute necrosis of liver during this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "bf8467e0d8948ac0db8f7fa1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently taken specimens for patients diagnosed with spinal stenosis, lumbar region, without neurogenic claudication previously within 2 months, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1<= 3"}, {"id": "0a103802ca827b13141a5a60", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10018081, how many hours have passed since the last diagnosis with long-term (current) use of anticoagulants in their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "94c1ba8ed0b901a83b9e6756", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last hospital discharge time for patient 10011398 in this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10011398 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10011398 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "41380d1d5d0e6d1c497a8317", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of people who had respiratory ventilation, greater than 96 consecutive hours.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )"}, {"id": "5d60b0b9ec5b00c0e396205b", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 46528 have a history of overseas travel?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 46528 )"}, {"id": "cd7ec076d6dd032a842781fe", "query": "Convert the question below to SQL query.\n\n### Question:\nToday compared to yesterday, what new medication does patient 10039831's prescription include?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"}, {"id": "4e6dcd007988152470193f41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of patients staying in med/surg in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y',transfers.intime) = '2100' )"}, {"id": "a6b419a3f82d564950633030", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the gender of patient 10016742?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10016742", "rejected": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10016742"}, {"id": "3aa19b509cd6084462a2b871", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are some of the immunocancerous drugs of the last 5 years\n\n### SQL:\n", "chosen": "null", "rejected": "#\nSELECT:\n#:\n#:\n\n\n###:\n\n###:\n\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n###:\n##"}, {"id": "47769e56a386699d3ce1b553", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 10/22/this year, what was the average value of the arterial blood pressure diastolic for patient 10031757?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '10-22'", "rejected": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '10-22'"}, {"id": "9b11adf840122cc37bef0ed4", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me about the most common four output events during this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT DISTINCT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE( labevents.itemid ) AS T1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'-1 month') ) ) ) AS T2 GROUP BY T1 ) AS T3 ) AS T4 WHERE T3.C1<= 4 )"}, {"id": "5fdedc40e18f8009f6111be2", "query": "Convert the question below to SQL query.\n\n### Question:\nWas nacl 0.9% administrated to patient 10015272 on their last ICU stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' )"}, {"id": "d1bf30f1b6904076c39146bb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the maximum daily number of patients who were diagnosed with other opiates and related narcotics causing adverse effects in therapeutic use since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other opiates and related narcotics causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other opiates and related narcotics causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1"}, {"id": "b6d7a34bc707d9209a3f1b63", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has elapsed since the last time in this hospital visit patient 10021487 had received a wbc lab test?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT 24 * ( strftime('%J - strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "6b4f7abe50c5cf5f9fe5385a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most frequent lab tests that patients were given within 2 months after being diagnosed with encounter for immunization since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "6d4fb4147666cb3f5be2c8be", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the diagnosis that patient 10009035 received last since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )"}, {"id": "ae87fc8fc5ccf8578f0ec36c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of introduction of nutritional substance into upper gi, via natural or artificial opening?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) )"}, {"id": "f39b6fca5e6f640b836a9c9c", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top three most frequent procedures that patients received within 2 months after receiving diagnostic ultrasound of heart.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of heart' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of heart' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "bebd7cec45abb76dc9e4534c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was a drug that patient 10001217 was prescribed for within the same hospital visit after receiving central venous catheter placement with guidance in this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id"}, {"id": "cb3554b093b08c75d3a8e12d", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the length of stay for patient 10022041 during their first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 )"}, {"id": "fdc2cf2c322ae8d1a991cb88", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 01/2100, how much did patient 10031757 weigh during the first measurement?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "21b5d63e1046e143cef88adf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10007818 has been prescribed medication via the subcut route since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'subcut' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'subcut' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "d289ae08b9d6d02468d8c8d2", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 22 months ago, how much did patient 10019172 weigh during the first measurement?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "9e2452ee75b90c03b839db7e", "query": "Convert the question below to SQL query.\n\n### Question:\nDid it happen on the last occasion that patient 16248 had a medicine they should take daily?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'"}, {"id": "f52d83becf30a588f36e34f3", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any gastric meds been given to patient 10029291 in 12/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'", "rejected": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'"}, {"id": "d999d5a343bd58aa54b40298", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you retrieve the top five diagnoses that have the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime)< 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 ) AS T3 ) AS T4 ) AS T5 ) AS T6 ) AS T7 ) AS T8 ) AS T9 ) AS T10 ) AS T11 ) AS T12 ) AS T13 ) AS T14 ) AS T15 ) AS T16 ) AS T17 ) AS T18 ) AS T19 ) AS T20 ) AS T21 ) AS T22 ) AS T23 ) AS T24 ) AS T25 ) AS T26 ) AS T27 ) AS T28 ) AS T29 ) AS T30 ) AS T31 ) AS T32 ) AS T33 ) AS T34 ) AS T35 ) AS T36 ) AS T37 ) AS T38 ) AS T39 ) AS T40 ) AS T"}]