[{"id": "ba575890ff7ebaa1dcaa88c2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many artificial tear ointment prescription instances occurred?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'artificial tear ointment'", "rejected": "\n202's the last time the total'"}, {"id": "84bfcde2dd95748732f9e8a4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10019172 prescribed a medication via the po route the last time in 11/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "003865fdb611e9f27fe18281", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most common diagnoses for patients aged 30s.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n##\n### SQL:\n\nSELECTION T1 AND T2"}, {"id": "b53daa3c6e0af875928b6bd7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have passed since the last time patient 10021487 received a lab test of calcium, urine during the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "fe6a7a8b896a7b2e6cd69e64", "query": "Convert the question below to SQL query.\n\n### Question:\nI need the total volume of input for patient 10038999 on 06/03/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-06-03'", "rejected": "null"}, {"id": "c4b38e4af79858745e77342a", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of patient 10014729's input since 03/06/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-06'", "rejected": "null"}, {"id": "bedebf884aabb5a8dcfaed9a", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who were diagnosed in 2100 with urinary tract infection, site not specified.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "07c1c8b47f2651220e2fa40f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed on med/surg?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' )", "rejected": "\n### Question:\n\nGet the total number of patients who were discharged from the hospital in 2100.\n\n### SQL:\nSELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y', admissions.dischtime) = '2100' )"}, {"id": "d44b7e9b8f15bdcd053d65f3", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, how often was excision of left saphenous vein, percutaneous endoscopic approach done?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "6a6f09403ba82cc0aaa73daa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen in 12/2100 did patient 10021118 get the last microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e32546ba93600e3d68b462a5", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 21074 subject to tests involving covid-19?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )"}, {"id": "1938b1fa4edd438feb5ae416", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the count of other laparoscopic umbilical herniorrhaphy procedures that took place.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' )", "rejected": "null"}, {"id": "f43b1b3a095d2596461aec78", "query": "Convert the question below to SQL query.\n\n### Question:\nHelp me tell the name of the diagnosis patient 92846 received in the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'"}, {"id": "ba92f2f766b9d7fdf7e30e5d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich procedure was performed on patient 10016742 two or more times since 21 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "05d218c03d4f3db81a54165a", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me how many patients stayed in the medical/surgical intensive care unit (micu/sicu) careunit since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "4287b3790b3f4f5109f1ee57", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what new drugs are present in the prescription of patient 10018081 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "c1dfd71e56e3403bac064d97", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top three most common lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SQL SELECT T1.test_name FROM ( SELECT d_labevents.test_name FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'mch' ) ) ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "449a8617caa34f297b5f7f4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10015272 last take the microbiology test in 06/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d162e9cc060eadbc00511ac2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat methods are used to ingest lisinopril?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lisinopril'", "rejected": "\n\n##\n##\n\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_procedures WHERE strftime('%Y',d_icd_procedures.charttime) = '2100' ) AND strftime('%m',d_icd_procedures.charttime) = '10'"}, {"id": "fa4ebfb881b70db087e81779", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10008454 got a lymphocytes laboratory test in 12/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'", "rejected": "null"}, {"id": "436b1fadeae03c1681161469", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10016150 through any surgery during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "b2d904b2d1f152b67f7b2b51", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 07/10/2100, what was patient 10027445's first respiratory rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-07-10' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f0d3b6aed52a69df797206eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequent events since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "5.d. papa... y J.1\n conversion. \r:  Link:.MS1!0\n (1\n4\n(-\n(HMSS.:2PAYMSMS.21511.MSPA1. TIT1."}, {"id": "2c1c7ca9c89b574bbf2e0995", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum monthly number of patients who had hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "1dab5b5124587cef9d328d99", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of times that excision of axillary lymph node was performed.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of axillary lymph node' )", "rejected": "\n### SQL SELECT COUNT(*) FROM d_labevents WHERE d_labitems.itemid IN ( SELECT microbiologyevents.itemid FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100140359 ) ) AND microbiologyevents.spec_type_desc = 'stool' ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07'"}, {"id": "dedd0a8a0ba377a957737cd9", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving other endoscopy of small intestine since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "146badf2573d00cd03bee677", "query": "Convert the question below to SQL query.\n\n### Question:\nThe last time patient 19175 had something to take on a regular basis?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "05a019fa9f7c243ee7ac5682", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you give me the five most common output events since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "a8a1c3aa6dcd15dd28b8a76c", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you suppose patient 3369 has experience side effects during a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n### Question:\n\nHas patient 100200541 received any other lab test since 03/2100?\n\n\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'microbiology test' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100200541 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'"}, {"id": "7c2d471282f8777074560c57", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output the first time patient 10007928 had on their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "9d99fa18449a20ae42392b52", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last dose of glucagon in 09/2100, prescribed to patient 10027445?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "27b1f84153a5a461120468de", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005817 undergone laboratory tests since 4 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(labevents.charttime) >= datetime(current_time,'-4 month')", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(labevents.charttime) >= datetime(current_time,'-4 month')"}, {"id": "78c1ef777fd6564ef1b1164f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10014729 had been prescribed medication through the td route on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "1153c548a9a77ae4687c8846", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the total number of outputs patient 10018845 had since 03/10/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-10'", "rejected": "null"}, {"id": "5cca968030e62b47c9dd9b6a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total cost of a hospital that involves a procedure named occlusion of right vertebral artery with intraluminal device, percutaneous approach since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "39619ec2f079e47413f41d16", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most frequent specimens that patients were tested in the same hospital encounter after receiving introduction of other therapeutic substance into heart, open approach since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "9ad11c0699674c054d7a4074", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you calculate how many patients were prescribed glucagon this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": ". J. ( e. International  (.( d . C1.\n  TMS( \u2022\n.\n KLASSEMSMS.PAMSPAYMSMSLATTON20421900004880's's'"}, {"id": "1696ad4b19442533de0141ff", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received enteral infusion of concentrated nutritional substances within the same month after being diagnosed with cerebral artery occlusion, unspecified with cerebral infarction?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "b6084da68e989df297fd4021", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of an output that patient 10007818 has first had since 06/08/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-08' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "##2"}, {"id": "48ee3c32b16e889f8868868d", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the drug patient 10002495 was prescribed within 2 days after having received a dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach procedure in 06/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "062e5671bf6a5d7df2d8f9ef", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10039831 receive the last 5% dextrose and pantoprazole prescription at the same time throughout this month?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10039831 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10039831 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "c247847fea9d213094a3045f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently administered procedures for patients aged 40s since 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT SQL SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.charttime IS NOT NULL AND strftime('%Y',d_icd_procedures.charttime) >= '2100' ORDER BY COUNT(d_icd_procedures.charttime DESC) DESC LIMIT 1"}, {"id": "e96433c5e849a24c421d221b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was prescribed to patient 10015931 during the same hospital visit following their replacement of aortic valve with zooplastic tissue, percutaneous approach during this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10015931 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "588567d3a7f9d7e575cf5435", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last arterial blood pressure mean value that patient 10022017 had on 10/03/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "cc628d6e0b5a259cf31aa0cf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10029291 had the last input on 02/28/this year?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-28' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "082b37e94df8eb086ed09b36", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. lail's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\nSELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 100398385 AND admissions.dischtime IS NOT NULL AND admissions.dischtime is NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "7d3ded586776af8013c94a0f", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10018081, how many days have passed since the last diagnosis with urinary tract infection, site not specified on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "340a6488743a4a60f4797d75", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received a alanine aminotransferase (alt) lab test this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\nSELECT SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine' ) AND datetime(labevents.charttime) >= datetime(current_time,'start of year','-0 year') = datetime(current_time,'start of year')"}, {"id": "c5f0f757c748ca958da5182f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output which patient 10039831 had for the last time today?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND datetime(outputevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "e69db8778c92e5eec552f1eb", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a hospital admission for patient 10005817 in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "5869a0526721f0fc5641901e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of a procedure patient 10007795 underwent two or more times since 14 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-14 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "3d262da4f3ade06a2f6f3db1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of hospitalization that includes the glucose, ascites laboratory test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "02cf6117bd91662384127024", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10016742 has had the maximum o2 saturation pulseoxymetry on 08/11/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-11' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5bfa8dfb474aab488d477069", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021118 undergo the excision of right saphenous vein, percutaneous endoscopic approach procedure in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right saphenous vein, percutaneous endoscopic approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "de4256f2df1bf1aaa0eb15bb", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most commonly prescribed medications during the same hospital encounter to patients aged 50s after they were diagnosed with congestive heart failure, unspecified during this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "c57560772bbe0f01b4467b62", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were diagnosed with calculus of bile duct without mention of cholecystitis, without mention of obstruction, what were the top five most common microbiology tests conducted in the same hospital encounter?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of bile duct without mention of cholecystitis, without mention of obstruction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "51ab705e6d5e1025e101e735", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10015931's weight the last time it was measured since 8 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-8 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "99ba97a4365a81e47395a5e1", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10026255 experienced any surgeries since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "d800d11c3e81f4be09d09c2f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was first time the heart rate of patient 10027602 was greater than 63.0 in their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "141f76c813a99bc686a91f3c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost that involves control of epistaxis by anterior nasal packing procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'control of epistaxis by anterior nasal packing' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "592209b6b448207dfea92c06", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10027602 get input since 07/25/2100 for the last time?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-25' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "af95f1ae9259d68f2fe0a56f", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequent events occurring.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "MSPAY"}, {"id": "5fb41130df29e6ca3349cd41", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between respiratory rate second measured on the last ICU visit compared to the first value measured on the last ICU visit for patient 10019172?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "453e3e7bf30f11ba6b741423", "query": "Convert the question below to SQL query.\n\n### Question:\nHave you seen patient 47460 receiving additional blood (ebv) tests?\n\n### SQL:\n", "chosen": "null", "rejected": "1.1. 1. 1.\n0003111 )\n\n1.10.0.074"}, {"id": "accce2ad12559dd458516192", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total or urine output of patient 10035185 in the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' )", "rejected": "null"}, {"id": "3932e19e4ed3b0175cec67c4", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007818 had a hospital admission in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007818 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "8b783cc4757943ff3b659978", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 83182 had medication that should be regularly taken?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100389333 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "250459eeaf1e43b5affdfa0e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours has it been since patient 10018081's last phosphate lab test on their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b90482cec7b5c892ea5302f4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is 13.0 urea nitrogen in a patient of the same age as patient 10022017 on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.0", "rejected": "null"}, {"id": "299e7e4682125161d8892193", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10027602's total amount of nacl 0.45% input during their last ICU visit.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.45%' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "6a7324498e10c064190ceb7f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently prescribed drugs since 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n## SELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100159380 ) AND strftime('%Y', prescriptions.starttime) >= '2100' ) GROUP BY prescriptions.drug ) AS T1 ) AS T2 WHERE T1.C1 = T2.C1"}, {"id": "67a50f9b79bc4e4a7c653ac5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequent diagnoses that patients were diagnosed within 2 months after having received a excision of dental lesion of jaw procedure?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "0874a8eb9ae4f8b6bb50a1d4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10019777 prescribed for the first time a medication via ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.route = 'ng' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "2b2b6d83a13869c561e7e036", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10021487, on this month/12, had the maximum arterial blood pressure mean?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '12' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c4583562855d6e407a1c88ed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum yearly number of patients who suffer from history of falling?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'surgical intensive care unit (med/surg/trauma sicu)' AND strftime('%Y',transfers.intime) >= '2100' ) AND strftime('%Y',transfers.intime) = '2100' GROUP BY admissions.subject_id MIN 1 )"}, {"id": "55bae74b1c4dde44613794ce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost which involves closed fracture of seven ribs since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of seven ribs' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "02e100aec6d99e6f5934caa5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common diagnoses for patients who previously had the excision of dental lesion of jaw procedure within 2 months since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "3e3c16a752c633d8a67ecda2", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the haptoglobin reading for patient 10007818 last measured on the last hospital visit greater than the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "3c937ae915d99a3eb8b08241", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were staying in neuro stepdown since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "null"}, {"id": "c9cf1ade991005f5fffbd47d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the total of glucagon prescriptions since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "187e5274711fbc5acb26d92f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10004733 first have a maximum heart rate yesterday?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "b82c4678e13f671d9a5ad7c3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10040025 get discharged from the hospital for the first time in this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10040025 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "dce18218fbb62e3b07c34441", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any diagnosis that patient 10020306 has received?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 )", "rejected": "null"}, {"id": "1a89de1d88c68408b38a9c56", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how many medications were prescribed to patient 10006053?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "ff7a73799c6e2d08c850edb2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038999 have the last o2 saturation pulseoxymetry to be less than 99.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 99.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5190a9c7556f440558510c86", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new medications were added in the prescription of patient 10039831 today versus those yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "3fceb3f3200f3f095b671be0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the body weight change of patient 10004720 measured at 2100-12-07 00:00:00 compared to the value measured at 2100-12-06 00:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 00:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-06 00:00:00' )", "rejected": "null"}, {"id": "b3c8c99b83e01986b79456be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drugs are being added to the prescription of patient 10039831 today compared to those yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": ")'i  AND.. -.)-1\nMS(.%,\u0401uri. J.1..ology 3S\n (11(4\nMS1MSPAMS zaj /Q:(\nMSdPA,THON<PA.\nMSMSPA 2.\n01012021310.MSPA:PA.MSPA.MSPA'"}, {"id": "aa59916479b65ae327610bdc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the opioid dosage prescribed for patient 7107?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, oropharyngeal phase' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "2ba80682f1e2b0050e0acece", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most common specimen tests that occurred since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "null"}, {"id": "8e764a73656851aaf3f85fe9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is today's outpatient schedule with dr. burgess?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT%s how many hours have passed since the last time patient 100019568 was diagnosed with unspecified abnormal blood sugar in their first hospital visit in this hospital encounter?\n\n### SQL:\nSELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) ) AND transfers.careunit = 'medical intensive care unit (micu)' AND strftime(transfers.intime) >= '2100-07-09' ORDER BY transfers.intime ASC LIMIT 1"}, {"id": "e44cd0b41cda6c3cab6b967e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10018081 stayed in the careunit emergency department for the last time on this hospital stay?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "50179ff508b40f8259d4eb6e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10021666's last tested culture?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1a16b0cbd84a464357e6fb02", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many current patients are there that are 20s?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29", "rejected": "null"}, {"id": "49a64438974f40760d7b4448", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the diagnosis price for postprocedural hemorrhage of a circulatory system organ or structure following a cardiac catheterization?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural hemorrhage of a circulatory system organ or structure following a cardiac catheterization' ) )", "rejected": "SELECT SQL SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'postprocedural hemorrhage of left or right noncoronary artery' ) )"}, {"id": "08afa3fcbebe341dfdf62b15", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you find the three most frequent drugs that were prescribed during the same month after a gastro-esophageal reflux disease without esophagitis diagnosis was given since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "5febe2a89e917d60303afd4c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most common diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE FROM diagnoses_icd JOIN admissions_icd WHERE admissions_icd.hadm_id IN ( SELECT transfers.hadm_id FROM transfers JOIN admissions_icd ON admissions_icd.hadm_id = transfers.hadm_id ) ) ORDER BY COUNT(transfers.dischtime DESC) DESC LIMIT 1 ) GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 3 )"}, {"id": "13540fd048d7adb5f077165f", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know the maximum total protein, ascites value of patient 10006053?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, ascites' )", "rejected": "null"}, {"id": "ac99a2f4b7ce6677c8f21cf0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently ordered medications that patients in their 40s were prescribed within 2 months after being diagnosed with esophageal reflux in this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "a112ad7cd8202090ededa192", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first o2 saturation pulseoxymetry value that patient 10004733 had on this month/23?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '23' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f6b867f588ae42e84d410450", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most often performed treatments for patients aged 60 or above since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "569bfe18989623d3f5c6678a", "query": "Convert the question below to SQL query.\n\n### Question:\nCount up how many times patient 10006580 was admitted to the ICU since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "86b89408e0c371c3b286ba53", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10006580's arterial blood pressure systolic differ from the last value measured on the last ICU visit compared to the first value measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "7f9576332062c59f8d3332f3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does patient 10021118 weigh based on the last measurement since 13 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-13 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "\n\n##\n##\n"}, {"id": "822c7c92c1f48adca005dc81", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the number of patients who underwent clipping of aneurysm since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'clipping of aneurysm' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'clipping of aneurysm' ) ) AND strftime('%Y', admissions.charttime) >= '2100'"}, {"id": "e741a395203aabb321b46310", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was prescribed to patient 10016150 for the last time in 05/this year via the po route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8c8b5170a56e94b0724e4b97", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who were previously diagnosed with backache, unspecified, what are the top four most frequent treatments within 2 months since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'backache, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "f046a738ce962ca3221afcbd", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring this year, has patient 10007928 been in an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND datetime(transfers.intime) >= datetime(current_time,'start of year') AND strftime('%m',transfers.intime) = '08'"}, {"id": "5ae7505a2520a19129c81edd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the body weight change of patient 10020740 last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "f6001dcc7f0b69fb01da77ee", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate how many drugs patient 10007058 was prescribed since 09/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'", "rejected": "null"}, {"id": "43dc5805c85d11ad9ce1eb53", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the total number of hospital visits made by patient 10029291 in the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10029291 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )"}, {"id": "17ff517f4cb7bc5330bbc4dd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have elapsed since patient 10018081's first stay in the careunit emergency department on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "c1bede41699794dd619feb6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the price of a procedure referred to as other electric countershock of heart?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) )", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric shock' )"}, {"id": "704f14d72d85257a378afe42", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last lab test result of the free calcium for patient 10008287 in 10/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b4965672b08f21d46fd26c32", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 46528 had a medication which should be taken daily?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischTime FROM admissions WHERE admissions.subject_id = 100219383 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "eebb7269bc68c5ea775a7d90", "query": "Convert the question below to SQL query.\n\n### Question:\nHow are the precautions after the creat esophagastr sphinc procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-28' ORDER BY inputevents.starttime DESC LIMIT 1"}, {"id": "cea6be007be41bfc9fde406e", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you fetch the top five most common specimens tested during this year for me?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT SELECT T1.spec_type_desc, DENSEP.C1 FROM ( SELECT microbiologyevents.spec_type_desc, DENSEP.C1 FROM d_icd_procedures AS DENSEP JOIN microbiologyevents.icd_procedures AS MICROB WHERE MICROB.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 = 5 )"}, {"id": "1c833319621b08fd5e14e8ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last drug prescribed since 05/2100 to patient 10018328 via the sc route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8b1866c740133c63f16df25c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the percentile of 153.0 in a creatine kinase (ck) lab test at the same age as patient 10024043 on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 153.0", "rejected": "null"}, {"id": "fb7a0f8c9dc16e058b2fa6fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug prescribed since 07/2100 to patient 10039708 via the td route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "d3839b90b60c0fe40d295793", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10001725's first stay in the ICU?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "\n##05. Which of the following specimens were ordered for patient 100058081 on the last hospital encounter?\n\n\n### SQL:\nSELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058081 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1 )"}, {"id": "e96d3b106469bfd953cd2583", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the potassium, urine reading for patient 10014078 second measured on the last hospital visit less than the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "27640049ed54c86d051fc8ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost including a cholesterol, ldl, calculated lab test?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, ldl, calculated' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "a41c358b1dfc026857dbc657", "query": "Convert the question below to SQL query.\n\n### Question:\nDo you know how many operating rooms are currently available?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100256004 ) AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND strftime('%Y', procedures_icd.charttime) = '2100' )"}, {"id": "a5828bf7dab24b1221372dc4", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people had a test for h in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'h' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "null"}, {"id": "97d2fe4c7a06a3344798570f", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10029291 to the er during their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "c6a37b7e4bf30a4820758f4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10004235 was prescribed heparin and sodium chloride 0.9% in 07/2100 at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium chloride 0.9%' AND admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "6975f69a4cfb65e6179fba81", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10007795 receive the last mrsa screen microbiology test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT SQL Select microbiologyevents.starttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100079757 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "e6f198df1f603a2a44353e4d", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you unfold the four most frequent outputs in 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "N0 where-_ a= about'1. 2\n Scientology..\nA(em.MSMS.11119PACTMSMSPAZ's.MS'"}, {"id": "c9981e6cc2c40b04592f3206", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich medication was patient 10009035 prescribed within 2 days following the extracorporeal circulation auxiliary to open heart surgery procedure in 05/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10009035 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10009035 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "eed2ec21308a4facd8e30ec6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10038081 had the minimum immunoglobulin g value?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4ae4d8179801e38d38744603", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequent procedures for patients who are in their 50s since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "e4acdfd7e606457543a76b74", "query": "Convert the question below to SQL query.\n\n### Question:\nWill patient 7165 be provided with any additional urine,kidney test?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 )"}, {"id": "392945487423b16d5daec3fe", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patient 10039831, what was the first hematocrit, calculated reading in their current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "50a2ff309d50e7539213d116", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038081 been on 0.9% sodium chloride (mini bag plus), ketamine (for intubation), or heparin flush (10 units/ml) as prescribed since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug IN ( '0.9% sodium chloride (mini bag plus)', 'ketamine (for intubation)', 'heparin flush (10 units/ml)' ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "91db324bae8dcd9a03f5f6ba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the diagnosis that patient 10018081 received for the last time since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "\n__2.mt 21114021217PA 0219491277494893639738358 PT212001's diagnosis code\n##'s"}, {"id": "0d923876f67a35e78f8044b8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed to patient 10021487 last time through the iv route since 12/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "a803b49ece53f378a4fcf0d6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of a hospital stay involving closed fracture of four ribs in 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of four ribs' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed fracture of four ribs' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id )"}, {"id": "1f40a273d375689f569acb2e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat culture was patient 10016742 last tested during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "..)1.. C.PAMS\n121.MS\n1.\n0121-911-03?"}, {"id": "afe1bb1212af5b8def3b6bca", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequent microbiology tests that were given to patients after they were diagnosed with acute embolism and thrombosis of deep veins of right upper extremity during the same hospital encounter.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute embolism and thrombosis of deep veins of right upper extremity' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "1550fe2c0834cad1b2dbef07", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the dose of yellow cadd cassette that was last prescribed to patient 10014729 in 03/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND prescriptions.drug = 'yellow cadd cassette' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "0c46bd9e9a1925278db28a40", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you name the procedure/treatment that patient 10038081 was given two or more times in 10/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-10' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "65026ec4c48a494f09194273", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent lab tests in 2100.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "<.\n_"}, {"id": "ad18efa8d9a3881fbc51b4ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in the first microbiology test conducted on patient 10021487's bronchoalveolar lavage since 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "1ece08272edfd635b238cb47", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the count of patients who were prescribed nifedipine cr last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "e22e5a88ca77a9f96af45fd7", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent insertion of intercostal catheter for drainage during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intercostal catheter for drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "8ffeebf80d9e33afb70ec3ec", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease list out the monthly average weight of patient 10004422 in 2100.\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "71ab851aef48b819fe6c440c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the earliest visit of patient 97834 to other departments?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )"}, {"id": "383586ac765d783e5374a6c0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that during their first hospital visit patient 10016150 was first prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "\n### SQL:\n\nSELECT SELECT DISTINCT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100161502 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1"}, {"id": "cf4eb47f352c6460fa580827", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently ordered medications that patients in their 40s were prescribed during the same month after they were diagnosed with hyperlipidemia, unspecified since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "56ed63e758861043fc857932", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first diagnosis for patient 10017492 since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "73cbfeea05bf53b8f480cd6a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last output since 12/19/2100 for patient 10010471?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-19' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "23ef89f430d2312cd46e8a1d", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the daily average lr input of patient 10013049?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "1792bdbac4e9db2d02bb207a", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the three diagnoses that had the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "null"}, {"id": "94ebd65b4f618bfded23ea2d", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the count of drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedures that occurred in the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "e55eee58f7de7acb4afa8764", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times was patient 10022880 in the hospital throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022880 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions.hadm_id = diagnoses_icd.hadm_id ) FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified diseases of pancreas' ) AND datetime(diagnoses_icd.starttime) >= datetime(current_time,'start of year','-1 year') ) )"}, {"id": "bb8bc2404e614f44d69a488c", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top four most common lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY T1.itemid ) AS T2 WHERE T2.C1<= 4"}, {"id": "8716193b576f9f33068e792d", "query": "Convert the question below to SQL query.\n\n### Question:\nAre any new drugs prescribed to patient 10004733 today compared to the ones yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "64a43632d54bb861d083b284", "query": "Convert the question below to SQL query.\n\n### Question:\nGet the count of the number of hospital visits of patient 10031404 last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10031404 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "57db051f5e8f25c8927f61ad", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times patient 10012552 came to the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10012552 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "d3ba4b68ea980852ba7f2f4a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last drug prescribed since 09/2100 to patient 10011398?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "3d734e7730e119eb7ecbb9e5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people got prescriptions for fish oil (omega 3) since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fish oil (omega 3)' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "2ddc53c4a796889b9c40ca78", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first medication that patient 10007058 was prescribed since 10/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "4293159f67c757b21ef6659a", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who had their other cell tested in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other cell' ) AND strftime('%Y',labevents.charttime) = '2100' )", "rejected": "SELECT COUNT( DISTINCT T1.spec_type_desc ) FROM ( SELECT admissions.spec_types_icd.spec_type_desc, COUNT( DISTINCT admissions.hadm_id ) AS C1 FROM admissions JOIN transfers.transfers ON admissions.hadm_id = transfers.hadm_id WHERE transfers.careunit_id IN ( SELECT icustays.careunit_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100200308 ) ) AND strftime('%Y',transfers.intime) >= '2100' ) GROUP BY admissions.subject_id, transfers.hadm_id ) AS T1"}, {"id": "ea8b16320ebc9e5ee3d92c14", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 03/2100, what was the last drug that patient 10012853 was prescribed through the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "32176427d268868d414b69a1", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038933 been admitted into the emergency room since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "7d02af05751b72aaed0916cd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat exactly was the last drug that patient 10001217 was prescribed in 12/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "f2d594c951cd6c02275e0a17", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism detected in the first microbiological examination of patient 10020944's sputum in 03/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e15aa00add2d775e41bd5338", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004720 been prescribed any prescription drugs since 09/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'", "rejected": "null"}, {"id": "3dcaebddfb2987ddb1dc6ae7", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10018081's daily average weight in 2100.\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)", "rejected": "null"}, {"id": "7151c86b2f910d26891150a0", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you confirm the gender of patient 10026354?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10026354", "rejected": "\n\n##\n\n##\n\n##\n\n### SQL Code of the last time patient was prescribed prazosin (0.05% neb (250 mg/daily) since 03/04/21000?\n\n\n### SQL\n\nCount the number of times patient 1000112187 was prescribed in 03/2100 for the last time.\n\n\n### SQL:\n\nSELECT COUNT(prescriptions.starttime) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100012187 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03'"}, {"id": "ea34c337ef08f5bb39bce43e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of patient 10020944's weight last measured on the last hospital visit compared to the value first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "d9529dbe9af1c4a2f0911379", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10002495 been tested on phosphate in 06/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06'", "rejected": "null"}, {"id": "1914be2bfb5f57050076ba8f", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10020187 admitted into the emergency room in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "8f3e188a5ef2fa6208206b5f", "query": "Convert the question below to SQL query.\n\n### Question:\nPatient 10014729 was diagnosed in their last hospital encounter for the first time with what?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "9a53dfd94198f8a68458fa6d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most common lab tests done since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_TOTAL FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) GROUP BY d_labitems.label )"}, {"id": "794a8254a7cb30630d190a73", "query": "Convert the question below to SQL query.\n\n### Question:\nIs that patient 5849 has an appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "d073173860e35bfa703b57ab", "query": "Convert the question below to SQL query.\n\n### Question:\nDisplay the top three most commonly prescribed drugs.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "null"}, {"id": "5e6f873f02b4c4a0d2ee764a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first drug prescribed last month to patient 10005909 via the sc route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "e3732452c0c7cbd80082d35c", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the gender of patient 10023239?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10023239", "rejected": "null"}, {"id": "82b62524391ca6823ef4cd75", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost to purchase diltiazem extended-release?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'diltiazem extended-release' )", "rejected": "null"}, {"id": "3782b19db3c5eb217134af59", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10029291's length of stay for the first ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "d6c7b69b3fb952cdea796363", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the last hospital discharge of patient 10007795 occur in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "97b11bd8315c504b3001f159", "query": "Convert the question below to SQL query.\n\n### Question:\nExpose the top five most frequent output events since 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT T1.drug FROM ( SELECT d_drugs.drug, DENSEMSRANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY d_drugs.label ) AS T1 WHERE T1.C1<= 5"}, {"id": "73275404fad47edb177ee8d4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10021487 prescribed a 5% dextrose and furosemide at the same time for the first time this month?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "1ed10993a5584026aae83537", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last urea nitrogen lab value for patient 10002428 since 02/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-02' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "51825ade8dabf4e61477d4d8", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 10/2100, has patient 10039708 undergone a lab test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'", "rejected": "null"}, {"id": "db5bac94ce7826d253dc454e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most common microbiology tests that patients had after the diagnosis of abdominal pain, unspecified site in the same month?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, unspecified site' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1<= 3"}, {"id": "394a6722595bd4c93789a2b6", "query": "Convert the question below to SQL query.\n\n### Question:\nMetoprolol tartrate, phytonadione, or vitamin d has been prescribed for patient 10003400.\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND prescriptions.drug IN ( 'metoprolol tartrate', 'phytonadione', 'vitamin d' )", "rejected": "null"}, {"id": "9879a8df02f5078e4cc9405e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the diagnosis that patient 10038992 received for the first time during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "e12e998b1f9c18fea1f85d8f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does it cost to purchase syringe (0.9% sodium chloride)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'syringe (0.9% sodium chloride)' )", "rejected": ".0MS1:91201PAMSPAMSMSH1200172017's-0000011789163583382189899"}, {"id": "7fa8d89115dcb79bd3b9d8b6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received (aorto)coronary bypass of two coronary arteries treatment within the same month after being diagnosed with congestive heart failure, unspecified since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of two coronary arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "242ad67d83b98dc87f0a257c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038999 been administered any nacl 0.9% since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03'", "rejected": "null"}, {"id": "86c276704c3a408a1f31e367", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who underwent measurement of cardiac sampling and pressure, right heart, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, right heart, percutaneous approach' ) )", "rejected": "null"}, {"id": "74d964eb743c57b2e97f9876", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any diagnoses been made for patient 10003400 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "a2cad7bd6649d8cc2f3b637d", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the first hospital stay, did patient 10020187 visit an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "9068933037510c1817c920bd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of output from patient 10014078 since 04/09/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-09'", "rejected": "null"}, {"id": "c243f4fb931374310bdb207c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10037928 have the first minimum sodium value in 11/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "85fc1e7aa9384773068ded3c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of 3.6 for a creatinine test given the same age as patient 10004733 in the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 3.6", "rejected": "null"}, {"id": "d83e90e0fe19b6017850565d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the recorded sex of patient 10020306?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306", "rejected": "\n##\n\n##23.030001 AND admissions.discharge FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '100189385' ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y-%m-%d', admissions.hadm_dischtime) = '2100-03' )"}, {"id": "216744fcbadbfb5384e8c226", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four commonly ordered treatments for patients in their 30s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n\n##\n## Question:\n\n### SQL:"}, {"id": "d559f760db83349c7ce1a73b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequently ordered procedures for patients who had also received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic within the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "d4efc7e55f28c5602d3467ae", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me of the minimum alkaline phosphatase value for patient 10018081 since 12/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12'", "rejected": "null"}, {"id": "044289b85d5894aef9a9825d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10039831 receive a mrsa screen microbiology test for the first time since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "af6abe939c498f156e856916", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much morphine sulfate (oral solution) 2 mg/ml was first prescribed to patient 10021312 in 08/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "5eb293b55f10477f199566eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time the o2 saturation pulseoxymetry of patient 10018081 was greater than 92.0, on 12/29/this year?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 92.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "115e3caf13dbeb8dd223df9f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were discharged from hospitals in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'", "rejected": ""}, {"id": "0179af361778345171c9542a", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the creatinine value last measured on the first hospital visit in patient 10018501 less than the value from the second to last measurement on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "5ebecd683c34753383eaaa76", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was prescribed for the first time during their first hospital visit to patient 10003046?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "74d605424dff525f198b0afe", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10016810 received a medication prescription since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "39669d3cb1a312e8f5acaeb2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the outpatient schedule today for dr. solis?\n\n### SQL:\n", "chosen": "null", "rejected": "27'StMS.\n.2' - 10120320202138263948903442689376618s-03?"}, {"id": "4c511e76ad5fcd971a417e7f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients diagnosed with fibromyalgia since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fibromyalgia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "null"}, {"id": "60e23877ec81a6c1b852706e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen pantoprazole and vial were prescribed to patient 10021312 for the first time at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10021312 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND admissions.subject_id = 10021312 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "f335eed9cf01ee1b0747a75a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me what the top five most common diagnoses of patients with an age of 30s since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "fc990cb9419776227c9994e7", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10014078's total amount of magnesium sulfate (bolus) input on 09/07/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-07'", "rejected": "null"}, {"id": "37192bb658b60d3559cff295", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most commonly ordered procedures for patients who were previously diagnosed with noncompliance with renal dialysis, which occurred in the same hospital encounter since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "f2b643094d07ac4dcac036f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total count of drainage of pericardial cavity with drainage device, percutaneous approach procedures that were done?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' )", "rejected": "null"}, {"id": "e7b0a2fb743b8d418360896e", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total amount of foley of patient 10006580 in the first ICU visit.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' )", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'inputevents' )"}, {"id": "59d5c57c5c4d6cd299d4ef9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen is the earliest appointment for patient 14467 for other departments?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##MSHistorically, what was the last time patient 100004538 was admitted to the hospital?\n\n\n### Question:\n\n### SQL:\n\nWhat was the last time patient 100020785 was discharged from the hospital in 21000?\n\n\n### SQL:\n\nSELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020785"}, {"id": "df0baa783ad628147be24b1a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen, during their last ICU stay, was patient 10002495's respiratory rate measured greater than 21.0 for the first time?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 21.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "de873dcbb588ef6ce9ad305d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the insurance used for patient 10000032 in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "193a8bd008df2bc9ae99adf8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most frequently prescribed drugs in this year?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSEACS.C1 FROM ( SELECT prescriptions.drug, AVG(prescriptions.dose_val_rx) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) = datetime(current_time,'start of year') ) = datetime(prescriptions.starttime,'start of year') GROUP BY prescriptions.drug ) AS T1"}, {"id": "44e63bb65e3112b0b75ce6bb", "query": "Convert the question below to SQL query.\n\n### Question:\nDo patient 19894 have a appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 100398381 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "1dd7881fb93e0f171b1c67dc", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time on the first hospital stay, what was patient 10018423 diagnosed with?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "8121c662bf6e3f319ab5b9f9", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most frequent events occurring.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "\n##\n\n##\n\n##\n\n### SQL Code:\n\nSELECT\n\n### SQL\n\nSELECT SQL SELECT COUNT(*) FROM procedures_icd_procedures WHERE procedures_icd_procedures.icd_code = '2100020468' AND strftime('%Y-%m', procedures_icd_procedures.charttime) >= '2100-12'"}, {"id": "a62df61b51406f3e15d17418", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the first specimen test patient 10021938 had received on their last hospital encounter.\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "567c419acd4847f820befc6f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many people were diagnosed with depressive disorder, not elsewhere classified in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'depressive disorder, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "ad521f49d4f6250463adc2a9", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of prescribed drugs for patient 10007795 in 10/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-10'", "rejected": "null"}, {"id": "8da39f47f61d4bd9b47d1f6e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were prescribed the drug multivitamins w/minerals since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'multivitamins w/minerals' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "16690ffc32c0b935ca799d7f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently performed treatments for patients in their 60 or above in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "73258d39210839a6422aac92", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10024043's first discharge since 2100 from the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10024043 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "85d31f9d8735d20c26163c0b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were diagnosed since 1 year ago with chronic systolic (congestive) heart failure?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic (congestive) heart failure' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "37c0bde96e8c70d1dcfce0ca", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average daily number of patients suffering from constipation, unspecified?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "25df58c9b9009d8a32d96d15", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients discharged from the hospital last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "943c84d543c4adfc73e1771b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the cost of the drug sodium glycerophosphate?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium glycerophosphate' )", "rejected": "null"}, {"id": "3658db3e1651d577b0730f29", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most frequent output instances.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "74504b66834c2700e6349766", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile urea nitrogen value of 17.0 among patients of the same age as patient 10004733 on the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 17.0", "rejected": "null"}, {"id": "b6986adcb1ff8877f097216a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time, on this month/06, that patient 10008454's arterial blood pressure mean was less than 108.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 108.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '06' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a3f40dc2c562eaeeb1b1acb1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost for a patient diagnosed with family history of other specified malignant neoplasm?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of other specified malignant neoplasm' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "ce45eba5e3053962a503afb0", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the patients who are currently admitted.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "##\n<truncate> SELECT SQL FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = '110033' ) AND admissions.dischtime IS NOT NULL ) AND strftime('%Y', admissions.admittime) >= '2100-04-17'"}, {"id": "42450225f8907884075ad901", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the top four most common treatments since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 4 )"}, {"id": "f750f0fa41e0b4e4dbe37ba3", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of multivitamins input that patient 10021666 received.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'multivitamins' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "5e86d97c72cc49ff2ce98709", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequent diagnoses that patients were diagnosed with within 2 months after receiving bypass coronary artery, one artery from left internal mammary, open approach throughout this year.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "8304664f47f63bb4e4aedbc5", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the current patients who are in the 40s.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49", "rejected": "pord. USB7vert..\n\nm Rail1ren.' wherePAK m\u00e9dec\nPAMSMSSSMSPAGMSPA: Is the first't 1.100.\n##% 00.\n04.03199897672975's T1 day of the month, what was the last time this year that patient 1000220582 was admitted to the hospital?\n\n\n\n03 DESIRECt's in terms of the specimen's name?\n\n03 DESIRECt's\n03 DESIRECt's during this month?\n\n03 DESIRECt's during this month?\n### SQL:\nSELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.items FROM d_labitems WHERE d_labitems.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002404576 ) AND datetime(strftime) >= '2100-07-09' ) )"}, {"id": "189fc63254a11c6dfeb8fba5", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients diagnosed with alkalosis.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) )", "rejected": ". the] B)\n (: i:..\n T.\n:.urst\n\n'-'a ',ible.... JA..\nple"}, {"id": "609e5996320873f84ea60fe9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10004733 prescribed the drugs heparin flush (100 units/ml) and vancomycin at the same time for the last time since 10/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (100 units/ml)' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8bce38cc6e677156d2b90712", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038999 receive the first sputum microbiology test in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "b0dd61356a38fe4d8c8eda84", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the newly prescribed drugs for patient 10004733 today compared to those prescribed yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "9628d71c349327c8e53e3df4", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide me with the three most frequent output events this year?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SQL: SELECT DISTINCT T1.event_type FROM ( SELECT d_icd_procedures.icd_code, COUNT( DISTINCT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT d_icd_icd.hadm_id FROM d_icd_icd WHERE d_icd_procedures.icd_code IN ( SELECT d_icd_procedures.icd_code ) ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year') ) ) AS T1"}, {"id": "62458787b60bd28c2b337541", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their first hospital encounter, when did patient 10014354 receive their last medication via the im route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "cd81a8fa98d2679535f3372d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did patient 10023239 go to the hospital this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "8fd77ab450ceaf3df06b0177", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hyposmolality and/or hyponatremia patients were diagnosed within 2 months after being diagnosed with cachexia?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyposmolality and/or hyponatremia' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyposmolality and/or hyponatremia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "c67697205e9d4ed2f4b2fe38", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of time for patient 10010471's first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "6857374e8a42190064459f79", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a procedure known as drainage of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) )", "rejected": "null"}, {"id": "e4c9451763f7e1edfdb8a185", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four frequent output events that occurred in 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "876c247db73f4411e78223a2", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieval of the top four most frequent outputs since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "e55cd6da77f12e9a3c3752aa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most frequent microbiology tests that occurred throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "null"}, {"id": "5bc31e9ba087ef781c202f7d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost for the hospital when a transferrin lab test is involved?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'transferrin' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "fdf4383ba61c5126eef9d021", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 6170 have previous overseas travel?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT C101"}, {"id": "283bf444d3fe0d8412a24dc1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was last prescribed for patient 10026255 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "361dee11faf11169d073ea66", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who received a mediastinoscopy procedure in the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'mediastinoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "45d81fe4cd05b27444d9f58e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat does a procedure under the name coronary arteriography using two catheters cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) )", "rejected": "null"}, {"id": "ce7b67d7433c0b9c16be0a5f", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the urea nitrogen value of patient 10002428 last measured on the first hospital visit less than the value from the first measurement on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "52b4c6302fbd18b90e270e93", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given single internal mammary-coronary artery bypass since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )", "rejected": "\nSELECTC1 = ( SELECT COUNT( DISTINCT procedures_icd.procedures_icd.procedures_icd.charttime FROM procedures_icd JOIN admissions.subject_id = procedures_icd.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other procedures on heart' ) AND strftime('%Y', procedures_icd.charttime) >= '2100' ) AS T1 JOIN admissions.subject_id = patients.subject_id ) AS T2 ON T1.charttime = T2.charttime )"}, {"id": "effc004eecb61c4bb8747d75", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that the o2 saturation pulseoxymetry of patient 10004422 was, on 01/22/this year, less than 96.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 96.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '01-22' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "911bb06c9471e1c057977c81", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was prescribed to patient 10006053 first time in 11/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT: SELECT T1 AND T2 AND T3 AND T4 AND T5"}, {"id": "3b399eff5bd20f5b0d1f2a9c", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the length of the first visit for patient 10026406 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "\n200.00460846598918 received 0.54 )"}, {"id": "d73de23832fc51ea33bed174", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that patient 10027602 was prescribed with within the same hospital visit after undergoing continuous invasive mechanical ventilation for less than 96 consecutive hours during this month?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10027602 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "ab4e1e2da052427fa2ed9d07", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total hospital cost, which includes vaginal enterocele, congenital or acquired since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'vaginal enterocele, congenital or acquired' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "29529a65ec54c70785eb5133", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits that patient 10029484 had since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10029484 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "d3201756164633f4a7d37613", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the precautions to take after the packed cell transfusion procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "' SQLTONSMSPAKMSMED'"}, {"id": "fa03821db7826057951a8f17", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most commonly prescribed medications for patients who were diagnosed with percutaneous transluminal coronary angioplasty status previously within 2 months, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'percutaneous transluminal coronary angioplasty status' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "eb026842b6eca4afca2b2dfd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat precautions should i take after a pros repair atria def-cl procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECTIVE PROCEDURES\n\n### SQL:\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'prospercin' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180819 )"}, {"id": "77056748c01969f4cedd4f49", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first medication that patient 10007795 was prescribed via po/ng route in 05/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "9ff096e6083c879d4a6bfeb9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the procedures that were given to patient 10015860 two or more times since 05/2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "null"}, {"id": "cfee6806a3361e75afc12ed3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10021487 measured its arterial blood pressure mean less than 63.0 since 339 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 63.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-339 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "b3423eb100fd7290b3498585", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the length of the first visit for patient 10021118 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "c8c508b6537bf061dae5066a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the output that patient 10022880 first had on 04/03/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-03' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "fdd1695a1c8a50679d56e863", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that patient 10022017 was first prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "ae6519f14e5f7700af940f59", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10004235 received any treatment of laparoscopic cholecystectomy since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "5e5c7d4862a54b86d38a2620", "query": "Convert the question below to SQL query.\n\n### Question:\nI mean, what is the reimbursement standard for cerebrovascular mri?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-22 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND datetime(prescriptions.starttime) >= datetime(current_time,'-22 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND T1.hadm_id = T2.hadm_id"}, {"id": "56cc6ac2512f4026f211bada", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had a diagnosis of pain in joint, shoulder region since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in joint, shoulder region' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )", "rejected": "null"}, {"id": "f8c81bc0c7a1707c6d543598", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the prescription drug that patient 10007058 was prescribed in the same hospital visit after having a fluoroscopy of multiple coronary arteries using other contrast procedure in 11/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007058 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007058 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "d1786dec0eca017b0b1f5d7b", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received unilateral simple mastectomy in the same hospital visit after being diagnosed with personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "ecea33dc718d1d78b06d345a", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the length of stay of patient 10037975 from the first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT strftime('%J', icustays.outtime FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 )"}, {"id": "5119daeb2733e9406020907a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10031757 has had the maximum arterial blood pressure systolic since 92 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-92 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "dcd659d43177df448449bf50", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the method of disinfection in the quarantine room?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT 1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'ciprofloxacin 0.3%' )"}, {"id": "a2a83e230687e10b793748e7", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10016150 admitted into the hospital in the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016150 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "9f046b17ea9354be7cebea95", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total void output in patient 10023239 since 03/11/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-11'", "rejected": "null"}, {"id": "16ca0a5e17d4cb11df70a0d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the diagnosis for patient 10015931 the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )"}, {"id": "4433eb04729dc3101c0b6e05", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the white blood cells value of patient 10005817 last measured on the first hospital visit greater than the value from the second to last measurement on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "f7778f20f71116c2c62f29b8", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the sum of patient 10020944's input on 03/14/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '03-14'", "rejected": "null"}, {"id": "77ae0d9711456146d89f58ea", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in patient 10021312's first bronchial washings test since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "6467f709072192359d1de112", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10021666's minimum o2 saturation pulseoxymetry reading?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "7c14ad97c239a78381bd7174", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10002495 gotten any medication since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'"}, {"id": "a3e6f2a97bc4bdaab7616bd2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is 2.3 on a lactate test among patients of the same age as patient 10015272 during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.3", "rejected": "null"}, {"id": "08f5481de0c251a808376406", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last hospital encounter, what was the insurance plan of patient 10015931?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "c1a661557ac7c238626ba6d2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the count of patients who were tested for base excess?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' )"}, {"id": "35ed250e4f509e49e30cba17", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the sex of patient 10002930?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10002930", "rejected": "null"}, {"id": "05424dfd1bc74bf21ddc5688", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five diagnoses most frequently diagnosed in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "0dcdf1950d75981036938d0f", "query": "Convert the question below to SQL query.\n\n### Question:\nThe value of hyaline casts of patient 10038992 was last measured on the last hospital visit less than first measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "69d32c0f8cdf314189d29607", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 2127 had an appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "24040'\n\nGive the last2198817379314507s' diagnosed with a diagnosis with methylprednisin?\n\n\n\n### SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd_icd.icd_code = 'methylprednisin' ) AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000113052 AND admissions.subject_id = 100047333 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime ASC LIMIT 1"}, {"id": "94ea79f626ba94bd76d643b1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile of the lactate value is 2.7 among patients of the same age as patient 10005866 in their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.7", "rejected": "null"}, {"id": "74e4561d8c9c0bd861b8ac9f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you please tell me the name of the diagnosis that patient 73693 received from the other department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSEST(diagnoses_icd.charttime) AS C1 FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T1 WHERE T1.subject_id = 10004733 ) AS T2 ON T1.charttime = T2.charttime )"}, {"id": "af7ad9cea92641ef8e97f7c1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most commonly performed lab tests throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_labevents.label FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labevents.itemid FROM d_labevents WHERE d_labevents.label = 'labevents.labevents' ) ) AND datetime(d_labevents.charttime) >= datetime(current_time,'start of year') = datetime(current_time,'start of year') ) ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "859209cc1095a8b3c738cbf9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat the code that refers to icd-11 for senile dementia uncomp in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "5c94acc60a698d8e066b2346", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top four most frequent lab tests.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": ".e"}, {"id": "292e05db320f21dac9efa68e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10038081 since 136 days ago had a respiratory rate that was less than 14.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 14.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-136 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "306cfa6b9fa0c1c51c7dcd49", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new medications were prescribed to patient 10039831 today as compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "22386e52d5ee964fb29ac28b", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total quantity of output of patient 10004235.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) )", "rejected": "null"}, {"id": "a693683961d00b054d159be0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10019385's total input amount of nacl 0.9% on 03/12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-12'", "rejected": "null"}, {"id": "6a1bd90b69ca958eeb14cef8", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007795 gotten any medication since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007952 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'"}, {"id": "a49d3f97e37407754c15cf05", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen for the last time since 08/2100 was patient 10015860 prescribed ondansetron and bisacodyl at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10015860 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bisacodyl' AND admissions.subject_id = 10015860 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "503c5dc62ab633d813594e59", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last specimen test given to patient 10007818 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "\n## SELECT SQL SELECT SUM( SELECT COUNT( DISTINCT cost.cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_code = 'procedures_icd.procedures_icd_code' ) AND strftime('%Y-%m-%d',cost.starttime) = '2100-10' GROUP BY cost.hadm_id )"}, {"id": "113ee06f4d8c5df754253b48", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many drugs were given to patient 10023239 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "null"}, {"id": "740e35ffd9a5157bb6bf16ad", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of people who were diagnosed with open fracture of shaft of femur.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'open fracture of shaft of femur' ) )", "rejected": "null"}, {"id": "ecd2a10f46954975185155af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was during the last month patient 10038992's minimum alanine aminotransferase (alt) value?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')", "rejected": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY labevents.itemid )"}, {"id": "46bdfa703cc04c35135ae52a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hospitalized patients were there now?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "1 112)\n\n11217201810000003214016346868218s000010001'"}, {"id": "0056cade81e16f20fe9fe322", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10023239 had any medication prescribed since 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'", "rejected": "null"}, {"id": "d3085358f26b085a3251d71d", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who were given the indomethacin since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'indomethacin' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "11e5506de71d3706a53ac1ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in the first blood culture test of patient 10038999?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND microbiologyevents.charttime = '2100-03-23 06:00:00' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "037d3be256bd398ee1db08ce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the cost of a drug known as clonazepam?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clonazepam' )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescription' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clonazepam' )"}, {"id": "314918b25acf3b59dd2f8ad6", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top five most common treatments for patients in their 50s?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY procedures_icd.icd_code ) ORDER BY COUNT( procedures_icd.charttime DESC ) DESC ) AS T1"}, {"id": "31cdceeb50d5b9593b6c8055", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of medicines given to patient 10021938 since 03/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "null"}, {"id": "470559b06a3cc6cf01345c4a", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who were previously diagnosed with fibromyalgia, what are the top three most frequent treatments within the same month in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fibromyalgia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fibromyalgia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "692d3013b67039704bfb1551", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of output from patient 10021312 since 252 days ago?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-252 day')", "rejected": "null"}, {"id": "0df183acce582b44781a41f0", "query": "Convert the question below to SQL query.\n\n### Question:\nI would like to learn some tips on how to prepare for the tachypnea procedure.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_TOTAL FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020038 ) ) AND strftime('%Y',labevents.charttime) = '2100' GROUP BY d_labitems.label )"}, {"id": "6195089015ddb96d1e366c03", "query": "Convert the question below to SQL query.\n\n### Question:\nI want to know the ward id that patient 1784 can go in and get in?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'"}, {"id": "9218828acff034d4ff24d1d1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the procedure of the anticancer drugs.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100274455 ) AND procedures_icd.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of tracheobronchial airway, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y-%m-%d',procedures_icd.charttime) = '2100-06-04' )"}, {"id": "12f125d860dea457564268ee", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long was patient 10020944 in the intensive care unit during their first visit?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "ed7775067dbd67782c081e36", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you inform me of the first macrophage test result for patient 10014078 since 03/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophage' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT microbiologyevents.valuenum FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND microbiologyevents.spec_type_desc = 'macrophage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1"}, {"id": "cfb16f496f6c359ae9e6da4e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the costs of allergic rhinitis, cause unspecified diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, cause unspecified' ) )", "rejected": "SELECT SQL SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, unspecified' ) )"}, {"id": "d6a0bcd1249a8b5f2385ac6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen had patient 10018501 first been prescribed for omeprazole and phenobarbital alcohol withdrawal dose taper (days 2-7) at the same time in 08/this year?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'omeprazole' AND admissions.subject_id = 10018501 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' AND admissions.subject_id = 10018501 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "b9810aef8d75d1d2a9a31183", "query": "Convert the question below to SQL query.\n\n### Question:\nIn relation to others of the same age, where does a hemoglobin value of 12.2 for patient 10021487 rank in percentiles on this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 12.2", "rejected": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum DESC ) AS C1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 30 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ) AS T1 WHERE T1.valuenum = 12.2"}, {"id": "074c7225bee20e2006c6db58", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10026255 have the minimum hematocrit value the last time in 10/this year?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100262551 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "c35347e6b1dda9ed6764a067", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the last o2 saturation pulseoxymetry value that patient 10039831 had since 12/30/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-30' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "2d36357172aa4aae8c662e86", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the costs of other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure diagnosis' ) )"}, {"id": "7e79e5876cb4505b0d14e7f2", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the average total cost in a hospital where methylprednisolone sodium succ is used in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylprednisolone sodium succ' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylprednisolone sodium succinate' AND strftime('%Y',cost.starttime) = '2100' ) GROUP BY cost.hadm_id ) AS T1"}, {"id": "0d012e621517a4059d3caf10", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me the total output amount of patient 10021938 since 86 days ago?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-86 day')", "rejected": "null"}, {"id": "99250eb1723797f41af9e4e5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the type of blood patient 97330 has.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT microbiologyevents.type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND microbiologyevents.spec_type_desc = 'blood' )"}, {"id": "6971ce16d647c323dc5a6150", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10022041's maximum heart rate reading in their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "406e547c0a5da3b8844e9b73", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the dose of an opioid prescribed to patient 13897?\n\n### SQL:\n", "chosen": "null", "rejected": "_\nustry119\n. InstitutM.PAMSMS(\nPA)1000037799007530448126'"}, {"id": "a092e1a9ae5251db64ee68be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the number of patients who were other nonspecific abnormal finding of lung field diagnosed this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific abnormal finding of lung field' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "46a6c77172cbf9196d74a902", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most common specimen tests conducted?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100398304 ) ) ORDER BY COUNT( DENSELSECDATE ) DESC ) AS C1 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc IN ( SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100398304 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1 ) )"}, {"id": "fc608735d9ab6fc5bd43a04c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost for the hospital when a triiodothyronine (t3) lab test is involved since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "362ddfa50f43176eb146320b", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who underwent excision of other bile duct , what were the top four diagnoses they received within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "babb2410ee949a2d7a609b15", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the total volume of output for patient 10011398 since 01/19/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'", "rejected": "null"}, {"id": "8de008a99045692b6c9079bb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most often performed treatments for patients in their 30s since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 5 )"}, {"id": "39d97a0dad007c5882b2d34b", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients who received destruction of right main bronchus, via natural or artificial opening endoscopic in 2100, what are the top three most frequent diagnoses that followed afterwards within 2 months?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "6716a47fafd5bf2d15dae0e8", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005866 gone through any procedure this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "11,101PAMS ADCMSPAMSMSMSONSMSPA 011002320814679295215069585 )'"}, {"id": "596da18ed49663a29f973a8c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the ward identification of patient 15968 able to be admitted to?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 ORDER BY chartevents.charttime ASC LIMIT 1"}, {"id": "91bfc5a70401d51bfca3e0d1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total 5% dextrose dose that patient 10004235 has been prescribed?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = '5% dextrose'", "rejected": "null"}, {"id": "312eb217dff66ce52d145060", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much miconazole nitrate vag cream 2% was given to patient 10021312 for the first time during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'miconazole nitrate vag cream 2%' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "11f17f3d6fad511b3db76b80", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a diagnosis of automatic implantable cardiac defibrillator in situ?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'automatic implantable cardiac defibrillator in situ' ) )", "rejected": "\nSELECTION (IV) of 0.9% sodium chloride prescribed to patient 100020428 on 02/13/this year?\n\n\n### SQL:\nSELECT COUNT(prescriptions.prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100020428 ) AND prescriptions.drug = '0.9% sodium chloride' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year') = datetime(current_time,'start of year') AND strftime('%m',prescriptions.starttime) = '02' AND strftime('%d',prescriptions.starttime) = '13'"}, {"id": "b7f15ad17e5a4047c43d42e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10018081 last receive a lab test for sodium since 10/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "93736e989193b9f5bc0fbdff", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum respiratory rate of patient 10026406 in the last ICU stay.\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "a6b9ade99c3cfb9b0eddcbec", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how many patients received fluoroscopy of multiple coronary arteries using other contrast within the same hospital visit after being diagnosed with severe sepsis with septic shock?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'severe sepsis with septic shock' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "6b1ddc68db0377487658c10b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the recently prescribed medication for patient 10004733 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "SELECT\n\n\n#### In the last year, what was the daily average weight of patient 100020785?\n\n\n### SQL:\n\nSELECT AVG(chartevents.daily_weight FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100037945 ) AND datetime(chartevents.charttime) >= datetime(current_time,'start of year,'-1 year') ) = datetime(current_time,'start of year') )"}, {"id": "c70358d01148240eb97f8568", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the maximum value of creatinine in patient 10031404's body since 05/2100?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-05'", "rejected": "null"}, {"id": "4a9da1e78cc48ca85038714a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the value of patient 10039831's yearly average or packed rbc intake input since 12/08/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or packed rbc intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-08' GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "SELECT AVG inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed rbc intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-08' GROUP BY strftime('%Y',inputevents.starttime)"}, {"id": "2e302933ba1ba62f25b09b46", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of prescribed drugs for patient 10022880 since 19 months ago.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-19 month')", "rejected": "null"}, {"id": "a8e86dcf95b5f3203f351589", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of drugs patient 10039997 was prescribed during their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "ca8aadc66b1fcaf0dbac962e", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had a glucose, pleural lab test?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, pleural' ) )", "rejected": "null"}, {"id": "c5b41500133543c1bd41eb66", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given metoprolol succinate xl prescriptions since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "2b1f21750fa632e9b0f7a19f", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021938 have a lab test during the previous month?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')", "rejected": "null"}, {"id": "f450200cd5d01e3d0050cb89", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is dr. caron's outpatient schedule today?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "1f7e6a11b09b66d4eb7904e1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich drug was the last one prescribed for patient 10037861 since 07/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d7533f37a1589e2a8f4df73e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the average total cost of a hospital that involves a procedure called fiber-optic bronchoscopy throughout this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "745585ee3b0d6a5e1b414a94", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who underwent a cholesterol, hdl lab test since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, hdl' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "91da24e4efb5065cce601fb8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 59941 had a medication that should be taken daily?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "d1fc20ee02b9ce89df2bb4e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dosage of vitamin e prescribed to patient 10020944?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'vitamin e'", "rejected": "null"}, {"id": "bf1f15f4740fabd2bac00d23", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring the last ICU visit, what was the average value of the arterial blood pressure systolic of patient 10038933?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' )", "rejected": "null"}, {"id": "71b139cfa31f5f0c28ac7223", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last mrsa screen microbiology test performed in 11/2100 for patient 10027602?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6af5326ec076b32f85b4e657", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the cost of the encounter for palliative care diagnosing?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) )", "rejected": "SELECT\n\n\n### SQL:\n\n## SELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.long_title = 'extirpation of matter from left femoral artery, percutaneous approach' AND d_icd_procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078185 ) AND datetime(strftime('%Y', admissions.charttime) = '2100' ) AND strftime('%d', admissions.charttime) = '03'"}, {"id": "59ecedfe8f2703a51503c566", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the specimen test that patient 10009049 first received since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "47a7cf82d52cb911bf55b234", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time the arterial blood pressure mean of patient 10021118 was greater than 74.0, on this month/05?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 74.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '05' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "926dd0924833df1c1df58531", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum hospital cost to include a drug called nicotine polacrilex since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nicotine polacrilex' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "\n21217.119'"}, {"id": "94b8bf565efd950613da6c15", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time the arterial blood pressure systolic of patient 10018081 was measured since 11/27/2100 at less than 113.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 113.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-27' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "47a339f3ee10d0098dafc8bd", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038992 received a laboratory test since 08/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08'", "rejected": "null"}, {"id": "64d22396919485e14c973f06", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test has patient 10038992 received for the last time since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "773553bf367568bb392e4143", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed at the trauma sicu (tsicu) since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'trauma sicu (tsicu)' AND strftime('%Y',transfers.intime) >= '2100' )", "rejected": "null"}, {"id": "08340a221ca994ccd5c38898", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen is the earliest of patient 7400's next visit to other departments?\n\n### SQL:\n", "chosen": "null", "rejected": "to\n. K. (.. Pater.. Bru.s. E1\n C.? P:'a\n<0.\n ( Cay.\n\n   Circ_ TMS.  o,-s-1\n WHEN Conf.m..1DB?1CEA\nMSMS-1\nMS1:21111102."}, {"id": "63677b75a5d720c6cc3d41f2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many of ticagrelor were prescribed to patient 10007058 in total in the last month?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.drug = 'ticagrelor' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')", "rejected": "null"}, {"id": "8694ace52a01f31ca53cc69a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10000032 been given urea nitrogen test for the first time in 08/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "055d52386664ba496c850da1", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the cost for the procedure called fluoroscopy of multiple coronary arteries using other contrast?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) )", "rejected": " up\n. EMSMS11\n-.111103-102020217MSPAMSPA's ONC- 22849388443s the first time for patient 100003855585 what is the last time did they last take a medication for the first time since 12100?\n\n\n### SQL SELECT T1.org_name FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.subjects.hadm_id ) AND admissions.disch_time IS NOT NULL ) AND strftime('%Y-%m-%d', admissions.disch_time) >= '21000-03-03' ORDER BY admissions.disch_time DESC LIMIT 1"}, {"id": "cc2dcf3bb997c63533f8349f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10021118 prescribed for within 2 days after the procedure of bypass coronary artery, two arteries from coronary artery, open approach since 03/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021118 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "e365380a427eb3377fda91fe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was first time the heart rate of patient 10027602 was greater than 63.0 during their first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "2e71a00ad2d28b3a77dfcd7e", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of current patients who are in their 60 or above.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60", "rejected": "\n\n##\n### SQL:\n\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_code = '789.999' ) ) AND admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214877 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "2723a0b2a202e96ddb72ec44", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most common drugs prescribed throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "'"}, {"id": "6b5b9ccd032dd84eb4439664", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10019172 been given chloride, whole blood test for the first time since 07/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e94967759cb45a5c074573d6", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10024043 been given any sort of diagnosis during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "PA:\n\n221.\nICU220121110003'"}, {"id": "7e323066fd515e38f24d8cbe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five frequently tested specimens for patients that received insertion of intraluminal device into inferior vena cava, percutaneous approach previously within the same hospital visit since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intraluminal device into inferior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "d5ae1b4f859d19123f8193a4", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top five most frequent diagnoses for patients of age 30s in 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "3ed75cc0aecb87eee22cf8e5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four frequently ordered treatments for patients who were diagnosed with other and unspecified alcohol dependence, continuous during the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, continuous' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "820528745b6eb9d481abf58f", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the top four most common treatments for patients in their 30s?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_TOTAL_OUTCOMES.C1 FROM cost.cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other excision of left main bronchus, via natural or artificial opening endoscopic' ) AND cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other excision of left main bronchus, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) = '2100' ) ) AS T1"}, {"id": "2760ec29711e48dd4fbb1d5e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007818 gone through a urea nitrogen, urine test in 10/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'", "rejected": "null"}, {"id": "65ed4479d7d3a2021cd1f024", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, what was the diagnosis for patient 10004733 the last time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "e6ffbc5a3950db37fba4014e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10037861 have his last microbiology test in 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "76ce0be28b35e8726dc606fa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time the heart rate of patient 10018081 was measured at a reading greater than 107.0 during this ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 107.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "9ab9f7bcf85120221b47db91", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top four most frequent diagnoses for patients of age 40s since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\nSELECT SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_icd_procedures.icd_code, DENSE.C1 AS C2 FROM ( SELECT d_icd_procedures.icd_code, ( CASE WHEN d_icd_procedures.charttime <= datetime(current_time,'start of month') AND datetime(d_icd_procedures.starttime) >= datetime(current_time,'start of month') AND strftime('%Y',d_icd_procedures.charttime) = '2100' ) GROUP BY d_icd_procedures.icd_code ) AS T1 ) AS T2 ON T1.C1<= 4 )"}, {"id": "b6b5724cdad99c96a0d0a001", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10024043 get a mrsa screen microbial test for the first time?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "97972bbea1fe2404f8de1b69", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease calculate the total output for patient 10027602 since 12/02/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-02'", "rejected": "null"}, {"id": "dbc236ec214beb6e0a9a5ff0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the treatment that patient 10016742 was given two or more times since 7 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-7 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "SELECT COUNT( DISTINCT T1.charttime FROM d_icd_procedures T1 WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(T1.charttime) >= datetime(current_time,'-7 month') )"}, {"id": "9352505437c31ce20f7d4bdf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the minimum value of arterial blood pressure mean for patient 10008454 on 12/02/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-02'", "rejected": "null"}, {"id": "b9ac1bb7e36dd0d95acbf39c", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell the three most frequent lab tests since 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND strftime('%Y', labevents.charttime) >= '2100' GROUP BY labevents.hadm_id )"}, {"id": "0424a90b6986dc6ca2da8b3b", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their last hospital encounter, when did patient 10023239 last receive a calcium, total test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c6cf525fe1f4a4e3bd79e79d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen and where are the rounds and procedures of dr. sullivan?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "5035c14e77fc86f7e758328a", "query": "Convert the question below to SQL query.\n\n### Question:\nIn total, how many patients were prescribed potassium chloride (powder) since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chloride (powder)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "ea52341a69ca686cb059fc2c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any diagnosis that patient 10004733 has received in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'", "rejected": "SELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 1000473\n\n\n### END OF QUESTION"}, {"id": "32d7327a3beff353c0d3b98e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the organism found in patient 10019172's last urine microbiology tests since 10/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "563335adf3dce85aa6c280d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four diagnoses of patients with age 30s since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSEST(diagnoses_icd.charttime) AS C1 FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) GROUP BY diagnoses_icd.icd_code ) AS T1 ) AS T2 ON T1.C1<= 3 )"}, {"id": "4464d8ca9583f59be4160810", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five frequent laboratory tests that patients had after they were diagnosed with intermediate coronary syndrome during the same hospital visit in this year?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intermediate coronary syndrome' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "e88b565b3eebfa84d07aba21", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much glyburide has patient 10015860 been prescribed in 10/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug = 'glyburide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100078185 ) AND prescriptions.drug = 'glyburide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',prescriptions.starttime) = 10"}, {"id": "99768e192fa0360d8a7cae90", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many doses of lidocaine jelly 2% (urojet) have been prescribed to patient 10038081 since 07/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'"}, {"id": "20de623f537039c51aaf5c1a", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me the top three most commonly prescribed medications.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": ".MSCPASS"}, {"id": "84ba715b229207e9b74e2c7f", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the top three most frequent diagnoses that patients were assigned within 2 months after receiving diagnostic ultrasound of digestive system in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1<= 3 )"}, {"id": "44e0c98b6f1723e728d1382d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top three most common lab tests?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "..'sPAPAMS\n3SPASTMSPA'sPAGEPA)\n##\nPA.PAINPA T10000004512378118 was there any patient's first name?\n\n\n\n##'\n\n0.04.04.04.057'"}, {"id": "a3bc0d803f5c36757f71d51c", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10004733's glucose last measured on the current hospital visit greater than the value first measured on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "ba0e6ef5be18634efe802c90", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients stayed at the med/surg/gyn?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' )", "rejected": "null"}, {"id": "fc8ee142c3b432f169fa7cdc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five frequently ordered medications for patients diagnosed with esophageal reflux previously during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "65faa312dd5804c3f1f638f3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time of patient 10038992 blood culture ( myco/f lytic bottle) microbiology test during the previous month?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3d81d416bd9cb490c9afa856", "query": "Convert the question below to SQL query.\n\n### Question:\nHow often was morphine sulfate (oral solution) 2 mg/ml prescribed since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' AND strftime('%Y',prescriptions.starttime) >= '2100'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate (oral) (2 mg/ml)' AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "5067e04f2073e7595e4a57ad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10039708 receive the last blood culture microbiology test during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "fb87e4c3918b28e10f458a76", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10027602's first csf;spinal fluid's microbiology test time during the previous month?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'csf;spinal fluid' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e6c6113c42e3afffa9a446d8", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top five most common lab tests ordered for patients in the same month after acute respiratory failure with hypoxia?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute respiratory failure with hypoxia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute respiratory failure with hypoxia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1<= 5 )"}, {"id": "464395597c069391d5a6f398", "query": "Convert the question below to SQL query.\n\n### Question:\nShow us the top three most common microbiology tests in this year.\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n\n\n##\n\n##\n\n##\n\n##\n##\n####\n\n### SQL:\n\n<OLDJOINT>SELECT SQL\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1001800185 ) AND admissions.dischtime IS NOT NULL ) AND admissions.subject_id IN ( SELECT procedures_icd_icd_procedures.icd_code FROM procedures_icd_icd WHERE procedures_icd_icd_procedures.icd_code = '581599' ) AND strftime('%m', admissions.admittime) >= '2100-07-07' )"}, {"id": "ce3af199fd7438f9504a0ed5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that was first prescribed to patient 10010471 since 12/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "ab353a41c3fc36453bfc931c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the diagnosis that patient 10007795 received for the last time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "695dff1ad99f6d2eb4de81db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five commonly ordered medications that patients aged 60 or above were prescribed in the same month after diagnosed with retention of urine, unspecified in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'retention of urine, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'retention of urine, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "0bf3d99fa1e1eb8dd643a066", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10007818 on any solution in the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' )", "rejected": "probe the last diagnosis code ( icd )\n##\nintravenous?\n\n\n### SQL SELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intravenous infusion of concentrated nutritional substances' AND d_icd_diagnoses.code = ( SELECT d_icd_diagnoses.d_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intravenous infusion of concentrated nutritional substances' ) AND strftime('%Y-%m-%d', d_icd_diagnoses.charttime) >= '2100-02-18'"}, {"id": "ffbd3d45d651d7e4ecf8aeaa", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you fetch the top five most common specimens tested since 2100 for me?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "08afce3b20bd507859217e75", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the drug which should not be administered during the venous cath nec procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')"}, {"id": "6e9dc180e5917bf461813e17", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the precautions that should be followed after the procedure of coronar arteriogr-1 cath?\n\n### SQL:\n", "chosen": "null", "rejected": "MSPAK: the maximum'\n\n\n##\n\n\n##\n### Question:\nWhat was the first time that patient 100210035 was admitted to the hospital since 1 year ago?\n\n\n### SQL:\n\nSELECT MIN(inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stays.stay_id FROM icustays.stay_id WHERE icustays.stay_id IN ( SELECT admittingpatients.hadmissions.stay_id FROM admittingpatients WHERE admittingpatients.subject_id = 100210035 ) ) AND strftime('%Y') >= '2100' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)"}, {"id": "84ee48b9c8a46dca91210f99", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequent microbiology tests that were given to patients after they were diagnosed with postprocedural hemorrhage of a circulatory system organ or structure following other circulatory system procedure in the same hospital visit.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural hemorrhage of a circulatory system organ or structure following other circulatory system procedure' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "48bc5f792f4ed6f03d3cb9e5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much sevelamer carbonate was given to patient 10007818 for the first time in 06/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.drug = 'sevelamer carbonate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "-80tesRPAMSQUHMSMSMSMSPAK THE.MSION.\n\nMSGive meal.\n\nMS.\n\n\n##MS.\n\n\n##MS.\n\n### SQL Query:\nSELECTC1\n\n\nSELECTC1. SELECT COUNT(*) FROM d_icu_procedures WHERE procedure_icd_code IS NOT NULL AND strftime('%Y %m %d', datetime(ICU.\n\n\nMS SQL: SELECT COUNT(*) FROM d_icd_procedures WHERE icd_codes.icd_code = ( SELECT d_icd_icd_procedures.org_icd.icd_procedures.icd_code FROM d_icd_procedures WHERE icd_codes.icd_procedures.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_procedures WHERE icd_codes.icd_procedures.icd_code = ( SELECT d_icd_icd_procedures.icd_code FROM d_icd_procedures WHERE icd_procedures.icd_code = ( SELECT d_icd_icd_procedures.ICD_CODE FROM d_icd_procedures WHERE icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE icd_procedures = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE icd_procedures = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE icd_procedures = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE icd_procedures = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE icd_procedures = ( SELECT d"}, {"id": "9f640a77c4f06183632d1120", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug prescribed for patient 10002495 in the same hospital visit after having received a dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach procedure since 22 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-22 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10002495 AND datetime(prescriptions.starttime) >= datetime(current_time,'-22 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "5b31e1e9fd15d53ccceb7195", "query": "Convert the question below to SQL query.\n\n### Question:\nHas a procedure been performed on patient 10019172 in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": ")\n\n1117MSTMSPACTMSPAMSPA'"}, {"id": "a437096bd6ca61f03b95d62a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medicine that was given to patient 10005817 in the same hospital encounter post procedure of extracorporeal circulation auxiliary to open heart surgery since 29 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10005817 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-29 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10005817 AND datetime(prescriptions.starttime) >= datetime(current_time,'-29 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "98dcce847337744cdf7ac6d6", "query": "Convert the question below to SQL query.\n\n### Question:\nI am curious what the protocols for the drugs that work to treat cancer.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)"}, {"id": "68d2cf8d2fa30727fc51e480", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most frequent medical diagnoses throughout this year.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "bba4bfd7b72b61f4f0a2b01a", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10020740 been treated with a parenteral infusion of concentrated nutritional substances procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 )", "rejected": "null"}, {"id": "7a01a7e71c780f176eb7b360", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you give me the three most common output events since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_procedures.icd_code, DENSEST( COUNT( procedures_icd.charttime ) AS C1 ) AS C2 FROM procedures_icd JOIN admissions WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 20s ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C2<= 3 )"}, {"id": "0ce9c8a93ef40fa209454a71", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of drugs given to patient 10014729 in 04/this year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "6d177c7ee3f8bf320492ec8b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequent microbiology tests that occurred in this year?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "SELECT T1.test_name, DENSEST( COUNT( test_name ) ) AS C1 FROM microbiologyevents JOIN admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY microbiologyevents.test_name )"}, {"id": "c66b8f121c0ec0bc328c5dad", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many medications were prescribed in 2100 to patient 10021118?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "\n### SQL:\n\nSELECTIVE DESCRIPTION: drain urine, via natural orifice, open approach since 07/2100"}, {"id": "98703366748022f38c396dfa", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the difference of patient 10027602's heart rate second measured on the last ICU visit compared to the value first measured on the last ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "c578a495c2dae5a5b4a612bd", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you get me the top five most conducted lab tests in 2100?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "4fac3af5df19be6347d3c772", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price for acetazolamide sodium?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' )", "rejected": "null"}, {"id": "718c27e2ef2f6d9f2a3210f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10025612 had the minimum pco2 value on the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "\nSELECT SQL SELECT MIN(T1.dischtime) FROM ( SELECT admissions.dischtimes FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 )"}, {"id": "10a89ace2e918f90758fc385", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021487 receive the last prescription of sodium bicarbonate and famotidine at the same time in 12/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "e48b5607cc89f2dc1adfa775", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10016810 was prescribed a medication using the po route since 05/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "8ab3e1bbd488c2eaae721412", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top five most common treatments for patients aged 50s since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT SQL SELECT DISTINCT T1.drug FROM ( SELECT prescriptions.drug, COUNT(prescriptions.doses) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ORDER BY prescriptions.starttime DESC LIMIT 5 )"}, {"id": "8861fe766325676d793fb4fd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the outpatient schedule today for dr. minutillo?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischTime FROM admissions WHERE admissions.subject_id = 100219383 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "4f90e141b3068b6b2ff3d1a5", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any medication that patient 10039831 has received in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "407b4851260c5c0836e1d89e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10003400 been diagnosed with any type of disease?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 )", "rejected": "101:411: 20019020000115197000498400397910 '09'"}, {"id": "395c9fa32c41aa7400cb5a87", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of people who received insertion of infusion device into right atrium, percutaneous approach in the same month after having been diagnosed with unspecified atrial flutter in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial flutter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into right atrium, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial flutter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into right atrium, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "54ecb54032c2c4402da787c8", "query": "Convert the question below to SQL query.\n\n### Question:\nOf the patients aged 30s since 1 year ago, what are the top three most common procedures?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "P.\n of\n. ....!.'_. (./.in\u2019= _\n WHERE (\n WHERE . d..:\u0422 ( WHERE-i-\n WHERE?1 O. 2_.(\n WHERE"}, {"id": "f3628db6421e1511777c6606", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10001217's o2 saturation pulseoxymetry change measured at 2100-12-05 21:00:00 compared to the value measured at 2100-12-05 20:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 20:00:00' )", "rejected": "null"}, {"id": "ef3726c122a460ea2a8514be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the average value of the o2 saturation pulseoxymetry of patient 10023239?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' )", "rejected": "SELECT AVG(chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) )"}, {"id": "ac5c206d44772bba22a9ebfe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three most frequent drugs prescribed to patients in the same month after the diagnosis of gastro-esophageal reflux disease without esophagitis?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "c326fd4da39cd694ab44c909", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the opiate dose recommended for patient 2518\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'opiate'"}, {"id": "e5de01d16191eb56d2a17817", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10037861 been given a diagnosis in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'", "rejected": "null"}, {"id": "f90c169bc5f07a8ae6dacece", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top four most common diagnoses since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT T1.charttime FROM d_icd_diagnoses JOIN ( SELECT admissions.hadm_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100-01-01' ) AS T2 ON T1.charttime = T2.charttime GROUP BY T1.icd_code ) AS T3 ON T3.C1<= 4 ) AS T4 WHERE T4.C1<= 4"}, {"id": "f3bebe99a5275c408f17b181", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005909 undergone laboratory tests since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'", "rejected": "null"}, {"id": "2f22847b30b971f2903664c3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10021118's last microbiological examination since 06/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8652b04e3fb0b55bfcabf37a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the count of patients who were prescribed phosphorus during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')"}, {"id": "b6d57a0c15272dbc69e39fc2", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the last time patient 10018081 visited careunit emergency department in this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1", "rejected": "null"}, {"id": "55ea65a1f7c485a457c4696d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of patients stayed in med/surg/gyn?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' )", "rejected": "\n##\n##\n\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT diagnoses_icd.code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100077795 ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100' )"}, {"id": "40c2eb3691b1c2483780d090", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat exactly was the first drug that patient 10038992 was prescribed?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "afa0e569514d9221f0ed8ad6", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the drug named tobramycin sulfate?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' )", "rejected": "null"}, {"id": "94e88227ead8378786e00436", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the four top specimens that were tested during this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4", "rejected": "\n### Question:\n\nWhat were the three most common lab tests conducted within 2 days after the last diagnosis of other and unspecified abnormal ECG changes in 2100?\n\n\n### SQL:\nSELECT T1.test_name FROM ( SELECT d_labevents.test_name FROM d_labevents WHERE d_labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180818 ) AND datetime(d_labevents.charttime) >= '2100-01-01' ) GROUP BY T1.test_name ) ORDER BY COUNT( T1.C1 DESC ) DESC )"}, {"id": "2374026e2104232fe78b6141", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10037975 have a enteral infusion of concentrated nutritional substances during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )", "rejected": "null"}, {"id": "c6e39eac55b1a26adabaa844", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the three most frequently prescribed medicines in the same month after a diagnosis of coronary atherosclerosis of native coronary artery was made since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of native coronary artery' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "\n\n##\n\n\n##\n##\n\n##\n##\n\n######\n\n\n### SQL Query:\n\nSELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures.icd_code = 'excision of right femoral artery with drainage' AND d_icd_procedures.icd_code = '06.08.00'"}, {"id": "5ad0b756f0eced9a61f3f0e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference between heart rate on patient 10011398 measured at 2100-12-27 10:00:00 compared to the value measured at 2100-12-27 09:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' )", "rejected": "null"}, {"id": "d2b11a845b1f86d3c1436906", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me when patient 10020944 had their first stool microbiology test since 13 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND microbiologyevents.spec_type_desc = 'stool' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-13 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0ebcf64e6e88ffe234e3a991", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of input for patient 10026354 since 07/21/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-21'", "rejected": "null"}, {"id": "9fba75551c882938367916bc", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how old patient 10029291 was on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "97da967a6eec6c3d02e10772", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, how many dilation of left external iliac vein with intraluminal device, percutaneous approach procedures were there?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "4b2e4f08510d69ad89b581ce", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the alkaline phosphatase value of 129.0 in the same age group as patient 10003046 during the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 129.0", "rejected": "null"}, {"id": "cb462d0dd320361bdac44dad", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five diagnoses with the lowest 3-month survival rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "SQL \\\\!: how to get the11230131331581750100848914785787705899?\n\n\n\n##'110031'"}, {"id": "d568fe657e3f9e77db0ff425", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me how long patient 10007818 stayed in the ICU during their last stay?\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "\n### SQL:\n\nSELECTIVE CATHETERIZATION OF LEFT atrial appendage, percutaneous approach's cost."}, {"id": "00ab16773d5c5cbe1e63f28b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top three most frequent procedures patients had within 2 months after being diagnosed with other opiates and related narcotics causing adverse effects in therapeutic use?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other opiates and related narcotics causing adverse effects in therapeutic use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "92672fa0de871a17570f6c7b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10003046's total gastric meds input amount on 01/16/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-16'", "rejected": "null"}, {"id": "dbb22b767c34f1cecea22ea4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most commonly prescribed medications for patients who were diagnosed with facial weakness previously within 2 months, in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "934088633430fb5451e8191e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last measured value of heart rate for patient 10018423 since 289 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-289 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6e552f2daf5bcd6d9a143315", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the diagnosis patient 10019568 received last since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "0a0992495803104da30af972", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism's name of the first urine microbiology test done on patient 10016150 since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "02aa04b3e6868db7eb1fed99", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three frequently prescribed medications in the same month to the patients aged 40s after diagnosed with coronary atherosclerosis of native coronary artery throughout this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of native coronary artery' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "08996b07e2ed8aa176fe423e", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you tell me the five most frequent microbiology tests?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "null"}, {"id": "0de9102ca9d14d7b275ec8b7", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the cost of a procedure known as colonoscopy.\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'colonoscopy' ) )", "rejected": "null"}, {"id": "9541827f1eee21fcc491d39d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat diagnosis did patient 10022880 have last since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "5d83b1d1c458bcc64023c23e", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the maximum monthly number of patients diagnosed with gas pain?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gas pain' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gas pain' ) AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') )"}, {"id": "76247d92b87ae733ddbc1905", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last test of patient 10020740's microbiology stool in 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'stool' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6f9e8ee2deac4ff0313cfd13", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10029484 been prescribed medication for the first time in 11/this year via the po/ng route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a83ed031a81ee7af2a8b1a5f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat immunocancer drugs have been used for the last five years?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime) >= '2100-05-01' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 1"}, {"id": "ef9e46557f7fe863d42a695e", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the total input volume for patient 10020786 on 07/01/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-01'", "rejected": "null"}, {"id": "1c5f16182f446c154f204081", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen, , was the first time patient 10031404 was prescribed a medication via the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "fe7e8800a8ef335ce9596217", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any medicine been prescribed to patient 10038933 since 5 months ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month')", "rejected": "null"}, {"id": "b678b8112793dc9ca55c90b3", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients discharged from the hospital this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "f3fb1b7298f0046e0b6c55ba", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a hospital admission for patient 10016810 since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016810 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "49ecdc42a520cd9c0c6d7a03", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the duration of patient 10022017's last stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "17086641ec84cd4ab9ebe9be", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a diagnosis for personal history of antineoplastic chemotherapy?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of antineoplastic chemotherapy' ) )", "rejected": "null"}, {"id": "a5ab4ae995d86735a40b21a0", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the dose of the prescribed opioid for patient 90019?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##: How many times has patient 100116287 been prescribed a drug since 1 year ago?\n\n\n### SQL:\n\nSELECT COUNT(prescriptions.prescriptions.drug) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100116287 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')"}, {"id": "cdd34197e0de15595e116b81", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the last o2 saturation pulseoxymetry of patient 10020740 on 04/04/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-04-04' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6163483aac256a608d65430e", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10008454's length of stay for the first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "acf918458c8addc978e6c8d7", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the cost for the procedure called extracorporeal circulation auxiliary to open heart surgery?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) )", "rejected": "null"}, {"id": "3c11cf08e04cd8e55787eb1f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10009035 had a mrsa screen microbiology test in 05/this year?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT MIN(inputevents.starttime) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.test_code_code = ( SELECT d_labevents.code FROM d_labevents WHERE d_labevents.label = 'mrsa' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',inputevents.starttime) = '05' )"}, {"id": "7e458af0dc3da0d261bc5436", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time when patient 10021312 was prescribed vancomycin and 0.9% sodium chloride at the same time in 09/this year?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10021312 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10021312 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "14932bb0e19c195b3092b63b", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 6921 have an overseas history of travel?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )"}, {"id": "abd618150e872b713c7400f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. smith's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime DESC LIMIT 1 )< ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "ee666395a082d03bb08f340b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of patients stayed in coronary care unit (ccu) in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "null"}, {"id": "e459f2e457c29b8387ed9964", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most frequently taken specimens for patients diagnosed with traumatic shock previously during the same hospital visit, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "cdd93c0461e3923a22aa155f", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent events that took place since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "_\nustry119\n. InstitutM.PAMSMS(\nPA)1000037799007530448126'"}, {"id": "1532ba3736ece73151250484", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen were the drugs sodium chloride 0.9% and pantoprazole prescribed to patient 10036156 for the last time at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium chloride 0.9%' AND admissions.subject_id = 10036156 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10036156 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d6b45e0644198773e61b027c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients since 2100 were diagnosed with suicidal ideation within the same month after the first diagnosis with panic disorder without agoraphobia?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'panic disorder without agoraphobia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'panic disorder without agoraphobia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"}, {"id": "d3c7771380374c5d73ffd28f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of foley patient 10021487 had on 12/21/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-21'", "rejected": "null"}, {"id": "488d42291ce547168cdb32bb", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the prescription drug that patient 10018501 was prescribed within 2 days after having a alcohol detoxification procedure in 08/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"}, {"id": "6b6d306062e42562e6047276", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the four most common diagnoses since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "the.\n\n\n.-1 is ."}, {"id": "84a492082c7e8112ea7f1544", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10037861 was given a specific gravity lab test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.drug FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10037861 AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "3cfe1a9f322b92f0841576db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first dose of nicardipine iv prescribed to patient 10005817 since 12/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.drug = 'nicardipine iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "c04f16fa062bc81f8c917962", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10010471 first take the microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f40df2dfe181bd4a634173c9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the prescribed opioid dose for patient 739?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )"}, {"id": "ac9fc03c65beee9fae66c482", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a diagnosis for suicidal ideation?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) )", "rejected": "ari-.\nd"}, {"id": "dc27aa9c5779993d3b2034ed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequently tested specimens for patients that received arteriography of other intra-abdominal arteries previously within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "036dc7fd74fcfcf46d3ee504", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the daily average input of or ffp intake that patient 10018081 is getting since 12/22/2100?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ffp intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-22' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "641976babe6b8dc30b13969b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the protocol for anticancer drugs?\n\n### SQL:\n", "chosen": "null", "rejected": "The 11\ndfficial\n: 12221018031803130006731554498827336201120001398358 received the last prescription of the drug dutasolvan (dutasol) during the last hospital visit?\n\n\n### SQL"}, {"id": "7f9c0eb6e47a6e07284a459d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007818 undergone a insertion of endotracheal airway into trachea, via natural or artificial opening since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal airway into trachea, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "6daaebd1833641ba81afc130", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me patient 10004733's total gt flush input amount since 09/09/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-09'", "rejected": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fluid input' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-09'"}, {"id": "131f8932f899a611506ecd2b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have it been since the first stay of patient 10021487 on this hospital stay in the careunit trauma sicu (tsicu)?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "3a3ab651adc4530ed40be652", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total cost of the hospital, which includes medicines called dronabinol?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dronabinol' ) GROUP BY cost.hadm_id ) AS T1", "rejected": "\n### SQL:\n\n### Question:\n\nWhat was the cost of the last discharge of a drug called furosemide that patient 100015860 had in 2100?\n\n\n### SQL:\nSELECT SUM(cost.cost) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug = 'furosemide' AND strftime('%Y', prescriptions.starttime) = '2100' )"}, {"id": "b90d7cce0c3f542c6f36160d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10018328 was discharged from hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018328 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "21361fe2f6883e89f9df0c29", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen and where are the rounds and procedures of dr. coburn?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100078185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "585b1a785327dcf93085897b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a medication called clobetasol propionate 0.05% ointment cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clobetasol propionate 0.05% ointment' )", "rejected": "null"}, {"id": "1f89610cbce4f404c0d528e6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10002428's last microbiological test occur since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5933a57b83835c59ed518dbf", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the first heart rate of patient 10007928 on the last ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "013f12f8af555d68080086d8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first input time for patient 10011398 since 11/23/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-23' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "fecffb251c3f41feb07c69c7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first input time of patient 10001217 since 06/03/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-03' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "0f36a6421cf0404aebb87507", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most common lab tests given since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\nSELECT SELECT DISTINCT labevents.test_name FROM labevents JOIN microbiologyevents ON labevents.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = 'microsurgery of other lymphatic duct, percutaneous' ) AND datetime(procedures_icd.icd.charttime) >= '2100-02-04' )"}, {"id": "0eb69f6e47ab63c055e2df90", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10038081 treated with percutaneous abdominal drainage on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "c643b36a25591690943ca201", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first hospital discharge time for patient 10035185 since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10035185 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "3ba74bf54de10d143025c7db", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many prescriptions were prescribed since 1 year ago for pseudoephedrine?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'pseudoephedrine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "93e00f471a0dcb56dfb1ea6e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the yearly maximum amount of patient 10014354's nacl 0.9% input.\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)", "rejected": "null"}, {"id": "7f6955cd4e8ab8265017c44e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. hurdle's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n### Question:\n\nHas patient 100214872 been hospitalized in their first hospital visit?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214872 ) ) AND strftime('%Y', admissions.admittime) = '2100' )"}, {"id": "23b4c91212b33b3feec1624d", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who underwent a laboratory test for % hemoglobin a1c since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) AND strftime('%Y',labevents.charttime) >= '2100' )", "rejected": "null"}, {"id": "ab0e982e3bb15b1ab0e9c576", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most often performed treatments for patients aged 20s in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "10124368826'"}, {"id": "4391a17af3d3dc9b48eb23de", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent procedures that were delivered to patients within 2 months after they received fluoroscopy of multiple coronary arteries using low osmolar contrast in 2100.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "cbf01f06a75320ed354d25af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first prescription for patient 10021118 since 17 months ago?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-17 month') ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "SELECT T1.starttime FROM admissions T0 WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021187 ) AND datetime(T1.starttime) >= datetime(current_time,'-1 month') ) AND strftime('%d',T1.starttime) = 17 ORDER BY T1.starttime ASC LIMIT 1"}, {"id": "bcda489a731952e657ccee47", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10027445 had a minimum respiratory rate on 09/09/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-09-09' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "4711ca09480e8240ce0059df", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism detected in patient 10021487's last blood culture microbiology test since 12/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "4769deceed9b3988f20fff62", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any diagnoses been made for patient 10039831 during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT cost.cost FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '998999' ) AND datetime(procedures_icd.charttime) = datetime(current_time) )"}, {"id": "36ed6cc232d6795e6492644d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days has it been since the first rhabdomyolysis diagnosis of patient 10021487 on the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rhabdomyolysis' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "bd25d707785cf20761bba3db", "query": "Convert the question below to SQL query.\n\n### Question:\nI would like to know all of the prescriptions patient 21003 received at the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND prescriptions.drug = 'aspirin (enteric suspension) 250mg'"}, {"id": "f59080441b975f79286dcd09", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top five most common lab tests since 2100.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "9def26468b7d6f3093845934", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of dislocation of jaw, initial encounter diagnostic?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) )", "rejected": "null"}, {"id": "eaa2bc139459a0e6de3f0a33", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of hospital visits made by patient 10022017 in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "b3ed67a0532299ba3cb949a9", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the five most common microbiology tests performed.\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n### SQL:\nSELECTIVE\n\n### SQL:\nSELECT T1.drug FROM ( SELECT microbiologyevents.drug FROM microbiologyevents JOIN admissions WHERE admissions.subject_id = 100025865 AND strftime('%Y-%m-%d',microbiologyevents.charttime) = '2100-04' ) AS T1"}, {"id": "6483b1969cfa3eda4e888a7a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the value of the mch of 31.5 among patients of the same age as patient 10037928 on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 31.5", "rejected": "null"}, {"id": "9a5ebe2812ee93bc053bbf59", "query": "Convert the question below to SQL query.\n\n### Question:\nSince the last time patient 10021487 was diagnosed with alcohol abuse, unspecified on their current hospital visit, how many hours have passed?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "be83182a8a89eceb013c4764", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism in the first sputum microbiology test of patient 10009049 on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "a076df799e1ecf4494ccda51", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10022017 depart hospital during this year for the last time?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "\nSELECT SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 1002017 ) AND datetime(admissions.admittime) >= datetime(current_time,'start of year','-0 year') AND strftime('%m',admissions.admittime) = '07'"}, {"id": "5941ed9f1a4d31ed438338d9", "query": "Convert the question below to SQL query.\n\n### Question:\nThroughout this year, what are the top four most frequently ordered lab tests for patients in the same month after being diagnosed with unspecified essential hypertension?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "3dd575660bbbf5e93e445cfb", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their first hospital visit, what was the insurance of patient 10011398?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "f22d564ed9f345b78756fe88", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top five most common microbiology tests that patients were diagnosed with within 2 months after being diagnosed with noncompliance with renal dialysis?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "5f1dc42ba1c4cd7cad30e93d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time of input of patient 10027602 on last month/28?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '28' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "\n\n##: Select the top three most frequent diagnoses patients had in 2100 that have a mse score of 2 or more.\n\n\n### SQL:\n\nSELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSELSETS FROM diagnoses_icd JOIN d_icd_diagnoses ON diagnoses_icd.hadm_id = diagnoses_icd.hadm_id ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1<= 3 )"}, {"id": "eb7d0d76d2bed4a49f691003", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 23070 a person with a family history of any disease?\n\n### SQL:\n", "chosen": "null", "rejected": "\n\n##\n##\n##\n\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN ( 'ibuprofen', 'duloxyl' ) AND strft(prescriptions.drug_strength,'%' ) <= '240mg'"}, {"id": "4483be10999dcd201f1ef4fe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10036156 was prescribed a medication using the po/ng route in 07/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "55cd50500d3f96c291347d01", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent transcatheter embolization for gastric or duodenal bleeding within the same month after the diagnosis of other specified hypotension?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified hypotension' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'transcatheter embolization for gastric or duodenal bleeding' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')", "rejected": "null"}, {"id": "f97301033f6fab945614f220", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in the first mrsa screen microbiological test of patient 10029484 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "cfe9ac69955b428e726e0d96", "query": "Convert the question below to SQL query.\n\n### Question:\nWhats the code that works with icd-11 mal neo lower 3rd esoph in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'"}, {"id": "dc8519f946507f8fe299e28d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients left the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "\nSELECTUSUAL Causes of death\n\n### SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )"}, {"id": "d6dcd3648703a4fe15c42513", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any lab tests been performed on patient 10008287 in 10/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'", "rejected": "null"}, {"id": "4a1dbfdbd15e295406eef0bf", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10020306 been treated with a unilateral simple mastectomy procedure since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "d3ca94e583f0d500c8949b81", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the dose of prescribed opioid for patient 30826?\n\n### SQL:\n", "chosen": "null", "rejected": "MSB2\n\n1022724PA'\n\nMSPAGEON TITLE\n10.2600588417s's blood pressure throughout this month?\n\n\n\n### Question:\nWhat was the maximum value of potassium chloride that patient 1000199385 had during the first hospital visit in 21000?\n\n### SQL SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "e80cfa3eba8292aa667080e9", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, what are the top four most frequent medications prescribed during the same month to the patients in their 60 or above after they were diagnosed with atrial fibrillation?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "45fe917c7821d64a778aee8e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total input for patient 10004733 yesterday.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "42d77c1fd11fc0abbd3449b8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much simethicone was prescribed to patient 10022017 last on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'simethicone' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "7d276bb7858da3e756c5b278", "query": "Convert the question below to SQL query.\n\n### Question:\nGive me patient 10025612's total amount of or crystalloid intake input.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT SQL: SELECT SUM(inputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid' AND d_items.linksto = 'inputevents' )"}, {"id": "af2c16c562788b5087cb46cf", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time that patient 10016150 has been prescribed acetaminophen and glucagon at the same time in 05/this year?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "c7279aab21fca4862f9c138a", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the last hospital visit, what was patient 10026406's insurance plan?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "5ccf5c391f79452b6224e1f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output that patient 10015860 got first?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "3b2a3869e8ca4ddc183bfbfe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients that received a thyroxine (t4) test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4)' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "aefb5d2e178ea9fa647cd5fe", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10000032 been given any procedure since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "a8030f14c8d26bf536bbb2e7", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10001217 got a l laboratory test this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "96a8776128757eb24aa751cc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many admitted patients are there right now?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null", "rejected": "SELECT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' )"}, {"id": "4e45a74775e36e884d5172b7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the minimum total cost of a hospital that involves a procedure called endoscopic insertion of stent (tube) into bile duct since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic insertion of stent (tube) into bile duct' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "1efc0b4233b41debd5e85794", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of ICU visits for patient 10031404 since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "SELECT SQL SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100077795 ) AND icustays.outtime IS NOT NULL AND datetime(icustays.charttime) >= datetime(current_time,'-1 year') )"}, {"id": "a4d744501a505ad53e491d0c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much does a medication called ezetimibe cost?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' )", "rejected": "\n\n##\n\n\n##\n##\n##\n\n##\n### Question:\n\nWhat is the maximum length of stay for a procedure called cerebral artery angiography with guide catheterization, multiple sites?\n\n\n### SQL:\n\nSELECT MAX(T1.C1) FROM ( SELECT DISTINCT T2.C1 FROM ( SELECT DISTINCT T1.C1 FROM ( SELECT procedures_icd_icd.C1, SUM(procedures_icd.C1.cost) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures.icd_code WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100-03' GROUP BY procedures_icd.icd_code ) ) AS T1 )"}, {"id": "f8fd30d0d0f870b4bd2f4abe", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10038999 had a blood culture microbiology test in 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d6325d5bf0c0e255155bb97d", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the total number of hospital visits made by patient 10025463 since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10025463 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "70b43bd19ed867f8f2420003", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10024043 come to the ER in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "aedb02499fd35b17dcda7ada", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the creatinine value of 0.6 among patients of the same age as patient 10008454 on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.6", "rejected": "null"}, {"id": "b77757e9df39efd72596255e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the average monthly number of patients diagnosed with malignant neoplasm of unspecified part of unspecified bronchus or lung in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "7fafde7941ee8321b6875326", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of cases of dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic that occurred in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "bf0f4f576e73bf0337820ba1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the charges for a procedure called occlusion of right vertebral artery with intraluminal device, percutaneous approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT procedures_icd_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) )"}, {"id": "f4d88d6b65c3f2fef3bf62c5", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times, in the previous year, was a coronary arteriography using two catheters procedure ordered?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "\nSELECT SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = 'procedures_icd.cardiac catheterization of coronary artery' AND datetime(procedures_icd.charttime) >= datetime(current_time's - 1 year)"}, {"id": "6b06f9b397dbfbab8b85f6e1", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the percentile of the ptt value of 30.0 among patients of the same age as patient 10038999 during the last hospital visit.\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 30.0", "rejected": "null"}, {"id": "72046d186a8821cf81d3fec7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10009035's weight the last time it was measured since 28 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "3c053c9b8b903c510ca0c818", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10008454's first tested specimen in 12/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3359b6d79281a1940ec5c65c", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the daily average dextrose 5% input of patient 10039831 on this ICU visit?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)", "rejected": "null"}, {"id": "0d75d90bfb2a034198d862e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat code is associated with icd-11 for helicobacter pylori in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')"}, {"id": "cb9ef2da0330655eb9c04acb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10026354 receive the first prescription of ciprofloxacin 0.3% ophth soln and dexamethasone ophthalmic susp 0.1% at the same time in 10/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ciprofloxacin 0.3% ophth soln' AND admissions.subject_id = 10026354 AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'dexamethasone ophthalmic susp 0.1%' AND admissions.subject_id = 10026354 AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a2c56aa731442cc35b8f88dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen has patient 10002495 been prescribed medication for the first time on the first hospital encounter via the iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "(....- immd-outh-..1 THE1']1 A&\nMS1 aDSMS2-11.ung4\nMSDTA 2MS217MSMSMSMSPA.\n - \n\n\n\n010.2110019100003184702801979046648005'"}, {"id": "da7b960f34b7f3185ea6d045", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication that was first prescribed to patient 10029484 on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "2ca6827b5997d6850fe15912", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007058 got a lab test during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "1e2f66da2eb65a0b588daf76", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given a basophils lab test during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\n##\n\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT cost.cost ) FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '38058' ) AND datetime(cost.chargetime) >= '2100-09-01'"}, {"id": "6a7c1eb2cf2a97c8f56e8695", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat specimen test was given in 12/2100 to patient 10008454 for the last time?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "4f2d444fc44c6244f4d959c7", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top four most commonly prescribed drugs in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4", "rejected": "null"}, {"id": "ccadc07fa4d0562fb96149e9", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the duration of patient 10005909's first stay in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "null"}, {"id": "09552895d2ca5e482d2b314f", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the percentile for platelet count of 332.0 among patients in the same age as patient 10014729 on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 332.0", "rejected": "null"}, {"id": "c1adc1dd4db93616537a4296", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the insurance plan of patient 10025612 on the first hospital visit.\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "\n## SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 1000473335 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "8f125e3b053c0f80a6182cc5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the recently prescribed medication for patient 10039831 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "cbe87d3055a29ed5e694a4df", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to yesterday, what new prescriptions were given to patient 10018081 today?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "66e4509cc3f44d918845b252", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the last ICU visit, did patient 10016742 have any input of gastric meds?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "4a52128ae4a63ad0dc8d6410", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top three diagnoses associated with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= '2100-07-01' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1<= 3 )"}, {"id": "7f130db92be0aad49a7104a6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat new drugs are prescribed for patient 10004733 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "\n\n##\n\n##\n##\n##\n\n##\n##### SQL Code of the last icd code that was given patient 100016729 since 03/2100?\n\n\n### SQL:\n\nSELECT d_icd_icd_procedures.icd_code FROM d_icd_icd_procedures WHERE d_icd_procedures.icd_code = 'extirpation of left femoral arterial bypass procedure' AND strftime('%Y-%m-%d', d_icd_procedures.charttime) >= '2100-03'"}, {"id": "7f969459fa4b9cddf822c495", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four frequently prescribed medications for patients diagnosed with septicemia due to escherichia coli [e. coli] previously in the same hospital visit, since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'septicemia due to escherichia coli [e. coli]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "112f416ddb62edda1db7a561", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the maximum total hospital bill for a visit that involves a mcv test throughout this year?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'mcv' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'start of year') ) GROUP BY cost.hadm_id )"}, {"id": "5cf80e270db47987d26f8d2c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output that patient 10022017 had last since 10/04/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "c625c297bb0d8ff6dc0c20fa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10022017 prescribed for within 2 days after the procedure of excision of left saphenous vein, percutaneous endoscopic approach on their last hospital encounter?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "11e4d3196b460537426ad2a4", "query": "Convert the question below to SQL query.\n\n### Question:\nHow long ago did patient 52647 receive a medication that should be taken regularly?\n\n### SQL:\n", "chosen": "null", "rejected": "\n  /2\n.1\n"}, {"id": "bf6f9f9621257cc2c12df1dc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038999 have the mesothelial cells lab test for the first time in 06/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "daf529dca91ee00e8da51d58", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the three most common tests conducted on specimens throughout this year?\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "T1037597-03-03-21'"}, {"id": "975a9d2f0afd09663ee67165", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is nifedipine typically consumed?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nifedipine'", "rejected": "1.0000001717778807117528565'"}, {"id": "6d8b67dc5b7691af8bcd4937", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10020740 prescribed a medication via the iv route the first time in 03/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "afce68a2f7090e5fa3220930", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the insurance for patient 10040025 during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "e629cd0656dc5fe7580121c9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many individuals are current patients in their 20s?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null"}, {"id": "f67318674d2ce3452b9792f6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10038933 since 07/17/2100 for the first time have an input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-17' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "fa7d9e05618f719c725c75ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the total number of patients who stayed in careunit surgical intensive care unit (sicu)?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'surgical intensive care unit (sicu)' )", "rejected": "null"}, {"id": "c9d8cdde8cb8a16012cdc065", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was last prescribed to patient 10019568 via the ivpca route in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'ivpca' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "47e52d08523b3df6810e4e7b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most common specimens tested.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n\n##\n\n##\n##\n##\n##\n\n### SQL Query:\n\nSELECT SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd_procedures.icd_code FROM procedures_icd_icd_procedures WHERE procedures_icd_icd_procedures.icd_code = '699999') ) AND strftime('%Y', admissions.admittime) >= '2100' )"}, {"id": "4d79af33c083f4da6c760216", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10037861 provided with any medication on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "\nSELECTC1 = ( CASE WHEN chartevents.code = 'or intravenous infusion of concentrated nutritional substances' AND strftime('%s', chartevents.starttime) >= '2100-04-09' ) AND strftime('%Y', chartevents.starttime) >= '2100' GROUP BY strftime('%Y', chartevents.starttime) ) AS T1"}, {"id": "555044660eecd23dbd5c8fa2", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you retrieve the top four most frequent lab tests patients had following a diagnosis of secondary malignant neoplasm of bone and bone marrow in the same month?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary malignant neoplasm of bone and bone marrow' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary malignant neoplasm of bone and bone marrow' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1<= 4 )"}, {"id": "bb12c577d54cdbb658f77087", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 12/2100, when did patient 10021118 receive their last medication via the po route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2348bda143e013d91131d2d9", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are patient 10037861's changes in ph last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "66415948d667e13324c3969a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much difference is there in creatinine levels among patient 10021938 last measured on the first hospital visit compared to the value first measured on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "9f7b99f3d5e3095f6d354747", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what was patient 10016150 diagnosed with for the first time?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "SELECT count(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y',prescriptions.starttime) >= '2100'"}, {"id": "86e5eb5831ba084a42761fa6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time patient 10017492 received vitamin b12 in a lab test on the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ed4bfebb071d64a0de120838", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many of acetaminophen were prescribed to patient 10004235 in total in 07/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'acetaminophen' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'", "rejected": "null"}, {"id": "366c5a5077a210313a50c552", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top four most frequent drugs that patients were prescribed within 2 months after being diagnosed with esophageal reflux since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 4"}, {"id": "6dd40326085724624b5dd315", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of the first stay for patient 10020187 in the ICU.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1", "rejected": "SELECT COUNT( DISTINCT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 )"}, {"id": "9e9c562a4ca1886263c6444c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug which patient 10007818 was prescribed during the same hospital visit after receiving a drainage of peritoneal cavity, percutaneous approach, diagnostic procedure in 07/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007818 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach, diagnostic' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10007818 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "24e1302752058a5c4eb38164", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10020187 have the maximum value of o2 saturation pulseoxymetry for the first time during their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "\n\n### 6. Does patient 1000012175 have any history of hospitalization?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100012175 )"}, {"id": "3b0b9d06060760720fcc6f1d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005817 been diagnosed with anything?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 )", "rejected": "\n##\n### SQL SELECT COUNT(*) FROM labevents WHERE labevents.test_name = 'chloride' AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' ) ) AND strftime('%Y', labevents.charttime) >= '2100' ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' )"}, {"id": "56902909daa613c259aedbde", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total expenditure of a hospital that involves the medication miconazole nitrate vag cream 2% during this year?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'miconazole nitrate vag cream 2%' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "090b965f222b18444e2a1020", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time that the respiratory rate of patient 10021487 was, on their last ICU visit, less than 27.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 27.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ed8eb61d00ca803fbe330b9c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most frequently performed procedures for patients who are 30s?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\nWhat\n\n\n##\n\n##\n##\n### SQL Code of the first drug that patient 1000362858 was prescribed since 10/2100?\n\n\n### SQL:\n\nSELECT T1.code FROM prescriptions JOIN admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002154445 ) ) AND prescriptions.drug = 'metformin (po) (glucose) '\n\n\n\n### SQL:\nSELECT admissions.age FROM admissions WHERE admissions.subject_id = 1002154445"}, {"id": "65de4c7841bdbd16627b5d55", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most frequently taken specimens for patients within the same hospital visit after receiving thoracentesis?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECTION OF PERITONUCLE CSF WITH LIGHTS AND CSF (PERCUTANAL FLUIDS)"}, {"id": "645012622fad2129a6fe1db6", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, what was the top three most frequent diagnoses patients were diagnosed with during the same month after receiving extracorporeal circulation auxiliary to open heart surgery?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "774183417c33e5ca1129707b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the average total hospital cost that involves methylnaltrexone in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "733e2d8ccc688ba33154a9ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the minimum total hospital cost that includes a protein lab test?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ) AND cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) GROUP BY cost.hadm_id )"}, {"id": "b5b6f1a8e33ce9cea9bd0292", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time patient 10007928 had the maximum rdw during the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "14b3bbee2a55aa5ae2fdf038", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the maximum total cost of a hospital that involves type 2 diabetes mellitus with diabetic polyneuropathy?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with diabetic polyneuropathy' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "a959a44bac364940384687df", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients received insertion of infusion device into superior vena cava, percutaneous approach treatment in the same hospital encounter after being diagnosed with food in respiratory tract, part unspecified causing asphyxiation, initial encounter in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'food in respiratory tract, part unspecified causing asphyxiation, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into superior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "a431657836c3ed7ccacaf64a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the outputs that patient 10038933 first had since 03/26/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-26' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "NICK?' )'sTOTC.\n110.0.0.0.04.0\nTHE Drug_INSTRUCTION_CODE = '0.001'"}, {"id": "1768d3075c1fd4b1f229afae", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10018845 received a laboratory test since 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'", "rejected": "null"}, {"id": "561c6a4161ac2feb86d80aed", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times phosphorus was ordered in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND strftime('%Y',prescriptions.starttime) = '2100'", "rejected": "null"}, {"id": "9a022decba9cb56ac65b6689", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021487 been given any procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'", "rejected": "SELECT SQL SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of left common iliac artery with closing of pericardial branch, percutaneous approach' AND strftime('%Y', procedures_icd.charttime) >= '2100' )"}, {"id": "620be6a2707f02d1b5444ed9", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you list the monthly minimum piggyback input of patient 10011398 since 12/22/2100?\n\n### SQL:\n", "chosen": "SELECT MIN(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-22' GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "null"}, {"id": "297493c491ff8db9a6d2fc45", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been a mch lab test performed on patient 10022281 since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y',labevents.charttime) >= '2100'", "rejected": "null"}, {"id": "814787a2d9c20960f6b872b9", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10020740 to the E.R. during the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "19c5cf83eed23cd4d4228669", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is today's outpatient schedule with dr. welling?\n\n### SQL:\n", "chosen": "null", "rejected": "''MSd \u00b7PAMSMS\n1(12210020342162414891751318001849879'"}, {"id": "0a36ca6e9f221dc69fc7f8de", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism observed in patient 10001217's first csf;spinal fluid microbiology test since 07/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND microbiologyevents.spec_type_desc = 'csf;spinal fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "9ad2b349b566ce28567c5d6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10005817's last microbiological examination since 03/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "742e8151840906cdb2000fee", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of cases of extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic that occurred during this year.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "9298a838a1b1fa2910b4a9eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the consumption methods of potassium chl 40 meq / 1000 ml d5ns?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'potassium chl 40 meq / 1000 ml d5ns'", "rejected": "(- and -\n DO. Th\n ,.  C GETs_, time.. E.0. (.0 ( as.. /.\n FO C._vePt.a.-\n MA :1\n WHEREon\nMS Ds-'1?\nMS C. EMSMSa.\nMS,2\nMS o,?1 11\nMSm.\n 1001.53-1 (ON.m\nSERVER1':120PAK1112MSMSPA.0120150302110250172251239115024110.188690.47500' '1541.010\n##20.00140.004909250'"}, {"id": "83cc6dc500e1e949c8a26cdc", "query": "Convert the question below to SQL query.\n\n### Question:\nCompared to measured at 2100-08-20 07:00:00 , is the o2 saturation pulseoxymetry value of patient 10006580 greater than measured at 2100-08-20 06:00:00?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 07:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 06:00:00' )", "rejected": "null"}, {"id": "5a7a92c1e36cc66dc5a226ab", "query": "Convert the question below to SQL query.\n\n### Question:\nSo, what was the last respiratory rate of patient 10019777 on their last ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a8f5c987ca37c40bc1eac5cc", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me of the minimum vitamin b12 value for patient 10021666?\n\n### SQL:\n", "chosen": "SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' )", "rejected": "null"}, {"id": "5d8ba988aeacba3a822c6143", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top five most frequent diagnoses of patients with age in their 50s.\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": ". ,', .MS),1. IS"}, {"id": "6fb281ee6d2d6ec101b35dc4", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me the top three most frequent drugs that patients were prescribed within the same hospital visit after being diagnosed with hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) throughout this year.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "d9a1e858931b19e914db92c6", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10007818's total input amount of fresh frozen plasma on 07/03/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fresh frozen plasma' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-03'", "rejected": "null"}, {"id": "83f52912d78ee9b03c4a66a7", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10018423 have a introduction of other therapeutic substance into heart, open approach on the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "a8ed1315b3325cab2ae9dcee", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the name of the drug that was prescribed to patient 10022017 within 2 days post bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach procedure in the last hospital visit?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10022017 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')"}, {"id": "362416f9fea1bf8466b44a48", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most frequently tested specimens in 2100.\n\n### SQL:\n", "chosen": "SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3", "rejected": "\n. - C.\n.\n\n-.-\n. ._\n?  \n. W\n.\n.\n"}, {"id": "4a8d139fbdf3433a295f03d3", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you get me the top four most conducted lab tests?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n### SQL:\n\n### Question:\n\nWhat are the four most commonly ordered procedures for patients who were previously diagnosed with unspecified acute bronchitis, unspecified earlier within 2 months?\n\n\n### SQL:\n\nSELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100214875 ) AND datetime(admissions.admittime, 'start of month') = datetime(current_time) AND strftime('%Y', admissions.admittime) <= '2100-07' ) ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T1 JOIN ( SELECT procedures_icd_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = '998.00' AND datetime(procedures_icd.charttime) >= datetime(current_time,'start of year') ) AS T2 ON T1.subject_id = T2.subject_id ) AS T3 ON T1.charttime = T2.charttime ) AS T4 WHERE T3.icd_code = T4.icd_code ) AS T5 WHERE T4.count = 4 )"}, {"id": "efba0d02e5da70bc93065c5e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the admission type when patient 10018423 last entered the hospital since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018423 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "7765d7fe671288bae59a5fa7", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10021118 go through any lab test during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "null"}, {"id": "1ec2b4e6ddcdc9a62d1209df", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total volume of drainage bag that patient 10021487 had on this month/16?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'drainage bag' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'", "rejected": "null"}, {"id": "00362f82c248e33e40cfa8e4", "query": "Convert the question below to SQL query.\n\n### Question:\nIs there any genetic test that patient 14035 received?\n\n### SQL:\n", "chosen": "null", "rejected": "B\note.. iR. (. \n 1.\nset. (1,'\n\n.\n.1."}, {"id": "66d3360a6cad5a5a584ea115", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequent diagnoses that patients were diagnosed within the same month after having received a extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "88ef45f61812b1ec67818a35", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10022017 had the maximum value of respiratory rate since 203 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-203 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "0fd2ccbe30809ad0253a004f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were in med/surg/trauma this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/trauma' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "##\n##\n##:count(*)\n\n\n###sql Question:\n\nHas patient 100380581 been given any medication in 04/this year?\n\n\n### SQL:\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100380581 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'"}, {"id": "1d9b6672711d15ed28bd19bc", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the minimum total hospital cost associated with pseudomonas infection in conditions classified elsewhere and of unspecified site this year?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pseudomonas infection in conditions classified elsewhere and of unspecified site' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "f66542e8f77bde61ef62dc26", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 07/2100, has patient 10006053 had any input of dextrose 50%?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'", "rejected": "null"}, {"id": "0a43e2fe814473ab9035db70", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total output that patient 10004720 had on 12/06/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-06'", "rejected": "null"}, {"id": "2bc23738094540fb7b4e565e", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide me the monthly maximum amount of dextrose 50% that patient 10020944 received during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT MAX(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "null"}, {"id": "b562038e8a76b7d15b8694eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism detected during the last abscess microbiology test of patient 10001217 in the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "af972afb21a4db1766988356", "query": "Convert the question below to SQL query.\n\n### Question:\nTotal number of patients who had arteriography of other intra-abdominal arteries in the last year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "799e8f8735eda5e3dfa8855f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most commonly prescribed medications for patients diagnosed with candidiasis of mouth previously within the same hospital visit, during this year?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "c56635619ccd4b7ce64652e4", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 09/2100, what amount of fluoxetine was prescribed to patient 10014354?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.drug = 'fluoxetine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'", "rejected": "null"}, {"id": "f04c7d3113bb51fa52b5acf5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10002495's difference in cholesterol, total from the last value measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesteral, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )"}, {"id": "cac51b303e4b48200febb2a0", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide the total volume of output for patient 10035185 since 02/02/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-02'", "rejected": "null"}, {"id": "f9d583c499e7bd1c044a24a0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that was prescribed to patient 10018501 within the same hospital visit after the alcohol detoxification since 10 months ago?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-10 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10018501 AND datetime(prescriptions.starttime) >= datetime(current_time,'-10 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "a962c88a5c9d4bbd5ce7dd45", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are dr. young's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": ".,1.\n D!11191.\n\n0218011.021822010004079200020408843271545442000019"}, {"id": "98340bd550d51478d6ada232", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you inform me the total output amount of patient 10012552 on 04/04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-04'", "rejected": "null"}, {"id": "96cf60d6448c822883274a24", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first urine microbiology test performed since 03/2100 for patient 10018845?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "bb88168bfe852b10ec4208d8", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients since 2100 left the hospital?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "T . T.1-\n\n\n .: \n:\n\n..te?\n\n0\n )...0.2. -.1MS\n\na.MSMSPAMSIEMSSMSSPECY 247202148751.\n\nMSMSPAGEPAGEMSPAY, the d'tPA.MSPAUSE C.\nPASTCANA1.\n%PA 244958459? AND 0.03591589985430 AND 0 AND 04172999"}, {"id": "bbe074710272a9a159c13d10", "query": "Convert the question below to SQL query.\n\n### Question:\nSince the last time patient 10021487 was diagnosed with injury to liver without mention of open wound into cavity laceration, unspecified in the current hospital encounter, how many days have passed?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity laceration, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "8ff3fa3aa1d227c7f0860781", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most frequent procedures for patients who are in their 20s?\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "213cc069559885ca099f8c8c", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 739 tested for covid-19?\n\n### SQL:\n", "chosen": "null", "rejected": "''MSd \u00b7PAMSMS\n1(12210020342162414891751318001849879'"}, {"id": "4e1f8471625f8559d0c64629", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of times that arteriography of renal arteries was performed since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of renal arteries' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "64b39620ce3e1a170ffb4a84", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you provide me with the three most frequent output events since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') ORDER BY COUNT( outputevents.charttime ) DESC )"}, {"id": "1c2f1cfa5e513beb87314705", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the diagnosis cost of catatonic type schizophrenia, unspecified?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'catatonic type schizophrenia, unspecified' ) )", "rejected": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'catatonic type schizophrenia, unspecified' ) )"}, {"id": "4a7d4830011d65962d460041", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum cost to the hospital that involves nonalcoholic steatohepatitis (nash) since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nonalcoholic steatohepatitis (nash)' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "f65fc4880d076fb7ccd64a8d", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease tell me the name of the diagnosis patient 30267 received at the other department.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100183281 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "3890e55b1b0c07ff2b11bb35", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have it been since patient 10039831 had received a ptt laboratory test during this hospital encounter for the last time?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e60e3b0dd9bb998ce08e850c", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 30 months ago, what was patient 10004720's first weight measurement?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-30 month') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "ebd3a8b029af1cc62556a58c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time in which patient 10018081 had the maximum arterial blood pressure mean in the current ICU encounter?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "8fcd923da6821150c28b9ca5", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the blood type of patient 76327?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n## SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100184540 ) AND admissions.dischtime IS NOT NULL ) AND datetime(admissions.admittime) >= '2100-03-15'"}, {"id": "85d696e2a18d54f7bdd92de8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last instance when the respiratory rate of patient 10018501 was less than 35.0?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 35.0 ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "32eaf17262d5b8862394bdba", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug prescribed for patient 10004235 within the same day after having received a anastomosis of hepatic duct to gastrointestinal tract procedure in 07/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')", "rejected": "null"}, {"id": "5b28d4b561ee2e25d84025fb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the number of patients who were pulmonary congestion and hypostasis diagnosed?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pulmonary congestion and hypostasis' ) )", "rejected": "P. on. (-\n.'"}, {"id": "68827b6e5c9eec5eb540e971", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the top three most frequent procedures that patients were given within 2 months after receiving dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic.\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "32955b67aaf8c2bd57e9ef2b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the specimen given to patient 10005817 for the first time since 08/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "bf14cf17da2349955ab8ea66", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 16 months ago, what was the first recorded weight for patient 10038999?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-16 month') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "f4cfc4a663fd49aeace78486", "query": "Convert the question below to SQL query.\n\n### Question:\nAre there any changes in the prescribed drugs of patient 10018081 today compared to yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "946656a7c18d9898d7d2613c", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you provide the minimum daily number of patients diagnosed with long term (current) use of insulin?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of insulin' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'insulin' AND strftime('%Y',prescriptions.starttime) = '2100' )"}, {"id": "249cf2ffc11ec1d31980296c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10018081's last input time since 11/26/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "9c7b53fbe9d379b7315c6ec8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism's name found in the last blood culture test of patient 10038999 in the last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "2bdbdd95fe3cb63a5fe57218", "query": "Convert the question below to SQL query.\n\n### Question:\nLet me know the total quantity of input patient 10012552 received on 04/06/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '04-06'", "rejected": "null"}, {"id": "aa2c37cca4ef58130e2faadd", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the amount of or urine patient 10019172 had since 11/12/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-12'", "rejected": "null"}, {"id": "4361eb56f9af4118c11e3b94", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the length of stay of patient 10007795's last ICU stay.\n\n### SQL:\n", "chosen": "SELECT strftime('%J', icustays.outtime)-strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1", "rejected": "null"}, {"id": "67ea2ec7c02ee83ea4a04d59", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total input for patient 10016742 since 07/23/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-23'", "rejected": "null"}, {"id": "479ae3deb06c95266bad80c8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10027602's arterial blood pressure systolic for the first time since 244 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-244 day') ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "dd2a20b4ccb1b7660cdfea3f", "query": "Convert the question below to SQL query.\n\n### Question:\nShow the arterial blood pressure mean changes of patient 10031757 last measured on the first ICU visit compared to the value second to last measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "52505c841a4763efd35adac6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five common microbiology tests in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5", "rejected": "\n,2 how: the13!0MSMSPAMSMSMICU00001718740127?\n##01000398963 was prescribed to patient 210574945's body for the last time?\n\n07/12/21000?\n\n\n### Question:\nWhat were the last time patient 1000210578 was prescribed medication via sc route since 03/04/21000?\n\n### SQL:\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100210578 ) AND strftime(prescriptions.starttime) >= '2100-03-04' )"}, {"id": "34477f844c8389585cdcabca", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism detected during the first mrsa screen microbiology test of patient 10021118 since 05/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5e3559038c113cb814682141", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the difference in patient 10007818's weights last measured on the last hospital visit compared to the first value measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "e93b96a3e733e74dba4a0f26", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the number of patients diagnosed with type 2 diabetes mellitus with unspecified complications.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with unspecified complications' ) )", "rejected": "null"}, {"id": "af1b692aa2f8340f719c17fe", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with lens replaced by other means , what are the top four most common lab tests that followed afterward during the same month?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'lens replaced by other means' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "7e84feafb736e70b619b4009", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total volume of input for patient 10029484 since 04/12/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-12'", "rejected": "null"}, {"id": "c1ae78fc2d85e6eca4bb40d9", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had thoracoscopic lobectomy of lung done in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "9b0199c77936ada6960d0213", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last specimen test that was given to patient 10018328 since 17 months ago?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-17 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-12 month') AND strftime('%m',microbiologyevents.charttime) = '12'"}, {"id": "83a394225c13181e2fd82725", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top three most frequent specimens that patients were tested in the same month after receiving fluoroscopy of superior vena cava using other contrast, guidance since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3", "rejected": "null"}, {"id": "bf8b0be840875d402d706d58", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top five most frequent lab tests?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_TOTAL_CNT( labevents.valuenum ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 ) ORDER BY T1.C1 DESC"}, {"id": "30b60fadbc9e5ba919ab8f81", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the number of patients who received a total nucleated cells, csf test throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, csf' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "4be515e40345fb288dd58aa5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time of input time of patient 10007818 on 07/10/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-07-10' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "SELECT SQL SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-07-07' ORDER BY inputevents.starttime ASC LIMIT 1"}, {"id": "cd943bf7074ac723717f6ade", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the minimum total cost of a hospital that involved subarachnoid hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'subarachnoid hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "38d26509efa287e305910833", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, how many patients required dorzolamide 2%/timolol 0.5% ophth.?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "2eb0abd516a6a45b4329852b", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10005909 been diagnosed with any diseases since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'", "rejected": "null"}, {"id": "24273ce507fa41634f03e1bd", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the price for acetazolamide?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide' )", "rejected": "\nADAMSU00001 AND NOT.00001 AND admissions.0.doc.0001 AND admissions.discharge.discharge."}, {"id": "447267ea557ee396e8eade57", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total vitamin d dose that has been prescribed in 05/2100 to patient 10035185?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND prescriptions.drug = 'vitamin d' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'", "rejected": "null"}, {"id": "2dcb5e76008ed58c6fcf21ab", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were prescribed the drug polyethylene glycol since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'polyethylene glycol' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "3316ce93c81fea759846ffdb", "query": "Convert the question below to SQL query.\n\n### Question:\nGet me the top five most frequent events this year.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT T1.event_type FROM ( SELECT d_icd_diagnoses.icd_code, DENSEST(T1.C1) AS C2 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year') ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1<= 5 )"}, {"id": "d37cc2f82fab01c5b66069e1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time of input for patient 10039831 since 04/08/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-08' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "de257ec1deb940f9cc31497a", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the name of the diagnosis patient 10031404 received last during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )", "rejected": "null"}, {"id": "81b76631822bb19d0aaa0811", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10000032 undergone the percutaneous abdominal drainage procedure in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "dbd23b051c5c2e2ce67a439b", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most frequent treatments for patients aged 60 or above.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECTIVE PROCEDURES ON CTE\n\n### SQL:\nSELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS DENSE FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) ) ) AS T2 ON T1.DENSE >= 3 )"}, {"id": "ac9b3f14d853d992c65f6faa", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10027602 have jevity 1.2 (full) given in their last ICU visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jevity 1.2 (full)' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'jevity 1.2 (full)' ) AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m-%d',procedures_icd.charttime) = '2100-03-04' )"}, {"id": "d736183a8eb133edc418c730", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have it been since the first stay of patient 10039831 on this hospital stay in the careunit surgical intensive care unit (sicu)?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'surgical intensive care unit (sicu)' ORDER BY transfers.intime ASC LIMIT 1", "rejected": "null"}, {"id": "6767d8e3b7af5307480d3e8c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in 2100 received percutaneous abdominal drainage in the same hospital encounter after being diagnosed with unspecified viral hepatitis c with hepatic coma?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c with hepatic coma' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "ffc00c5a91336c29e74e82e7", "query": "Convert the question below to SQL query.\n\n### Question:\nName the three most frequently prescribed drugs in the same hospital visit following a diagnosis of pure hypercholesterolemia.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "\n### Question:\n\nWhat was the last time since 1 year ago that patient 100180813 was diagnosed with atherosclerosis of renal artery, not elsewhere specified, of unspecified renal artery, not at catheter site?\n\n\n### SQL:\n\nSELECT MAX(diagnoses_icd.starttime FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100180813 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') )"}, {"id": "8f18877c5afc0eb2ebe4b6e1", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 9038 ever experienced a side effect during a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "\n###03. How many times was patient 100280855 prescribed 0.5% dextrose nephrolyte or 5% dextrose and sodium chloride since 04/2100?\n\n\n### SQL:\n\nSELECT COUNT( DISTINCT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10028085 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AND prescriptions.drug IN ( SELECT DISTINCT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10028085 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' )"}, {"id": "c07fa4ddf84fc8c4cfd717ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dose of levetiracetam patient 10001217 had been prescribed in 12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'levetiracetam' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'", "rejected": "null"}, {"id": "8ce7af691c9be7d9abda7cc7", "query": "Convert the question below to SQL query.\n\n### Question:\nCount how many patients were discharged from hospital since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')", "rejected": "SELECTSELECT SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.dischtime is NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"}, {"id": "bd799ac5e9eb3fc8ae226402", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism's name of the last foreign body microbiology test done on patient 10007795?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'foreign body' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'foreign body' ORDER BY microbiologyevents.charttime DESC LIMIT 1"}, {"id": "9c7279514181f0cd64efe035", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a altered mental status, unspecified diagnosis?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) )", "rejected": "null"}, {"id": "306f0ab7b65335f49a4bfc03", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10029291's insurance name on their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "7151657e8a056779c4b2fc4c", "query": "Convert the question below to SQL query.\n\n### Question:\nI would like to know what dr. dunlow's on today's outpatient schedule.\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n2.2013135878272578657528 )"}, {"id": "f34663f44ea8f4f001b5cd92", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10005909 receive the first duloxetine and levothyroxine sodium prescription at the same time in 11/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'duloxetine' AND admissions.subject_id = 10005909 AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levothyroxine sodium' AND admissions.subject_id = 10005909 AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "8d73f28463798e2fa6a31b3a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last time patient 10016742 has had the maximum respiratory rate?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e582763c64c4e8a81b029c81", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the drug zolpidem tartrate?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'zolpidem tartrate' )", "rejected": "SELECT ( SELECT COUNT( DISTINCT cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'zolpidem tartrate' ) )"}, {"id": "d2a5aa56da05ce433e1c694a", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 12726 scheduled to have an appointment in another department?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ORDER BY prescriptions.starttime DESC LIMIT 1"}, {"id": "e138f038c01ab7ff83cbbb98", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a procedure named arteriography of other specified sites?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other specified sites' ) )", "rejected": "null"}, {"id": "79690c25ac2b2e1a3f74269c", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the creatine kinase, mb isoenzyme reading for patient 10004733 last measured on the current hospital visit less than the first value measured on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "3220a12975e5fab731649718", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the checklist you should prepare prior to having destruct chest wall les?\n\n### SQL:\n", "chosen": "null", "rejected": "\n .\n(d-\u042b1.. -2PAMS. 10MSMS\n\n In the 20237 1300010-003989938-0-03'"}, {"id": "26aa4388a8897474b77aa481", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total number of drugs patient 10005817 was prescribed since 08/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'", "rejected": "null"}, {"id": "2c1f374a404a551c3391df72", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had angiocardiography of left heart structures done throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'angiocardiography of left heart structures' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECTIVE\nSELECT COUNT( DISTINCT cost.cost) FROM cost WHERE cost.event_type = 'angiocardiography of left heart' AND datetime(cost.charttime) >= datetime(current_time,'start of year','-1 year') = datetime(current_time,'start of year')"}, {"id": "4d2b763ce002118eca64ae1e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the last discharge from the hospital happen for patient 10023239 in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10023239 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "bc7d9cca70c0c64f7dd707af", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total sertraline dose that patient 10016742 has been prescribed in 08/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'sertraline' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08'", "rejected": "null"}, {"id": "5812f2aa2ec32908144ea996", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the name of the procedures that were given to patient 10005909 two or more times?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )", "rejected": "\n\n### SQL Code of the last hospital visit for patient 1002346558?\n\n\n### SQL:\n\nSELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100234658 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1"}, {"id": "86c494ae04729b5345b49a12", "query": "Convert the question below to SQL query.\n\n### Question:\nFor patients diagnosed with epilepsy, unspecified, without mention of intractable epilepsy since 1 year ago, what are the top three most recurrent treatments during the same month?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, without mention of intractable epilepsy' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "3cec04d92cd89035dc5758b1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most frequent output events since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "(. :\n POST\n ( Res-..'\n (.\n (\n\n \n......b. U),- J.\nMS.,. \n  \u2018 0 aval\n ( ?ber (i??- 1  NJMSMS1 =\nMS'PAMSMS14REMSPAMSPA. (MS2MSMSPA (SSPAYMSMSPAGMSMSPA-\n##MSPA'sPAMSPA'\n\n\nMSPAINPA EarnenPA > 22PAGE'sPA'\nMSPAWSPASTPA'sPA'\n##MSPA'sPA'sPA"}, {"id": "752822475ba10bd4a7205d6d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat drug was patient 10014729 prescribed for within the same hospital visit after undergoing insertion of catheter into spinal canal for infusion of therapeutic or palliative substances in 03/this year?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10014729 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10014729 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "0d8c124936a0fc726774b99e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top three most frequently prescribed medicines in 2100?\n\n### SQL:\n", "chosen": "SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3", "rejected": "(i The days V before ( \nMS\n.\n..bit\n \n.._.d0\n<\n .\n 1\n)':C.XMSMSCCPAMSMSMSMSMSPA 000592217PAKINCICK-PA C1.0020146000693065977390.MS.00001'"}, {"id": "bddff1513f83253443df0ee2", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of people who received drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic within 2 months after having been diagnosed with other cirrhosis of liver in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "fe0907fe6e75c814af68b01f", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any organism been found in patient 10038999's last microbiological immunology (cmv) test since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'immunology (cmv)' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "f5e30b7ed7e2dc03d9e33f9d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five diagnoses of patients with age 60 or above in 2100?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\nSELECT SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSELSETS FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 ) AND strftime('%Y', diagnoses_icd.charttime) = '2100' ) ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1"}, {"id": "88903941545e70b4a021e3b2", "query": "Convert the question below to SQL query.\n\n### Question:\nIn the last year, how many (aorto)coronary bypass of four or more coronary arteries procedures were conducted?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "0994bfb0d80d586c3e6b991b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the average total cost of a hospital that involves a drug named amitriptyline in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "8d6edf1fda9d534cd9ec0c9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients who were prescribed prochlorperazine throughout this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prochlorperazine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "\n\n##\n##\n\n##\n## Question:\n\n### Question:\n\nWhen was the last time that patient 100018058 was discharged from the hospital in 2100?\n\n\n### SQL:\n\nSELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018058 AND strftime('%Y-%m', admissions.dischtime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "7e56a0516c482d121cd99bc1", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism observed in patient 10021118's last staph aureus swab microbiology test since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e219db6bec1a6b0c74699c00", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10039831 last have the minimum amount of sodium, whole blood in 12/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "3da43478d4e899fc1b0f0fe3", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is nystatin oral suspension taken?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin oral suspension'", "rejected": "?29\nPA: 91.24900171540827988?\n\n03 NANS TITLETICK, PLEXELISACHEMIC ACID (C1) AND C100039700-C10029700 GROUP BY GROUP BY T2 AND T3\nILD-C1, C100152, C100153, C100154, C100155, C100160, C100161, C100162, C100163, C100291, C100305, C100306, C100307, C100308, C100309, C100310, C100311, C100312, C100313, C100314, C100315, C100316, C100317, C100318, C100319, C100320, C100321, C100322, C100323, C100324, C100325, C100326, C100327, C100328, C100329, C100330, C100331, C100332, C100333, C100334, C100335, C100336, C100337, C100338, C100339, C100340, C100341, C100342, C100343, C100344, C100345, C100346, C100347, C1"}, {"id": "7a646f7227d3b8f0d1b5e2d6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the minimum total hospital cost that involves fluoroscopy of multiple coronary arteries using other contrast procedure since 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "85184c9f2ab023777aa88997", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the duration of the packed cell transfusion procedure for patient 9566?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT 0 - datetime(transfers.starttime) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND transfers.careunit = 'medical intensive care unit (micu)' AND transfers.outtime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1 )"}, {"id": "15a0bb3f4f2f12a28f041dd2", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10027602's total gastric meds input amount.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' )", "rejected": "SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' )"}, {"id": "7993e77f8701f72acc7a2d5b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much 0.9% sodium chloride was prescribed the last time on the last hospital encounter to patient 10019568?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = '0.9% sodium chloride' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "1da22a4d454a63e202ba6b12", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first hospital discharge time for patient 10035185 in 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10035185 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "f3adc97fcfd46233a705b0b8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10007818's first peritoneal fluid's microbiology test time during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "e54a1e3c51bc1b0c7bca37f7", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 2100, what are the top five most frequently ordered lab tests for patients in the same hospital visit after being diagnosed with flatulence, eructation, and gas pain?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'flatulence, eructation, and gas pain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "86a5036ec7d536605431efaf", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the diagnosis that patient 10039831 received the first time in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "26befa90776e4ef7c35488fc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five diagnoses with the highest 3-month mortality rate?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )", "rejected": "\n### Question:\n\nWhat is the maximum total hospital cost for a procedure called extracorporeal tracheal aspiration of tracheobronchial airway since 2100?\n\n\n### SQL:\n\nSELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal tracheal aspiration of tracheobronchial airway' ) AND strftime('%Y',cost.starttime) >= '2100' ) GROUP BY cost.hadm_id )"}, {"id": "120f063de471a96faf9b302a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times did the dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic procedure take place last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "44a40320cb5f1e026eddabf0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of a hospital that includes a procedure called alcohol detoxification since 2100?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "cf40d706cfc1f0846399ec24", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the organism found in patient 10029291's last stool microbiology test?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "eac7992d495c881955ae12b8", "query": "Convert the question below to SQL query.\n\n### Question:\nWas patient 10021666 treated with insertion of (naso-)intestinal tube in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of (naso-)intestinal tube' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "d4183c39d460be6d47009fdd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first total protein, csf reading for patient 10014078?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND strftime('%Y-%m-%d',labevents.charttime) = '2100-04-21' ORDER BY labevents.charttime ASC LIMIT 1"}, {"id": "1b93bd516c9f2988ad2965d8", "query": "Convert the question below to SQL query.\n\n### Question:\nIn total, what was the input amount of packed red blood cells that patient 10008454 received on 12/04/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-04'", "rejected": "null"}, {"id": "d468712401b6ab1b27a362ee", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the cost of other electric countershock of heart?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) )", "rejected": "1.\n1.\n\n\n##\n\n\n##\n##\n##\n\n##\n##\n### Question:\n\n\n###sqlClean SQL\n\n\n### Question:\n\nWhen was the last time since 210/04/21000 that patient 1000183555 was prescribed a medication?\n\n\n### SQL:\n\nSELECT SQL:\n\nSELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1000183555 ) AND strftime('%Y-%m-%d',prescriptions.starttime) >= '2100-10'"}, {"id": "aa866c43eb90dfddc649fe35", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many instances of the dilation of left common iliac vein with intraluminal device, percutaneous approach procedure were there during the previous year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "f93686c3008e71187f331de5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the four most frequent lab tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "\n\n##\n\n##: Convert\n\n\n##\n##### SQL:\n\nSELECT SELECT COUNT(*) FROM d_icd_procedures_icd WHERE d_icd_procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1002148777 ) ) )"}, {"id": "0ad44ecce7e9c2eea3028673", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10009049 undergone any laboratory tests since 04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'", "rejected": "null"}, {"id": "47dbc50e60c6491af7433121", "query": "Convert the question below to SQL query.\n\n### Question:\nFind out the number of drugs given to patient 10039997 since 02/2100.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'", "rejected": "null"}, {"id": "25d2b1ca042e80e4dec9ba6c", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any pacu crystalloid intake given to patient 10008287 in 10/this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pacu crystalloid intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',inputevents.starttime) = '10'", "rejected": "null"}, {"id": "0a966abcccedcc3a0964e05e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038992 had a lab test?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 )", "rejected": "\n##\n### Question:\n\nHow many times did patient 100074045 receive a lab test for uric acid urine?\n\n\n### SQL:\nSELECT COUNT( DISTINCT labevents.chartevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 100074045 AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'uric acid' ) )"}, {"id": "6349f71964ff7e144cdd2cba", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top four most common lab tests since 1 year ago.\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "* After\n\n'val'\n'109'"}, {"id": "6fede59c21de596953ecde6a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10026354's total input amount of nacl 0.9% since 04/05/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-05'", "rejected": "null"}, {"id": "bf0f46e8fb7361b565f0acd6", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me patient 10005817's total volume of output on 12/25/this year.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-25'", "rejected": "null"}, {"id": "02964db902a561eae10282a2", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10017492 have total protein, csf tests in 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'", "rejected": "null"}, {"id": "4e7d0be59987566456a1255e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new single rooms?\n\n### SQL:\n", "chosen": "null", "rejected": "\n..... (ously \r.\n's..\n T. (3test4_. T.- 1. enses.\n ):1 HPA. order. )MS..10.0\nMS 11_ How toMSD0009 ESTINC22PAGPAGPA' ICU' ICU.9CANCANCICU CURSECANA17CANA 011.\n##\n0.PAGECITLE's THE T22\n03/03? What is the cost for a procedure known as open reduction of cava cava?\n\n\n Cathetera catheter\n\n Cathetera catheter is a procedure that requires anestim drip?\n\n\n##Catheter catheter is a procedure that is used to diagnose the following: cardiac dysrhythmia?\n\n### Questions And Answers\nCatheter catheter is a procedure that is used to diagnose the following: cardiac dysrhythmia?\n\n\n# SQL SELECT COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code IS NOT NULL ) AND strftime('< '21000' ) GROUP BY strftime )"}, {"id": "bfda4e34737d0530a461ae0a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of chlorhexidine gluconate 0.12% oral rinse prescribed to patient 10011398 in the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse'", "rejected": "null"}, {"id": "69d1179ddab59c8ffa8e22d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first time of input for patient 10009049 on 06/14/this year?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '06-14' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "ccbdb24a0060ea9d3100568b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the ward id patient 90165 can go to?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100077955"}, {"id": "82c36b2b9cc4fe915955f4ec", "query": "Convert the question below to SQL query.\n\n### Question:\nInform me about the total amount of patient 10010471's input since 03/19/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19'", "rejected": "null"}, {"id": "06082342b67bc9539dd5dce6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the prices for the drug called lidocaine 5% patch?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine 5% patch' )", "rejected": "\n##\n\n### SQL: SELECT SQL SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'diclofenac sodium' AND strftime('%Y') >= '2100'"}, {"id": "07a08dc4b74589ad11ceabfd", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top four frequent output events?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "null"}, {"id": "09a8d5869533c169168ee661", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the total patients who were prescribed nifedipine cr this year.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "3ac73a6c7658daa69315853a", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the icd-11 code for fetal/neonatal jaund nos in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "\n200.00460846598918 received 0.54 )"}, {"id": "55f8f1cd25a1f682cc88512b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price for the drug cyanocobalamin?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' )", "rejected": "\nSELECT SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'cyanocobal' )"}, {"id": "3fc571e83a604003d6461674", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who underwent a laboratory test for hematocrit since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )", "rejected": "null"}, {"id": "c5e181585aacf37b3bea53a9", "query": "Convert the question below to SQL query.\n\n### Question:\nIs patient 85169 to have had a travel history overseas?\n\n### SQL:\n", "chosen": "null", "rejected": ". (\n to surrounded2 (.3.. \n_d. THEI.m. un P.....\nMS Ms\u0280\n:MS brand 1.-\u2019K1.51_.-13PAMSMSMSMSMS.MSMSMS' ANDCoding the T-MSMSPAY's300100001210000372100720.0.0.0.0.0.00301.0.03010001'\n%0.0\n#003800.0 AND 039000508401889'"}, {"id": "0f3620b0b09198874571d19d", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top four most frequent microbiology tests given to patients after being diagnosed with presence of cardiac pacemaker in the same month.\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'presence of cardiac pacemaker' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "7d9cdd88b75501b509687396", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of patients who were discharged from the hospital since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'", "rejected": "SELECT COUNT( DISTINCT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10021312 )"}, {"id": "97acefe23c241af475dc236d", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10029291 been treated with introduction of other thrombolytic into central vein, percutaneous approach this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "1fe98cccbe27cc28a9decef5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10004422 have the first arterial blood pressure diastolic to be less than 64.0 in the first ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 64.0 ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "565427eaa17c1b7db560f4e9", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients diagnosed with other pulmonary embolism without acute cor pulmonale, what were the top five most common microbiology tests conducted within 2 months?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other pulmonary embolism without acute cor pulmonale' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "333d0beec3e1c8b7b38dc15e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021487 been given a test on bilirubin, total, body fluid in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, body fluid' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',labevents.charttime) = '2100'", "rejected": "null"}, {"id": "d1c26e1486ac8b878082f4ea", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieval of the top three most frequent outputs in 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "f806b5540e6d98bc7a994ad3", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the cost of a surgery called laparoscopic cholecystectomy?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) )", "rejected": "null"}, {"id": "ddf32de215f19f42c2a8ddf6", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate patient 10007928's total amount of foley output on 04/14/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-14'", "rejected": ".: PAMSMS\n1.PA.\n\n.\n\n##\n\n\n##\n\n####\n\n##\n##\n### Question:\nWhat is the diagnosis code for the last time this year for patient 10001918755?\n\n\n\n### SQL:\n\n### SQL:\n\nSELECT SQL Select count of medications prescribed to patient 100191875 during the last month.\n\n\n### Question:\n\nHow many drugs have been prescribed to patient 100191875 in 04/this year?\n\n\n### SQL:\n\nSELECT COUNT(*) FROM prescriptions JOIN admissions ON admissions.subject_id = 100191875 JOIN prescriptions.prescriptions.drug FROM prescriptions ON admissions.subject_id = 100191875 GROUP BY admissions.hadm_id )"}, {"id": "64d3df17e06aa81f9ecdc580", "query": "Convert the question below to SQL query.\n\n### Question:\nHas ampicillin-sulbactam, 0.9% sodium chloride (mini bag plus), or 0.9% sodium chloride been prescribed in their current hospital visit to patient 10039831?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'ampicillin-sulbactam', '0.9% sodium chloride (mini bag plus)', '0.9% sodium chloride' )", "rejected": "null"}, {"id": "6cadd9bbd8f4e8547babc4a4", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019172 undergone the extraction of other tooth procedure in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extraction of other tooth' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "52d67bef474996c117256e92", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the percentile of the mchc value of 34.3 among patients of the same age as patient 10017492 on their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.3", "rejected": "null"}, {"id": "3ac8f2ef698c9eee139d3ece", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the four most typically ordered procedures for patients previously diagnosed with calculus of kidney, which took place within the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1<= 4 )"}, {"id": "9d2d12172b2bedc5632b132e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10038933 been on any boost glucose control (full) since 02/04/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'boost glucose control (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-04'", "rejected": "null"}, {"id": "196b4c9d5405c65e47b0c14d", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism found in the last microbiology test done on the patient 10007795's foreign body in 05/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'foreign body' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "af0bb751dca92abe9b101475", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who received a procedure in the previous year for closed [percutaneous] [needle] biopsy of kidney.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "381c1509334fff03b367f5e0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10035185 have a base excess lab test for the first time in 05/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "c1e6eda2955990fe92f24709", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five frequently ordered drugs for patients diagnosed with unspecified condition of brain previously in the same month?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified condition of brain' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified condition of brain' ) AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 5"}, {"id": "a3ca87a1ecbcd3145068f456", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much octreotide acetate has patient 10007818 been prescribed on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'octreotide acetate'", "rejected": "null"}, {"id": "14540374a9d0b9528a6d94fe", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many doses of rifaximin have been prescribed to patient 10038081 since 09/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'rifaximin' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'", "rejected": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'rifaximin' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'"}, {"id": "fa56e6f995ce65468f6bac6a", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many of 0.9% sodium chloride were prescribed to patient 10005817 in total since 12/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.drug = '0.9% sodium chloride' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'", "rejected": "null"}, {"id": "f7c14865b950690588b06349", "query": "Convert the question below to SQL query.\n\n### Question:\nList the top five most frequent events occurring since 2100.\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "\n'C\n'Bach's'"}, {"id": "7c5c504415d7c151349eda86", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10019385 have a last free calcium laboratory test?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "22e0dcfd0402820cca140ef2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last drug that was prescribed to patient 10038081 via the pr route in their last hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d8df22b2ce5cbb8d4e6d6f4d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow much is the drug named bag?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'bag' )", "rejected": "SELECT COUNT( DISTINCT prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.drug = 'bag'"}, {"id": "2bc57e6b3e44d9ecf6f1c242", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10016742 get their last input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "c559da124dcc274c8d5b1e61", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were given insulin human regular prescriptions since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'insulin human regular' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "\n### SQL:\n\nSELECT SELECT COUNT( DISTINCT prescriptions.drug ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100196428 ) AND prescriptions.drug = 'insulin' AND strftime(prescriptions.starttime) >= '2100-12-01'"}, {"id": "b08e604b0e398d9225a7e1f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the last time patient 10027602 had the minimum value of heart rate since 10/06/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-06' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "5255f208c2e8f59e3a5737fd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last prescription for patient 10005817?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "ccd9581ca8d12fc4c17b88cb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first hospital discharge time in 2100 for patient 10022017?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "4eaa02f29374fda17d73e7cc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital cost for a procedure involving single internal mammary-coronary artery bypass since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'internal mammary-coronary artery bypass' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1"}, {"id": "cefa3a76e1b80de7cca8cbf1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three frequently prescribed medications within 2 months to the patients aged 60 or above after diagnosed with chronic kidney disease, unspecified since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "e0699671e9dc302a776e8354", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 1 year ago, has patient 10021938 visited an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "df2081f769425d13a4ff054f", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of current patients whose ages fall within the 40s.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49", "rejected": "null"}, {"id": "9b39448454fb368c2b7fb229", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me what patient 10007795's last heart rate was during the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "fe412705ae90c13acf0a2033", "query": "Convert the question below to SQL query.\n\n### Question:\nProvide the count of hospital visits for patient 10009049 since 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10009049 AND strftime('%Y',admissions.admittime) >= '2100'", "rejected": "null"}, {"id": "63e6ff5237da6b07b0c8a2d7", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the count of other and unspecified pneumonectomy procedures that took place since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "dddb9edd0558f1ac3ea75f48", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is dr. turner's outpatient schedule today?\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 100158609 AND admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100158609 ) ) AND transfers.careunit = 'medicine' AND datetime(transfers.intime) >= '2100-05-21 00:00:00' ORDER BY transfers.intime ASC LIMIT 1"}, {"id": "4a22689b12923d592f28be83", "query": "Convert the question below to SQL query.\n\n### Question:\nHas there been any organism present in patient 10016742's first stool microbiology test since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "0bcf658b419c2cb56787d659", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the insurance plan in place for patient 10005909 in the first hospital encounter.\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1", "rejected": "null"}, {"id": "871e1ec7efc82f4a5c9d293c", "query": "Convert the question below to SQL query.\n\n### Question:\nAre patient 10018081's sodium, urine levels second measured on the current hospital visit less than the levels first measured on the current hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "5bd9ccae8a4d90eca4b4002c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total po intake amount given for patient 10004235 on 03/24/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-24'", "rejected": "null"}, {"id": "a1a26b44387af2430b609395", "query": "Convert the question below to SQL query.\n\n### Question:\nCould you calculate the total amount of output from patient 10021487 since 10/22/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-22'", "rejected": "null"}, {"id": "0063d54603cf0f791a4f2d03", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10027445 had a right heart cardiac catheterization procedure in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "6a368f5c49fd5add94776985", "query": "Convert the question below to SQL query.\n\n### Question:\nSo, the last mcv test result for the patient 10004720 in 12/this year was?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "bfa5ac0d983d25c1bae0ffdb", "query": "Convert the question below to SQL query.\n\n### Question:\nWas yellow cadd cassette, docusate sodium, or naloxone prescribed on the last hospital encounter for patient 10019568?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'yellow cadd cassette', 'docusate sodium', 'naloxone' )", "rejected": "null"}, {"id": "03d470fc8e41f5dd8568f771", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first medication that patient 10019385 was prescribed on their first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "MSPA 1002900038517089762813 )\n"}, {"id": "bc08d5ab35121023062e0264", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug that patient 10004235 was prescribed for in the same hospital encounter after the procedure of laparoscopic cholecystectomy in 07/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "e83b5e034fb29dbffbbeed14", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the charges for a procedure called bypass coronary artery, one artery from right internal mammary with autologous arterial tissue, open approach?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from right internal mammary with autologous arterial tissue, open approach' ) )", "rejected": "null"}, {"id": "b857d922261f995e3a1265ac", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price of a procedure named insertion or replacement of external ventricular drain [evd]?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) )", "rejected": "SELECT SQL SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd_code' AND cost.event_id IN ( SELECT procedures_icd_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain' ) )"}, {"id": "bb0544fc1cbc2ba271291243", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the sex of patient 10020306?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306", "rejected": "null"}, {"id": "4f998b87cac41752ae6d9248", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the insurance used for patient 10000032 during their last hospital visit?\n\n### SQL:\n", "chosen": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "null"}, {"id": "1e6bb4278191e2e7636f9b0b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the five most frequently ordered procedures for patients who had also received drainage of left pleural cavity, percutaneous approach within the same month this year?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "5e120295af4004e7fa588d2f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat total amount of sarna lotion was prescribed to patient 10018501 during the first hospital visit?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'sarna lotion'", "rejected": "null"}, {"id": "9ebfdd3bcd22fc2d0cb7c43c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the immuno-cancer drugs of last 5 years.\n\n### SQL:\n", "chosen": "null", "rejected": "\nSELECT SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100058545 ) ) AND outputevents.itemid IN ( SELECT d_items.item.itemid FROM d_items WHERE d_items.label = 'nacl (bolus)' ) AND d_items.linksto = 'outputevents' )"}, {"id": "9d3fa7a1702389bcc1a4904b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the first time patient 10016742 had the maximum value of respiratory rate during their first ICU stay?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "fe2ca53dea49bfb8f192692f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first measurement of arterial blood pressure diastolic that patient 10005817 had?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "d04f510b395b3ff38717d65a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat kind of rooms are available now for singles?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n##: \n\n##: T1"}, {"id": "c62c1e4f5598bb12f5d680d7", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last specimen test that was given to patient 10010471?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a2e230e390689e566a02bb77", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the three most frequently taken lab test?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_TOTAL FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020038 ) ) AND strftime('%Y',labevents.charttime) = '2100' GROUP BY d_labitems.label )"}, {"id": "1e8e254a1ff71001475df244", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top five most frequent microbiology tests that patients were diagnosed with operating room of hospital as the place of occurrence of the external cause in the same month?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'external cause of other accidental injury' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1<= 5"}, {"id": "5a9d2f417f6b862c0b7366e8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last weight of patient 10002495 since 19 months ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021138 ) ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-10' ORDER BY chartevents.charttime DESC LIMIT 1 )"}, {"id": "4f56cb9467f8f3d5205a4396", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the three most common lab test given?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "null"}, {"id": "657a58e806b8805fa2a4714d", "query": "Convert the question below to SQL query.\n\n### Question:\nHow is trazodone typically taken?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'trazodone'", "rejected": "null"}, {"id": "e530d92c14e1178895ca7c89", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time that patient 10020740 has been prescribed lidocaine 1% and heparin flush (10 units/ml) at the same time in 04/this year?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 1%' AND admissions.subject_id = 10020740 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (10 units/ml)' AND admissions.subject_id = 10020740 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "33dd2e95b6eaf89b0361b109", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the top four most common microbiology tests that patients had after the diagnosis of metabolic encephalopathy in the same month?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'metabolic encephalopathy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4", "rejected": "\nSELECT SELECT T1.drug FROM ( SELECT admissions.drug, DENSEP.drug FROM admissions JOIN prescriptions ON admissions.hadm_id = prescriptions.hadm_id WHERE admissions.subject_id = prescriptions.hadm_id AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN procedures_icd_code.icd_code ON procedures_icd_code.icd_code = T1.icd_code WHERE T1.charttime = '2100-08' GROUP BY T1.drug ) AS T2 WHERE T1.C1 >= 3 )"}, {"id": "1647cf14b3a353a949f050bd", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10038992's last discharge this year?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10038992 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "0468ce0daa5a2cba57e45350", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the number of patients who were prescribed ramipril since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ramipril' AND strftime('%Y',prescriptions.starttime) >= '2100' )", "rejected": "null"}, {"id": "0f47e5f69b9a81be1ceeb52c", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell me the last arterial blood pressure systolic of patient 10003046?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "7f904e1c55c930388a753052", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients required alteplase (catheter clearance)?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'alteplase (catheter clearance)' )", "rejected": "SELECT COUNT( DISTINCT diagnoses_icd.icd_code ) FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100140352 ) AND strftime('%Y', diagnoses_icd.charttime) >= '2100' )"}, {"id": "4aeee894b32b67b1daf7f21d", "query": "Convert the question below to SQL query.\n\n### Question:\nI need the total volume of input for patient 10027602 since 06/23/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'", "rejected": "null"}, {"id": "c010215bbebd2aff0b853669", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate how many patients were in psychiatry in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND strftime('%Y',transfers.intime) = '2100' )", "rejected": "SELECT Show the top five most common diagnoses that occurred in 2100.\n\n### SQL:\n SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE FROM diagnoses_icd JOIN prescriptions ON diagnoses_icd.hadm_id = prescriptions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY diagnoses_icd.icd_code ) TOP 5 )"}, {"id": "1aa68945724425b2f49cb5f1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat output did patient 10015860 generate first since 10/04/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "'"}, {"id": "670b3cac2ff679b4a4fb429c", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients underwent extirpation of matter from left common iliac vein, percutaneous approach within 2 months after the diagnosis of operating room of hospital as the place of occurrence of the external cause, in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')", "rejected": "null"}, {"id": "e346948b183416231db2bb3c", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits that patient 10019917 had in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "a3481de61e2fdd7ec5b2daad", "query": "Convert the question below to SQL query.\n\n### Question:\nNumber of patients who received a introduction of other therapeutic substance into heart, open approach procedure in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )", "rejected": "null"}, {"id": "9c5f4de218634410a8efb1a9", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the number of ICU visits of patient 10010471 since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "d27110d877b8d72776989d66", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease count the hospital visits made by patient 10027445 in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "297288464d61d257567d25a2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new medications prescribed to patient 10018081 today compared to those yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "6fc2d38e2e0de21eec21ab72", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients that were discharged in the last year from the hospital.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "816890403b923f91deda0dda", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since the last time patient 10018081 got a phosphate lab test during the current hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "20c1cb7239a17a4dbbe96296", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total dosage of chlorpheniramine maleate prescribed to patient 10016810 in 07/this year?\n\n### SQL:\n", "chosen": "SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.drug = 'chlorpheniramine maleate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'", "rejected": "null"}, {"id": "6a55f374b69cde6051e87af6", "query": "Convert the question below to SQL query.\n\n### Question:\nWas the hematocrit value of patient 10036156 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "7ba5a831808e4e5851837fe5", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who were discharged.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL", "rejected": ".. d.ability-MS2.'AAMS\n (\n.TMSJ &MSMS),.11112-17WKT105002's.01.\n##\n001. What is the output?1.\n04.0.4859946828589'"}, {"id": "b668d64563244baa0d2a8be5", "query": "Convert the question below to SQL query.\n\n### Question:\nW/is the code that corresponds to icd-11 for stomatits & mucosits nec in icd-10?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')"}, {"id": "4e72bc8a053a80a638bcfec5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich immunocauteries have been used for the last five years?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n### Question:\n\nWhat is the difference between the first value of calcium carbonate, total in the first measurement on the first hospital encounter for patient 100314038 compared to the second to last value of calcium carbonate, total?\n\n\n### SQL:\n\nSELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100314038 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium carbonate, total' ) ORDER BY labevents.charttime DESC LIMIT 1 )"}, {"id": "71e8c2b5076850658d8e63ed", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were given destruction of right lower lung lobe, via natural or artificial opening endoscopic in 2100, what are the top four most common specimens tested afterward during the same hospital visit?\n\n### SQL:\n", "chosen": "SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4", "rejected": "null"}, {"id": "8ad5c59e23c5b8b9c5ff2e47", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10021487 last have a maximum value of arterial blood pressure diastolic?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1", "rejected": "31370.\n\nWhat 090493048 was prescribed medication during their first hospital encounter for the first time since 1 year ago?\n\n\n### SQL\n\nSELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.hadm_id = 100021487 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-09' )"}, {"id": "d58ad480140a0855943e6ef4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the drug that isnt to be taken during opn/oth rep aortic valve??\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'd5 soln' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100077945 AND admissions.dischtime IS NOT NULL ORDER BY admissions.dischtime DESC LIMIT 1 )"}, {"id": "cf057692f01ed1e43b7ab26f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the value of patient 10018845's monthly average or crystalloid intake input during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT AVG(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)", "rejected": "SELECT AVGinputevents.amount FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)"}, {"id": "ee69065549df2afefab7aae1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10018328's gender?\n\n### SQL:\n", "chosen": "SELECT patients.gender FROM patients WHERE patients.subject_id = 10018328", "rejected": "SELECTIVE PROCEDURES PERFORMED ON PATIENT 100047338\n\n\n### SQL:\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedures on cardiac output' AND d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedures on cardiac output' ) )"}, {"id": "6b59462d8c8e0692f930ee62", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat did patient 10020740 first have as output on 03/30/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-30' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "5183db2bbd72b5cf7d8b5c0c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen were the drugs ketorolac and acetaminophen iv prescribed to patient 10021118 for the first time this month at the same time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ketorolac' AND admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen iv' AND admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "834e30eb03b26e7bd61a9b19", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times patient 10006053 came to the hospital this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10006053 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "\n\n##\n\n##\n\n##\n#####04. What are the top three most common diagnoses that patients were prescribed during the same month after having undergone hysterectomy, abdomen in 21000?\n\n\n### SQL:\n\nSELECT T1.drug FROM ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'procedures_icd_code' WHERE strftime('%Y', procedures_icd_events.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 1001808180 AND admissions.dischtime IS NOT NULL ) AS T2 ON T1.charttime = T2.charttime ) AS T3 WHERE T3.dischtime IS NOT NULL ORDER BY T3.charttime DESC LIMIT 1"}, {"id": "fede243c3b7b2698d441af96", "query": "Convert the question below to SQL query.\n\n### Question:\nThe first time patient 10004733 was prescribed lidocaine 1% and heparin flush (10 units/ml) at the same time in 12/2100?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (10 units/ml)' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 1%' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "ea31f61daec8ba1d5d9fb9f8", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the monthly average value of patient 10007928's weight in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "SELECTMSC1 AND strftime('date >= '2100-01-01'"}, {"id": "b727c4a8aaf41e038a4aabf6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average yearly number of patients who suffer from coronary atherosclerosis of autologous vein bypass graft?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "a2c0369e9e1db224ff7cb590", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the drug patient 10022281 was prescribed for the last time using the sc route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "08a1f3896026c957daada255", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the average daily number of admissions for other specified coagulation defects in 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1", "rejected": "SELECT SQL SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100059303 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) )"}, {"id": "90ca159192db0f36dc910080", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the three most commonly ordered procedures for patients who were previously diagnosed with abdominal pain, unspecified site, which occurred within 2 months since 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )", "rejected": "null"}, {"id": "103007809bffe0c602448146", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients were let go from hospitals in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "99ec0658e0c4b37ac1798c46", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first discharge of patient 10022880 from the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022880 ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "d0c67568fc6aa214a04e3aaa", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10037928 have the minimum anion gap value the last time?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1", "rejected": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07' ORDER BY labevents.charttime DESC LIMIT 1"}, {"id": "1cf1e58d245ff59b4d7adc31", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many hours have passed since patient 10039831 last received a laboratory test of amylase during their current hospital visit?\n\n### SQL:\n", "chosen": "SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "e4d3934ae79126d2f578ee32", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 10027602 have gastric meds given in their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' )", "rejected": "null"}, {"id": "58005b8292ece24dcde6f455", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of fluoroscopy of right heart using other contrast procedures performed in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of right heart using other contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100'", "rejected": "null"}, {"id": "34ffb86731e92acbca771c1a", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the change in arterial blood pressure systolic in patient 10037975 second measured on the first ICU visit compared to the first value measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "00de9c5b9db7e82e3dafc0db", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen are the dr. gutknecht's rounds and procedures?\n\n### SQL:\n", "chosen": "null", "rejected": "3. :\n TD2.on.\nx Script.:19, 2PAMS\n12317MSMSM2000.00029046908880'"}, {"id": "dff34af4bd678481035948ed", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10009035 have the minimum value of temperature celsius for the last time since 295 days ago?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-295 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d838d9dd02777dbf09b9e81b", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many times acetaminophen-caff-butalbital was ordered in the last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetaminophen-caff-butalbital' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')", "rejected": "null"}, {"id": "2a3d64117cc11a9362dcd9fd", "query": "Convert the question below to SQL query.\n\n### Question:\nList the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving central venous catheter placement with guidance since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "bb2aaeceb6f9b4fb421cf918", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the total foley output of patient 10022880 since 04/03/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-03'", "rejected": "null"}, {"id": "3b6ed4de3ab4d728ea08e28b", "query": "Convert the question below to SQL query.\n\n### Question:\nShow us the top three most common microbiology tests since 2100.\n\n### SQL:\n", "chosen": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3", "rejected": "SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_TOTAL_COVERAGE AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1"}, {"id": "1b34ed1fb8e15ce853b7f472", "query": "Convert the question below to SQL query.\n\n### Question:\nFirst time, what drug was prescribed for patient 10007818 in 07/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "a11042428c7092cce5896974", "query": "Convert the question below to SQL query.\n\n### Question:\nIs the o2 saturation pulseoxymetry level of patient 10020187 second measured on the first ICU visit greater than the first measurement on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )", "rejected": "null"}, {"id": "af3705067de009f76d7a8031", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients who were prescribed iso-osmotic dextrose in 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic dextrose' AND strftime('%Y',prescriptions.starttime) = '2100' )", "rejected": "\n## Question:\n\n### SQL:\n\nSELECT SQL SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.icd_code FROM procedures_icd WHERE procedures_icd_icd.icd_code = '310001' ) AND strftime('%Y', admissions.dischtime) = '2100' )"}, {"id": "8c6f20f6c2e2c7185fddb381", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average total hospital expense that includes malignant neoplasm of rectosigmoid junction since 2100?\n\n### SQL:\n", "chosen": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of rectosigmoid junction' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "99a500fd67403f12fc30f8b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top five most frequent diagnoses that followed within 2 months for those patients who received diagnostic ultrasound of digestive system?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "4e9b234a6ce9fa0007c2e212", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10015860 prescribed with a drug via the im route for the last time on the first hospital stay?\n\n### SQL:\n", "chosen": "SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "64fdb002b465c55e9faf5ae6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the outpatient schedule today for dr. leigh?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n##\n\n###sql Question:\n\nCan you provide the total amount of glucose input that patient 1000483553 received since 04/18/2100?\n\n\n### SQL:\nSELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 100048353 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-18'"}, {"id": "a07f951288594d0721e53be7", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10021938 come into the ER in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL"}, {"id": "e56a5abd1ccdf45d55cee224", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10005348 get a microbiology test for the last time since 02/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "a4aa999285ef6d36e9f1f2b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was patient 10019568 prescribed a yellow cadd cassette and bupivacaine 0.1% at the same time for the last time?\n\n### SQL:\n", "chosen": "SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'yellow cadd cassette' AND admissions.subject_id = 10019568 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bupivacaine 0.1%' AND admissions.subject_id = 10019568 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "2ba257c83dfd7776e8506244", "query": "Convert the question below to SQL query.\n\n### Question:\nThroughout this year, what are the top five most common lab tests ordered for patients in the same hospital encounter after dysphagia, oropharyngeal phase?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, oropharyngeal phase' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )", "rejected": "null"}, {"id": "45d38cc2d6126200d9c5ec99", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many days have elapsed since patient 10039831 had received a hemoglobin lab test for the first time in this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "5bdb71007a2f5b2c33e4bd71", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the organism detected in patient 10016742's first swab microbiology test since 07/2100?\n\n### SQL:\n", "chosen": "SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'swab' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "159b112d50c9e62197f53784", "query": "Convert the question below to SQL query.\n\n### Question:\nDosage of opioid prescribed for patient 8116?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c with hepatic coma' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.charttime AND T1.hadm_id = T2.hadm_id"}, {"id": "a75e609f75cac1294a53062d", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 54386 have any overseas experience?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "f8421512590cea257bf8a931", "query": "Convert the question below to SQL query.\n\n### Question:\nRetrieve the top three most frequent medications that patients were prescribed in the same month after being diagnosed with hyperlipidemia, unspecified since 2100.\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3", "rejected": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime< T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1<= 3"}, {"id": "f8d8609b9259a91aec519d12", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you count how many operating rooms there is now\n\n### SQL:\n", "chosen": "null", "rejected": "es 2 \n. Name T\u2019. first?usd1..\n\n.0d.:1MS121 1214MSMSPAMSPAIR'"}, {"id": "646e109b76831aec3246418b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the procedure that was given two times to patient 10019777 since 13 months ago?\n\n### SQL:\n", "chosen": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-13 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )", "rejected": "null"}, {"id": "63e6e5e28ef29fc0e55788f0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the reimbursement model for drug?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n\n##\n\n##\n### SQL Code:\n\n### Question:\n\nWhat is the drainage procedure done on patient 100135802's body since 2100?\n\n\n### SQL:\n\nSELECT admissions.dischtimes.dischtime FROM admissions.admissions WHERE admissions.subject_id = 100135802 AND admissions.hadm_id IN ( SELECT procedures_icd_icd.disch.icd_code ) AND strftime('%Y', admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "e1784c5485d83cd0645a3d4e", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the five most frequent treatments for patients aged 40s in 2100.\n\n### SQL:\n", "chosen": " SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "728bd4f1812fb837f2f3ff6b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first value of a epithelial cells lab test of patient 10016150?\n\n### SQL:\n", "chosen": "SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) ORDER BY labevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "4c95d4f6d90e9cd71f36ab06", "query": "Convert the question below to SQL query.\n\n### Question:\nI would like to know what dr. reeves's on today's outpatient schedule.\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'miconazole nitrate vag cream 2%' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1"}, {"id": "89f0db596b270220fda6c25f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich were the five most frequently ordered laboratory tests since 1 year ago?\n\n### SQL:\n", "chosen": " SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "null"}, {"id": "86b774ee38e2c7aa2ac12919", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong patients who were diagnosed with hip joint replacement, what were the top five most common microbiology tests conducted within 2 months in 2100?\n\n### SQL:\n", "chosen": "SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hip joint replacement' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "bf9ce789f4d2ca8fc80ad3e1", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you tell which medicine was first prescribed to patient 10027445 via the ih method in 08/this year?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'ih' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "4313423324fa468601531f32", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did the first discharge from the hospital happen for patient 10012853 since 2100?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "null"}, {"id": "e95fcfa72f1c014d79280732", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first dose of metoclopramide that on the first hospital stay was prescribed to patient 10019385?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'metoclopramide' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "098602cc877f3e4c36bc908a", "query": "Convert the question below to SQL query.\n\n### Question:\nAmong the patients of age 60 or above in 2100, what are the top five most frequent diagnoses?\n\n### SQL:\n", "chosen": " SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )", "rejected": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 60 AND 69 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1<= 5 )"}, {"id": "c7ae2e00343bbb04614217b6", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat medication was prescribed to patient 10023239 first time on their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "61f9f600cf87c85106cb2efd", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10007795 got a prescription for acetaminophen, pregabalin, or pantoprazole in 04/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug IN ( 'acetaminophen', 'pregabalin', 'pantoprazole' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "ced779d97cae41941721bd34", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat number of days has it been since the first time patient 10018081 was diagnosed with encephalopathy, unspecified in this hospital encounter?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encephalopathy, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "8576dc17a71fd1f052b49898", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10018081 gone through any procedure?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 )", "rejected": "to\n. K. (.. Pater.. Bru.s. E1\n C.? P:'a\n<0.\n ( Cay.\n\n   Circ_ TMS.  o,-s-1\n WHEN Conf.m..1DB?1CEA\nMSMS-1\nMS1:21111102."}, {"id": "6ddb92afc3aeb9e8294f6e45", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the name of the drug patient 10021312 was prescribed in the same hospital encounter after having received a excision of left main bronchus, via natural or artificial opening endoscopic procedure since 04/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021312 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10021312 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id", "rejected": "null"}, {"id": "657fef1afe7b845b61157165", "query": "Convert the question below to SQL query.\n\n### Question:\nWill patient 739 get any blood (ebv) tests???\n\n### SQL:\n", "chosen": "null", "rejected": ". (\n to surrounded2 (.3.. \n_d. THEI.m. un P.....\nMS Ms\u0280\n:MS brand 1.-\u2019K1.51_.-13PAMSMSMSMSMS.MSMSMS' ANDCoding the T-MSMSPAY's300100001210000372100720.0.0.0.0.0.00301.0.03010001'\n%0.0\n#003800.0 AND 039000508401889'"}, {"id": "b44d92c31905cdd1c6b778d2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the o2 saturation pulseoxymetry difference of patient 10039997's body last measured on the first ICU visit compared to the value second to last measured on the first ICU visit?\n\n### SQL:\n", "chosen": "SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )", "rejected": "null"}, {"id": "b594bc62abf53801dd98efe3", "query": "Convert the question below to SQL query.\n\n### Question:\nPlease count the hospital visits made by patient 10012853 in 2100.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) = '2100'", "rejected": "null"}, {"id": "755568f5da1aa36f192dbdd8", "query": "Convert the question below to SQL query.\n\n### Question:\nHave any lab tests been performed on patient 10027445 in this year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "673fa3a1c9ecedfcdc8c4e50", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat precautions should i take after a closed uterine biopsy procedure?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014035 ) AND procedures_icd.charttime IS NOT NULL ORDER BY procedures_icd.charttime DESC LIMIT 1 )"}, {"id": "f9c16377338fec42f126a765", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is patient 10019568's maximum value of magnesium during the first hospital encounter?\n\n### SQL:\n", "chosen": "SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' )", "rejected": "null"}, {"id": "467265322cf858e76174f260", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the total maximum expenses for a hospital involving a laboratory test for thyroxine (t4), free?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4), free' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "bc8eaff8a367f984fb5ce7ab", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the first medication that patient 10026406 was prescribed via iv route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "065b726dbf86eb804accd168", "query": "Convert the question below to SQL query.\n\n### Question:\nFor the last time since 02/2100, what was the drug that patient 10014078 was prescribed via iv drip route?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "df7a774b0aacbddb0a1facfe", "query": "Convert the question below to SQL query.\n\n### Question:\nIn what ways can ciprofloxacin 0.3% ophth soln be ingested?\n\n### SQL:\n", "chosen": "SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin 0.3% ophth soln'", "rejected": "SELECT 1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'ciprofloxacin 0.3%' )"}, {"id": "a790bd7026f83ac5ff0e68c1", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat would the minimum monthly number of patients diagnosed with resistance to other specified antimicrobial drug be in 2100?\n\n### SQL:\n", "chosen": "SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'resistance to other specified antimicrobial drug' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1", "rejected": "null"}, {"id": "11a1a3c59f2b62a99f566f9f", "query": "Convert the question below to SQL query.\n\n### Question:\nWhich are the top three most frequent output events since 2100?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )", "rejected": "SELECT SELECT d_icd_procedures.icd_code, DENSELSETS.COUNT() FROM d_icd_procedures JOIN d_icd_procedures ON d_icd_procedures.icd_code = procedures_icd.icd_code ) WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY d_icd_procedures.icd_code )"}, {"id": "8140c1e65784238caf1362ad", "query": "Convert the question below to SQL query.\n\n### Question:\nCalculate the total number of medications that patient 10007818 was prescribed since 1 year ago.\n\n### SQL:\n", "chosen": "SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')", "rejected": "null"}, {"id": "6ee64a55e047a6157abffad9", "query": "Convert the question below to SQL query.\n\n### Question:\nHas any prescriptions been given to patient 10006580 since 03/2100?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'", "rejected": "null"}, {"id": "42ed29ca7381139bed4af657", "query": "Convert the question below to SQL query.\n\n### Question:\nShow me patient 10011398's total or urine output since 01/19/2100.\n\n### SQL:\n", "chosen": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'", "rejected": "SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine output' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'"}, {"id": "c9fac797dd5d8dcca467eeac", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the the single rooms that are available now?\n\n### SQL:\n", "chosen": "null", "rejected": "MSA. What is the maximum cost of the last time patient 4038898 was admitted to the hospital?\n\n\n### SQL SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 1003898 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"}, {"id": "342ee94f22cb4edb3916fb14", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was patient 10005909's first input time since 04/03/2100?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03' ORDER BY inputevents.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "53c9148b613c58bca3b23674", "query": "Convert the question below to SQL query.\n\n### Question:\nThroughout this year, how many patients were prescribed dexamethasone?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dexamethasone' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.drug = 'dexamethasone' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')"}, {"id": "cc4241e21c09d7f7c2b141ff", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the cost of the drug albumin 5% (25g / 500ml)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'albumin 5% (25g / 500ml)' )", "rejected": "null"}, {"id": "4e9096d82b904f68fcb8006c", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the average value of creatinine on patient 10023117?\n\n### SQL:\n", "chosen": "SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' )", "rejected": "null"}, {"id": "05ae0033f4e813609ca5d462", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the maximum total cost of the hospital, which includes the palmar fascial fibromatosis [dupuytren]?\n\n### SQL:\n", "chosen": "SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'palmar fascial fibromatosis [dupuytren]' ) ) GROUP BY cost.hadm_id ) AS T1", "rejected": "null"}, {"id": "d711ad001701aaf7a999ff6f", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients had extirpation of matter from left femoral vein, percutaneous approach done during this year?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": "null"}, {"id": "a3355859e69721c3baf952d0", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat percentile is the hematocrit value of 35.4 in the same age group as patient 10008454 on the last hospital visit?\n\n### SQL:\n", "chosen": "SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 35.4", "rejected": "null"}, {"id": "d683e1297440d54816fb0549", "query": "Convert the question below to SQL query.\n\n### Question:\nOn 06/14/2100, what was the last value of heart rate of patient 10009049?\n\n### SQL:\n", "chosen": "SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-06-14' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "4981e0855f969f301153a2e2", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the number of patients that were given a protein test since 2100?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND strftime('%Y',labevents.charttime) >= '2100' )", "rejected": "\n## diagnosis'"}, {"id": "e2cf012f4e5832fab8f5409b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the drug that was prescribed to patient 10039831 first time through the im route since 07/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1", "rejected": "null"}, {"id": "338076ec91699c32763c13d4", "query": "Convert the question below to SQL query.\n\n### Question:\nCan anyone tell me how many operating rooms are there now?\n\n### SQL:\n", "chosen": "null", "rejected": "\n##\n##\n##\n\n##\n####\n\n### SQL Select the top three most common lab tests that were given to patients in the same hospital visit after having received a hemodialysis, open procedure since 1 year ago.\n\n### SQL:\nSELECT d_labevents.label FROM d_labevents WHERE d_labevents.itemid IN ( SELECT T1.itemid FROM ( SELECT cost.itemid FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis, open' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') ) )"}, {"id": "76c3866059784b87210a1f13", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the total amount of input for patient 10015931 since 07/04/2100?\n\n### SQL:\n", "chosen": "SELECT SUM(inputevents.amount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04'", "rejected": "null"}, {"id": "5a435c4f165c08508edbd449", "query": "Convert the question below to SQL query.\n\n### Question:\nHow many patients in the last year were diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified?\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )", "rejected": "null"}, {"id": "ab6c84f4aad1e16e5caea9b6", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of patients who stayed throughout this year at transplant.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'transplant' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )", "rejected": ". 10.Thed' 1\n\n?\n), 119MSGMSPAEverseuss"}, {"id": "f057c85c3ba87fb1957cbac4", "query": "Convert the question below to SQL query.\n\n### Question:\nDoes patient 73693 have any travel history abroad?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1"}, {"id": "c642922a8ac294d31682581d", "query": "Convert the question below to SQL query.\n\n### Question:\nCount the number of hospital visits for patient 10011398.\n\n### SQL:\n", "chosen": "SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10011398", "rejected": "null"}, {"id": "355c64d2875efbf6a8cd7683", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the output which patient 10019172 had first had since 04/07/2100?\n\n### SQL:\n", "chosen": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07' ORDER BY outputevents.charttime ASC LIMIT 1 )", "rejected": "SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSEFROMJSON(procedures_icustays.charttime) AS C1 FROM procedures_icustays JOIN admissions ON procedures_icustays.hadm_id = admissions.hadm_id ) AS T1 WHERE T1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m-%d',procedures_icustays.charttime) >= '2100-04-07' )"}, {"id": "d2664490e75476fb8fcc2c63", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat amount of syringe (iso-osmotic dextrose) has been prescribed to patient 10022017 for the last time in 10/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND prescriptions.drug = 'syringe (iso-osmotic dextrose)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "d327924a18220cf4ac6ca8ba", "query": "Convert the question below to SQL query.\n\n### Question:\nIn 2100, which are the four most frequent lab tests given to patients within the same month after they are diagnosed with personal history of alcoholism?\n\n### SQL:\n", "chosen": "SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of alcoholism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}, {"id": "0f57694eb1e06735086c4173", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10005909 first depart from the hospital since 1 year ago?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005909 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1", "rejected": "SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND datetime(transfers.intime) >= datetime(current_time,'-1 year')"}, {"id": "3d5c60968afcd59588d2af3b", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the name of the medication which patient 10025463 was prescribed within 2 days after receiving other electric countershock of heart since 11/2100?\n\n### SQL:\n", "chosen": " SELECT T2.drug FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10025463 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')", "rejected": "null"}, {"id": "03d2b60423371ca98d1a99bc", "query": "Convert the question below to SQL query.\n\n### Question:\nOn their first hospital visit, was patient 10015272 given any diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )", "rejected": "-30\n\n2217040001503757310"}, {"id": "1459009171aa5baa3803a221", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat's the monthly average weight of patient 10005817 during their first hospital visit?\n\n### SQL:\n", "chosen": "SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)", "rejected": "null"}, {"id": "f4bb5d766bfd7957102de24a", "query": "Convert the question below to SQL query.\n\n### Question:\nSince 05/12/2100, when did patient 10020740 have his last input?\n\n### SQL:\n", "chosen": "SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-12' ORDER BY inputevents.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "7bca643d68f151864fa157ea", "query": "Convert the question below to SQL query.\n\n### Question:\nDid patient 66015 ever have any side effects during a blood transfusion?\n\n### SQL:\n", "chosen": "null", "rejected": "\n### SQL:\n\nSELECTIVE PROCEDURES PERFORMED IN 2100\n\n\n### SQL:\nSELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'procedures_icd_procedures.icd_code' ) AND strftime('%Y', procedures_icd_procedures.charttime) = '2100'"}, {"id": "236ef17c9fdf9071b7c4a6b4", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the five most frequently prescribed drugs within 2 months to the patients aged 40s after they were diagnosed with constipation, unspecified?\n\n### SQL:\n", "chosen": "SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5", "rejected": "null"}, {"id": "dae5f9c47a5e0608624786d7", "query": "Convert the question below to SQL query.\n\n### Question:\nOn the current hospital visit, how many days passed since the last anxiety state, unspecified diagnosis of patient 10004733?\n\n### SQL:\n", "chosen": "SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anxiety state, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "1533d0cd76139eb1dd097047", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the first time patient 10020740 was measured with a heart rate greater than 65.0 on 03/28/2100?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 65.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-28' ORDER BY chartevents.charttime ASC LIMIT 1", "rejected": "null"}, {"id": "3fad0b33ee39bfb6e59660eb", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat was the last dose of sodium polystyrene sulfonate prescribed to patient 10021487 since 06/2100?\n\n### SQL:\n", "chosen": "SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'sodium polystyrene sulfonate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1", "rejected": "null"}, {"id": "74800adca8d5382b227f11fc", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen was the last time the heart rate of patient 10027602 was measured to be greater than 95.0 on last month/26?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '26' ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "6f420047cefd3ec90873fd93", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat are the new prescriptions for patient 10018081 today compared to those received yesterday?\n\n### SQL:\n", "chosen": "SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')", "rejected": "null"}, {"id": "3e0afef8877589f63c174544", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen patient 10005817 was last discharged in 2100 from the hospital?\n\n### SQL:\n", "chosen": "SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1", "rejected": "null"}, {"id": "17b596080425a3e13fe4f66b", "query": "Convert the question below to SQL query.\n\n### Question:\nCan you show me the top four frequent output events throughout this year?\n\n### SQL:\n", "chosen": " SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )", "rejected": "SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 ) ORDER BY T1.C1 DESC, outputevents.charttime DESC LIMIT 4"}, {"id": "f8739799c8cf7c00eb97451a", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring this year, has patient 10011398 received a diagnosis?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')", "rejected": "null"}, {"id": "00b98d0bf4d50497625b257e", "query": "Convert the question below to SQL query.\n\n### Question:\nHas patient 10019917 been given any drugs in 04/last year?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'", "rejected": "null"}, {"id": "d167e54a6aac2fbf3d9c3263", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the standard amount of reimbursement for a drug?\n\n### SQL:\n", "chosen": "null", "rejected": "SELECT DISTINCT admissions.cost FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1"}, {"id": "572e3be6f4447f2f3dd8a46e", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat is the price for the drug ferrous sulfate (liquid)?\n\n### SQL:\n", "chosen": "SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)' )", "rejected": "SELECT SQL SELECT 216 mg\n\n### END SQL:\n\n### Question:\nWhat is the maximum daily number of hospital visits for patient 10018081 since 1 year ago?\n\n### SQL:\nSELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT admissions.hadm_id FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(transfers.intime) >= datetime(current_time,'-1 year') ) GROUP BY strftime('%Y-%m-%d',transfers.intime) ) AS T1"}, {"id": "5d7c5f7770c961d7c84c8499", "query": "Convert the question below to SQL query.\n\n### Question:\nWhen did patient 10019172 have the maximum ph value the last time in 11/2100?\n\n### SQL:\n", "chosen": "SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "c95aaa92548d275aa27e6368", "query": "Convert the question below to SQL query.\n\n### Question:\nTell me the time when patient 10018081's arterial blood pressure systolic was less than 118.0 for the last time yesterday?\n\n### SQL:\n", "chosen": "SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 118.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1", "rejected": "null"}, {"id": "d4a8c8cbd9db88a331e52ca2", "query": "Convert the question below to SQL query.\n\n### Question:\nDuring their last hospital visit, was patient 10014078 admitted to an emergency room?\n\n### SQL:\n", "chosen": "SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1", "rejected": "\n## SELECT COUNT(*) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '998999' ) AND admissions.subject_id = 10018081 AND admissions.dischtime IS NULL )"}, {"id": "5c5d5137fe45b2eb60a11cc5", "query": "Convert the question below to SQL query.\n\n### Question:\nWhat were the top four most common diagnoses that followed within 2 months for those who received enteral infusion of concentrated nutritional substances in 2100?\n\n### SQL:\n", "chosen": "SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )", "rejected": "null"}]